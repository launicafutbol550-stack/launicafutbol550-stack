var qF=Object.defineProperty;var XF=(n,e,t)=>e in n?qF(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var hr=(n,e,t)=>XF(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function PT(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var V2={exports:{}},Iy={},B2={exports:{}},_n={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dm=Symbol.for("react.element"),$F=Symbol.for("react.portal"),YF=Symbol.for("react.fragment"),KF=Symbol.for("react.strict_mode"),QF=Symbol.for("react.profiler"),ZF=Symbol.for("react.provider"),JF=Symbol.for("react.context"),e4=Symbol.for("react.forward_ref"),t4=Symbol.for("react.suspense"),n4=Symbol.for("react.memo"),r4=Symbol.for("react.lazy"),$C=Symbol.iterator;function i4(n){return n===null||typeof n!="object"?null:(n=$C&&n[$C]||n["@@iterator"],typeof n=="function"?n:null)}var z2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},H2=Object.assign,G2={};function Cd(n,e,t){this.props=n,this.context=e,this.refs=G2,this.updater=t||z2}Cd.prototype.isReactComponent={};Cd.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Cd.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function W2(){}W2.prototype=Cd.prototype;function NT(n,e,t){this.props=n,this.context=e,this.refs=G2,this.updater=t||z2}var LT=NT.prototype=new W2;LT.constructor=NT;H2(LT,Cd.prototype);LT.isPureReactComponent=!0;var YC=Array.isArray,j2=Object.prototype.hasOwnProperty,DT={current:null},q2={key:!0,ref:!0,__self:!0,__source:!0};function X2(n,e,t){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)j2.call(e,r)&&!q2.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=t;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:dm,type:n,key:s,ref:o,props:i,_owner:DT.current}}function s4(n,e){return{$$typeof:dm,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function kT(n){return typeof n=="object"&&n!==null&&n.$$typeof===dm}function o4(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var KC=/\/+/g;function Ox(n,e){return typeof n=="object"&&n!==null&&n.key!=null?o4(""+n.key):e.toString(36)}function Jv(n,e,t,r,i){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case dm:case $F:o=!0}}if(o)return o=n,i=i(o),n=r===""?"."+Ox(o,0):r,YC(i)?(t="",n!=null&&(t=n.replace(KC,"$&/")+"/"),Jv(i,e,t,"",function(u){return u})):i!=null&&(kT(i)&&(i=s4(i,t+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(KC,"$&/")+"/")+n)),e.push(i)),1;if(o=0,r=r===""?".":r+":",YC(n))for(var a=0;a<n.length;a++){s=n[a];var l=r+Ox(s,a);o+=Jv(s,e,t,l,i)}else if(l=i4(n),typeof l=="function")for(n=l.call(n),a=0;!(s=n.next()).done;)s=s.value,l=r+Ox(s,a++),o+=Jv(s,e,t,l,i);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Rg(n,e,t){if(n==null)return n;var r=[],i=0;return Jv(n,r,"","",function(s){return e.call(t,s,i++)}),r}function a4(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var qi={current:null},e_={transition:null},l4={ReactCurrentDispatcher:qi,ReactCurrentBatchConfig:e_,ReactCurrentOwner:DT};function $2(){throw Error("act(...) is not supported in production builds of React.")}_n.Children={map:Rg,forEach:function(n,e,t){Rg(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Rg(n,function(){e++}),e},toArray:function(n){return Rg(n,function(e){return e})||[]},only:function(n){if(!kT(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};_n.Component=Cd;_n.Fragment=YF;_n.Profiler=QF;_n.PureComponent=NT;_n.StrictMode=KF;_n.Suspense=t4;_n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=l4;_n.act=$2;_n.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=H2({},n.props),i=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=DT.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)j2.call(e,l)&&!q2.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:dm,type:n.type,key:i,ref:s,props:r,_owner:o}};_n.createContext=function(n){return n={$$typeof:JF,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:ZF,_context:n},n.Consumer=n};_n.createElement=X2;_n.createFactory=function(n){var e=X2.bind(null,n);return e.type=n,e};_n.createRef=function(){return{current:null}};_n.forwardRef=function(n){return{$$typeof:e4,render:n}};_n.isValidElement=kT;_n.lazy=function(n){return{$$typeof:r4,_payload:{_status:-1,_result:n},_init:a4}};_n.memo=function(n,e){return{$$typeof:n4,type:n,compare:e===void 0?null:e}};_n.startTransition=function(n){var e=e_.transition;e_.transition={};try{n()}finally{e_.transition=e}};_n.unstable_act=$2;_n.useCallback=function(n,e){return qi.current.useCallback(n,e)};_n.useContext=function(n){return qi.current.useContext(n)};_n.useDebugValue=function(){};_n.useDeferredValue=function(n){return qi.current.useDeferredValue(n)};_n.useEffect=function(n,e){return qi.current.useEffect(n,e)};_n.useId=function(){return qi.current.useId()};_n.useImperativeHandle=function(n,e,t){return qi.current.useImperativeHandle(n,e,t)};_n.useInsertionEffect=function(n,e){return qi.current.useInsertionEffect(n,e)};_n.useLayoutEffect=function(n,e){return qi.current.useLayoutEffect(n,e)};_n.useMemo=function(n,e){return qi.current.useMemo(n,e)};_n.useReducer=function(n,e,t){return qi.current.useReducer(n,e,t)};_n.useRef=function(n){return qi.current.useRef(n)};_n.useState=function(n){return qi.current.useState(n)};_n.useSyncExternalStore=function(n,e,t){return qi.current.useSyncExternalStore(n,e,t)};_n.useTransition=function(){return qi.current.useTransition()};_n.version="18.3.1";B2.exports=_n;var fe=B2.exports;const u4=PT(fe);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c4=fe,h4=Symbol.for("react.element"),d4=Symbol.for("react.fragment"),f4=Object.prototype.hasOwnProperty,p4=c4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,m4={key:!0,ref:!0,__self:!0,__source:!0};function Y2(n,e,t){var r,i={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)f4.call(e,r)&&!m4.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:h4,type:n,key:s,ref:o,props:i,_owner:p4.current}}Iy.Fragment=d4;Iy.jsx=Y2;Iy.jsxs=Y2;V2.exports=Iy;var F=V2.exports,K2={exports:{}},Ds={},Q2={exports:{}},Z2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(G,Z){var K=G.length;G.push(Z);e:for(;0<K;){var ce=K-1>>>1,de=G[ce];if(0<i(de,Z))G[ce]=Z,G[K]=de,K=ce;else break e}}function t(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var Z=G[0],K=G.pop();if(K!==Z){G[0]=K;e:for(var ce=0,de=G.length,ue=de>>>1;ce<ue;){var Ee=2*(ce+1)-1,Fe=G[Ee],ke=Ee+1,Ye=G[ke];if(0>i(Fe,K))ke<de&&0>i(Ye,Fe)?(G[ce]=Ye,G[ke]=K,ce=ke):(G[ce]=Fe,G[Ee]=K,ce=Ee);else if(ke<de&&0>i(Ye,K))G[ce]=Ye,G[ke]=K,ce=ke;else break e}}return Z}function i(G,Z){var K=G.sortIndex-Z.sortIndex;return K!==0?K:G.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,f=null,p=3,g=!1,y=!1,S=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(G){for(var Z=t(u);Z!==null;){if(Z.callback===null)r(u);else if(Z.startTime<=G)r(u),Z.sortIndex=Z.expirationTime,e(l,Z);else break;Z=t(u)}}function R(G){if(S=!1,T(G),!y)if(t(l)!==null)y=!0,te(U);else{var Z=t(u);Z!==null&&ye(R,Z.startTime-G)}}function U(G,Z){y=!1,S&&(S=!1,v(b),b=-1),g=!0;var K=p;try{for(T(Z),f=t(l);f!==null&&(!(f.expirationTime>Z)||G&&!L());){var ce=f.callback;if(typeof ce=="function"){f.callback=null,p=f.priorityLevel;var de=ce(f.expirationTime<=Z);Z=n.unstable_now(),typeof de=="function"?f.callback=de:f===t(l)&&r(l),T(Z)}else r(l);f=t(l)}if(f!==null)var ue=!0;else{var Ee=t(u);Ee!==null&&ye(R,Ee.startTime-Z),ue=!1}return ue}finally{f=null,p=K,g=!1}}var N=!1,P=null,b=-1,M=5,A=-1;function L(){return!(n.unstable_now()-A<M)}function z(){if(P!==null){var G=n.unstable_now();A=G;var Z=!0;try{Z=P(!0,G)}finally{Z?B():(N=!1,P=null)}}else N=!1}var B;if(typeof w=="function")B=function(){w(z)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,he=$.port2;$.port1.onmessage=z,B=function(){he.postMessage(null)}}else B=function(){x(z,0)};function te(G){P=G,N||(N=!0,B())}function ye(G,Z){b=x(function(){G(n.unstable_now())},Z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(G){G.callback=null},n.unstable_continueExecution=function(){y||g||(y=!0,te(U))},n.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<G?Math.floor(1e3/G):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(G){switch(p){case 1:case 2:case 3:var Z=3;break;default:Z=p}var K=p;p=Z;try{return G()}finally{p=K}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(G,Z){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var K=p;p=G;try{return Z()}finally{p=K}},n.unstable_scheduleCallback=function(G,Z,K){var ce=n.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?ce+K:ce):K=ce,G){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=K+de,G={id:d++,callback:Z,priorityLevel:G,startTime:K,expirationTime:de,sortIndex:-1},K>ce?(G.sortIndex=K,e(u,G),t(l)===null&&G===t(u)&&(S?(v(b),b=-1):S=!0,ye(R,K-ce))):(G.sortIndex=de,e(l,G),y||g||(y=!0,te(U))),G},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(G){var Z=p;return function(){var K=p;p=Z;try{return G.apply(this,arguments)}finally{p=K}}}})(Z2);Q2.exports=Z2;var g4=Q2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v4=fe,Ns=g4;function tt(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var J2=new Set,mp={};function Ec(n,e){ad(n,e),ad(n+"Capture",e)}function ad(n,e){for(mp[n]=e,n=0;n<e.length;n++)J2.add(e[n])}var Sa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_w=Object.prototype.hasOwnProperty,_4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,QC={},ZC={};function y4(n){return _w.call(ZC,n)?!0:_w.call(QC,n)?!1:_4.test(n)?ZC[n]=!0:(QC[n]=!0,!1)}function x4(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function E4(n,e,t,r){if(e===null||typeof e>"u"||x4(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Xi(n,e,t,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var ai={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){ai[n]=new Xi(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];ai[e]=new Xi(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){ai[n]=new Xi(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){ai[n]=new Xi(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){ai[n]=new Xi(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){ai[n]=new Xi(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){ai[n]=new Xi(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){ai[n]=new Xi(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){ai[n]=new Xi(n,5,!1,n.toLowerCase(),null,!1,!1)});var OT=/[\-:]([a-z])/g;function UT(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(OT,UT);ai[e]=new Xi(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(OT,UT);ai[e]=new Xi(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(OT,UT);ai[e]=new Xi(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){ai[n]=new Xi(n,1,!1,n.toLowerCase(),null,!1,!1)});ai.xlinkHref=new Xi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){ai[n]=new Xi(n,1,!1,n.toLowerCase(),null,!0,!0)});function FT(n,e,t,r){var i=ai.hasOwnProperty(e)?ai[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(E4(e,t,i,r)&&(t=null),r||i===null?y4(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var Da=v4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Pg=Symbol.for("react.element"),Ih=Symbol.for("react.portal"),bh=Symbol.for("react.fragment"),VT=Symbol.for("react.strict_mode"),yw=Symbol.for("react.profiler"),eN=Symbol.for("react.provider"),tN=Symbol.for("react.context"),BT=Symbol.for("react.forward_ref"),xw=Symbol.for("react.suspense"),Ew=Symbol.for("react.suspense_list"),zT=Symbol.for("react.memo"),al=Symbol.for("react.lazy"),nN=Symbol.for("react.offscreen"),JC=Symbol.iterator;function cf(n){return n===null||typeof n!="object"?null:(n=JC&&n[JC]||n["@@iterator"],typeof n=="function"?n:null)}var ar=Object.assign,Ux;function Df(n){if(Ux===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Ux=e&&e[1]||""}return`
`+Ux+n}var Fx=!1;function Vx(n,e){if(!n||Fx)return"";Fx=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){r=u}n.call(e.prototype)}else{try{throw Error()}catch(u){r=u}n()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{Fx=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Df(n):""}function w4(n){switch(n.tag){case 5:return Df(n.type);case 16:return Df("Lazy");case 13:return Df("Suspense");case 19:return Df("SuspenseList");case 0:case 2:case 15:return n=Vx(n.type,!1),n;case 11:return n=Vx(n.type.render,!1),n;case 1:return n=Vx(n.type,!0),n;default:return""}}function ww(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case bh:return"Fragment";case Ih:return"Portal";case yw:return"Profiler";case VT:return"StrictMode";case xw:return"Suspense";case Ew:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case tN:return(n.displayName||"Context")+".Consumer";case eN:return(n._context.displayName||"Context")+".Provider";case BT:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case zT:return e=n.displayName||null,e!==null?e:ww(n.type)||"Memo";case al:e=n._payload,n=n._init;try{return ww(n(e))}catch{}}return null}function S4(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ww(e);case 8:return e===VT?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Fl(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function rN(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function T4(n){var e=rN(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Ng(n){n._valueTracker||(n._valueTracker=T4(n))}function iN(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=rN(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function b_(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Sw(n,e){var t=e.checked;return ar({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function eI(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Fl(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function sN(n,e){e=e.checked,e!=null&&FT(n,"checked",e,!1)}function Tw(n,e){sN(n,e);var t=Fl(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Mw(n,e.type,t):e.hasOwnProperty("defaultValue")&&Mw(n,e.type,Fl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function tI(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Mw(n,e,t){(e!=="number"||b_(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var kf=Array.isArray;function Yh(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+Fl(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function Aw(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(tt(91));return ar({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function nI(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(tt(92));if(kf(t)){if(1<t.length)throw Error(tt(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Fl(t)}}function oN(n,e){var t=Fl(e.value),r=Fl(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function rI(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function aN(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Cw(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?aN(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Lg,lN=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Lg=Lg||document.createElement("div"),Lg.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Lg.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function gp(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var qf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},M4=["Webkit","ms","Moz","O"];Object.keys(qf).forEach(function(n){M4.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),qf[e]=qf[n]})});function uN(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||qf.hasOwnProperty(n)&&qf[n]?(""+e).trim():e+"px"}function cN(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=uN(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var A4=ar({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Iw(n,e){if(e){if(A4[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(tt(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(tt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(tt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(tt(62))}}function bw(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rw=null;function HT(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Pw=null,Kh=null,Qh=null;function iI(n){if(n=mm(n)){if(typeof Pw!="function")throw Error(tt(280));var e=n.stateNode;e&&(e=Ly(e),Pw(n.stateNode,n.type,e))}}function hN(n){Kh?Qh?Qh.push(n):Qh=[n]:Kh=n}function dN(){if(Kh){var n=Kh,e=Qh;if(Qh=Kh=null,iI(n),e)for(n=0;n<e.length;n++)iI(e[n])}}function fN(n,e){return n(e)}function pN(){}var Bx=!1;function mN(n,e,t){if(Bx)return n(e,t);Bx=!0;try{return fN(n,e,t)}finally{Bx=!1,(Kh!==null||Qh!==null)&&(pN(),dN())}}function vp(n,e){var t=n.stateNode;if(t===null)return null;var r=Ly(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(tt(231,e,typeof t));return t}var Nw=!1;if(Sa)try{var hf={};Object.defineProperty(hf,"passive",{get:function(){Nw=!0}}),window.addEventListener("test",hf,hf),window.removeEventListener("test",hf,hf)}catch{Nw=!1}function C4(n,e,t,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(d){this.onError(d)}}var Xf=!1,R_=null,P_=!1,Lw=null,I4={onError:function(n){Xf=!0,R_=n}};function b4(n,e,t,r,i,s,o,a,l){Xf=!1,R_=null,C4.apply(I4,arguments)}function R4(n,e,t,r,i,s,o,a,l){if(b4.apply(this,arguments),Xf){if(Xf){var u=R_;Xf=!1,R_=null}else throw Error(tt(198));P_||(P_=!0,Lw=u)}}function wc(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function gN(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function sI(n){if(wc(n)!==n)throw Error(tt(188))}function P4(n){var e=n.alternate;if(!e){if(e=wc(n),e===null)throw Error(tt(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return sI(i),n;if(s===r)return sI(i),e;s=s.sibling}throw Error(tt(188))}if(t.return!==r.return)t=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===t){o=!0,t=i,r=s;break}if(a===r){o=!0,r=i,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,r=i;break}if(a===r){o=!0,r=s,t=i;break}a=a.sibling}if(!o)throw Error(tt(189))}}if(t.alternate!==r)throw Error(tt(190))}if(t.tag!==3)throw Error(tt(188));return t.stateNode.current===t?n:e}function vN(n){return n=P4(n),n!==null?_N(n):null}function _N(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=_N(n);if(e!==null)return e;n=n.sibling}return null}var yN=Ns.unstable_scheduleCallback,oI=Ns.unstable_cancelCallback,N4=Ns.unstable_shouldYield,L4=Ns.unstable_requestPaint,wr=Ns.unstable_now,D4=Ns.unstable_getCurrentPriorityLevel,GT=Ns.unstable_ImmediatePriority,xN=Ns.unstable_UserBlockingPriority,N_=Ns.unstable_NormalPriority,k4=Ns.unstable_LowPriority,EN=Ns.unstable_IdlePriority,by=null,Oo=null;function O4(n){if(Oo&&typeof Oo.onCommitFiberRoot=="function")try{Oo.onCommitFiberRoot(by,n,void 0,(n.current.flags&128)===128)}catch{}}var _o=Math.clz32?Math.clz32:V4,U4=Math.log,F4=Math.LN2;function V4(n){return n>>>=0,n===0?32:31-(U4(n)/F4|0)|0}var Dg=64,kg=4194304;function Of(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function L_(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~i;a!==0?r=Of(a):(s&=o,s!==0&&(r=Of(s)))}else o=t&~i,o!==0?r=Of(o):s!==0&&(r=Of(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-_o(e),i=1<<t,r|=n[t],e&=~i;return r}function B4(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function z4(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-_o(s),a=1<<o,l=i[o];l===-1?(!(a&t)||a&r)&&(i[o]=B4(a,e)):l<=e&&(n.expiredLanes|=a),s&=~a}}function Dw(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function wN(){var n=Dg;return Dg<<=1,!(Dg&4194240)&&(Dg=64),n}function zx(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function fm(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-_o(e),n[e]=t}function H4(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-_o(t),s=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~s}}function WT(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-_o(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var Bn=0;function SN(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var TN,jT,MN,AN,CN,kw=!1,Og=[],xl=null,El=null,wl=null,_p=new Map,yp=new Map,cl=[],G4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function aI(n,e){switch(n){case"focusin":case"focusout":xl=null;break;case"dragenter":case"dragleave":El=null;break;case"mouseover":case"mouseout":wl=null;break;case"pointerover":case"pointerout":_p.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":yp.delete(e.pointerId)}}function df(n,e,t,r,i,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=mm(e),e!==null&&jT(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function W4(n,e,t,r,i){switch(e){case"focusin":return xl=df(xl,n,e,t,r,i),!0;case"dragenter":return El=df(El,n,e,t,r,i),!0;case"mouseover":return wl=df(wl,n,e,t,r,i),!0;case"pointerover":var s=i.pointerId;return _p.set(s,df(_p.get(s)||null,n,e,t,r,i)),!0;case"gotpointercapture":return s=i.pointerId,yp.set(s,df(yp.get(s)||null,n,e,t,r,i)),!0}return!1}function IN(n){var e=Wu(n.target);if(e!==null){var t=wc(e);if(t!==null){if(e=t.tag,e===13){if(e=gN(t),e!==null){n.blockedOn=e,CN(n.priority,function(){MN(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function t_(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Ow(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);Rw=r,t.target.dispatchEvent(r),Rw=null}else return e=mm(t),e!==null&&jT(e),n.blockedOn=t,!1;e.shift()}return!0}function lI(n,e,t){t_(n)&&t.delete(e)}function j4(){kw=!1,xl!==null&&t_(xl)&&(xl=null),El!==null&&t_(El)&&(El=null),wl!==null&&t_(wl)&&(wl=null),_p.forEach(lI),yp.forEach(lI)}function ff(n,e){n.blockedOn===e&&(n.blockedOn=null,kw||(kw=!0,Ns.unstable_scheduleCallback(Ns.unstable_NormalPriority,j4)))}function xp(n){function e(i){return ff(i,n)}if(0<Og.length){ff(Og[0],n);for(var t=1;t<Og.length;t++){var r=Og[t];r.blockedOn===n&&(r.blockedOn=null)}}for(xl!==null&&ff(xl,n),El!==null&&ff(El,n),wl!==null&&ff(wl,n),_p.forEach(e),yp.forEach(e),t=0;t<cl.length;t++)r=cl[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<cl.length&&(t=cl[0],t.blockedOn===null);)IN(t),t.blockedOn===null&&cl.shift()}var Zh=Da.ReactCurrentBatchConfig,D_=!0;function q4(n,e,t,r){var i=Bn,s=Zh.transition;Zh.transition=null;try{Bn=1,qT(n,e,t,r)}finally{Bn=i,Zh.transition=s}}function X4(n,e,t,r){var i=Bn,s=Zh.transition;Zh.transition=null;try{Bn=4,qT(n,e,t,r)}finally{Bn=i,Zh.transition=s}}function qT(n,e,t,r){if(D_){var i=Ow(n,e,t,r);if(i===null)Qx(n,e,r,k_,t),aI(n,r);else if(W4(i,n,e,t,r))r.stopPropagation();else if(aI(n,r),e&4&&-1<G4.indexOf(n)){for(;i!==null;){var s=mm(i);if(s!==null&&TN(s),s=Ow(n,e,t,r),s===null&&Qx(n,e,r,k_,t),s===i)break;i=s}i!==null&&r.stopPropagation()}else Qx(n,e,r,null,t)}}var k_=null;function Ow(n,e,t,r){if(k_=null,n=HT(r),n=Wu(n),n!==null)if(e=wc(n),e===null)n=null;else if(t=e.tag,t===13){if(n=gN(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return k_=n,null}function bN(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(D4()){case GT:return 1;case xN:return 4;case N_:case k4:return 16;case EN:return 536870912;default:return 16}default:return 16}}var gl=null,XT=null,n_=null;function RN(){if(n_)return n_;var n,e=XT,t=e.length,r,i="value"in gl?gl.value:gl.textContent,s=i.length;for(n=0;n<t&&e[n]===i[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===i[s-r];r++);return n_=i.slice(n,1<r?1-r:void 0)}function r_(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Ug(){return!0}function uI(){return!1}function ks(n){function e(t,r,i,s,o){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ug:uI,this.isPropagationStopped=uI,this}return ar(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Ug)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Ug)},persist:function(){},isPersistent:Ug}),e}var Id={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$T=ks(Id),pm=ar({},Id,{view:0,detail:0}),$4=ks(pm),Hx,Gx,pf,Ry=ar({},pm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:YT,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==pf&&(pf&&n.type==="mousemove"?(Hx=n.screenX-pf.screenX,Gx=n.screenY-pf.screenY):Gx=Hx=0,pf=n),Hx)},movementY:function(n){return"movementY"in n?n.movementY:Gx}}),cI=ks(Ry),Y4=ar({},Ry,{dataTransfer:0}),K4=ks(Y4),Q4=ar({},pm,{relatedTarget:0}),Wx=ks(Q4),Z4=ar({},Id,{animationName:0,elapsedTime:0,pseudoElement:0}),J4=ks(Z4),eV=ar({},Id,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),tV=ks(eV),nV=ar({},Id,{data:0}),hI=ks(nV),rV={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},iV={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sV={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function oV(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=sV[n])?!!e[n]:!1}function YT(){return oV}var aV=ar({},pm,{key:function(n){if(n.key){var e=rV[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=r_(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?iV[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:YT,charCode:function(n){return n.type==="keypress"?r_(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?r_(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),lV=ks(aV),uV=ar({},Ry,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dI=ks(uV),cV=ar({},pm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:YT}),hV=ks(cV),dV=ar({},Id,{propertyName:0,elapsedTime:0,pseudoElement:0}),fV=ks(dV),pV=ar({},Ry,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),mV=ks(pV),gV=[9,13,27,32],KT=Sa&&"CompositionEvent"in window,$f=null;Sa&&"documentMode"in document&&($f=document.documentMode);var vV=Sa&&"TextEvent"in window&&!$f,PN=Sa&&(!KT||$f&&8<$f&&11>=$f),fI=" ",pI=!1;function NN(n,e){switch(n){case"keyup":return gV.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function LN(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Rh=!1;function _V(n,e){switch(n){case"compositionend":return LN(e);case"keypress":return e.which!==32?null:(pI=!0,fI);case"textInput":return n=e.data,n===fI&&pI?null:n;default:return null}}function yV(n,e){if(Rh)return n==="compositionend"||!KT&&NN(n,e)?(n=RN(),n_=XT=gl=null,Rh=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return PN&&e.locale!=="ko"?null:e.data;default:return null}}var xV={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mI(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!xV[n.type]:e==="textarea"}function DN(n,e,t,r){hN(r),e=O_(e,"onChange"),0<e.length&&(t=new $T("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var Yf=null,Ep=null;function EV(n){jN(n,0)}function Py(n){var e=Lh(n);if(iN(e))return n}function wV(n,e){if(n==="change")return e}var kN=!1;if(Sa){var jx;if(Sa){var qx="oninput"in document;if(!qx){var gI=document.createElement("div");gI.setAttribute("oninput","return;"),qx=typeof gI.oninput=="function"}jx=qx}else jx=!1;kN=jx&&(!document.documentMode||9<document.documentMode)}function vI(){Yf&&(Yf.detachEvent("onpropertychange",ON),Ep=Yf=null)}function ON(n){if(n.propertyName==="value"&&Py(Ep)){var e=[];DN(e,Ep,n,HT(n)),mN(EV,e)}}function SV(n,e,t){n==="focusin"?(vI(),Yf=e,Ep=t,Yf.attachEvent("onpropertychange",ON)):n==="focusout"&&vI()}function TV(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Py(Ep)}function MV(n,e){if(n==="click")return Py(e)}function AV(n,e){if(n==="input"||n==="change")return Py(e)}function CV(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var xo=typeof Object.is=="function"?Object.is:CV;function wp(n,e){if(xo(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!_w.call(e,i)||!xo(n[i],e[i]))return!1}return!0}function _I(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function yI(n,e){var t=_I(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=_I(t)}}function UN(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?UN(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function FN(){for(var n=window,e=b_();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=b_(n.document)}return e}function QT(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function IV(n){var e=FN(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&UN(t.ownerDocument.documentElement,t)){if(r!==null&&QT(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=yI(t,s);var o=yI(t,r);i&&o&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var bV=Sa&&"documentMode"in document&&11>=document.documentMode,Ph=null,Uw=null,Kf=null,Fw=!1;function xI(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Fw||Ph==null||Ph!==b_(r)||(r=Ph,"selectionStart"in r&&QT(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Kf&&wp(Kf,r)||(Kf=r,r=O_(Uw,"onSelect"),0<r.length&&(e=new $T("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=Ph)))}function Fg(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Nh={animationend:Fg("Animation","AnimationEnd"),animationiteration:Fg("Animation","AnimationIteration"),animationstart:Fg("Animation","AnimationStart"),transitionend:Fg("Transition","TransitionEnd")},Xx={},VN={};Sa&&(VN=document.createElement("div").style,"AnimationEvent"in window||(delete Nh.animationend.animation,delete Nh.animationiteration.animation,delete Nh.animationstart.animation),"TransitionEvent"in window||delete Nh.transitionend.transition);function Ny(n){if(Xx[n])return Xx[n];if(!Nh[n])return n;var e=Nh[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in VN)return Xx[n]=e[t];return n}var BN=Ny("animationend"),zN=Ny("animationiteration"),HN=Ny("animationstart"),GN=Ny("transitionend"),WN=new Map,EI="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ql(n,e){WN.set(n,e),Ec(e,[n])}for(var $x=0;$x<EI.length;$x++){var Yx=EI[$x],RV=Yx.toLowerCase(),PV=Yx[0].toUpperCase()+Yx.slice(1);Ql(RV,"on"+PV)}Ql(BN,"onAnimationEnd");Ql(zN,"onAnimationIteration");Ql(HN,"onAnimationStart");Ql("dblclick","onDoubleClick");Ql("focusin","onFocus");Ql("focusout","onBlur");Ql(GN,"onTransitionEnd");ad("onMouseEnter",["mouseout","mouseover"]);ad("onMouseLeave",["mouseout","mouseover"]);ad("onPointerEnter",["pointerout","pointerover"]);ad("onPointerLeave",["pointerout","pointerover"]);Ec("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ec("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ec("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ec("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ec("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ec("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Uf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),NV=new Set("cancel close invalid load scroll toggle".split(" ").concat(Uf));function wI(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,R4(r,e,void 0,n),n.currentTarget=null}function jN(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;wI(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;wI(i,a,u),s=l}}}if(P_)throw n=Lw,P_=!1,Lw=null,n}function Yn(n,e){var t=e[Gw];t===void 0&&(t=e[Gw]=new Set);var r=n+"__bubble";t.has(r)||(qN(e,n,2,!1),t.add(r))}function Kx(n,e,t){var r=0;e&&(r|=4),qN(t,n,r,e)}var Vg="_reactListening"+Math.random().toString(36).slice(2);function Sp(n){if(!n[Vg]){n[Vg]=!0,J2.forEach(function(t){t!=="selectionchange"&&(NV.has(t)||Kx(t,!1,n),Kx(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Vg]||(e[Vg]=!0,Kx("selectionchange",!1,e))}}function qN(n,e,t,r){switch(bN(e)){case 1:var i=q4;break;case 4:i=X4;break;default:i=qT}t=i.bind(null,e,t,n),i=void 0,!Nw||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function Qx(n,e,t,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Wu(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}mN(function(){var u=s,d=HT(t),f=[];e:{var p=WN.get(n);if(p!==void 0){var g=$T,y=n;switch(n){case"keypress":if(r_(t)===0)break e;case"keydown":case"keyup":g=lV;break;case"focusin":y="focus",g=Wx;break;case"focusout":y="blur",g=Wx;break;case"beforeblur":case"afterblur":g=Wx;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=cI;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=K4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=hV;break;case BN:case zN:case HN:g=J4;break;case GN:g=fV;break;case"scroll":g=$4;break;case"wheel":g=mV;break;case"copy":case"cut":case"paste":g=tV;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=dI}var S=(e&4)!==0,x=!S&&n==="scroll",v=S?p!==null?p+"Capture":null:p;S=[];for(var w=u,T;w!==null;){T=w;var R=T.stateNode;if(T.tag===5&&R!==null&&(T=R,v!==null&&(R=vp(w,v),R!=null&&S.push(Tp(w,R,T)))),x)break;w=w.return}0<S.length&&(p=new g(p,y,null,t,d),f.push({event:p,listeners:S}))}}if(!(e&7)){e:{if(p=n==="mouseover"||n==="pointerover",g=n==="mouseout"||n==="pointerout",p&&t!==Rw&&(y=t.relatedTarget||t.fromElement)&&(Wu(y)||y[Ta]))break e;if((g||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,g?(y=t.relatedTarget||t.toElement,g=u,y=y?Wu(y):null,y!==null&&(x=wc(y),y!==x||y.tag!==5&&y.tag!==6)&&(y=null)):(g=null,y=u),g!==y)){if(S=cI,R="onMouseLeave",v="onMouseEnter",w="mouse",(n==="pointerout"||n==="pointerover")&&(S=dI,R="onPointerLeave",v="onPointerEnter",w="pointer"),x=g==null?p:Lh(g),T=y==null?p:Lh(y),p=new S(R,w+"leave",g,t,d),p.target=x,p.relatedTarget=T,R=null,Wu(d)===u&&(S=new S(v,w+"enter",y,t,d),S.target=T,S.relatedTarget=x,R=S),x=R,g&&y)t:{for(S=g,v=y,w=0,T=S;T;T=Kc(T))w++;for(T=0,R=v;R;R=Kc(R))T++;for(;0<w-T;)S=Kc(S),w--;for(;0<T-w;)v=Kc(v),T--;for(;w--;){if(S===v||v!==null&&S===v.alternate)break t;S=Kc(S),v=Kc(v)}S=null}else S=null;g!==null&&SI(f,p,g,S,!1),y!==null&&x!==null&&SI(f,x,y,S,!0)}}e:{if(p=u?Lh(u):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var U=wV;else if(mI(p))if(kN)U=AV;else{U=TV;var N=SV}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(U=MV);if(U&&(U=U(n,u))){DN(f,U,t,d);break e}N&&N(n,p,u),n==="focusout"&&(N=p._wrapperState)&&N.controlled&&p.type==="number"&&Mw(p,"number",p.value)}switch(N=u?Lh(u):window,n){case"focusin":(mI(N)||N.contentEditable==="true")&&(Ph=N,Uw=u,Kf=null);break;case"focusout":Kf=Uw=Ph=null;break;case"mousedown":Fw=!0;break;case"contextmenu":case"mouseup":case"dragend":Fw=!1,xI(f,t,d);break;case"selectionchange":if(bV)break;case"keydown":case"keyup":xI(f,t,d)}var P;if(KT)e:{switch(n){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Rh?NN(n,t)&&(b="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(b="onCompositionStart");b&&(PN&&t.locale!=="ko"&&(Rh||b!=="onCompositionStart"?b==="onCompositionEnd"&&Rh&&(P=RN()):(gl=d,XT="value"in gl?gl.value:gl.textContent,Rh=!0)),N=O_(u,b),0<N.length&&(b=new hI(b,n,null,t,d),f.push({event:b,listeners:N}),P?b.data=P:(P=LN(t),P!==null&&(b.data=P)))),(P=vV?_V(n,t):yV(n,t))&&(u=O_(u,"onBeforeInput"),0<u.length&&(d=new hI("onBeforeInput","beforeinput",null,t,d),f.push({event:d,listeners:u}),d.data=P))}jN(f,e)})}function Tp(n,e,t){return{instance:n,listener:e,currentTarget:t}}function O_(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=vp(n,t),s!=null&&r.unshift(Tp(n,s,i)),s=vp(n,e),s!=null&&r.push(Tp(n,s,i))),n=n.return}return r}function Kc(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function SI(n,e,t,r,i){for(var s=e._reactName,o=[];t!==null&&t!==r;){var a=t,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=vp(t,s),l!=null&&o.unshift(Tp(t,l,a))):i||(l=vp(t,s),l!=null&&o.push(Tp(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var LV=/\r\n?/g,DV=/\u0000|\uFFFD/g;function TI(n){return(typeof n=="string"?n:""+n).replace(LV,`
`).replace(DV,"")}function Bg(n,e,t){if(e=TI(e),TI(n)!==e&&t)throw Error(tt(425))}function U_(){}var Vw=null,Bw=null;function zw(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Hw=typeof setTimeout=="function"?setTimeout:void 0,kV=typeof clearTimeout=="function"?clearTimeout:void 0,MI=typeof Promise=="function"?Promise:void 0,OV=typeof queueMicrotask=="function"?queueMicrotask:typeof MI<"u"?function(n){return MI.resolve(null).then(n).catch(UV)}:Hw;function UV(n){setTimeout(function(){throw n})}function Zx(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),xp(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);xp(e)}function Sl(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function AI(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var bd=Math.random().toString(36).slice(2),Do="__reactFiber$"+bd,Mp="__reactProps$"+bd,Ta="__reactContainer$"+bd,Gw="__reactEvents$"+bd,FV="__reactListeners$"+bd,VV="__reactHandles$"+bd;function Wu(n){var e=n[Do];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Ta]||t[Do]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=AI(n);n!==null;){if(t=n[Do])return t;n=AI(n)}return e}n=t,t=n.parentNode}return null}function mm(n){return n=n[Do]||n[Ta],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Lh(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(tt(33))}function Ly(n){return n[Mp]||null}var Ww=[],Dh=-1;function Zl(n){return{current:n}}function Zn(n){0>Dh||(n.current=Ww[Dh],Ww[Dh]=null,Dh--)}function Xn(n,e){Dh++,Ww[Dh]=n.current,n.current=e}var Vl={},Ri=Zl(Vl),os=Zl(!1),ac=Vl;function ld(n,e){var t=n.type.contextTypes;if(!t)return Vl;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function as(n){return n=n.childContextTypes,n!=null}function F_(){Zn(os),Zn(Ri)}function CI(n,e,t){if(Ri.current!==Vl)throw Error(tt(168));Xn(Ri,e),Xn(os,t)}function XN(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(tt(108,S4(n)||"Unknown",i));return ar({},t,r)}function V_(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Vl,ac=Ri.current,Xn(Ri,n),Xn(os,os.current),!0}function II(n,e,t){var r=n.stateNode;if(!r)throw Error(tt(169));t?(n=XN(n,e,ac),r.__reactInternalMemoizedMergedChildContext=n,Zn(os),Zn(Ri),Xn(Ri,n)):Zn(os),Xn(os,t)}var da=null,Dy=!1,Jx=!1;function $N(n){da===null?da=[n]:da.push(n)}function BV(n){Dy=!0,$N(n)}function Jl(){if(!Jx&&da!==null){Jx=!0;var n=0,e=Bn;try{var t=da;for(Bn=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}da=null,Dy=!1}catch(i){throw da!==null&&(da=da.slice(n+1)),yN(GT,Jl),i}finally{Bn=e,Jx=!1}}return null}var kh=[],Oh=0,B_=null,z_=0,qs=[],Xs=0,lc=null,ga=1,va="";function Lu(n,e){kh[Oh++]=z_,kh[Oh++]=B_,B_=n,z_=e}function YN(n,e,t){qs[Xs++]=ga,qs[Xs++]=va,qs[Xs++]=lc,lc=n;var r=ga;n=va;var i=32-_o(r)-1;r&=~(1<<i),t+=1;var s=32-_o(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,ga=1<<32-_o(e)+i|t<<i|r,va=s+n}else ga=1<<s|t<<i|r,va=n}function ZT(n){n.return!==null&&(Lu(n,1),YN(n,1,0))}function JT(n){for(;n===B_;)B_=kh[--Oh],kh[Oh]=null,z_=kh[--Oh],kh[Oh]=null;for(;n===lc;)lc=qs[--Xs],qs[Xs]=null,va=qs[--Xs],qs[Xs]=null,ga=qs[--Xs],qs[Xs]=null}var As=null,Ts=null,Jn=!1,fo=null;function KN(n,e){var t=Ys(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function bI(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,As=n,Ts=Sl(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,As=n,Ts=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=lc!==null?{id:ga,overflow:va}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Ys(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,As=n,Ts=null,!0):!1;default:return!1}}function jw(n){return(n.mode&1)!==0&&(n.flags&128)===0}function qw(n){if(Jn){var e=Ts;if(e){var t=e;if(!bI(n,e)){if(jw(n))throw Error(tt(418));e=Sl(t.nextSibling);var r=As;e&&bI(n,e)?KN(r,t):(n.flags=n.flags&-4097|2,Jn=!1,As=n)}}else{if(jw(n))throw Error(tt(418));n.flags=n.flags&-4097|2,Jn=!1,As=n}}}function RI(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;As=n}function zg(n){if(n!==As)return!1;if(!Jn)return RI(n),Jn=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!zw(n.type,n.memoizedProps)),e&&(e=Ts)){if(jw(n))throw QN(),Error(tt(418));for(;e;)KN(n,e),e=Sl(e.nextSibling)}if(RI(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(tt(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Ts=Sl(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Ts=null}}else Ts=As?Sl(n.stateNode.nextSibling):null;return!0}function QN(){for(var n=Ts;n;)n=Sl(n.nextSibling)}function ud(){Ts=As=null,Jn=!1}function e1(n){fo===null?fo=[n]:fo.push(n)}var zV=Da.ReactCurrentBatchConfig;function mf(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(tt(309));var r=t.stateNode}if(!r)throw Error(tt(147,n));var i=r,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(tt(284));if(!t._owner)throw Error(tt(290,n))}return n}function Hg(n,e){throw n=Object.prototype.toString.call(e),Error(tt(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function PI(n){var e=n._init;return e(n._payload)}function ZN(n){function e(v,w){if(n){var T=v.deletions;T===null?(v.deletions=[w],v.flags|=16):T.push(w)}}function t(v,w){if(!n)return null;for(;w!==null;)e(v,w),w=w.sibling;return null}function r(v,w){for(v=new Map;w!==null;)w.key!==null?v.set(w.key,w):v.set(w.index,w),w=w.sibling;return v}function i(v,w){return v=Cl(v,w),v.index=0,v.sibling=null,v}function s(v,w,T){return v.index=T,n?(T=v.alternate,T!==null?(T=T.index,T<w?(v.flags|=2,w):T):(v.flags|=2,w)):(v.flags|=1048576,w)}function o(v){return n&&v.alternate===null&&(v.flags|=2),v}function a(v,w,T,R){return w===null||w.tag!==6?(w=oE(T,v.mode,R),w.return=v,w):(w=i(w,T),w.return=v,w)}function l(v,w,T,R){var U=T.type;return U===bh?d(v,w,T.props.children,R,T.key):w!==null&&(w.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===al&&PI(U)===w.type)?(R=i(w,T.props),R.ref=mf(v,w,T),R.return=v,R):(R=c_(T.type,T.key,T.props,null,v.mode,R),R.ref=mf(v,w,T),R.return=v,R)}function u(v,w,T,R){return w===null||w.tag!==4||w.stateNode.containerInfo!==T.containerInfo||w.stateNode.implementation!==T.implementation?(w=aE(T,v.mode,R),w.return=v,w):(w=i(w,T.children||[]),w.return=v,w)}function d(v,w,T,R,U){return w===null||w.tag!==7?(w=tc(T,v.mode,R,U),w.return=v,w):(w=i(w,T),w.return=v,w)}function f(v,w,T){if(typeof w=="string"&&w!==""||typeof w=="number")return w=oE(""+w,v.mode,T),w.return=v,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Pg:return T=c_(w.type,w.key,w.props,null,v.mode,T),T.ref=mf(v,null,w),T.return=v,T;case Ih:return w=aE(w,v.mode,T),w.return=v,w;case al:var R=w._init;return f(v,R(w._payload),T)}if(kf(w)||cf(w))return w=tc(w,v.mode,T,null),w.return=v,w;Hg(v,w)}return null}function p(v,w,T,R){var U=w!==null?w.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return U!==null?null:a(v,w,""+T,R);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Pg:return T.key===U?l(v,w,T,R):null;case Ih:return T.key===U?u(v,w,T,R):null;case al:return U=T._init,p(v,w,U(T._payload),R)}if(kf(T)||cf(T))return U!==null?null:d(v,w,T,R,null);Hg(v,T)}return null}function g(v,w,T,R,U){if(typeof R=="string"&&R!==""||typeof R=="number")return v=v.get(T)||null,a(w,v,""+R,U);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case Pg:return v=v.get(R.key===null?T:R.key)||null,l(w,v,R,U);case Ih:return v=v.get(R.key===null?T:R.key)||null,u(w,v,R,U);case al:var N=R._init;return g(v,w,T,N(R._payload),U)}if(kf(R)||cf(R))return v=v.get(T)||null,d(w,v,R,U,null);Hg(w,R)}return null}function y(v,w,T,R){for(var U=null,N=null,P=w,b=w=0,M=null;P!==null&&b<T.length;b++){P.index>b?(M=P,P=null):M=P.sibling;var A=p(v,P,T[b],R);if(A===null){P===null&&(P=M);break}n&&P&&A.alternate===null&&e(v,P),w=s(A,w,b),N===null?U=A:N.sibling=A,N=A,P=M}if(b===T.length)return t(v,P),Jn&&Lu(v,b),U;if(P===null){for(;b<T.length;b++)P=f(v,T[b],R),P!==null&&(w=s(P,w,b),N===null?U=P:N.sibling=P,N=P);return Jn&&Lu(v,b),U}for(P=r(v,P);b<T.length;b++)M=g(P,v,b,T[b],R),M!==null&&(n&&M.alternate!==null&&P.delete(M.key===null?b:M.key),w=s(M,w,b),N===null?U=M:N.sibling=M,N=M);return n&&P.forEach(function(L){return e(v,L)}),Jn&&Lu(v,b),U}function S(v,w,T,R){var U=cf(T);if(typeof U!="function")throw Error(tt(150));if(T=U.call(T),T==null)throw Error(tt(151));for(var N=U=null,P=w,b=w=0,M=null,A=T.next();P!==null&&!A.done;b++,A=T.next()){P.index>b?(M=P,P=null):M=P.sibling;var L=p(v,P,A.value,R);if(L===null){P===null&&(P=M);break}n&&P&&L.alternate===null&&e(v,P),w=s(L,w,b),N===null?U=L:N.sibling=L,N=L,P=M}if(A.done)return t(v,P),Jn&&Lu(v,b),U;if(P===null){for(;!A.done;b++,A=T.next())A=f(v,A.value,R),A!==null&&(w=s(A,w,b),N===null?U=A:N.sibling=A,N=A);return Jn&&Lu(v,b),U}for(P=r(v,P);!A.done;b++,A=T.next())A=g(P,v,b,A.value,R),A!==null&&(n&&A.alternate!==null&&P.delete(A.key===null?b:A.key),w=s(A,w,b),N===null?U=A:N.sibling=A,N=A);return n&&P.forEach(function(z){return e(v,z)}),Jn&&Lu(v,b),U}function x(v,w,T,R){if(typeof T=="object"&&T!==null&&T.type===bh&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case Pg:e:{for(var U=T.key,N=w;N!==null;){if(N.key===U){if(U=T.type,U===bh){if(N.tag===7){t(v,N.sibling),w=i(N,T.props.children),w.return=v,v=w;break e}}else if(N.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===al&&PI(U)===N.type){t(v,N.sibling),w=i(N,T.props),w.ref=mf(v,N,T),w.return=v,v=w;break e}t(v,N);break}else e(v,N);N=N.sibling}T.type===bh?(w=tc(T.props.children,v.mode,R,T.key),w.return=v,v=w):(R=c_(T.type,T.key,T.props,null,v.mode,R),R.ref=mf(v,w,T),R.return=v,v=R)}return o(v);case Ih:e:{for(N=T.key;w!==null;){if(w.key===N)if(w.tag===4&&w.stateNode.containerInfo===T.containerInfo&&w.stateNode.implementation===T.implementation){t(v,w.sibling),w=i(w,T.children||[]),w.return=v,v=w;break e}else{t(v,w);break}else e(v,w);w=w.sibling}w=aE(T,v.mode,R),w.return=v,v=w}return o(v);case al:return N=T._init,x(v,w,N(T._payload),R)}if(kf(T))return y(v,w,T,R);if(cf(T))return S(v,w,T,R);Hg(v,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,w!==null&&w.tag===6?(t(v,w.sibling),w=i(w,T),w.return=v,v=w):(t(v,w),w=oE(T,v.mode,R),w.return=v,v=w),o(v)):t(v,w)}return x}var cd=ZN(!0),JN=ZN(!1),H_=Zl(null),G_=null,Uh=null,t1=null;function n1(){t1=Uh=G_=null}function r1(n){var e=H_.current;Zn(H_),n._currentValue=e}function Xw(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function Jh(n,e){G_=n,t1=Uh=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(ss=!0),n.firstContext=null)}function Qs(n){var e=n._currentValue;if(t1!==n)if(n={context:n,memoizedValue:e,next:null},Uh===null){if(G_===null)throw Error(tt(308));Uh=n,G_.dependencies={lanes:0,firstContext:n}}else Uh=Uh.next=n;return e}var ju=null;function i1(n){ju===null?ju=[n]:ju.push(n)}function eL(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,i1(e)):(t.next=i.next,i.next=t),e.interleaved=t,Ma(n,r)}function Ma(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var ll=!1;function s1(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function tL(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Ea(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Tl(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,bn&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ma(n,t)}return i=r.interleaved,i===null?(e.next=e,i1(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ma(n,t)}function i_(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,WT(n,t)}}function NI(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function W_(n,e,t,r){var i=n.updateQueue;ll=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var d=n.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;o=0,d=u=l=null,a=s;do{var p=a.lane,g=a.eventTime;if((r&p)===p){d!==null&&(d=d.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=n,S=a;switch(p=e,g=t,S.tag){case 1:if(y=S.payload,typeof y=="function"){f=y.call(g,f,p);break e}f=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=S.payload,p=typeof y=="function"?y.call(g,f,p):y,p==null)break e;f=ar({},f,p);break e;case 2:ll=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,p=i.effects,p===null?i.effects=[a]:p.push(a))}else g={eventTime:g,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=g,l=f):d=d.next=g,o|=p;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;p=a,a=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(d===null&&(l=f),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);cc|=o,n.lanes=o,n.memoizedState=f}}function LI(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(tt(191,i));i.call(r)}}}var gm={},Uo=Zl(gm),Ap=Zl(gm),Cp=Zl(gm);function qu(n){if(n===gm)throw Error(tt(174));return n}function o1(n,e){switch(Xn(Cp,e),Xn(Ap,n),Xn(Uo,gm),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Cw(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Cw(e,n)}Zn(Uo),Xn(Uo,e)}function hd(){Zn(Uo),Zn(Ap),Zn(Cp)}function nL(n){qu(Cp.current);var e=qu(Uo.current),t=Cw(e,n.type);e!==t&&(Xn(Ap,n),Xn(Uo,t))}function a1(n){Ap.current===n&&(Zn(Uo),Zn(Ap))}var rr=Zl(0);function j_(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var eE=[];function l1(){for(var n=0;n<eE.length;n++)eE[n]._workInProgressVersionPrimary=null;eE.length=0}var s_=Da.ReactCurrentDispatcher,tE=Da.ReactCurrentBatchConfig,uc=0,or=null,zr=null,Zr=null,q_=!1,Qf=!1,Ip=0,HV=0;function vi(){throw Error(tt(321))}function u1(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!xo(n[t],e[t]))return!1;return!0}function c1(n,e,t,r,i,s){if(uc=s,or=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,s_.current=n===null||n.memoizedState===null?qV:XV,n=t(r,i),Qf){s=0;do{if(Qf=!1,Ip=0,25<=s)throw Error(tt(301));s+=1,Zr=zr=null,e.updateQueue=null,s_.current=$V,n=t(r,i)}while(Qf)}if(s_.current=X_,e=zr!==null&&zr.next!==null,uc=0,Zr=zr=or=null,q_=!1,e)throw Error(tt(300));return n}function h1(){var n=Ip!==0;return Ip=0,n}function Po(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zr===null?or.memoizedState=Zr=n:Zr=Zr.next=n,Zr}function Zs(){if(zr===null){var n=or.alternate;n=n!==null?n.memoizedState:null}else n=zr.next;var e=Zr===null?or.memoizedState:Zr.next;if(e!==null)Zr=e,zr=n;else{if(n===null)throw Error(tt(310));zr=n,n={memoizedState:zr.memoizedState,baseState:zr.baseState,baseQueue:zr.baseQueue,queue:zr.queue,next:null},Zr===null?or.memoizedState=Zr=n:Zr=Zr.next=n}return Zr}function bp(n,e){return typeof e=="function"?e(n):e}function nE(n){var e=Zs(),t=e.queue;if(t===null)throw Error(tt(311));t.lastRenderedReducer=n;var r=zr,i=r.baseQueue,s=t.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var d=u.lane;if((uc&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:n(r,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,or.lanes|=d,cc|=d}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,xo(r,e.memoizedState)||(ss=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do s=i.lane,or.lanes|=s,cc|=s,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function rE(n){var e=Zs(),t=e.queue;if(t===null)throw Error(tt(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var o=i=i.next;do s=n(s,o.action),o=o.next;while(o!==i);xo(s,e.memoizedState)||(ss=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function rL(){}function iL(n,e){var t=or,r=Zs(),i=e(),s=!xo(r.memoizedState,i);if(s&&(r.memoizedState=i,ss=!0),r=r.queue,d1(aL.bind(null,t,r,n),[n]),r.getSnapshot!==e||s||Zr!==null&&Zr.memoizedState.tag&1){if(t.flags|=2048,Rp(9,oL.bind(null,t,r,i,e),void 0,null),ti===null)throw Error(tt(349));uc&30||sL(t,e,i)}return i}function sL(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=or.updateQueue,e===null?(e={lastEffect:null,stores:null},or.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function oL(n,e,t,r){e.value=t,e.getSnapshot=r,lL(e)&&uL(n)}function aL(n,e,t){return t(function(){lL(e)&&uL(n)})}function lL(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!xo(n,t)}catch{return!0}}function uL(n){var e=Ma(n,1);e!==null&&yo(e,n,1,-1)}function DI(n){var e=Po();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bp,lastRenderedState:n},e.queue=n,n=n.dispatch=jV.bind(null,or,n),[e.memoizedState,n]}function Rp(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=or.updateQueue,e===null?(e={lastEffect:null,stores:null},or.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function cL(){return Zs().memoizedState}function o_(n,e,t,r){var i=Po();or.flags|=n,i.memoizedState=Rp(1|e,t,void 0,r===void 0?null:r)}function ky(n,e,t,r){var i=Zs();r=r===void 0?null:r;var s=void 0;if(zr!==null){var o=zr.memoizedState;if(s=o.destroy,r!==null&&u1(r,o.deps)){i.memoizedState=Rp(e,t,s,r);return}}or.flags|=n,i.memoizedState=Rp(1|e,t,s,r)}function kI(n,e){return o_(8390656,8,n,e)}function d1(n,e){return ky(2048,8,n,e)}function hL(n,e){return ky(4,2,n,e)}function dL(n,e){return ky(4,4,n,e)}function fL(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function pL(n,e,t){return t=t!=null?t.concat([n]):null,ky(4,4,fL.bind(null,e,n),t)}function f1(){}function mL(n,e){var t=Zs();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&u1(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function gL(n,e){var t=Zs();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&u1(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function vL(n,e,t){return uc&21?(xo(t,e)||(t=wN(),or.lanes|=t,cc|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,ss=!0),n.memoizedState=t)}function GV(n,e){var t=Bn;Bn=t!==0&&4>t?t:4,n(!0);var r=tE.transition;tE.transition={};try{n(!1),e()}finally{Bn=t,tE.transition=r}}function _L(){return Zs().memoizedState}function WV(n,e,t){var r=Al(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},yL(n))xL(e,t);else if(t=eL(n,e,t,r),t!==null){var i=zi();yo(t,n,r,i),EL(t,e,r)}}function jV(n,e,t){var r=Al(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(yL(n))xL(e,i);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(i.hasEagerState=!0,i.eagerState=a,xo(a,o)){var l=e.interleaved;l===null?(i.next=i,i1(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}t=eL(n,e,i,r),t!==null&&(i=zi(),yo(t,n,r,i),EL(t,e,r))}}function yL(n){var e=n.alternate;return n===or||e!==null&&e===or}function xL(n,e){Qf=q_=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function EL(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,WT(n,t)}}var X_={readContext:Qs,useCallback:vi,useContext:vi,useEffect:vi,useImperativeHandle:vi,useInsertionEffect:vi,useLayoutEffect:vi,useMemo:vi,useReducer:vi,useRef:vi,useState:vi,useDebugValue:vi,useDeferredValue:vi,useTransition:vi,useMutableSource:vi,useSyncExternalStore:vi,useId:vi,unstable_isNewReconciler:!1},qV={readContext:Qs,useCallback:function(n,e){return Po().memoizedState=[n,e===void 0?null:e],n},useContext:Qs,useEffect:kI,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,o_(4194308,4,fL.bind(null,e,n),t)},useLayoutEffect:function(n,e){return o_(4194308,4,n,e)},useInsertionEffect:function(n,e){return o_(4,2,n,e)},useMemo:function(n,e){var t=Po();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Po();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=WV.bind(null,or,n),[r.memoizedState,n]},useRef:function(n){var e=Po();return n={current:n},e.memoizedState=n},useState:DI,useDebugValue:f1,useDeferredValue:function(n){return Po().memoizedState=n},useTransition:function(){var n=DI(!1),e=n[0];return n=GV.bind(null,n[1]),Po().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=or,i=Po();if(Jn){if(t===void 0)throw Error(tt(407));t=t()}else{if(t=e(),ti===null)throw Error(tt(349));uc&30||sL(r,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,kI(aL.bind(null,r,s,n),[n]),r.flags|=2048,Rp(9,oL.bind(null,r,s,t,e),void 0,null),t},useId:function(){var n=Po(),e=ti.identifierPrefix;if(Jn){var t=va,r=ga;t=(r&~(1<<32-_o(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Ip++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=HV++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},XV={readContext:Qs,useCallback:mL,useContext:Qs,useEffect:d1,useImperativeHandle:pL,useInsertionEffect:hL,useLayoutEffect:dL,useMemo:gL,useReducer:nE,useRef:cL,useState:function(){return nE(bp)},useDebugValue:f1,useDeferredValue:function(n){var e=Zs();return vL(e,zr.memoizedState,n)},useTransition:function(){var n=nE(bp)[0],e=Zs().memoizedState;return[n,e]},useMutableSource:rL,useSyncExternalStore:iL,useId:_L,unstable_isNewReconciler:!1},$V={readContext:Qs,useCallback:mL,useContext:Qs,useEffect:d1,useImperativeHandle:pL,useInsertionEffect:hL,useLayoutEffect:dL,useMemo:gL,useReducer:rE,useRef:cL,useState:function(){return rE(bp)},useDebugValue:f1,useDeferredValue:function(n){var e=Zs();return zr===null?e.memoizedState=n:vL(e,zr.memoizedState,n)},useTransition:function(){var n=rE(bp)[0],e=Zs().memoizedState;return[n,e]},useMutableSource:rL,useSyncExternalStore:iL,useId:_L,unstable_isNewReconciler:!1};function uo(n,e){if(n&&n.defaultProps){e=ar({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function $w(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:ar({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Oy={isMounted:function(n){return(n=n._reactInternals)?wc(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=zi(),i=Al(n),s=Ea(r,i);s.payload=e,t!=null&&(s.callback=t),e=Tl(n,s,i),e!==null&&(yo(e,n,i,r),i_(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=zi(),i=Al(n),s=Ea(r,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=Tl(n,s,i),e!==null&&(yo(e,n,i,r),i_(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=zi(),r=Al(n),i=Ea(t,r);i.tag=2,e!=null&&(i.callback=e),e=Tl(n,i,r),e!==null&&(yo(e,n,r,t),i_(e,n,r))}};function OI(n,e,t,r,i,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!wp(t,r)||!wp(i,s):!0}function wL(n,e,t){var r=!1,i=Vl,s=e.contextType;return typeof s=="object"&&s!==null?s=Qs(s):(i=as(e)?ac:Ri.current,r=e.contextTypes,s=(r=r!=null)?ld(n,i):Vl),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Oy,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=s),e}function UI(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&Oy.enqueueReplaceState(e,e.state,null)}function Yw(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},s1(n);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Qs(s):(s=as(e)?ac:Ri.current,i.context=ld(n,s)),i.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&($w(n,e,s,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Oy.enqueueReplaceState(i,i.state,null),W_(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function dd(n,e){try{var t="",r=e;do t+=w4(r),r=r.return;while(r);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:i,digest:null}}function iE(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Kw(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var YV=typeof WeakMap=="function"?WeakMap:Map;function SL(n,e,t){t=Ea(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){Y_||(Y_=!0,oS=r),Kw(n,e)},t}function TL(n,e,t){t=Ea(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){Kw(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){Kw(n,e),typeof r!="function"&&(Ml===null?Ml=new Set([this]):Ml.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function FI(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new YV;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=uB.bind(null,n,e,t),e.then(n,n))}function VI(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function BI(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Ea(-1,1),e.tag=2,Tl(t,e,1))),t.lanes|=1),n)}var KV=Da.ReactCurrentOwner,ss=!1;function Vi(n,e,t,r){e.child=n===null?JN(e,null,t,r):cd(e,n.child,t,r)}function zI(n,e,t,r,i){t=t.render;var s=e.ref;return Jh(e,i),r=c1(n,e,t,r,s,i),t=h1(),n!==null&&!ss?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Aa(n,e,i)):(Jn&&t&&ZT(e),e.flags|=1,Vi(n,e,r,i),e.child)}function HI(n,e,t,r,i){if(n===null){var s=t.type;return typeof s=="function"&&!E1(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,ML(n,e,s,r,i)):(n=c_(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&i)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:wp,t(o,r)&&n.ref===e.ref)return Aa(n,e,i)}return e.flags|=1,n=Cl(s,r),n.ref=e.ref,n.return=e,e.child=n}function ML(n,e,t,r,i){if(n!==null){var s=n.memoizedProps;if(wp(s,r)&&n.ref===e.ref)if(ss=!1,e.pendingProps=r=s,(n.lanes&i)!==0)n.flags&131072&&(ss=!0);else return e.lanes=n.lanes,Aa(n,e,i)}return Qw(n,e,t,r,i)}function AL(n,e,t){var r=e.pendingProps,i=r.children,s=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xn(Vh,xs),xs|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Xn(Vh,xs),xs|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,Xn(Vh,xs),xs|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,Xn(Vh,xs),xs|=r;return Vi(n,e,i,t),e.child}function CL(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Qw(n,e,t,r,i){var s=as(t)?ac:Ri.current;return s=ld(e,s),Jh(e,i),t=c1(n,e,t,r,s,i),r=h1(),n!==null&&!ss?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Aa(n,e,i)):(Jn&&r&&ZT(e),e.flags|=1,Vi(n,e,t,i),e.child)}function GI(n,e,t,r,i){if(as(t)){var s=!0;V_(e)}else s=!1;if(Jh(e,i),e.stateNode===null)a_(n,e),wL(e,t,r),Yw(e,t,r,i),r=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=Qs(u):(u=as(t)?ac:Ri.current,u=ld(e,u));var d=t.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&UI(e,o,r,u),ll=!1;var p=e.memoizedState;o.state=p,W_(e,r,o,i),l=e.memoizedState,a!==r||p!==l||os.current||ll?(typeof d=="function"&&($w(e,t,d,r),l=e.memoizedState),(a=ll||OI(e,t,a,r,p,l,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,tL(n,e),a=e.memoizedProps,u=e.type===e.elementType?a:uo(e.type,a),o.props=u,f=e.pendingProps,p=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Qs(l):(l=as(t)?ac:Ri.current,l=ld(e,l));var g=t.getDerivedStateFromProps;(d=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||p!==l)&&UI(e,o,r,l),ll=!1,p=e.memoizedState,o.state=p,W_(e,r,o,i);var y=e.memoizedState;a!==f||p!==y||os.current||ll?(typeof g=="function"&&($w(e,t,g,r),y=e.memoizedState),(u=ll||OI(e,t,u,r,p,y,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,y,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,y,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),o.props=r,o.state=y,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),r=!1)}return Zw(n,e,t,r,s,i)}function Zw(n,e,t,r,i,s){CL(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&II(e,t,!1),Aa(n,e,s);r=e.stateNode,KV.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=cd(e,n.child,null,s),e.child=cd(e,null,a,s)):Vi(n,e,a,s),e.memoizedState=r.state,i&&II(e,t,!0),e.child}function IL(n){var e=n.stateNode;e.pendingContext?CI(n,e.pendingContext,e.pendingContext!==e.context):e.context&&CI(n,e.context,!1),o1(n,e.containerInfo)}function WI(n,e,t,r,i){return ud(),e1(i),e.flags|=256,Vi(n,e,t,r),e.child}var Jw={dehydrated:null,treeContext:null,retryLane:0};function eS(n){return{baseLanes:n,cachePool:null,transitions:null}}function bL(n,e,t){var r=e.pendingProps,i=rr.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),Xn(rr,i&1),n===null)return qw(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Vy(o,r,0,null),n=tc(n,r,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=eS(t),e.memoizedState=Jw,n):p1(e,o));if(i=n.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return QV(n,e,o,r,a,i,t);if(s){s=r.fallback,o=e.mode,i=n.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Cl(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Cl(a,s):(s=tc(s,o,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=n.child.memoizedState,o=o===null?eS(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=Jw,r}return s=n.child,n=s.sibling,r=Cl(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function p1(n,e){return e=Vy({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Gg(n,e,t,r){return r!==null&&e1(r),cd(e,n.child,null,t),n=p1(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function QV(n,e,t,r,i,s,o){if(t)return e.flags&256?(e.flags&=-257,r=iE(Error(tt(422))),Gg(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Vy({mode:"visible",children:r.children},i,0,null),s=tc(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&cd(e,n.child,null,o),e.child.memoizedState=eS(o),e.memoizedState=Jw,s);if(!(e.mode&1))return Gg(n,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(tt(419)),r=iE(s,r,void 0),Gg(n,e,o,r)}if(a=(o&n.childLanes)!==0,ss||a){if(r=ti,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ma(n,i),yo(r,n,i,-1))}return x1(),r=iE(Error(tt(421))),Gg(n,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=cB.bind(null,n),i._reactRetry=e,null):(n=s.treeContext,Ts=Sl(i.nextSibling),As=e,Jn=!0,fo=null,n!==null&&(qs[Xs++]=ga,qs[Xs++]=va,qs[Xs++]=lc,ga=n.id,va=n.overflow,lc=e),e=p1(e,r.children),e.flags|=4096,e)}function jI(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),Xw(n.return,e,t)}function sE(n,e,t,r,i){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=i)}function RL(n,e,t){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Vi(n,e,r.children,t),r=rr.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&jI(n,t,e);else if(n.tag===19)jI(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Xn(rr,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&j_(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),sE(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&j_(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}sE(e,!0,t,null,s);break;case"together":sE(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function a_(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Aa(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),cc|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(tt(153));if(e.child!==null){for(n=e.child,t=Cl(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Cl(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function ZV(n,e,t){switch(e.tag){case 3:IL(e),ud();break;case 5:nL(e);break;case 1:as(e.type)&&V_(e);break;case 4:o1(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Xn(H_,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Xn(rr,rr.current&1),e.flags|=128,null):t&e.child.childLanes?bL(n,e,t):(Xn(rr,rr.current&1),n=Aa(n,e,t),n!==null?n.sibling:null);Xn(rr,rr.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return RL(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Xn(rr,rr.current),r)break;return null;case 22:case 23:return e.lanes=0,AL(n,e,t)}return Aa(n,e,t)}var PL,tS,NL,LL;PL=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};tS=function(){};NL=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,qu(Uo.current);var s=null;switch(t){case"input":i=Sw(n,i),r=Sw(n,r),s=[];break;case"select":i=ar({},i,{value:void 0}),r=ar({},r,{value:void 0}),s=[];break;case"textarea":i=Aw(n,i),r=Aw(n,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=U_)}Iw(t,r);var o;t=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(mp.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(s||(s=[]),s.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(mp.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Yn("scroll",n),s||a===l||(s=[])):(s=s||[]).push(u,l))}t&&(s=s||[]).push("style",t);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};LL=function(n,e,t,r){t!==r&&(e.flags|=4)};function gf(n,e){if(!Jn)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function _i(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function JV(n,e,t){var r=e.pendingProps;switch(JT(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _i(e),null;case 1:return as(e.type)&&F_(),_i(e),null;case 3:return r=e.stateNode,hd(),Zn(os),Zn(Ri),l1(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(zg(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,fo!==null&&(uS(fo),fo=null))),tS(n,e),_i(e),null;case 5:a1(e);var i=qu(Cp.current);if(t=e.type,n!==null&&e.stateNode!=null)NL(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(tt(166));return _i(e),null}if(n=qu(Uo.current),zg(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[Do]=e,r[Mp]=s,n=(e.mode&1)!==0,t){case"dialog":Yn("cancel",r),Yn("close",r);break;case"iframe":case"object":case"embed":Yn("load",r);break;case"video":case"audio":for(i=0;i<Uf.length;i++)Yn(Uf[i],r);break;case"source":Yn("error",r);break;case"img":case"image":case"link":Yn("error",r),Yn("load",r);break;case"details":Yn("toggle",r);break;case"input":eI(r,s),Yn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Yn("invalid",r);break;case"textarea":nI(r,s),Yn("invalid",r)}Iw(t,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Bg(r.textContent,a,n),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Bg(r.textContent,a,n),i=["children",""+a]):mp.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Yn("scroll",r)}switch(t){case"input":Ng(r),tI(r,s,!0);break;case"textarea":Ng(r),rI(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=U_)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=aN(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[Do]=e,n[Mp]=r,PL(n,e,!1,!1),e.stateNode=n;e:{switch(o=bw(t,r),t){case"dialog":Yn("cancel",n),Yn("close",n),i=r;break;case"iframe":case"object":case"embed":Yn("load",n),i=r;break;case"video":case"audio":for(i=0;i<Uf.length;i++)Yn(Uf[i],n);i=r;break;case"source":Yn("error",n),i=r;break;case"img":case"image":case"link":Yn("error",n),Yn("load",n),i=r;break;case"details":Yn("toggle",n),i=r;break;case"input":eI(n,r),i=Sw(n,r),Yn("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=ar({},r,{value:void 0}),Yn("invalid",n);break;case"textarea":nI(n,r),i=Aw(n,r),Yn("invalid",n);break;default:i=r}Iw(t,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?cN(n,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&lN(n,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&gp(n,l):typeof l=="number"&&gp(n,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(mp.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Yn("scroll",n):l!=null&&FT(n,s,l,o))}switch(t){case"input":Ng(n),tI(n,r,!1);break;case"textarea":Ng(n),rI(n);break;case"option":r.value!=null&&n.setAttribute("value",""+Fl(r.value));break;case"select":n.multiple=!!r.multiple,s=r.value,s!=null?Yh(n,!!r.multiple,s,!1):r.defaultValue!=null&&Yh(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=U_)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return _i(e),null;case 6:if(n&&e.stateNode!=null)LL(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(tt(166));if(t=qu(Cp.current),qu(Uo.current),zg(e)){if(r=e.stateNode,t=e.memoizedProps,r[Do]=e,(s=r.nodeValue!==t)&&(n=As,n!==null))switch(n.tag){case 3:Bg(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Bg(r.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Do]=e,e.stateNode=r}return _i(e),null;case 13:if(Zn(rr),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Jn&&Ts!==null&&e.mode&1&&!(e.flags&128))QN(),ud(),e.flags|=98560,s=!1;else if(s=zg(e),r!==null&&r.dehydrated!==null){if(n===null){if(!s)throw Error(tt(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(tt(317));s[Do]=e}else ud(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;_i(e),s=!1}else fo!==null&&(uS(fo),fo=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||rr.current&1?Hr===0&&(Hr=3):x1())),e.updateQueue!==null&&(e.flags|=4),_i(e),null);case 4:return hd(),tS(n,e),n===null&&Sp(e.stateNode.containerInfo),_i(e),null;case 10:return r1(e.type._context),_i(e),null;case 17:return as(e.type)&&F_(),_i(e),null;case 19:if(Zn(rr),s=e.memoizedState,s===null)return _i(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)gf(s,!1);else{if(Hr!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=j_(n),o!==null){for(e.flags|=128,gf(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,n=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Xn(rr,rr.current&1|2),e.child}n=n.sibling}s.tail!==null&&wr()>fd&&(e.flags|=128,r=!0,gf(s,!1),e.lanes=4194304)}else{if(!r)if(n=j_(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),gf(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Jn)return _i(e),null}else 2*wr()-s.renderingStartTime>fd&&t!==1073741824&&(e.flags|=128,r=!0,gf(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=wr(),e.sibling=null,t=rr.current,Xn(rr,r?t&1|2:t&1),e):(_i(e),null);case 22:case 23:return y1(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?xs&1073741824&&(_i(e),e.subtreeFlags&6&&(e.flags|=8192)):_i(e),null;case 24:return null;case 25:return null}throw Error(tt(156,e.tag))}function eB(n,e){switch(JT(e),e.tag){case 1:return as(e.type)&&F_(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return hd(),Zn(os),Zn(Ri),l1(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return a1(e),null;case 13:if(Zn(rr),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(tt(340));ud()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Zn(rr),null;case 4:return hd(),null;case 10:return r1(e.type._context),null;case 22:case 23:return y1(),null;case 24:return null;default:return null}}var Wg=!1,Ai=!1,tB=typeof WeakSet=="function"?WeakSet:Set,bt=null;function Fh(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){pr(n,e,r)}else t.current=null}function nS(n,e,t){try{t()}catch(r){pr(n,e,r)}}var qI=!1;function nB(n,e){if(Vw=D_,n=FN(),QT(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,u=0,d=0,f=n,p=null;t:for(;;){for(var g;f!==t||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(g=f.firstChild)!==null;)p=f,f=g;for(;;){if(f===n)break t;if(p===t&&++u===i&&(a=o),p===s&&++d===r&&(l=o),(g=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=g}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Bw={focusedElem:n,selectionRange:t},D_=!1,bt=e;bt!==null;)if(e=bt,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,bt=n;else for(;bt!==null;){e=bt;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var S=y.memoizedProps,x=y.memoizedState,v=e.stateNode,w=v.getSnapshotBeforeUpdate(e.elementType===e.type?S:uo(e.type,S),x);v.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(tt(163))}}catch(R){pr(e,e.return,R)}if(n=e.sibling,n!==null){n.return=e.return,bt=n;break}bt=e.return}return y=qI,qI=!1,y}function Zf(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var s=i.destroy;i.destroy=void 0,s!==void 0&&nS(e,t,s)}i=i.next}while(i!==r)}}function Uy(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function rS(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function DL(n){var e=n.alternate;e!==null&&(n.alternate=null,DL(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Do],delete e[Mp],delete e[Gw],delete e[FV],delete e[VV])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function kL(n){return n.tag===5||n.tag===3||n.tag===4}function XI(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||kL(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function iS(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=U_));else if(r!==4&&(n=n.child,n!==null))for(iS(n,e,t),n=n.sibling;n!==null;)iS(n,e,t),n=n.sibling}function sS(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(sS(n,e,t),n=n.sibling;n!==null;)sS(n,e,t),n=n.sibling}var ri=null,ho=!1;function Ka(n,e,t){for(t=t.child;t!==null;)OL(n,e,t),t=t.sibling}function OL(n,e,t){if(Oo&&typeof Oo.onCommitFiberUnmount=="function")try{Oo.onCommitFiberUnmount(by,t)}catch{}switch(t.tag){case 5:Ai||Fh(t,e);case 6:var r=ri,i=ho;ri=null,Ka(n,e,t),ri=r,ho=i,ri!==null&&(ho?(n=ri,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):ri.removeChild(t.stateNode));break;case 18:ri!==null&&(ho?(n=ri,t=t.stateNode,n.nodeType===8?Zx(n.parentNode,t):n.nodeType===1&&Zx(n,t),xp(n)):Zx(ri,t.stateNode));break;case 4:r=ri,i=ho,ri=t.stateNode.containerInfo,ho=!0,Ka(n,e,t),ri=r,ho=i;break;case 0:case 11:case 14:case 15:if(!Ai&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&nS(t,e,o),i=i.next}while(i!==r)}Ka(n,e,t);break;case 1:if(!Ai&&(Fh(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){pr(t,e,a)}Ka(n,e,t);break;case 21:Ka(n,e,t);break;case 22:t.mode&1?(Ai=(r=Ai)||t.memoizedState!==null,Ka(n,e,t),Ai=r):Ka(n,e,t);break;default:Ka(n,e,t)}}function $I(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new tB),e.forEach(function(r){var i=hB.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function ro(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var s=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:ri=a.stateNode,ho=!1;break e;case 3:ri=a.stateNode.containerInfo,ho=!0;break e;case 4:ri=a.stateNode.containerInfo,ho=!0;break e}a=a.return}if(ri===null)throw Error(tt(160));OL(s,o,i),ri=null,ho=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){pr(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)UL(e,n),e=e.sibling}function UL(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(ro(e,n),bo(n),r&4){try{Zf(3,n,n.return),Uy(3,n)}catch(S){pr(n,n.return,S)}try{Zf(5,n,n.return)}catch(S){pr(n,n.return,S)}}break;case 1:ro(e,n),bo(n),r&512&&t!==null&&Fh(t,t.return);break;case 5:if(ro(e,n),bo(n),r&512&&t!==null&&Fh(t,t.return),n.flags&32){var i=n.stateNode;try{gp(i,"")}catch(S){pr(n,n.return,S)}}if(r&4&&(i=n.stateNode,i!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&sN(i,s),bw(a,o);var u=bw(a,s);for(o=0;o<l.length;o+=2){var d=l[o],f=l[o+1];d==="style"?cN(i,f):d==="dangerouslySetInnerHTML"?lN(i,f):d==="children"?gp(i,f):FT(i,d,f,u)}switch(a){case"input":Tw(i,s);break;case"textarea":oN(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?Yh(i,!!s.multiple,g,!1):p!==!!s.multiple&&(s.defaultValue!=null?Yh(i,!!s.multiple,s.defaultValue,!0):Yh(i,!!s.multiple,s.multiple?[]:"",!1))}i[Mp]=s}catch(S){pr(n,n.return,S)}}break;case 6:if(ro(e,n),bo(n),r&4){if(n.stateNode===null)throw Error(tt(162));i=n.stateNode,s=n.memoizedProps;try{i.nodeValue=s}catch(S){pr(n,n.return,S)}}break;case 3:if(ro(e,n),bo(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{xp(e.containerInfo)}catch(S){pr(n,n.return,S)}break;case 4:ro(e,n),bo(n);break;case 13:ro(e,n),bo(n),i=n.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(v1=wr())),r&4&&$I(n);break;case 22:if(d=t!==null&&t.memoizedState!==null,n.mode&1?(Ai=(u=Ai)||d,ro(e,n),Ai=u):ro(e,n),bo(n),r&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!d&&n.mode&1)for(bt=n,d=n.child;d!==null;){for(f=bt=d;bt!==null;){switch(p=bt,g=p.child,p.tag){case 0:case 11:case 14:case 15:Zf(4,p,p.return);break;case 1:Fh(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){r=p,t=p.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(S){pr(r,t,S)}}break;case 5:Fh(p,p.return);break;case 22:if(p.memoizedState!==null){KI(f);continue}}g!==null?(g.return=p,bt=g):KI(f)}d=d.sibling}e:for(d=null,f=n;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=uN("display",o))}catch(S){pr(n,n.return,S)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(S){pr(n,n.return,S)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:ro(e,n),bo(n),r&4&&$I(n);break;case 21:break;default:ro(e,n),bo(n)}}function bo(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(kL(t)){var r=t;break e}t=t.return}throw Error(tt(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(gp(i,""),r.flags&=-33);var s=XI(n);sS(n,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=XI(n);iS(n,a,o);break;default:throw Error(tt(161))}}catch(l){pr(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function rB(n,e,t){bt=n,FL(n)}function FL(n,e,t){for(var r=(n.mode&1)!==0;bt!==null;){var i=bt,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Wg;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Ai;a=Wg;var u=Ai;if(Wg=o,(Ai=l)&&!u)for(bt=i;bt!==null;)o=bt,l=o.child,o.tag===22&&o.memoizedState!==null?QI(i):l!==null?(l.return=o,bt=l):QI(i);for(;s!==null;)bt=s,FL(s),s=s.sibling;bt=i,Wg=a,Ai=u}YI(n)}else i.subtreeFlags&8772&&s!==null?(s.return=i,bt=s):YI(n)}}function YI(n){for(;bt!==null;){var e=bt;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ai||Uy(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ai)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:uo(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&LI(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}LI(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&xp(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(tt(163))}Ai||e.flags&512&&rS(e)}catch(p){pr(e,e.return,p)}}if(e===n){bt=null;break}if(t=e.sibling,t!==null){t.return=e.return,bt=t;break}bt=e.return}}function KI(n){for(;bt!==null;){var e=bt;if(e===n){bt=null;break}var t=e.sibling;if(t!==null){t.return=e.return,bt=t;break}bt=e.return}}function QI(n){for(;bt!==null;){var e=bt;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Uy(4,e)}catch(l){pr(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){pr(e,i,l)}}var s=e.return;try{rS(e)}catch(l){pr(e,s,l)}break;case 5:var o=e.return;try{rS(e)}catch(l){pr(e,o,l)}}}catch(l){pr(e,e.return,l)}if(e===n){bt=null;break}var a=e.sibling;if(a!==null){a.return=e.return,bt=a;break}bt=e.return}}var iB=Math.ceil,$_=Da.ReactCurrentDispatcher,m1=Da.ReactCurrentOwner,Ks=Da.ReactCurrentBatchConfig,bn=0,ti=null,Lr=null,oi=0,xs=0,Vh=Zl(0),Hr=0,Pp=null,cc=0,Fy=0,g1=0,Jf=null,ns=null,v1=0,fd=1/0,ha=null,Y_=!1,oS=null,Ml=null,jg=!1,vl=null,K_=0,ep=0,aS=null,l_=-1,u_=0;function zi(){return bn&6?wr():l_!==-1?l_:l_=wr()}function Al(n){return n.mode&1?bn&2&&oi!==0?oi&-oi:zV.transition!==null?(u_===0&&(u_=wN()),u_):(n=Bn,n!==0||(n=window.event,n=n===void 0?16:bN(n.type)),n):1}function yo(n,e,t,r){if(50<ep)throw ep=0,aS=null,Error(tt(185));fm(n,t,r),(!(bn&2)||n!==ti)&&(n===ti&&(!(bn&2)&&(Fy|=t),Hr===4&&hl(n,oi)),ls(n,r),t===1&&bn===0&&!(e.mode&1)&&(fd=wr()+500,Dy&&Jl()))}function ls(n,e){var t=n.callbackNode;z4(n,e);var r=L_(n,n===ti?oi:0);if(r===0)t!==null&&oI(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&oI(t),e===1)n.tag===0?BV(ZI.bind(null,n)):$N(ZI.bind(null,n)),OV(function(){!(bn&6)&&Jl()}),t=null;else{switch(SN(r)){case 1:t=GT;break;case 4:t=xN;break;case 16:t=N_;break;case 536870912:t=EN;break;default:t=N_}t=qL(t,VL.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function VL(n,e){if(l_=-1,u_=0,bn&6)throw Error(tt(327));var t=n.callbackNode;if(ed()&&n.callbackNode!==t)return null;var r=L_(n,n===ti?oi:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Q_(n,r);else{e=r;var i=bn;bn|=2;var s=zL();(ti!==n||oi!==e)&&(ha=null,fd=wr()+500,ec(n,e));do try{aB();break}catch(a){BL(n,a)}while(!0);n1(),$_.current=s,bn=i,Lr!==null?e=0:(ti=null,oi=0,e=Hr)}if(e!==0){if(e===2&&(i=Dw(n),i!==0&&(r=i,e=lS(n,i))),e===1)throw t=Pp,ec(n,0),hl(n,r),ls(n,wr()),t;if(e===6)hl(n,r);else{if(i=n.current.alternate,!(r&30)&&!sB(i)&&(e=Q_(n,r),e===2&&(s=Dw(n),s!==0&&(r=s,e=lS(n,s))),e===1))throw t=Pp,ec(n,0),hl(n,r),ls(n,wr()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(tt(345));case 2:Du(n,ns,ha);break;case 3:if(hl(n,r),(r&130023424)===r&&(e=v1+500-wr(),10<e)){if(L_(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){zi(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=Hw(Du.bind(null,n,ns,ha),e);break}Du(n,ns,ha);break;case 4:if(hl(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var o=31-_o(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=wr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*iB(r/1960))-r,10<r){n.timeoutHandle=Hw(Du.bind(null,n,ns,ha),r);break}Du(n,ns,ha);break;case 5:Du(n,ns,ha);break;default:throw Error(tt(329))}}}return ls(n,wr()),n.callbackNode===t?VL.bind(null,n):null}function lS(n,e){var t=Jf;return n.current.memoizedState.isDehydrated&&(ec(n,e).flags|=256),n=Q_(n,e),n!==2&&(e=ns,ns=t,e!==null&&uS(e)),n}function uS(n){ns===null?ns=n:ns.push.apply(ns,n)}function sB(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],s=i.getSnapshot;i=i.value;try{if(!xo(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function hl(n,e){for(e&=~g1,e&=~Fy,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-_o(e),r=1<<t;n[t]=-1,e&=~r}}function ZI(n){if(bn&6)throw Error(tt(327));ed();var e=L_(n,0);if(!(e&1))return ls(n,wr()),null;var t=Q_(n,e);if(n.tag!==0&&t===2){var r=Dw(n);r!==0&&(e=r,t=lS(n,r))}if(t===1)throw t=Pp,ec(n,0),hl(n,e),ls(n,wr()),t;if(t===6)throw Error(tt(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Du(n,ns,ha),ls(n,wr()),null}function _1(n,e){var t=bn;bn|=1;try{return n(e)}finally{bn=t,bn===0&&(fd=wr()+500,Dy&&Jl())}}function hc(n){vl!==null&&vl.tag===0&&!(bn&6)&&ed();var e=bn;bn|=1;var t=Ks.transition,r=Bn;try{if(Ks.transition=null,Bn=1,n)return n()}finally{Bn=r,Ks.transition=t,bn=e,!(bn&6)&&Jl()}}function y1(){xs=Vh.current,Zn(Vh)}function ec(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,kV(t)),Lr!==null)for(t=Lr.return;t!==null;){var r=t;switch(JT(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&F_();break;case 3:hd(),Zn(os),Zn(Ri),l1();break;case 5:a1(r);break;case 4:hd();break;case 13:Zn(rr);break;case 19:Zn(rr);break;case 10:r1(r.type._context);break;case 22:case 23:y1()}t=t.return}if(ti=n,Lr=n=Cl(n.current,null),oi=xs=e,Hr=0,Pp=null,g1=Fy=cc=0,ns=Jf=null,ju!==null){for(e=0;e<ju.length;e++)if(t=ju[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,s=t.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}t.pending=r}ju=null}return n}function BL(n,e){do{var t=Lr;try{if(n1(),s_.current=X_,q_){for(var r=or.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}q_=!1}if(uc=0,Zr=zr=or=null,Qf=!1,Ip=0,m1.current=null,t===null||t.return===null){Hr=1,Pp=e,Lr=null;break}e:{var s=n,o=t.return,a=t,l=e;if(e=oi,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=VI(o);if(g!==null){g.flags&=-257,BI(g,o,a,s,e),g.mode&1&&FI(s,u,e),e=g,l=u;var y=e.updateQueue;if(y===null){var S=new Set;S.add(l),e.updateQueue=S}else y.add(l);break e}else{if(!(e&1)){FI(s,u,e),x1();break e}l=Error(tt(426))}}else if(Jn&&a.mode&1){var x=VI(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),BI(x,o,a,s,e),e1(dd(l,a));break e}}s=l=dd(l,a),Hr!==4&&(Hr=2),Jf===null?Jf=[s]:Jf.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=SL(s,l,e);NI(s,v);break e;case 1:a=l;var w=s.type,T=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Ml===null||!Ml.has(T)))){s.flags|=65536,e&=-e,s.lanes|=e;var R=TL(s,a,e);NI(s,R);break e}}s=s.return}while(s!==null)}GL(t)}catch(U){e=U,Lr===t&&t!==null&&(Lr=t=t.return);continue}break}while(!0)}function zL(){var n=$_.current;return $_.current=X_,n===null?X_:n}function x1(){(Hr===0||Hr===3||Hr===2)&&(Hr=4),ti===null||!(cc&268435455)&&!(Fy&268435455)||hl(ti,oi)}function Q_(n,e){var t=bn;bn|=2;var r=zL();(ti!==n||oi!==e)&&(ha=null,ec(n,e));do try{oB();break}catch(i){BL(n,i)}while(!0);if(n1(),bn=t,$_.current=r,Lr!==null)throw Error(tt(261));return ti=null,oi=0,Hr}function oB(){for(;Lr!==null;)HL(Lr)}function aB(){for(;Lr!==null&&!N4();)HL(Lr)}function HL(n){var e=jL(n.alternate,n,xs);n.memoizedProps=n.pendingProps,e===null?GL(n):Lr=e,m1.current=null}function GL(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=eB(t,e),t!==null){t.flags&=32767,Lr=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Hr=6,Lr=null;return}}else if(t=JV(t,e,xs),t!==null){Lr=t;return}if(e=e.sibling,e!==null){Lr=e;return}Lr=e=n}while(e!==null);Hr===0&&(Hr=5)}function Du(n,e,t){var r=Bn,i=Ks.transition;try{Ks.transition=null,Bn=1,lB(n,e,t,r)}finally{Ks.transition=i,Bn=r}return null}function lB(n,e,t,r){do ed();while(vl!==null);if(bn&6)throw Error(tt(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(tt(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(H4(n,s),n===ti&&(Lr=ti=null,oi=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||jg||(jg=!0,qL(N_,function(){return ed(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=Ks.transition,Ks.transition=null;var o=Bn;Bn=1;var a=bn;bn|=4,m1.current=null,nB(n,t),UL(t,n),IV(Bw),D_=!!Vw,Bw=Vw=null,n.current=t,rB(t),L4(),bn=a,Bn=o,Ks.transition=s}else n.current=t;if(jg&&(jg=!1,vl=n,K_=i),s=n.pendingLanes,s===0&&(Ml=null),O4(t.stateNode),ls(n,wr()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(Y_)throw Y_=!1,n=oS,oS=null,n;return K_&1&&n.tag!==0&&ed(),s=n.pendingLanes,s&1?n===aS?ep++:(ep=0,aS=n):ep=0,Jl(),null}function ed(){if(vl!==null){var n=SN(K_),e=Ks.transition,t=Bn;try{if(Ks.transition=null,Bn=16>n?16:n,vl===null)var r=!1;else{if(n=vl,vl=null,K_=0,bn&6)throw Error(tt(331));var i=bn;for(bn|=4,bt=n.current;bt!==null;){var s=bt,o=s.child;if(bt.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(bt=u;bt!==null;){var d=bt;switch(d.tag){case 0:case 11:case 15:Zf(8,d,s)}var f=d.child;if(f!==null)f.return=d,bt=f;else for(;bt!==null;){d=bt;var p=d.sibling,g=d.return;if(DL(d),d===u){bt=null;break}if(p!==null){p.return=g,bt=p;break}bt=g}}}var y=s.alternate;if(y!==null){var S=y.child;if(S!==null){y.child=null;do{var x=S.sibling;S.sibling=null,S=x}while(S!==null)}}bt=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,bt=o;else e:for(;bt!==null;){if(s=bt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Zf(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,bt=v;break e}bt=s.return}}var w=n.current;for(bt=w;bt!==null;){o=bt;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,bt=T;else e:for(o=w;bt!==null;){if(a=bt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Uy(9,a)}}catch(U){pr(a,a.return,U)}if(a===o){bt=null;break e}var R=a.sibling;if(R!==null){R.return=a.return,bt=R;break e}bt=a.return}}if(bn=i,Jl(),Oo&&typeof Oo.onPostCommitFiberRoot=="function")try{Oo.onPostCommitFiberRoot(by,n)}catch{}r=!0}return r}finally{Bn=t,Ks.transition=e}}return!1}function JI(n,e,t){e=dd(t,e),e=SL(n,e,1),n=Tl(n,e,1),e=zi(),n!==null&&(fm(n,1,e),ls(n,e))}function pr(n,e,t){if(n.tag===3)JI(n,n,t);else for(;e!==null;){if(e.tag===3){JI(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ml===null||!Ml.has(r))){n=dd(t,n),n=TL(e,n,1),e=Tl(e,n,1),n=zi(),e!==null&&(fm(e,1,n),ls(e,n));break}}e=e.return}}function uB(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=zi(),n.pingedLanes|=n.suspendedLanes&t,ti===n&&(oi&t)===t&&(Hr===4||Hr===3&&(oi&130023424)===oi&&500>wr()-v1?ec(n,0):g1|=t),ls(n,e)}function WL(n,e){e===0&&(n.mode&1?(e=kg,kg<<=1,!(kg&130023424)&&(kg=4194304)):e=1);var t=zi();n=Ma(n,e),n!==null&&(fm(n,e,t),ls(n,t))}function cB(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),WL(n,t)}function hB(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(tt(314))}r!==null&&r.delete(e),WL(n,t)}var jL;jL=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||os.current)ss=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return ss=!1,ZV(n,e,t);ss=!!(n.flags&131072)}else ss=!1,Jn&&e.flags&1048576&&YN(e,z_,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;a_(n,e),n=e.pendingProps;var i=ld(e,Ri.current);Jh(e,t),i=c1(null,e,r,n,i,t);var s=h1();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,as(r)?(s=!0,V_(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,s1(e),i.updater=Oy,e.stateNode=i,i._reactInternals=e,Yw(e,r,n,t),e=Zw(null,e,r,!0,s,t)):(e.tag=0,Jn&&s&&ZT(e),Vi(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(a_(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=fB(r),n=uo(r,n),i){case 0:e=Qw(null,e,r,n,t);break e;case 1:e=GI(null,e,r,n,t);break e;case 11:e=zI(null,e,r,n,t);break e;case 14:e=HI(null,e,r,uo(r.type,n),t);break e}throw Error(tt(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:uo(r,i),Qw(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:uo(r,i),GI(n,e,r,i,t);case 3:e:{if(IL(e),n===null)throw Error(tt(387));r=e.pendingProps,s=e.memoizedState,i=s.element,tL(n,e),W_(e,r,null,t);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=dd(Error(tt(423)),e),e=WI(n,e,r,t,i);break e}else if(r!==i){i=dd(Error(tt(424)),e),e=WI(n,e,r,t,i);break e}else for(Ts=Sl(e.stateNode.containerInfo.firstChild),As=e,Jn=!0,fo=null,t=JN(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(ud(),r===i){e=Aa(n,e,t);break e}Vi(n,e,r,t)}e=e.child}return e;case 5:return nL(e),n===null&&qw(e),r=e.type,i=e.pendingProps,s=n!==null?n.memoizedProps:null,o=i.children,zw(r,i)?o=null:s!==null&&zw(r,s)&&(e.flags|=32),CL(n,e),Vi(n,e,o,t),e.child;case 6:return n===null&&qw(e),null;case 13:return bL(n,e,t);case 4:return o1(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=cd(e,null,r,t):Vi(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:uo(r,i),zI(n,e,r,i,t);case 7:return Vi(n,e,e.pendingProps,t),e.child;case 8:return Vi(n,e,e.pendingProps.children,t),e.child;case 12:return Vi(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Xn(H_,r._currentValue),r._currentValue=o,s!==null)if(xo(s.value,o)){if(s.children===i.children&&!os.current){e=Aa(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Ea(-1,t&-t),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),Xw(s.return,t,e),a.lanes|=t;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(tt(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),Xw(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Vi(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Jh(e,t),i=Qs(i),r=r(i),e.flags|=1,Vi(n,e,r,t),e.child;case 14:return r=e.type,i=uo(r,e.pendingProps),i=uo(r.type,i),HI(n,e,r,i,t);case 15:return ML(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:uo(r,i),a_(n,e),e.tag=1,as(r)?(n=!0,V_(e)):n=!1,Jh(e,t),wL(e,r,i),Yw(e,r,i,t),Zw(null,e,r,!0,n,t);case 19:return RL(n,e,t);case 22:return AL(n,e,t)}throw Error(tt(156,e.tag))};function qL(n,e){return yN(n,e)}function dB(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ys(n,e,t,r){return new dB(n,e,t,r)}function E1(n){return n=n.prototype,!(!n||!n.isReactComponent)}function fB(n){if(typeof n=="function")return E1(n)?1:0;if(n!=null){if(n=n.$$typeof,n===BT)return 11;if(n===zT)return 14}return 2}function Cl(n,e){var t=n.alternate;return t===null?(t=Ys(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function c_(n,e,t,r,i,s){var o=2;if(r=n,typeof n=="function")E1(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case bh:return tc(t.children,i,s,e);case VT:o=8,i|=8;break;case yw:return n=Ys(12,t,e,i|2),n.elementType=yw,n.lanes=s,n;case xw:return n=Ys(13,t,e,i),n.elementType=xw,n.lanes=s,n;case Ew:return n=Ys(19,t,e,i),n.elementType=Ew,n.lanes=s,n;case nN:return Vy(t,i,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case eN:o=10;break e;case tN:o=9;break e;case BT:o=11;break e;case zT:o=14;break e;case al:o=16,r=null;break e}throw Error(tt(130,n==null?n:typeof n,""))}return e=Ys(o,t,e,i),e.elementType=n,e.type=r,e.lanes=s,e}function tc(n,e,t,r){return n=Ys(7,n,r,e),n.lanes=t,n}function Vy(n,e,t,r){return n=Ys(22,n,r,e),n.elementType=nN,n.lanes=t,n.stateNode={isHidden:!1},n}function oE(n,e,t){return n=Ys(6,n,null,e),n.lanes=t,n}function aE(n,e,t){return e=Ys(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function pB(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zx(0),this.expirationTimes=zx(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zx(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function w1(n,e,t,r,i,s,o,a,l){return n=new pB(n,e,t,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Ys(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},s1(s),n}function mB(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ih,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function XL(n){if(!n)return Vl;n=n._reactInternals;e:{if(wc(n)!==n||n.tag!==1)throw Error(tt(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(as(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(tt(171))}if(n.tag===1){var t=n.type;if(as(t))return XN(n,t,e)}return e}function $L(n,e,t,r,i,s,o,a,l){return n=w1(t,r,!0,n,i,s,o,a,l),n.context=XL(null),t=n.current,r=zi(),i=Al(t),s=Ea(r,i),s.callback=e??null,Tl(t,s,i),n.current.lanes=i,fm(n,i,r),ls(n,r),n}function By(n,e,t,r){var i=e.current,s=zi(),o=Al(i);return t=XL(t),e.context===null?e.context=t:e.pendingContext=t,e=Ea(s,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=Tl(i,e,o),n!==null&&(yo(n,i,o,s),i_(n,i,o)),o}function Z_(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function eb(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function S1(n,e){eb(n,e),(n=n.alternate)&&eb(n,e)}function gB(){return null}var YL=typeof reportError=="function"?reportError:function(n){console.error(n)};function T1(n){this._internalRoot=n}zy.prototype.render=T1.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(tt(409));By(n,e,null,null)};zy.prototype.unmount=T1.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;hc(function(){By(null,n,null,null)}),e[Ta]=null}};function zy(n){this._internalRoot=n}zy.prototype.unstable_scheduleHydration=function(n){if(n){var e=AN();n={blockedOn:null,target:n,priority:e};for(var t=0;t<cl.length&&e!==0&&e<cl[t].priority;t++);cl.splice(t,0,n),t===0&&IN(n)}};function M1(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Hy(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function tb(){}function vB(n,e,t,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=Z_(o);s.call(u)}}var o=$L(e,r,n,0,null,!1,!1,"",tb);return n._reactRootContainer=o,n[Ta]=o.current,Sp(n.nodeType===8?n.parentNode:n),hc(),o}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=Z_(l);a.call(u)}}var l=w1(n,0,!1,null,null,!1,!1,"",tb);return n._reactRootContainer=l,n[Ta]=l.current,Sp(n.nodeType===8?n.parentNode:n),hc(function(){By(e,l,t,r)}),l}function Gy(n,e,t,r,i){var s=t._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Z_(o);a.call(l)}}By(e,o,n,i)}else o=vB(t,e,n,i,r);return Z_(o)}TN=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Of(e.pendingLanes);t!==0&&(WT(e,t|1),ls(e,wr()),!(bn&6)&&(fd=wr()+500,Jl()))}break;case 13:hc(function(){var r=Ma(n,1);if(r!==null){var i=zi();yo(r,n,1,i)}}),S1(n,1)}};jT=function(n){if(n.tag===13){var e=Ma(n,134217728);if(e!==null){var t=zi();yo(e,n,134217728,t)}S1(n,134217728)}};MN=function(n){if(n.tag===13){var e=Al(n),t=Ma(n,e);if(t!==null){var r=zi();yo(t,n,e,r)}S1(n,e)}};AN=function(){return Bn};CN=function(n,e){var t=Bn;try{return Bn=n,e()}finally{Bn=t}};Pw=function(n,e,t){switch(e){case"input":if(Tw(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=Ly(r);if(!i)throw Error(tt(90));iN(r),Tw(r,i)}}}break;case"textarea":oN(n,t);break;case"select":e=t.value,e!=null&&Yh(n,!!t.multiple,e,!1)}};fN=_1;pN=hc;var _B={usingClientEntryPoint:!1,Events:[mm,Lh,Ly,hN,dN,_1]},vf={findFiberByHostInstance:Wu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},yB={bundleType:vf.bundleType,version:vf.version,rendererPackageName:vf.rendererPackageName,rendererConfig:vf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Da.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=vN(n),n===null?null:n.stateNode},findFiberByHostInstance:vf.findFiberByHostInstance||gB,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qg.isDisabled&&qg.supportsFiber)try{by=qg.inject(yB),Oo=qg}catch{}}Ds.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_B;Ds.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!M1(e))throw Error(tt(200));return mB(n,e,null,t)};Ds.createRoot=function(n,e){if(!M1(n))throw Error(tt(299));var t=!1,r="",i=YL;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=w1(n,1,!1,null,null,t,!1,r,i),n[Ta]=e.current,Sp(n.nodeType===8?n.parentNode:n),new T1(e)};Ds.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(tt(188)):(n=Object.keys(n).join(","),Error(tt(268,n)));return n=vN(e),n=n===null?null:n.stateNode,n};Ds.flushSync=function(n){return hc(n)};Ds.hydrate=function(n,e,t){if(!Hy(e))throw Error(tt(200));return Gy(null,n,e,!0,t)};Ds.hydrateRoot=function(n,e,t){if(!M1(n))throw Error(tt(405));var r=t!=null&&t.hydratedSources||null,i=!1,s="",o=YL;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=$L(e,null,n,1,t??null,i,!1,s,o),n[Ta]=e.current,Sp(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new zy(e)};Ds.render=function(n,e,t){if(!Hy(e))throw Error(tt(200));return Gy(null,n,e,!1,t)};Ds.unmountComponentAtNode=function(n){if(!Hy(n))throw Error(tt(40));return n._reactRootContainer?(hc(function(){Gy(null,null,n,!1,function(){n._reactRootContainer=null,n[Ta]=null})}),!0):!1};Ds.unstable_batchedUpdates=_1;Ds.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!Hy(t))throw Error(tt(200));if(n==null||n._reactInternals===void 0)throw Error(tt(38));return Gy(n,e,t,!1,r)};Ds.version="18.3.1-next-f1338f8080-20240426";function KL(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(KL)}catch(n){console.error(n)}}KL(),K2.exports=Ds;var xB=K2.exports,QL,nb=xB;QL=nb.createRoot,nb.hydrateRoot;const EB=()=>{};var rb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZL=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},wB=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],o=n[t++],a=n[t++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},JL={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],o=i+1<n.length,a=o?n[i+1]:0,l=i+2<n.length,u=l?n[i+2]:0,d=s>>2,f=(s&3)<<4|a>>4;let p=(a&15)<<2|u>>6,g=u&63;l||(g=64,o||(p=64)),r.push(t[d],t[f],t[p],t[g])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(ZL(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):wB(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;const u=i<n.length?t[n.charAt(i)]:64;++i;const f=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||u==null||f==null)throw new SB;const p=s<<2|a>>4;if(r.push(p),u!==64){const g=a<<4&240|u>>2;if(r.push(g),f!==64){const y=u<<6&192|f;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class SB extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const TB=function(n){const e=ZL(n);return JL.encodeByteArray(e,!0)},J_=function(n){return TB(n).replace(/\./g,"")},eD=function(n){try{return JL.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MB(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AB=()=>MB().__FIREBASE_DEFAULTS__,CB=()=>{if(typeof process>"u"||typeof rb>"u")return;const n=rb.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},IB=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&eD(n[1]);return e&&JSON.parse(e)},Wy=()=>{try{return EB()||AB()||CB()||IB()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},tD=n=>{var e,t;return(t=(e=Wy())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},bB=n=>{const e=tD(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},nD=()=>{var n;return(n=Wy())===null||n===void 0?void 0:n.config},rD=n=>{var e;return(e=Wy())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RB{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rd(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function iD(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PB(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[J_(JSON.stringify(t)),J_(JSON.stringify(o)),""].join(".")}const tp={};function NB(){const n={prod:[],emulator:[]};for(const e of Object.keys(tp))tp[e]?n.emulator.push(e):n.prod.push(e);return n}function LB(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let ib=!1;function sD(n,e){if(typeof window>"u"||typeof document>"u"||!Rd(window.location.host)||tp[n]===e||tp[n]||ib)return;tp[n]=e;function t(p){return`__firebase__banner__${p}`}const r="__firebase__banner",s=NB().prod.length>0;function o(){const p=document.getElementById(r);p&&p.remove()}function a(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function l(p,g){p.setAttribute("width","24"),p.setAttribute("id",g),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function u(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{ib=!0,o()},p}function d(p,g){p.setAttribute("id",g),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function f(){const p=LB(r),g=t("text"),y=document.getElementById(g)||document.createElement("span"),S=t("learnmore"),x=document.getElementById(S)||document.createElement("a"),v=t("preprendIcon"),w=document.getElementById(v)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const T=p.element;a(T),d(x,S);const R=u();l(w,v),T.append(w,y,x,R),document.body.appendChild(T)}s?(y.innerText="Preview backend disconnected.",w.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(w.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function DB(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Pi())}function kB(){var n;const e=(n=Wy())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function OB(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function UB(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function FB(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function VB(){const n=Pi();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function BB(){return!kB()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function zB(){try{return typeof indexedDB=="object"}catch{return!1}}function HB(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GB="FirebaseError";class ka extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=GB,Object.setPrototypeOf(this,ka.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vm.prototype.create)}}class vm{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?WB(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new ka(i,a,r)}}function WB(n,e){return n.replace(jB,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const jB=/\{\$([^}]+)}/g;function qB(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function dc(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],o=e[i];if(sb(s)&&sb(o)){if(!dc(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function sb(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _m(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ff(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Vf(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function XB(n,e){const t=new $B(n,e);return t.subscribe.bind(t)}class $B{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");YB(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=lE),i.error===void 0&&(i.error=lE),i.complete===void 0&&(i.complete=lE);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function YB(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function lE(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fr(n){return n&&n._delegate?n._delegate:n}class fc{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ku="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let KB=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new RB;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ZB(e))try{this.getOrInitializeService({instanceIdentifier:ku})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=ku){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ku){return this.instances.has(e)}getOptions(e=ku){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:QB(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ku){return this.component?this.component.multipleInstances?e:ku:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function QB(n){return n===ku?void 0:n}function ZB(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JB{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new KB(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wn;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(wn||(wn={}));const ez={debug:wn.DEBUG,verbose:wn.VERBOSE,info:wn.INFO,warn:wn.WARN,error:wn.ERROR,silent:wn.SILENT},tz=wn.INFO,nz={[wn.DEBUG]:"log",[wn.VERBOSE]:"log",[wn.INFO]:"info",[wn.WARN]:"warn",[wn.ERROR]:"error"},rz=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=nz[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class A1{constructor(e){this.name=e,this._logLevel=tz,this._logHandler=rz,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in wn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ez[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,wn.DEBUG,...e),this._logHandler(this,wn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,wn.VERBOSE,...e),this._logHandler(this,wn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,wn.INFO,...e),this._logHandler(this,wn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,wn.WARN,...e),this._logHandler(this,wn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,wn.ERROR,...e),this._logHandler(this,wn.ERROR,...e)}}const iz=(n,e)=>e.some(t=>n instanceof t);let ob,ab;function sz(){return ob||(ob=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function oz(){return ab||(ab=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const oD=new WeakMap,cS=new WeakMap,aD=new WeakMap,uE=new WeakMap,C1=new WeakMap;function az(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Il(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&oD.set(t,n)}).catch(()=>{}),C1.set(e,n),e}function lz(n){if(cS.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});cS.set(n,e)}let hS={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return cS.get(n);if(e==="objectStoreNames")return n.objectStoreNames||aD.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Il(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function uz(n){hS=n(hS)}function cz(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(cE(this),e,...t);return aD.set(r,e.sort?e.sort():[e]),Il(r)}:oz().includes(n)?function(...e){return n.apply(cE(this),e),Il(oD.get(this))}:function(...e){return Il(n.apply(cE(this),e))}}function hz(n){return typeof n=="function"?cz(n):(n instanceof IDBTransaction&&lz(n),iz(n,sz())?new Proxy(n,hS):n)}function Il(n){if(n instanceof IDBRequest)return az(n);if(uE.has(n))return uE.get(n);const e=hz(n);return e!==n&&(uE.set(n,e),C1.set(e,n)),e}const cE=n=>C1.get(n);function dz(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,e),a=Il(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Il(o.result),l.oldVersion,l.newVersion,Il(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const fz=["get","getKey","getAll","getAllKeys","count"],pz=["put","add","delete","clear"],hE=new Map;function lb(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(hE.get(e))return hE.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=pz.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||fz.includes(t)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[t](...a),i&&l.done]))[0]};return hE.set(e,s),s}uz(n=>({...n,get:(e,t,r)=>lb(e,t)||n.get(e,t,r),has:(e,t)=>!!lb(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mz{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(gz(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function gz(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const dS="@firebase/app",ub="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ca=new A1("@firebase/app"),vz="@firebase/app-compat",_z="@firebase/analytics-compat",yz="@firebase/analytics",xz="@firebase/app-check-compat",Ez="@firebase/app-check",wz="@firebase/auth",Sz="@firebase/auth-compat",Tz="@firebase/database",Mz="@firebase/data-connect",Az="@firebase/database-compat",Cz="@firebase/functions",Iz="@firebase/functions-compat",bz="@firebase/installations",Rz="@firebase/installations-compat",Pz="@firebase/messaging",Nz="@firebase/messaging-compat",Lz="@firebase/performance",Dz="@firebase/performance-compat",kz="@firebase/remote-config",Oz="@firebase/remote-config-compat",Uz="@firebase/storage",Fz="@firebase/storage-compat",Vz="@firebase/firestore",Bz="@firebase/ai",zz="@firebase/firestore-compat",Hz="firebase",Gz="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fS="[DEFAULT]",Wz={[dS]:"fire-core",[vz]:"fire-core-compat",[yz]:"fire-analytics",[_z]:"fire-analytics-compat",[Ez]:"fire-app-check",[xz]:"fire-app-check-compat",[wz]:"fire-auth",[Sz]:"fire-auth-compat",[Tz]:"fire-rtdb",[Mz]:"fire-data-connect",[Az]:"fire-rtdb-compat",[Cz]:"fire-fn",[Iz]:"fire-fn-compat",[bz]:"fire-iid",[Rz]:"fire-iid-compat",[Pz]:"fire-fcm",[Nz]:"fire-fcm-compat",[Lz]:"fire-perf",[Dz]:"fire-perf-compat",[kz]:"fire-rc",[Oz]:"fire-rc-compat",[Uz]:"fire-gcs",[Fz]:"fire-gcs-compat",[Vz]:"fire-fst",[zz]:"fire-fst-compat",[Bz]:"fire-vertex","fire-js":"fire-js",[Hz]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ey=new Map,jz=new Map,pS=new Map;function cb(n,e){try{n.container.addComponent(e)}catch(t){Ca.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function pd(n){const e=n.name;if(pS.has(e))return Ca.debug(`There were multiple attempts to register component ${e}.`),!1;pS.set(e,n);for(const t of ey.values())cb(t,n);for(const t of jz.values())cb(t,n);return!0}function I1(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Es(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qz={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},bl=new vm("app","Firebase",qz);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xz{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new fc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bl.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pd=Gz;function lD(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:fS,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw bl.create("bad-app-name",{appName:String(i)});if(t||(t=nD()),!t)throw bl.create("no-options");const s=ey.get(i);if(s){if(dc(t,s.options)&&dc(r,s.config))return s;throw bl.create("duplicate-app",{appName:i})}const o=new JB(i);for(const l of pS.values())o.addComponent(l);const a=new Xz(t,r,o);return ey.set(i,a),a}function uD(n=fS){const e=ey.get(n);if(!e&&n===fS&&nD())return lD();if(!e)throw bl.create("no-app",{appName:n});return e}function Rl(n,e,t){var r;let i=(r=Wz[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ca.warn(a.join(" "));return}pd(new fc(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $z="firebase-heartbeat-database",Yz=1,Np="firebase-heartbeat-store";let dE=null;function cD(){return dE||(dE=dz($z,Yz,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Np)}catch(t){console.warn(t)}}}}).catch(n=>{throw bl.create("idb-open",{originalErrorMessage:n.message})})),dE}async function Kz(n){try{const t=(await cD()).transaction(Np),r=await t.objectStore(Np).get(hD(n));return await t.done,r}catch(e){if(e instanceof ka)Ca.warn(e.message);else{const t=bl.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ca.warn(t.message)}}}async function hb(n,e){try{const r=(await cD()).transaction(Np,"readwrite");await r.objectStore(Np).put(e,hD(n)),await r.done}catch(t){if(t instanceof ka)Ca.warn(t.message);else{const r=bl.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ca.warn(r.message)}}}function hD(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qz=1024,Zz=30;class Jz{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new t5(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=db();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>Zz){const o=n5(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Ca.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=db(),{heartbeatsToSend:r,unsentEntries:i}=e5(this._heartbeatsCache.heartbeats),s=J_(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Ca.warn(t),""}}}function db(){return new Date().toISOString().substring(0,10)}function e5(n,e=Qz){const t=[];let r=n.slice();for(const i of n){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),fb(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),fb(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class t5{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return zB()?HB().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Kz(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return hb(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return hb(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function fb(n){return J_(JSON.stringify({version:2,heartbeats:n})).length}function n5(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r5(n){pd(new fc("platform-logger",e=>new mz(e),"PRIVATE")),pd(new fc("heartbeat",e=>new Jz(e),"PRIVATE")),Rl(dS,ub,n),Rl(dS,ub,"esm2017"),Rl("fire-js","")}r5("");function b1(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function dD(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const i5=dD,fD=new vm("auth","Firebase",dD());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ty=new A1("@firebase/auth");function s5(n,...e){ty.logLevel<=wn.WARN&&ty.warn(`Auth (${Pd}): ${n}`,...e)}function h_(n,...e){ty.logLevel<=wn.ERROR&&ty.error(`Auth (${Pd}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Js(n,...e){throw P1(n,...e)}function Fo(n,...e){return P1(n,...e)}function R1(n,e,t){const r=Object.assign(Object.assign({},i5()),{[e]:t});return new vm("auth","Firebase",r).create(e,{appName:n.name})}function Vo(n){return R1(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function o5(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Js(n,"argument-error"),R1(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function P1(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return fD.create(n,...e)}function Qt(n,e,...t){if(!n)throw P1(e,...t)}function _a(n){const e="INTERNAL ASSERTION FAILED: "+n;throw h_(e),new Error(e)}function Ia(n,e){n||_a(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mS(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function a5(){return pb()==="http:"||pb()==="https:"}function pb(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l5(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(a5()||UB()||"connection"in navigator)?navigator.onLine:!0}function u5(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ym{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ia(t>e,"Short delay should be less than long delay!"),this.isMobile=DB()||FB()}get(){return l5()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N1(n,e){Ia(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;_a("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;_a("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;_a("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c5={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h5=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],d5=new ym(3e4,6e4);function Oa(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Ua(n,e,t,r,i={}){return mD(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=_m(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const u=Object.assign({method:e,headers:l},s);return OB()||(u.referrerPolicy="no-referrer"),n.emulatorConfig&&Rd(n.emulatorConfig.host)&&(u.credentials="include"),pD.fetch()(await gD(n,n.config.apiHost,t,a),u)})}async function mD(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},c5),e);try{const i=new p5(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Xg(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xg(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Xg(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw Xg(n,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw R1(n,d,u);Js(n,d)}}catch(i){if(i instanceof ka)throw i;Js(n,"network-request-failed",{message:String(i)})}}async function xm(n,e,t,r,i={}){const s=await Ua(n,e,t,r,i);return"mfaPendingCredential"in s&&Js(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function gD(n,e,t,r){const i=`${e}${t}?${r}`,s=n,o=s.config.emulator?N1(n.config,i):`${n.config.apiScheme}://${i}`;return h5.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function f5(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class p5{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Fo(this.auth,"network-request-failed")),d5.get())})}}function Xg(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=Fo(n,e,r);return i.customData._tokenResponse=t,i}function mb(n){return n!==void 0&&n.enterprise!==void 0}class m5{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return f5(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function g5(n,e){return Ua(n,"GET","/v2/recaptchaConfig",Oa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v5(n,e){return Ua(n,"POST","/v1/accounts:delete",e)}async function ny(n,e){return Ua(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function np(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function _5(n,e=!1){const t=Fr(n),r=await t.getIdToken(e),i=L1(r);Qt(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:np(fE(i.auth_time)),issuedAtTime:np(fE(i.iat)),expirationTime:np(fE(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function fE(n){return Number(n)*1e3}function L1(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return h_("JWT malformed, contained fewer than 3 sections"),null;try{const i=eD(t);return i?JSON.parse(i):(h_("Failed to decode base64 JWT payload"),null)}catch(i){return h_("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function gb(n){const e=L1(n);return Qt(e,"internal-error"),Qt(typeof e.exp<"u","internal-error"),Qt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lp(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof ka&&y5(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function y5({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x5{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gS{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=np(this.lastLoginAt),this.creationTime=np(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ry(n){var e;const t=n.auth,r=await n.getIdToken(),i=await Lp(n,ny(t,{idToken:r}));Qt(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?vD(s.providerUserInfo):[],a=w5(n.providerData,o),l=n.isAnonymous,u=!(n.email&&s.passwordHash)&&!(a!=null&&a.length),d=l?u:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new gS(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(n,f)}async function E5(n){const e=Fr(n);await ry(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function w5(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function vD(n){return n.map(e=>{var{providerId:t}=e,r=b1(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S5(n,e){const t=await mD(n,{},async()=>{const r=_m({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=await gD(n,i,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return n.emulatorConfig&&Rd(n.emulatorConfig.host)&&(l.credentials="include"),pD.fetch()(o,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function T5(n,e){return Ua(n,"POST","/v2/accounts:revokeToken",Oa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Qt(e.idToken,"internal-error"),Qt(typeof e.idToken<"u","internal-error"),Qt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):gb(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Qt(e.length!==0,"internal-error");const t=gb(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Qt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await S5(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new td;return r&&(Qt(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Qt(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(Qt(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new td,this.toJSON())}_performRefresh(){return _a("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qa(n,e){Qt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class go{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=b1(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new x5(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new gS(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Lp(this,this.stsTokenManager.getToken(this.auth,e));return Qt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return _5(this,e)}reload(){return E5(this)}_assign(e){this!==e&&(Qt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new go(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Qt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await ry(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Es(this.auth.app))return Promise.reject(Vo(this.auth));const e=await this.getIdToken();return await Lp(this,v5(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,l,u,d;const f=(r=t.displayName)!==null&&r!==void 0?r:void 0,p=(i=t.email)!==null&&i!==void 0?i:void 0,g=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,y=(o=t.photoURL)!==null&&o!==void 0?o:void 0,S=(a=t.tenantId)!==null&&a!==void 0?a:void 0,x=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,v=(u=t.createdAt)!==null&&u!==void 0?u:void 0,w=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:T,emailVerified:R,isAnonymous:U,providerData:N,stsTokenManager:P}=t;Qt(T&&P,e,"internal-error");const b=td.fromJSON(this.name,P);Qt(typeof T=="string",e,"internal-error"),Qa(f,e.name),Qa(p,e.name),Qt(typeof R=="boolean",e,"internal-error"),Qt(typeof U=="boolean",e,"internal-error"),Qa(g,e.name),Qa(y,e.name),Qa(S,e.name),Qa(x,e.name),Qa(v,e.name),Qa(w,e.name);const M=new go({uid:T,auth:e,email:p,emailVerified:R,displayName:f,isAnonymous:U,photoURL:y,phoneNumber:g,tenantId:S,stsTokenManager:b,createdAt:v,lastLoginAt:w});return N&&Array.isArray(N)&&(M.providerData=N.map(A=>Object.assign({},A))),x&&(M._redirectEventId=x),M}static async _fromIdTokenResponse(e,t,r=!1){const i=new td;i.updateFromServerResponse(t);const s=new go({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await ry(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Qt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?vD(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new td;a.updateFromIdToken(r);const l=new go({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new gS(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vb=new Map;function ya(n){Ia(n instanceof Function,"Expected a class definition");let e=vb.get(n);return e?(Ia(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,vb.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}_D.type="NONE";const _b=_D;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d_(n,e,t){return`firebase:${n}:${e}:${t}`}class nd{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=d_(this.userKey,i.apiKey,s),this.fullPersistenceKey=d_("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await ny(this.auth,{idToken:e}).catch(()=>{});return t?go._fromGetAccountInfoResponse(this.auth,t,e):null}return go._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new nd(ya(_b),e,r);const i=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||ya(_b);const o=d_(r,e.config.apiKey,e.name);let a=null;for(const u of t)try{const d=await u._get(o);if(d){let f;if(typeof d=="string"){const p=await ny(e,{idToken:d}).catch(()=>{});if(!p)break;f=await go._fromGetAccountInfoResponse(e,p,d)}else f=go._fromJSON(e,d);u!==s&&(a=f),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new nd(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new nd(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yb(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(wD(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(yD(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(TD(e))return"Blackberry";if(MD(e))return"Webos";if(xD(e))return"Safari";if((e.includes("chrome/")||ED(e))&&!e.includes("edge/"))return"Chrome";if(SD(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function yD(n=Pi()){return/firefox\//i.test(n)}function xD(n=Pi()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ED(n=Pi()){return/crios\//i.test(n)}function wD(n=Pi()){return/iemobile/i.test(n)}function SD(n=Pi()){return/android/i.test(n)}function TD(n=Pi()){return/blackberry/i.test(n)}function MD(n=Pi()){return/webos/i.test(n)}function D1(n=Pi()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function M5(n=Pi()){var e;return D1(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function A5(){return VB()&&document.documentMode===10}function AD(n=Pi()){return D1(n)||SD(n)||MD(n)||TD(n)||/windows phone/i.test(n)||wD(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CD(n,e=[]){let t;switch(n){case"Browser":t=yb(Pi());break;case"Worker":t=`${yb(Pi())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Pd}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C5{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I5(n,e={}){return Ua(n,"GET","/v2/passwordPolicy",Oa(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b5=6;class R5{constructor(e){var t,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:b5,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P5{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new xb(this),this.idTokenSubscription=new xb(this),this.beforeStateQueue=new C5(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=fD,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ya(t)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await nd.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await ny(this,{idToken:e}),r=await go._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Es(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Qt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ry(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=u5()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Es(this.app))return Promise.reject(Vo(this));const t=e?Fr(e):null;return t&&Qt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Qt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Es(this.app)?Promise.reject(Vo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Es(this.app)?Promise.reject(Vo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ya(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await I5(this),t=new R5(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new vm("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await T5(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ya(e)||this._popupRedirectResolver;Qt(t,this,"argument-error"),this.redirectPersistenceManager=await nd.create(this,[ya(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Qt(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Qt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=CD(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;if(Es(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&s5(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Fa(n){return Fr(n)}class xb{constructor(e){this.auth=e,this.observer=null,this.addObserver=XB(t=>this.observer=t)}get next(){return Qt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jy={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function N5(n){jy=n}function ID(n){return jy.loadJS(n)}function L5(){return jy.recaptchaEnterpriseScript}function D5(){return jy.gapiScript}function k5(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class O5{constructor(){this.enterprise=new U5}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class U5{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const F5="recaptcha-enterprise",bD="NO_RECAPTCHA";class V5{constructor(e){this.type=F5,this.auth=Fa(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{g5(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new m5(l);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(l=>{a(l)})})}function i(s,o,a){const l=window.grecaptcha;mb(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(bD)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new O5().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&mb(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=L5();l.length!==0&&(l+=a),ID(l).then(()=>{i(a,s,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})}}async function Eb(n,e,t,r=!1,i=!1){const s=new V5(n);let o;if(i)o=bD;else try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}const a=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,u=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function iy(n,e,t,r,i){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await Eb(n,e,t,t==="getOobCode");return r(n,o)}else return r(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Eb(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B5(n,e){const t=I1(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(dc(s,e??{}))return i;Js(i,"already-initialized")}return t.initialize({options:e})}function z5(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(ya);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function H5(n,e,t){const r=Fa(n);Qt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=RD(e),{host:o,port:a}=G5(e),l=a===null?"":`:${a}`,u={url:`${s}//${o}${l}/`},d=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Qt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Qt(dc(u,r.config.emulator)&&dc(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,Rd(o)?(iD(`${s}//${o}${l}`),sD("Auth",!0)):W5()}function RD(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function G5(n){const e=RD(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:wb(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:wb(o)}}}function wb(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function W5(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return _a("not implemented")}_getIdTokenResponse(e){return _a("not implemented")}_linkToIdToken(e,t){return _a("not implemented")}_getReauthenticationResolver(e){return _a("not implemented")}}async function j5(n,e){return Ua(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q5(n,e){return xm(n,"POST","/v1/accounts:signInWithPassword",Oa(n,e))}async function X5(n,e){return Ua(n,"POST","/v1/accounts:sendOobCode",Oa(n,e))}async function $5(n,e){return X5(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y5(n,e){return xm(n,"POST","/v1/accounts:signInWithEmailLink",Oa(n,e))}async function K5(n,e){return xm(n,"POST","/v1/accounts:signInWithEmailLink",Oa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp extends k1{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Dp(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Dp(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return iy(e,t,"signInWithPassword",q5);case"emailLink":return Y5(e,{email:this._email,oobCode:this._password});default:Js(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return iy(e,r,"signUpPassword",j5);case"emailLink":return K5(e,{idToken:t,email:this._email,oobCode:this._password});default:Js(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rd(n,e){return xm(n,"POST","/v1/accounts:signInWithIdp",Oa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q5="http://localhost";class pc extends k1{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new pc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Js("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=b1(t,["providerId","signInMethod"]);if(!r||!i)return null;const o=new pc(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return rd(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,rd(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,rd(e,t)}buildRequest(){const e={requestUri:Q5,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=_m(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z5(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function J5(n){const e=Ff(Vf(n)).link,t=e?Ff(Vf(e)).deep_link_id:null,r=Ff(Vf(n)).deep_link_id;return(r?Ff(Vf(r)).link:null)||r||t||e||n}class O1{constructor(e){var t,r,i,s,o,a;const l=Ff(Vf(e)),u=(t=l.apiKey)!==null&&t!==void 0?t:null,d=(r=l.oobCode)!==null&&r!==void 0?r:null,f=Z5((i=l.mode)!==null&&i!==void 0?i:null);Qt(u&&d&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=d,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.lang)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=J5(e);try{return new O1(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(){this.providerId=Nd.PROVIDER_ID}static credential(e,t){return Dp._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=O1.parseLink(t);return Qt(r,"argument-error"),Dp._fromEmailAndCode(e,r.code,r.tenantId)}}Nd.PROVIDER_ID="password";Nd.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Nd.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Em extends U1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl extends Em{constructor(){super("facebook.com")}static credential(e){return pc._fromParams({providerId:dl.PROVIDER_ID,signInMethod:dl.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return dl.credentialFromTaggedObject(e)}static credentialFromError(e){return dl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return dl.credential(e.oauthAccessToken)}catch{return null}}}dl.FACEBOOK_SIGN_IN_METHOD="facebook.com";dl.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa extends Em{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return pc._fromParams({providerId:pa.PROVIDER_ID,signInMethod:pa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return pa.credentialFromTaggedObject(e)}static credentialFromError(e){return pa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return pa.credential(t,r)}catch{return null}}}pa.GOOGLE_SIGN_IN_METHOD="google.com";pa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl extends Em{constructor(){super("github.com")}static credential(e){return pc._fromParams({providerId:fl.PROVIDER_ID,signInMethod:fl.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return fl.credentialFromTaggedObject(e)}static credentialFromError(e){return fl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return fl.credential(e.oauthAccessToken)}catch{return null}}}fl.GITHUB_SIGN_IN_METHOD="github.com";fl.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl extends Em{constructor(){super("twitter.com")}static credential(e,t){return pc._fromParams({providerId:pl.PROVIDER_ID,signInMethod:pl.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return pl.credentialFromTaggedObject(e)}static credentialFromError(e){return pl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return pl.credential(t,r)}catch{return null}}}pl.TWITTER_SIGN_IN_METHOD="twitter.com";pl.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e6(n,e){return xm(n,"POST","/v1/accounts:signUp",Oa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await go._fromIdTokenResponse(e,r,i),o=Sb(r);return new mc({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=Sb(r);return new mc({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function Sb(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy extends ka{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,sy.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new sy(e,t,r,i)}}function PD(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?sy._fromErrorAndOperation(n,s,e,r):s})}async function t6(n,e,t=!1){const r=await Lp(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return mc._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n6(n,e,t=!1){const{auth:r}=n;if(Es(r.app))return Promise.reject(Vo(r));const i="reauthenticate";try{const s=await Lp(n,PD(r,i,e,n),t);Qt(s.idToken,r,"internal-error");const o=L1(s.idToken);Qt(o,r,"internal-error");const{sub:a}=o;return Qt(n.uid===a,r,"user-mismatch"),mc._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Js(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ND(n,e,t=!1){if(Es(n.app))return Promise.reject(Vo(n));const r="signIn",i=await PD(n,r,e),s=await mc._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function r6(n,e){return ND(Fa(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LD(n){const e=Fa(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function i6(n,e,t){const r=Fa(n);await iy(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",$5)}async function s6(n,e,t){if(Es(n.app))return Promise.reject(Vo(n));const r=Fa(n),o=await iy(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",e6).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&LD(n),l}),a=await mc._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function o6(n,e,t){return Es(n.app)?Promise.reject(Vo(n)):r6(Fr(n),Nd.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&LD(n),r})}function a6(n,e,t,r){return Fr(n).onIdTokenChanged(e,t,r)}function l6(n,e,t){return Fr(n).beforeAuthStateChanged(e,t)}function u6(n,e,t,r){return Fr(n).onAuthStateChanged(e,t,r)}function c6(n){return Fr(n).signOut()}const oy="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DD{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(oy,"1"),this.storage.removeItem(oy),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h6=1e3,d6=10;class kD extends DD{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=AD(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);A5()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,d6):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},h6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}kD.type="LOCAL";const f6=kD;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD extends DD{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}OD.type="SESSION";const UD=OD;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p6(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qy{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new qy(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(t.origin,s)),l=await p6(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}qy.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F1(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m6{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=F1("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(f){const p=f;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(p.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bo(){return window}function g6(n){Bo().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FD(){return typeof Bo().WorkerGlobalScope<"u"&&typeof Bo().importScripts=="function"}async function v6(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _6(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function y6(){return FD()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD="firebaseLocalStorageDb",x6=1,ay="firebaseLocalStorage",BD="fbase_key";class wm{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Xy(n,e){return n.transaction([ay],e?"readwrite":"readonly").objectStore(ay)}function E6(){const n=indexedDB.deleteDatabase(VD);return new wm(n).toPromise()}function vS(){const n=indexedDB.open(VD,x6);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(ay,{keyPath:BD})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(ay)?e(r):(r.close(),await E6(),e(await vS()))})})}async function Tb(n,e,t){const r=Xy(n,!0).put({[BD]:e,value:t});return new wm(r).toPromise()}async function w6(n,e){const t=Xy(n,!1).get(e),r=await new wm(t).toPromise();return r===void 0?null:r.value}function Mb(n,e){const t=Xy(n,!0).delete(e);return new wm(t).toPromise()}const S6=800,T6=3;class zD{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await vS(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>T6)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return FD()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=qy._getInstance(y6()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await v6(),!this.activeServiceWorker)return;this.sender=new m6(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_6()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await vS();return await Tb(e,oy,"1"),await Mb(e,oy),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Tb(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>w6(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Mb(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Xy(i,!1).getAll();return new wm(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),S6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}zD.type="LOCAL";const M6=zD;new ym(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HD(n,e){return e?ya(e):(Qt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1 extends k1{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return rd(e,this._buildIdpRequest())}_linkToIdToken(e,t){return rd(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return rd(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function A6(n){return ND(n.auth,new V1(n),n.bypassAuthState)}function C6(n){const{auth:e,user:t}=n;return Qt(t,e,"internal-error"),n6(t,new V1(n),n.bypassAuthState)}async function I6(n){const{auth:e,user:t}=n;return Qt(t,e,"internal-error"),t6(t,new V1(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return A6;case"linkViaPopup":case"linkViaRedirect":return I6;case"reauthViaPopup":case"reauthViaRedirect":return C6;default:Js(this.auth,"internal-error")}}resolve(e){Ia(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ia(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b6=new ym(2e3,1e4);class Bh extends GD{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Bh.currentPopupAction&&Bh.currentPopupAction.cancel(),Bh.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Qt(e,this.auth,"internal-error"),e}async onExecution(){Ia(this.filter.length===1,"Popup operations only handle one event");const e=F1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Fo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Fo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Bh.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Fo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,b6.get())};e()}}Bh.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R6="pendingRedirect",f_=new Map;class P6 extends GD{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=f_.get(this.auth._key());if(!e){try{const r=await N6(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}f_.set(this.auth._key(),e)}return this.bypassAuthState||f_.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function N6(n,e){const t=jD(e),r=WD(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}async function L6(n,e){return WD(n)._set(jD(e),"true")}function D6(n,e){f_.set(n._key(),e)}function WD(n){return ya(n._redirectPersistence)}function jD(n){return d_(R6,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k6(n,e,t){return O6(n,e,t)}async function O6(n,e,t){if(Es(n.app))return Promise.reject(Vo(n));const r=Fa(n);o5(n,e,U1),await r._initializationPromise;const i=HD(r,t);return await L6(i,r),i._openRedirect(r,e,"signInViaRedirect")}async function U6(n,e,t=!1){if(Es(n.app))return Promise.reject(Vo(n));const r=Fa(n),i=HD(r,e),o=await new P6(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F6=10*60*1e3;class V6{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!B6(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!qD(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Fo(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=F6&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ab(e))}saveEventToCache(e){this.cachedEventUids.add(Ab(e)),this.lastProcessedEventTime=Date.now()}}function Ab(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function qD({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function B6(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return qD(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z6(n,e={}){return Ua(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H6=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,G6=/^https?/;async function W6(n){if(n.config.emulator)return;const{authorizedDomains:e}=await z6(n);for(const t of e)try{if(j6(t))return}catch{}Js(n,"unauthorized-domain")}function j6(n){const e=mS(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!G6.test(t))return!1;if(H6.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q6=new ym(3e4,6e4);function Cb(){const n=Bo().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function X6(n){return new Promise((e,t)=>{var r,i,s;function o(){Cb(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Cb(),t(Fo(n,"network-request-failed"))},timeout:q6.get()})}if(!((i=(r=Bo().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Bo().gapi)===null||s===void 0)&&s.load)o();else{const a=k5("iframefcb");return Bo()[a]=()=>{gapi.load?o():t(Fo(n,"network-request-failed"))},ID(`${D5()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw p_=null,e})}let p_=null;function $6(n){return p_=p_||X6(n),p_}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y6=new ym(5e3,15e3),K6="__/auth/iframe",Q6="emulator/auth/iframe",Z6={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},J6=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function eH(n){const e=n.config;Qt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?N1(e,Q6):`https://${n.config.authDomain}/${K6}`,r={apiKey:e.apiKey,appName:n.name,v:Pd},i=J6.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${_m(r).slice(1)}`}async function tH(n){const e=await $6(n),t=Bo().gapi;return Qt(t,n,"internal-error"),e.open({where:document.body,url:eH(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Z6,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Fo(n,"network-request-failed"),a=Bo().setTimeout(()=>{s(o)},Y6.get());function l(){Bo().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nH={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},rH=500,iH=600,sH="_blank",oH="http://localhost";class Ib{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function aH(n,e,t,r=rH,i=iH){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},nH),{width:r.toString(),height:i.toString(),top:s,left:o}),u=Pi().toLowerCase();t&&(a=ED(u)?sH:t),yD(u)&&(e=e||oH,l.scrollbars="yes");const d=Object.entries(l).reduce((p,[g,y])=>`${p}${g}=${y},`,"");if(M5(u)&&a!=="_self")return lH(e||"",a),new Ib(null);const f=window.open(e||"",a,d);Qt(f,n,"popup-blocked");try{f.focus()}catch{}return new Ib(f)}function lH(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uH="__/auth/handler",cH="emulator/auth/handler",hH=encodeURIComponent("fac");async function bb(n,e,t,r,i,s){Qt(n.config.authDomain,n,"auth-domain-config-required"),Qt(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Pd,eventId:i};if(e instanceof U1){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",qB(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))o[d]=f}if(e instanceof Em){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await n._getAppCheckToken(),u=l?`#${hH}=${encodeURIComponent(l)}`:"";return`${dH(n)}?${_m(a).slice(1)}${u}`}function dH({config:n}){return n.emulator?N1(n,cH):`https://${n.authDomain}/${uH}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pE="webStorageSupport";class fH{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=UD,this._completeRedirectFn=U6,this._overrideRedirectResult=D6}async _openPopup(e,t,r,i){var s;Ia((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await bb(e,t,r,mS(),i);return aH(e,o,F1())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await bb(e,t,r,mS(),i);return g6(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Ia(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await tH(e),r=new V6(e);return t.register("authEvent",i=>(Qt(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(pE,{type:pE},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[pE];o!==void 0&&t(!!o),Js(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=W6(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return AD()||xD()||D1()}}const pH=fH;var Rb="@firebase/auth",Pb="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mH{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Qt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gH(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function vH(n){pd(new fc("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Qt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:CD(n)},u=new P5(r,i,s,l);return z5(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),pd(new fc("auth-internal",e=>{const t=Fa(e.getProvider("auth").getImmediate());return(r=>new mH(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Rl(Rb,Pb,gH(n)),Rl(Rb,Pb,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _H=5*60,yH=rD("authIdTokenMaxAge")||_H;let Nb=null;const xH=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>yH)return;const i=t==null?void 0:t.token;Nb!==i&&(Nb=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function EH(n=uD()){const e=I1(n,"auth");if(e.isInitialized())return e.getImmediate();const t=B5(n,{popupRedirectResolver:pH,persistence:[M6,f6,UD]}),r=rD("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=xH(s.toString());l6(t,o,()=>o(t.currentUser)),a6(t,a=>o(a))}}const i=tD("auth");return i&&H5(t,`http://${i}`),t}function wH(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}N5({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=Fo("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",wH().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});vH("Browser");var Lb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Pl,XD;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(P,b){function M(){}M.prototype=b.prototype,P.D=b.prototype,P.prototype=new M,P.prototype.constructor=P,P.C=function(A,L,z){for(var B=Array(arguments.length-2),$=2;$<arguments.length;$++)B[$-2]=arguments[$];return b.prototype[L].apply(A,B)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(P,b,M){M||(M=0);var A=Array(16);if(typeof b=="string")for(var L=0;16>L;++L)A[L]=b.charCodeAt(M++)|b.charCodeAt(M++)<<8|b.charCodeAt(M++)<<16|b.charCodeAt(M++)<<24;else for(L=0;16>L;++L)A[L]=b[M++]|b[M++]<<8|b[M++]<<16|b[M++]<<24;b=P.g[0],M=P.g[1],L=P.g[2];var z=P.g[3],B=b+(z^M&(L^z))+A[0]+3614090360&4294967295;b=M+(B<<7&4294967295|B>>>25),B=z+(L^b&(M^L))+A[1]+3905402710&4294967295,z=b+(B<<12&4294967295|B>>>20),B=L+(M^z&(b^M))+A[2]+606105819&4294967295,L=z+(B<<17&4294967295|B>>>15),B=M+(b^L&(z^b))+A[3]+3250441966&4294967295,M=L+(B<<22&4294967295|B>>>10),B=b+(z^M&(L^z))+A[4]+4118548399&4294967295,b=M+(B<<7&4294967295|B>>>25),B=z+(L^b&(M^L))+A[5]+1200080426&4294967295,z=b+(B<<12&4294967295|B>>>20),B=L+(M^z&(b^M))+A[6]+2821735955&4294967295,L=z+(B<<17&4294967295|B>>>15),B=M+(b^L&(z^b))+A[7]+4249261313&4294967295,M=L+(B<<22&4294967295|B>>>10),B=b+(z^M&(L^z))+A[8]+1770035416&4294967295,b=M+(B<<7&4294967295|B>>>25),B=z+(L^b&(M^L))+A[9]+2336552879&4294967295,z=b+(B<<12&4294967295|B>>>20),B=L+(M^z&(b^M))+A[10]+4294925233&4294967295,L=z+(B<<17&4294967295|B>>>15),B=M+(b^L&(z^b))+A[11]+2304563134&4294967295,M=L+(B<<22&4294967295|B>>>10),B=b+(z^M&(L^z))+A[12]+1804603682&4294967295,b=M+(B<<7&4294967295|B>>>25),B=z+(L^b&(M^L))+A[13]+4254626195&4294967295,z=b+(B<<12&4294967295|B>>>20),B=L+(M^z&(b^M))+A[14]+2792965006&4294967295,L=z+(B<<17&4294967295|B>>>15),B=M+(b^L&(z^b))+A[15]+1236535329&4294967295,M=L+(B<<22&4294967295|B>>>10),B=b+(L^z&(M^L))+A[1]+4129170786&4294967295,b=M+(B<<5&4294967295|B>>>27),B=z+(M^L&(b^M))+A[6]+3225465664&4294967295,z=b+(B<<9&4294967295|B>>>23),B=L+(b^M&(z^b))+A[11]+643717713&4294967295,L=z+(B<<14&4294967295|B>>>18),B=M+(z^b&(L^z))+A[0]+3921069994&4294967295,M=L+(B<<20&4294967295|B>>>12),B=b+(L^z&(M^L))+A[5]+3593408605&4294967295,b=M+(B<<5&4294967295|B>>>27),B=z+(M^L&(b^M))+A[10]+38016083&4294967295,z=b+(B<<9&4294967295|B>>>23),B=L+(b^M&(z^b))+A[15]+3634488961&4294967295,L=z+(B<<14&4294967295|B>>>18),B=M+(z^b&(L^z))+A[4]+3889429448&4294967295,M=L+(B<<20&4294967295|B>>>12),B=b+(L^z&(M^L))+A[9]+568446438&4294967295,b=M+(B<<5&4294967295|B>>>27),B=z+(M^L&(b^M))+A[14]+3275163606&4294967295,z=b+(B<<9&4294967295|B>>>23),B=L+(b^M&(z^b))+A[3]+4107603335&4294967295,L=z+(B<<14&4294967295|B>>>18),B=M+(z^b&(L^z))+A[8]+1163531501&4294967295,M=L+(B<<20&4294967295|B>>>12),B=b+(L^z&(M^L))+A[13]+2850285829&4294967295,b=M+(B<<5&4294967295|B>>>27),B=z+(M^L&(b^M))+A[2]+4243563512&4294967295,z=b+(B<<9&4294967295|B>>>23),B=L+(b^M&(z^b))+A[7]+1735328473&4294967295,L=z+(B<<14&4294967295|B>>>18),B=M+(z^b&(L^z))+A[12]+2368359562&4294967295,M=L+(B<<20&4294967295|B>>>12),B=b+(M^L^z)+A[5]+4294588738&4294967295,b=M+(B<<4&4294967295|B>>>28),B=z+(b^M^L)+A[8]+2272392833&4294967295,z=b+(B<<11&4294967295|B>>>21),B=L+(z^b^M)+A[11]+1839030562&4294967295,L=z+(B<<16&4294967295|B>>>16),B=M+(L^z^b)+A[14]+4259657740&4294967295,M=L+(B<<23&4294967295|B>>>9),B=b+(M^L^z)+A[1]+2763975236&4294967295,b=M+(B<<4&4294967295|B>>>28),B=z+(b^M^L)+A[4]+1272893353&4294967295,z=b+(B<<11&4294967295|B>>>21),B=L+(z^b^M)+A[7]+4139469664&4294967295,L=z+(B<<16&4294967295|B>>>16),B=M+(L^z^b)+A[10]+3200236656&4294967295,M=L+(B<<23&4294967295|B>>>9),B=b+(M^L^z)+A[13]+681279174&4294967295,b=M+(B<<4&4294967295|B>>>28),B=z+(b^M^L)+A[0]+3936430074&4294967295,z=b+(B<<11&4294967295|B>>>21),B=L+(z^b^M)+A[3]+3572445317&4294967295,L=z+(B<<16&4294967295|B>>>16),B=M+(L^z^b)+A[6]+76029189&4294967295,M=L+(B<<23&4294967295|B>>>9),B=b+(M^L^z)+A[9]+3654602809&4294967295,b=M+(B<<4&4294967295|B>>>28),B=z+(b^M^L)+A[12]+3873151461&4294967295,z=b+(B<<11&4294967295|B>>>21),B=L+(z^b^M)+A[15]+530742520&4294967295,L=z+(B<<16&4294967295|B>>>16),B=M+(L^z^b)+A[2]+3299628645&4294967295,M=L+(B<<23&4294967295|B>>>9),B=b+(L^(M|~z))+A[0]+4096336452&4294967295,b=M+(B<<6&4294967295|B>>>26),B=z+(M^(b|~L))+A[7]+1126891415&4294967295,z=b+(B<<10&4294967295|B>>>22),B=L+(b^(z|~M))+A[14]+2878612391&4294967295,L=z+(B<<15&4294967295|B>>>17),B=M+(z^(L|~b))+A[5]+4237533241&4294967295,M=L+(B<<21&4294967295|B>>>11),B=b+(L^(M|~z))+A[12]+1700485571&4294967295,b=M+(B<<6&4294967295|B>>>26),B=z+(M^(b|~L))+A[3]+2399980690&4294967295,z=b+(B<<10&4294967295|B>>>22),B=L+(b^(z|~M))+A[10]+4293915773&4294967295,L=z+(B<<15&4294967295|B>>>17),B=M+(z^(L|~b))+A[1]+2240044497&4294967295,M=L+(B<<21&4294967295|B>>>11),B=b+(L^(M|~z))+A[8]+1873313359&4294967295,b=M+(B<<6&4294967295|B>>>26),B=z+(M^(b|~L))+A[15]+4264355552&4294967295,z=b+(B<<10&4294967295|B>>>22),B=L+(b^(z|~M))+A[6]+2734768916&4294967295,L=z+(B<<15&4294967295|B>>>17),B=M+(z^(L|~b))+A[13]+1309151649&4294967295,M=L+(B<<21&4294967295|B>>>11),B=b+(L^(M|~z))+A[4]+4149444226&4294967295,b=M+(B<<6&4294967295|B>>>26),B=z+(M^(b|~L))+A[11]+3174756917&4294967295,z=b+(B<<10&4294967295|B>>>22),B=L+(b^(z|~M))+A[2]+718787259&4294967295,L=z+(B<<15&4294967295|B>>>17),B=M+(z^(L|~b))+A[9]+3951481745&4294967295,P.g[0]=P.g[0]+b&4294967295,P.g[1]=P.g[1]+(L+(B<<21&4294967295|B>>>11))&4294967295,P.g[2]=P.g[2]+L&4294967295,P.g[3]=P.g[3]+z&4294967295}r.prototype.u=function(P,b){b===void 0&&(b=P.length);for(var M=b-this.blockSize,A=this.B,L=this.h,z=0;z<b;){if(L==0)for(;z<=M;)i(this,P,z),z+=this.blockSize;if(typeof P=="string"){for(;z<b;)if(A[L++]=P.charCodeAt(z++),L==this.blockSize){i(this,A),L=0;break}}else for(;z<b;)if(A[L++]=P[z++],L==this.blockSize){i(this,A),L=0;break}}this.h=L,this.o+=b},r.prototype.v=function(){var P=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);P[0]=128;for(var b=1;b<P.length-8;++b)P[b]=0;var M=8*this.o;for(b=P.length-8;b<P.length;++b)P[b]=M&255,M/=256;for(this.u(P),P=Array(16),b=M=0;4>b;++b)for(var A=0;32>A;A+=8)P[M++]=this.g[b]>>>A&255;return P};function s(P,b){var M=a;return Object.prototype.hasOwnProperty.call(M,P)?M[P]:M[P]=b(P)}function o(P,b){this.h=b;for(var M=[],A=!0,L=P.length-1;0<=L;L--){var z=P[L]|0;A&&z==b||(M[L]=z,A=!1)}this.g=M}var a={};function l(P){return-128<=P&&128>P?s(P,function(b){return new o([b|0],0>b?-1:0)}):new o([P|0],0>P?-1:0)}function u(P){if(isNaN(P)||!isFinite(P))return f;if(0>P)return x(u(-P));for(var b=[],M=1,A=0;P>=M;A++)b[A]=P/M|0,M*=4294967296;return new o(b,0)}function d(P,b){if(P.length==0)throw Error("number format error: empty string");if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(P.charAt(0)=="-")return x(d(P.substring(1),b));if(0<=P.indexOf("-"))throw Error('number format error: interior "-" character');for(var M=u(Math.pow(b,8)),A=f,L=0;L<P.length;L+=8){var z=Math.min(8,P.length-L),B=parseInt(P.substring(L,L+z),b);8>z?(z=u(Math.pow(b,z)),A=A.j(z).add(u(B))):(A=A.j(M),A=A.add(u(B)))}return A}var f=l(0),p=l(1),g=l(16777216);n=o.prototype,n.m=function(){if(S(this))return-x(this).m();for(var P=0,b=1,M=0;M<this.g.length;M++){var A=this.i(M);P+=(0<=A?A:4294967296+A)*b,b*=4294967296}return P},n.toString=function(P){if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(y(this))return"0";if(S(this))return"-"+x(this).toString(P);for(var b=u(Math.pow(P,6)),M=this,A="";;){var L=R(M,b).g;M=v(M,L.j(b));var z=((0<M.g.length?M.g[0]:M.h)>>>0).toString(P);if(M=L,y(M))return z+A;for(;6>z.length;)z="0"+z;A=z+A}},n.i=function(P){return 0>P?0:P<this.g.length?this.g[P]:this.h};function y(P){if(P.h!=0)return!1;for(var b=0;b<P.g.length;b++)if(P.g[b]!=0)return!1;return!0}function S(P){return P.h==-1}n.l=function(P){return P=v(this,P),S(P)?-1:y(P)?0:1};function x(P){for(var b=P.g.length,M=[],A=0;A<b;A++)M[A]=~P.g[A];return new o(M,~P.h).add(p)}n.abs=function(){return S(this)?x(this):this},n.add=function(P){for(var b=Math.max(this.g.length,P.g.length),M=[],A=0,L=0;L<=b;L++){var z=A+(this.i(L)&65535)+(P.i(L)&65535),B=(z>>>16)+(this.i(L)>>>16)+(P.i(L)>>>16);A=B>>>16,z&=65535,B&=65535,M[L]=B<<16|z}return new o(M,M[M.length-1]&-2147483648?-1:0)};function v(P,b){return P.add(x(b))}n.j=function(P){if(y(this)||y(P))return f;if(S(this))return S(P)?x(this).j(x(P)):x(x(this).j(P));if(S(P))return x(this.j(x(P)));if(0>this.l(g)&&0>P.l(g))return u(this.m()*P.m());for(var b=this.g.length+P.g.length,M=[],A=0;A<2*b;A++)M[A]=0;for(A=0;A<this.g.length;A++)for(var L=0;L<P.g.length;L++){var z=this.i(A)>>>16,B=this.i(A)&65535,$=P.i(L)>>>16,he=P.i(L)&65535;M[2*A+2*L]+=B*he,w(M,2*A+2*L),M[2*A+2*L+1]+=z*he,w(M,2*A+2*L+1),M[2*A+2*L+1]+=B*$,w(M,2*A+2*L+1),M[2*A+2*L+2]+=z*$,w(M,2*A+2*L+2)}for(A=0;A<b;A++)M[A]=M[2*A+1]<<16|M[2*A];for(A=b;A<2*b;A++)M[A]=0;return new o(M,0)};function w(P,b){for(;(P[b]&65535)!=P[b];)P[b+1]+=P[b]>>>16,P[b]&=65535,b++}function T(P,b){this.g=P,this.h=b}function R(P,b){if(y(b))throw Error("division by zero");if(y(P))return new T(f,f);if(S(P))return b=R(x(P),b),new T(x(b.g),x(b.h));if(S(b))return b=R(P,x(b)),new T(x(b.g),b.h);if(30<P.g.length){if(S(P)||S(b))throw Error("slowDivide_ only works with positive integers.");for(var M=p,A=b;0>=A.l(P);)M=U(M),A=U(A);var L=N(M,1),z=N(A,1);for(A=N(A,2),M=N(M,2);!y(A);){var B=z.add(A);0>=B.l(P)&&(L=L.add(M),z=B),A=N(A,1),M=N(M,1)}return b=v(P,L.j(b)),new T(L,b)}for(L=f;0<=P.l(b);){for(M=Math.max(1,Math.floor(P.m()/b.m())),A=Math.ceil(Math.log(M)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),z=u(M),B=z.j(b);S(B)||0<B.l(P);)M-=A,z=u(M),B=z.j(b);y(z)&&(z=p),L=L.add(z),P=v(P,B)}return new T(L,P)}n.A=function(P){return R(this,P).h},n.and=function(P){for(var b=Math.max(this.g.length,P.g.length),M=[],A=0;A<b;A++)M[A]=this.i(A)&P.i(A);return new o(M,this.h&P.h)},n.or=function(P){for(var b=Math.max(this.g.length,P.g.length),M=[],A=0;A<b;A++)M[A]=this.i(A)|P.i(A);return new o(M,this.h|P.h)},n.xor=function(P){for(var b=Math.max(this.g.length,P.g.length),M=[],A=0;A<b;A++)M[A]=this.i(A)^P.i(A);return new o(M,this.h^P.h)};function U(P){for(var b=P.g.length+1,M=[],A=0;A<b;A++)M[A]=P.i(A)<<1|P.i(A-1)>>>31;return new o(M,P.h)}function N(P,b){var M=b>>5;b%=32;for(var A=P.g.length-M,L=[],z=0;z<A;z++)L[z]=0<b?P.i(z+M)>>>b|P.i(z+M+1)<<32-b:P.i(z+M);return new o(L,P.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,XD=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,Pl=o}).apply(typeof Lb<"u"?Lb:typeof self<"u"?self:typeof window<"u"?window:{});var $g=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $D,Bf,YD,m_,_S,KD,QD,ZD;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(m,I,D){return m==Array.prototype||m==Object.prototype||(m[I]=D.value),m};function t(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof $g=="object"&&$g];for(var I=0;I<m.length;++I){var D=m[I];if(D&&D.Math==Math)return D}throw Error("Cannot find global object")}var r=t(this);function i(m,I){if(I)e:{var D=r;m=m.split(".");for(var j=0;j<m.length-1;j++){var ve=m[j];if(!(ve in D))break e;D=D[ve]}m=m[m.length-1],j=D[m],I=I(j),I!=j&&I!=null&&e(D,m,{configurable:!0,writable:!0,value:I})}}function s(m,I){m instanceof String&&(m+="");var D=0,j=!1,ve={next:function(){if(!j&&D<m.length){var Te=D++;return{value:I(Te,m[Te]),done:!1}}return j=!0,{done:!0,value:void 0}}};return ve[Symbol.iterator]=function(){return ve},ve}i("Array.prototype.values",function(m){return m||function(){return s(this,function(I,D){return D})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(m){var I=typeof m;return I=I!="object"?I:m?Array.isArray(m)?"array":I:"null",I=="array"||I=="object"&&typeof m.length=="number"}function u(m){var I=typeof m;return I=="object"&&m!=null||I=="function"}function d(m,I,D){return m.call.apply(m.bind,arguments)}function f(m,I,D){if(!m)throw Error();if(2<arguments.length){var j=Array.prototype.slice.call(arguments,2);return function(){var ve=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ve,j),m.apply(I,ve)}}return function(){return m.apply(I,arguments)}}function p(m,I,D){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,p.apply(null,arguments)}function g(m,I){var D=Array.prototype.slice.call(arguments,1);return function(){var j=D.slice();return j.push.apply(j,arguments),m.apply(this,j)}}function y(m,I){function D(){}D.prototype=I.prototype,m.aa=I.prototype,m.prototype=new D,m.prototype.constructor=m,m.Qb=function(j,ve,Te){for(var nt=Array(arguments.length-2),Tn=2;Tn<arguments.length;Tn++)nt[Tn-2]=arguments[Tn];return I.prototype[ve].apply(j,nt)}}function S(m){const I=m.length;if(0<I){const D=Array(I);for(let j=0;j<I;j++)D[j]=m[j];return D}return[]}function x(m,I){for(let D=1;D<arguments.length;D++){const j=arguments[D];if(l(j)){const ve=m.length||0,Te=j.length||0;m.length=ve+Te;for(let nt=0;nt<Te;nt++)m[ve+nt]=j[nt]}else m.push(j)}}class v{constructor(I,D){this.i=I,this.j=D,this.h=0,this.g=null}get(){let I;return 0<this.h?(this.h--,I=this.g,this.g=I.next,I.next=null):I=this.i(),I}}function w(m){return/^[\s\xa0]*$/.test(m)}function T(){var m=a.navigator;return m&&(m=m.userAgent)?m:""}function R(m){return R[" "](m),m}R[" "]=function(){};var U=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function N(m,I,D){for(const j in m)I.call(D,m[j],j,m)}function P(m,I){for(const D in m)I.call(void 0,m[D],D,m)}function b(m){const I={};for(const D in m)I[D]=m[D];return I}const M="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(m,I){let D,j;for(let ve=1;ve<arguments.length;ve++){j=arguments[ve];for(D in j)m[D]=j[D];for(let Te=0;Te<M.length;Te++)D=M[Te],Object.prototype.hasOwnProperty.call(j,D)&&(m[D]=j[D])}}function L(m){var I=1;m=m.split(":");const D=[];for(;0<I&&m.length;)D.push(m.shift()),I--;return m.length&&D.push(m.join(":")),D}function z(m){a.setTimeout(()=>{throw m},0)}function B(){var m=Z;let I=null;return m.g&&(I=m.g,m.g=m.g.next,m.g||(m.h=null),I.next=null),I}class ${constructor(){this.h=this.g=null}add(I,D){const j=he.get();j.set(I,D),this.h?this.h.next=j:this.g=j,this.h=j}}var he=new v(()=>new te,m=>m.reset());class te{constructor(){this.next=this.g=this.h=null}set(I,D){this.h=I,this.g=D,this.next=null}reset(){this.next=this.g=this.h=null}}let ye,G=!1,Z=new $,K=()=>{const m=a.Promise.resolve(void 0);ye=()=>{m.then(ce)}};var ce=()=>{for(var m;m=B();){try{m.h.call(m.g)}catch(D){z(D)}var I=he;I.j(m),100>I.h&&(I.h++,m.next=I.g,I.g=m)}G=!1};function de(){this.s=this.s,this.C=this.C}de.prototype.s=!1,de.prototype.ma=function(){this.s||(this.s=!0,this.N())},de.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ue(m,I){this.type=m,this.g=this.target=I,this.defaultPrevented=!1}ue.prototype.h=function(){this.defaultPrevented=!0};var Ee=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var m=!1,I=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const D=()=>{};a.addEventListener("test",D,I),a.removeEventListener("test",D,I)}catch{}return m}();function Fe(m,I){if(ue.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m){var D=this.type=m.type,j=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;if(this.target=m.target||m.srcElement,this.g=I,I=m.relatedTarget){if(U){e:{try{R(I.nodeName);var ve=!0;break e}catch{}ve=!1}ve||(I=null)}}else D=="mouseover"?I=m.fromElement:D=="mouseout"&&(I=m.toElement);this.relatedTarget=I,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=typeof m.pointerType=="string"?m.pointerType:ke[m.pointerType]||"",this.state=m.state,this.i=m,m.defaultPrevented&&Fe.aa.h.call(this)}}y(Fe,ue);var ke={2:"touch",3:"pen",4:"mouse"};Fe.prototype.h=function(){Fe.aa.h.call(this);var m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var Ye="closure_listenable_"+(1e6*Math.random()|0),Ct=0;function Dt(m,I,D,j,ve){this.listener=m,this.proxy=null,this.src=I,this.type=D,this.capture=!!j,this.ha=ve,this.key=++Ct,this.da=this.fa=!1}function gt(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function vt(m){this.src=m,this.g={},this.h=0}vt.prototype.add=function(m,I,D,j,ve){var Te=m.toString();m=this.g[Te],m||(m=this.g[Te]=[],this.h++);var nt=Be(m,I,j,ve);return-1<nt?(I=m[nt],D||(I.fa=!1)):(I=new Dt(I,this.src,Te,!!j,ve),I.fa=D,m.push(I)),I};function ie(m,I){var D=I.type;if(D in m.g){var j=m.g[D],ve=Array.prototype.indexOf.call(j,I,void 0),Te;(Te=0<=ve)&&Array.prototype.splice.call(j,ve,1),Te&&(gt(I),m.g[D].length==0&&(delete m.g[D],m.h--))}}function Be(m,I,D,j){for(var ve=0;ve<m.length;++ve){var Te=m[ve];if(!Te.da&&Te.listener==I&&Te.capture==!!D&&Te.ha==j)return ve}return-1}var Ae="closure_lm_"+(1e6*Math.random()|0),We={};function be(m,I,D,j,ve){if(Array.isArray(I)){for(var Te=0;Te<I.length;Te++)be(m,I[Te],D,j,ve);return null}return D=yt(D),m&&m[Ye]?m.K(I,D,u(j)?!!j.capture:!1,ve):At(m,I,D,!1,j,ve)}function At(m,I,D,j,ve,Te){if(!I)throw Error("Invalid event type");var nt=u(ve)?!!ve.capture:!!ve,Tn=ze(m);if(Tn||(m[Ae]=Tn=new vt(m)),D=Tn.add(I,D,j,nt,Te),D.proxy)return D;if(j=st(),D.proxy=j,j.src=m,j.listener=D,m.addEventListener)Ee||(ve=nt),ve===void 0&&(ve=!1),m.addEventListener(I.toString(),j,ve);else if(m.attachEvent)m.attachEvent(_e(I.toString()),j);else if(m.addListener&&m.removeListener)m.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return D}function st(){function m(D){return I.call(m.src,m.listener,D)}const I=Ve;return m}function W(m,I,D,j,ve){if(Array.isArray(I))for(var Te=0;Te<I.length;Te++)W(m,I[Te],D,j,ve);else j=u(j)?!!j.capture:!!j,D=yt(D),m&&m[Ye]?(m=m.i,I=String(I).toString(),I in m.g&&(Te=m.g[I],D=Be(Te,D,j,ve),-1<D&&(gt(Te[D]),Array.prototype.splice.call(Te,D,1),Te.length==0&&(delete m.g[I],m.h--)))):m&&(m=ze(m))&&(I=m.g[I.toString()],m=-1,I&&(m=Be(I,D,j,ve)),(D=-1<m?I[m]:null)&&H(D))}function H(m){if(typeof m!="number"&&m&&!m.da){var I=m.src;if(I&&I[Ye])ie(I.i,m);else{var D=m.type,j=m.proxy;I.removeEventListener?I.removeEventListener(D,j,m.capture):I.detachEvent?I.detachEvent(_e(D),j):I.addListener&&I.removeListener&&I.removeListener(j),(D=ze(I))?(ie(D,m),D.h==0&&(D.src=null,I[Ae]=null)):gt(m)}}}function _e(m){return m in We?We[m]:We[m]="on"+m}function Ve(m,I){if(m.da)m=!0;else{I=new Fe(I,this);var D=m.listener,j=m.ha||m.src;m.fa&&H(m),m=D.call(j,I)}return m}function ze(m){return m=m[Ae],m instanceof vt?m:null}var De="__closure_events_fn_"+(1e9*Math.random()>>>0);function yt(m){return typeof m=="function"?m:(m[De]||(m[De]=function(I){return m.handleEvent(I)}),m[De])}function Xe(){de.call(this),this.i=new vt(this),this.M=this,this.F=null}y(Xe,de),Xe.prototype[Ye]=!0,Xe.prototype.removeEventListener=function(m,I,D,j){W(this,m,I,D,j)};function Qe(m,I){var D,j=m.F;if(j)for(D=[];j;j=j.F)D.push(j);if(m=m.M,j=I.type||I,typeof I=="string")I=new ue(I,m);else if(I instanceof ue)I.target=I.target||m;else{var ve=I;I=new ue(j,m),A(I,ve)}if(ve=!0,D)for(var Te=D.length-1;0<=Te;Te--){var nt=I.g=D[Te];ve=lt(nt,j,!0,I)&&ve}if(nt=I.g=m,ve=lt(nt,j,!0,I)&&ve,ve=lt(nt,j,!1,I)&&ve,D)for(Te=0;Te<D.length;Te++)nt=I.g=D[Te],ve=lt(nt,j,!1,I)&&ve}Xe.prototype.N=function(){if(Xe.aa.N.call(this),this.i){var m=this.i,I;for(I in m.g){for(var D=m.g[I],j=0;j<D.length;j++)gt(D[j]);delete m.g[I],m.h--}}this.F=null},Xe.prototype.K=function(m,I,D,j){return this.i.add(String(m),I,!1,D,j)},Xe.prototype.L=function(m,I,D,j){return this.i.add(String(m),I,!0,D,j)};function lt(m,I,D,j){if(I=m.i.g[String(I)],!I)return!0;I=I.concat();for(var ve=!0,Te=0;Te<I.length;++Te){var nt=I[Te];if(nt&&!nt.da&&nt.capture==D){var Tn=nt.listener,Mr=nt.ha||nt.src;nt.fa&&ie(m.i,nt),ve=Tn.call(Mr,j)!==!1&&ve}}return ve&&!j.defaultPrevented}function Nt(m,I,D){if(typeof m=="function")D&&(m=p(m,D));else if(m&&typeof m.handleEvent=="function")m=p(m.handleEvent,m);else throw Error("Invalid listener argument");return 2147483647<Number(I)?-1:a.setTimeout(m,I||0)}function He(m){m.g=Nt(()=>{m.g=null,m.i&&(m.i=!1,He(m))},m.l);const I=m.h;m.h=null,m.m.apply(null,I)}class tn extends de{constructor(I,D){super(),this.m=I,this.l=D,this.h=null,this.i=!1,this.g=null}j(I){this.h=arguments,this.g?this.i=!0:He(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ht(m){de.call(this),this.h=m,this.g={}}y(Ht,de);var xt=[];function ct(m){N(m.g,function(I,D){this.g.hasOwnProperty(D)&&H(I)},m),m.g={}}Ht.prototype.N=function(){Ht.aa.N.call(this),ct(this)},Ht.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ft=a.JSON.stringify,ae=a.JSON.parse,Se=class{stringify(m){return a.JSON.stringify(m,void 0)}parse(m){return a.JSON.parse(m,void 0)}};function Je(){}Je.prototype.h=null;function ut(m){return m.h||(m.h=m.i())}function q(){}var J={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ne(){ue.call(this,"d")}y(Ne,ue);function Ke(){ue.call(this,"c")}y(Ke,ue);var Ze={},ot=null;function $t(){return ot=ot||new Xe}Ze.La="serverreachability";function rn(m){ue.call(this,Ze.La,m)}y(rn,ue);function sn(m){const I=$t();Qe(I,new rn(I))}Ze.STAT_EVENT="statevent";function gn(m,I){ue.call(this,Ze.STAT_EVENT,m),this.stat=I}y(gn,ue);function Vt(m){const I=$t();Qe(I,new gn(I,m))}Ze.Ma="timingevent";function $n(m,I){ue.call(this,Ze.Ma,m),this.size=I}y($n,ue);function ur(m,I){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){m()},I)}function qr(){this.g=!0}qr.prototype.xa=function(){this.g=!1};function eo(m,I,D,j,ve,Te){m.info(function(){if(m.g)if(Te)for(var nt="",Tn=Te.split("&"),Mr=0;Mr<Tn.length;Mr++){var xn=Tn[Mr].split("=");if(1<xn.length){var Ar=xn[0];xn=xn[1];var On=Ar.split("_");nt=2<=On.length&&On[1]=="type"?nt+(Ar+"="+xn+"&"):nt+(Ar+"=redacted&")}}else nt=null;else nt=Te;return"XMLHTTP REQ ("+j+") [attempt "+ve+"]: "+I+`
`+D+`
`+nt})}function ci(m,I,D,j,ve,Te,nt){m.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+ve+"]: "+I+`
`+D+`
`+Te+" "+nt})}function tr(m,I,D,j){m.info(function(){return"XMLHTTP TEXT ("+I+"): "+Os(m,D)+(j?" "+j:"")})}function Zt(m,I){m.info(function(){return"TIMEOUT: "+I})}qr.prototype.info=function(){};function Os(m,I){if(!m.g)return I;if(!I)return null;try{var D=JSON.parse(I);if(D){for(m=0;m<D.length;m++)if(Array.isArray(D[m])){var j=D[m];if(!(2>j.length)){var ve=j[1];if(Array.isArray(ve)&&!(1>ve.length)){var Te=ve[0];if(Te!="noop"&&Te!="stop"&&Te!="close")for(var nt=1;nt<ve.length;nt++)ve[nt]=""}}}}return ft(D)}catch{return I}}var us={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},V={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},X;function le(){}y(le,Je),le.prototype.g=function(){return new XMLHttpRequest},le.prototype.i=function(){return{}},X=new le;function O(m,I,D,j){this.j=m,this.i=I,this.l=D,this.R=j||1,this.U=new Ht(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Y}function Y(){this.i=null,this.g="",this.h=!1}var ee={},se={};function re(m,I,D){m.L=1,m.v=Us(et(I)),m.m=D,m.P=!0,xe(m,null)}function xe(m,I){m.F=Date.now(),Ce(m),m.A=et(m.v);var D=m.A,j=m.R;Array.isArray(j)||(j=[String(j)]),Lc(D.i,"t",j),m.C=0,D=m.j.J,m.h=new Y,m.g=fu(m.j,D?I:null,!m.m),0<m.O&&(m.M=new tn(p(m.Y,m,m.g),m.O)),I=m.U,D=m.g,j=m.ca;var ve="readystatechange";Array.isArray(ve)||(ve&&(xt[0]=ve.toString()),ve=xt);for(var Te=0;Te<ve.length;Te++){var nt=be(D,ve[Te],j||I.handleEvent,!1,I.h||I);if(!nt)break;I.g[nt.key]=nt}I=m.H?b(m.H):{},m.m?(m.u||(m.u="POST"),I["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.A,m.u,m.m,I)):(m.u="GET",m.g.ea(m.A,m.u,null,I)),sn(),eo(m.i,m.u,m.A,m.l,m.R,m.m)}O.prototype.ca=function(m){m=m.target;const I=this.M;I&&vr(m)==3?I.j():this.Y(m)},O.prototype.Y=function(m){try{if(m==this.g)e:{const On=vr(this.g);var I=this.g.Ba();const Cr=this.g.Z();if(!(3>On)&&(On!=3||this.g&&(this.h.h||this.g.oa()||uu(this.g)))){this.J||On!=4||I==7||(I==8||0>=Cr?sn(3):sn(2)),je(this);var D=this.g.Z();this.X=D;t:if(Me(this)){var j=uu(this.g);m="";var ve=j.length,Te=vr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){mt(this),$e(this);var nt="";break t}this.h.i=new a.TextDecoder}for(I=0;I<ve;I++)this.h.h=!0,m+=this.h.i.decode(j[I],{stream:!(Te&&I==ve-1)});j.length=0,this.h.g+=m,this.C=0,nt=this.h.g}else nt=this.g.oa();if(this.o=D==200,ci(this.i,this.u,this.A,this.l,this.R,On,D),this.o){if(this.T&&!this.K){t:{if(this.g){var Tn,Mr=this.g;if((Tn=Mr.g?Mr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(Tn)){var xn=Tn;break t}}xn=null}if(D=xn)tr(this.i,this.l,D,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Pt(this,D);else{this.o=!1,this.s=3,Vt(12),mt(this),$e(this);break e}}if(this.P){D=!0;let En;for(;!this.J&&this.C<nt.length;)if(En=Re(this,nt),En==se){On==4&&(this.s=4,Vt(14),D=!1),tr(this.i,this.l,null,"[Incomplete Response]");break}else if(En==ee){this.s=4,Vt(15),tr(this.i,this.l,nt,"[Invalid Chunk]"),D=!1;break}else tr(this.i,this.l,En,null),Pt(this,En);if(Me(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),On!=4||nt.length!=0||this.h.h||(this.s=1,Vt(16),D=!1),this.o=this.o&&D,!D)tr(this.i,this.l,nt,"[Invalid Chunked Response]"),mt(this),$e(this);else if(0<nt.length&&!this.W){this.W=!0;var Ar=this.j;Ar.g==this&&Ar.ba&&!Ar.M&&(Ar.j.info("Great, no buffering proxy detected. Bytes received: "+nt.length),ps(Ar),Ar.M=!0,Vt(11))}}else tr(this.i,this.l,nt,null),Pt(this,nt);On==4&&mt(this),this.o&&!this.J&&(On==4?Wd(this.j,this):(this.o=!1,Ce(this)))}else kc(this.g),D==400&&0<nt.indexOf("Unknown SID")?(this.s=3,Vt(12)):(this.s=0,Vt(13)),mt(this),$e(this)}}}catch{}finally{}};function Me(m){return m.g?m.u=="GET"&&m.L!=2&&m.j.Ca:!1}function Re(m,I){var D=m.C,j=I.indexOf(`
`,D);return j==-1?se:(D=Number(I.substring(D,j)),isNaN(D)?ee:(j+=1,j+D>I.length?se:(I=I.slice(j,j+D),m.C=j+D,I)))}O.prototype.cancel=function(){this.J=!0,mt(this)};function Ce(m){m.S=Date.now()+m.I,Et(m,m.I)}function Et(m,I){if(m.B!=null)throw Error("WatchDog timer not null");m.B=ur(p(m.ba,m),I)}function je(m){m.B&&(a.clearTimeout(m.B),m.B=null)}O.prototype.ba=function(){this.B=null;const m=Date.now();0<=m-this.S?(Zt(this.i,this.A),this.L!=2&&(sn(),Vt(17)),mt(this),this.s=2,$e(this)):Et(this,this.S-m)};function $e(m){m.j.G==0||m.J||Wd(m.j,m)}function mt(m){je(m);var I=m.M;I&&typeof I.ma=="function"&&I.ma(),m.M=null,ct(m.U),m.g&&(I=m.g,m.g=null,I.abort(),I.ma())}function Pt(m,I){try{var D=m.j;if(D.G!=0&&(D.g==m||Jt(D.h,m))){if(!m.K&&Jt(D.h,m)&&D.G==3){try{var j=D.Da.g.parse(I)}catch{j=null}if(Array.isArray(j)&&j.length==3){var ve=j;if(ve[0]==0){e:if(!D.u){if(D.g)if(D.g.F+3e3<m.F)ta(D),hu(D);else break e;Vc(D),Vt(18)}}else D.za=ve[1],0<D.za-D.T&&37500>ve[2]&&D.F&&D.v==0&&!D.C&&(D.C=ur(p(D.Za,D),6e3));if(1>=at(D.h)&&D.ca){try{D.ca()}catch{}D.ca=void 0}}else To(D,11)}else if((m.K||D.g==m)&&ta(D),!w(I))for(ve=D.Da.g.parse(I),I=0;I<ve.length;I++){let xn=ve[I];if(D.T=xn[0],xn=xn[1],D.G==2)if(xn[0]=="c"){D.K=xn[1],D.ia=xn[2];const Ar=xn[3];Ar!=null&&(D.la=Ar,D.j.info("VER="+D.la));const On=xn[4];On!=null&&(D.Aa=On,D.j.info("SVER="+D.Aa));const Cr=xn[5];Cr!=null&&typeof Cr=="number"&&0<Cr&&(j=1.5*Cr,D.L=j,D.j.info("backChannelRequestTimeoutMs_="+j)),j=D;const En=m.g;if(En){const Mo=En.g?En.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Mo){var Te=j.h;Te.g||Mo.indexOf("spdy")==-1&&Mo.indexOf("quic")==-1&&Mo.indexOf("h2")==-1||(Te.j=Te.l,Te.g=new Set,Te.h&&(kt(Te,Te.h),Te.h=null))}if(j.D){const Di=En.g?En.g.getResponseHeader("X-HTTP-Session-Id"):null;Di&&(j.ya=Di,ln(j.I,j.D,Di))}}D.G=3,D.l&&D.l.ua(),D.ba&&(D.R=Date.now()-m.F,D.j.info("Handshake RTT: "+D.R+"ms")),j=D;var nt=m;if(j.qa=Bc(j,j.J?j.ia:null,j.W),nt.K){Wt(j.h,nt);var Tn=nt,Mr=j.L;Mr&&(Tn.I=Mr),Tn.B&&(je(Tn),Ce(Tn)),j.g=nt}else Fc(j);0<D.i.length&&Ha(D)}else xn[0]!="stop"&&xn[0]!="close"||To(D,7);else D.G==3&&(xn[0]=="stop"||xn[0]=="close"?xn[0]=="stop"?To(D,7):cu(D):xn[0]!="noop"&&D.l&&D.l.ta(xn),D.v=0)}}sn(4)}catch{}}var Ut=class{constructor(m,I){this.g=m,this.map=I}};function Gt(m){this.l=m||10,a.PerformanceNavigationTiming?(m=a.performance.getEntriesByType("navigation"),m=0<m.length&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function pt(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function at(m){return m.h?1:m.g?m.g.size:0}function Jt(m,I){return m.h?m.h==I:m.g?m.g.has(I):!1}function kt(m,I){m.g?m.g.add(I):m.h=I}function Wt(m,I){m.h&&m.h==I?m.h=null:m.g&&m.g.has(I)&&m.g.delete(I)}Gt.prototype.cancel=function(){if(this.i=Mn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function Mn(m){if(m.h!=null)return m.i.concat(m.h.D);if(m.g!=null&&m.g.size!==0){let I=m.i;for(const D of m.g.values())I=I.concat(D.D);return I}return S(m.i)}function oe(m){if(m.V&&typeof m.V=="function")return m.V();if(typeof Map<"u"&&m instanceof Map||typeof Set<"u"&&m instanceof Set)return Array.from(m.values());if(typeof m=="string")return m.split("");if(l(m)){for(var I=[],D=m.length,j=0;j<D;j++)I.push(m[j]);return I}I=[],D=0;for(j in m)I[D++]=m[j];return I}function ge(m){if(m.na&&typeof m.na=="function")return m.na();if(!m.V||typeof m.V!="function"){if(typeof Map<"u"&&m instanceof Map)return Array.from(m.keys());if(!(typeof Set<"u"&&m instanceof Set)){if(l(m)||typeof m=="string"){var I=[];m=m.length;for(var D=0;D<m;D++)I.push(D);return I}I=[],D=0;for(const j in m)I[D++]=j;return I}}}function Le(m,I){if(m.forEach&&typeof m.forEach=="function")m.forEach(I,void 0);else if(l(m)||typeof m=="string")Array.prototype.forEach.call(m,I,void 0);else for(var D=ge(m),j=oe(m),ve=j.length,Te=0;Te<ve;Te++)I.call(void 0,j[Te],D&&D[Te],m)}var qe=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ht(m,I){if(m){m=m.split("&");for(var D=0;D<m.length;D++){var j=m[D].indexOf("="),ve=null;if(0<=j){var Te=m[D].substring(0,j);ve=m[D].substring(j+1)}else Te=m[D];I(Te,ve?decodeURIComponent(ve.replace(/\+/g," ")):"")}}}function rt(m){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,m instanceof rt){this.h=m.h,It(this,m.j),this.o=m.o,this.g=m.g,Yt(this,m.s),this.l=m.l;var I=m.i,D=new za;D.i=I.i,I.g&&(D.g=new Map(I.g),D.h=I.h),Dn(this,D),this.m=m.m}else m&&(I=String(m).match(qe))?(this.h=!1,It(this,I[1]||"",!0),this.o=Ki(I[2]||""),this.g=Ki(I[3]||"",!0),Yt(this,I[4]),this.l=Ki(I[5]||"",!0),Dn(this,I[6]||"",!0),this.m=Ki(I[7]||"")):(this.h=!1,this.i=new za(null,this.h))}rt.prototype.toString=function(){var m=[],I=this.j;I&&m.push(Xr(I,Pc,!0),":");var D=this.g;return(D||I=="file")&&(m.push("//"),(I=this.o)&&m.push(Xr(I,Pc,!0),"@"),m.push(encodeURIComponent(String(D)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),D=this.s,D!=null&&m.push(":",String(D))),(D=this.l)&&(this.g&&D.charAt(0)!="/"&&m.push("/"),m.push(Xr(D,D.charAt(0)=="/"?yn:Nc,!0))),(D=this.i.toString())&&m.push("?",D),(D=this.m)&&m.push("#",Xr(D,Qo)),m.join("")};function et(m){return new rt(m)}function It(m,I,D){m.j=D?Ki(I,!0):I,m.j&&(m.j=m.j.replace(/:$/,""))}function Yt(m,I){if(I){if(I=Number(I),isNaN(I)||0>I)throw Error("Bad port number "+I);m.s=I}else m.s=null}function Dn(m,I,D){I instanceof za?(m.i=I,j0(m.i,m.h)):(D||(I=Xr(I,Vr)),m.i=new za(I,m.h))}function ln(m,I,D){m.i.set(I,D)}function Us(m){return ln(m,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),m}function Ki(m,I){return m?I?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function Xr(m,I,D){return typeof m=="string"?(m=encodeURI(m).replace(I,ou),D&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function ou(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var Pc=/[#\/\?@]/g,Nc=/[#\?:]/g,yn=/[#\?]/g,Vr=/[#\?@]/g,Qo=/#/g;function za(m,I){this.h=this.g=null,this.i=m||null,this.j=!!I}function Ni(m){m.g||(m.g=new Map,m.h=0,m.i&&ht(m.i,function(I,D){m.add(decodeURIComponent(I.replace(/\+/g," ")),D)}))}n=za.prototype,n.add=function(m,I){Ni(this),this.i=null,m=Zo(this,m);var D=this.g.get(m);return D||this.g.set(m,D=[]),D.push(I),this.h+=1,this};function vn(m,I){Ni(m),I=Zo(m,I),m.g.has(I)&&(m.i=null,m.h-=m.g.get(I).length,m.g.delete(I))}function zd(m,I){return Ni(m),I=Zo(m,I),m.g.has(I)}n.forEach=function(m,I){Ni(this),this.g.forEach(function(D,j){D.forEach(function(ve){m.call(I,ve,j,this)},this)},this)},n.na=function(){Ni(this);const m=Array.from(this.g.values()),I=Array.from(this.g.keys()),D=[];for(let j=0;j<I.length;j++){const ve=m[j];for(let Te=0;Te<ve.length;Te++)D.push(I[j])}return D},n.V=function(m){Ni(this);let I=[];if(typeof m=="string")zd(this,m)&&(I=I.concat(this.g.get(Zo(this,m))));else{m=Array.from(this.g.values());for(let D=0;D<m.length;D++)I=I.concat(m[D])}return I},n.set=function(m,I){return Ni(this),this.i=null,m=Zo(this,m),zd(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[I]),this.h+=1,this},n.get=function(m,I){return m?(m=this.V(m),0<m.length?String(m[0]):I):I};function Lc(m,I,D){vn(m,I),0<D.length&&(m.i=null,m.g.set(Zo(m,I),S(D)),m.h+=D.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],I=Array.from(this.g.keys());for(var D=0;D<I.length;D++){var j=I[D];const Te=encodeURIComponent(String(j)),nt=this.V(j);for(j=0;j<nt.length;j++){var ve=Te;nt[j]!==""&&(ve+="="+encodeURIComponent(String(nt[j]))),m.push(ve)}}return this.i=m.join("&")};function Zo(m,I){return I=String(I),m.j&&(I=I.toLowerCase()),I}function j0(m,I){I&&!m.j&&(Ni(m),m.i=null,m.g.forEach(function(D,j){var ve=j.toLowerCase();j!=ve&&(vn(this,j),Lc(this,ve,D))},m)),m.j=I}function q0(m,I){const D=new qr;if(a.Image){const j=new Image;j.onload=g(Fs,D,"TestLoadImage: loaded",!0,I,j),j.onerror=g(Fs,D,"TestLoadImage: error",!1,I,j),j.onabort=g(Fs,D,"TestLoadImage: abort",!1,I,j),j.ontimeout=g(Fs,D,"TestLoadImage: timeout",!1,I,j),a.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=m}else I(!1)}function Tr(m,I){const D=new qr,j=new AbortController,ve=setTimeout(()=>{j.abort(),Fs(D,"TestPingServer: timeout",!1,I)},1e4);fetch(m,{signal:j.signal}).then(Te=>{clearTimeout(ve),Te.ok?Fs(D,"TestPingServer: ok",!0,I):Fs(D,"TestPingServer: server error",!1,I)}).catch(()=>{clearTimeout(ve),Fs(D,"TestPingServer: error",!1,I)})}function Fs(m,I,D,j,ve){try{ve&&(ve.onload=null,ve.onerror=null,ve.onabort=null,ve.ontimeout=null),j(D)}catch{}}function X0(){this.g=new Se}function Hd(m,I,D){const j=D||"";try{Le(m,function(ve,Te){let nt=ve;u(ve)&&(nt=ft(ve)),I.push(j+Te+"="+encodeURIComponent(nt))})}catch(ve){throw I.push(j+"type="+encodeURIComponent("_badmap")),ve}}function Dc(m){this.l=m.Ub||null,this.j=m.eb||!1}y(Dc,Je),Dc.prototype.g=function(){return new Jo(this.l,this.j)},Dc.prototype.i=function(m){return function(){return m}}({});function Jo(m,I){Xe.call(this),this.D=m,this.o=I,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(Jo,Xe),n=Jo.prototype,n.open=function(m,I){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=m,this.A=I,this.readyState=1,lu(this)},n.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const I={headers:this.u,method:this.B,credentials:this.m,cache:void 0};m&&(I.body=m),(this.D||a).fetch(new Request(this.A,I)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,au(this)),this.readyState=0},n.Sa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,lu(this)),this.g&&(this.readyState=3,lu(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;cs(this)}else m.text().then(this.Ra.bind(this),this.ga.bind(this))};function cs(m){m.j.read().then(m.Pa.bind(m)).catch(m.ga.bind(m))}n.Pa=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var I=m.value?m.value:new Uint8Array(0);(I=this.v.decode(I,{stream:!m.done}))&&(this.response=this.responseText+=I)}m.done?au(this):lu(this),this.readyState==3&&cs(this)}},n.Ra=function(m){this.g&&(this.response=this.responseText=m,au(this))},n.Qa=function(m){this.g&&(this.response=m,au(this))},n.ga=function(){this.g&&au(this)};function au(m){m.readyState=4,m.l=null,m.j=null,m.v=null,lu(m)}n.setRequestHeader=function(m,I){this.u.append(m,I)},n.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],I=this.h.entries();for(var D=I.next();!D.done;)D=D.value,m.push(D[0]+": "+D[1]),D=I.next();return m.join(`\r
`)};function lu(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(Jo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function hs(m){let I="";return N(m,function(D,j){I+=j,I+=":",I+=D,I+=`\r
`}),I}function ds(m,I,D){e:{for(j in D){var j=!1;break e}j=!0}j||(D=hs(D),typeof m=="string"?D!=null&&encodeURIComponent(String(D)):ln(m,I,D))}function Gn(m){Xe.call(this),this.headers=new Map,this.o=m||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(Gn,Xe);var Gd=/^https?$/i,Xm=["POST","PUT"];n=Gn.prototype,n.Ha=function(m){this.J=m},n.ea=function(m,I,D,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);I=I?I.toUpperCase():"GET",this.D=m,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():X.g(),this.v=this.o?ut(this.o):ut(X),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(I,String(m),!0),this.B=!1}catch(Te){$m(this,Te);return}if(m=D||"",D=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var ve in j)D.set(ve,j[ve]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const Te of j.keys())D.set(Te,j.get(Te));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(D.keys()).find(Te=>Te.toLowerCase()=="content-type"),ve=a.FormData&&m instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Xm,I,void 0))||j||ve||D.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Te,nt]of D)this.g.setRequestHeader(Te,nt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Km(this),this.u=!0,this.g.send(m),this.u=!1}catch(Te){$m(this,Te)}};function $m(m,I){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=I,m.m=5,fs(m),ea(m)}function fs(m){m.A||(m.A=!0,Qe(m,"complete"),Qe(m,"error"))}n.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=m||7,Qe(this,"complete"),Qe(this,"abort"),ea(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ea(this,!0)),Gn.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Ym(this):this.bb())},n.bb=function(){Ym(this)};function Ym(m){if(m.h&&typeof o<"u"&&(!m.v[1]||vr(m)!=4||m.Z()!=2)){if(m.u&&vr(m)==4)Nt(m.Ea,0,m);else if(Qe(m,"readystatechange"),vr(m)==4){m.h=!1;try{const nt=m.Z();e:switch(nt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var I=!0;break e;default:I=!1}var D;if(!(D=I)){var j;if(j=nt===0){var ve=String(m.D).match(qe)[1]||null;!ve&&a.self&&a.self.location&&(ve=a.self.location.protocol.slice(0,-1)),j=!Gd.test(ve?ve.toLowerCase():"")}D=j}if(D)Qe(m,"complete"),Qe(m,"success");else{m.m=6;try{var Te=2<vr(m)?m.g.statusText:""}catch{Te=""}m.l=Te+" ["+m.Z()+"]",fs(m)}}finally{ea(m)}}}}function ea(m,I){if(m.g){Km(m);const D=m.g,j=m.v[0]?()=>{}:null;m.g=null,m.v=null,I||Qe(m,"ready");try{D.onreadystatechange=j}catch{}}}function Km(m){m.I&&(a.clearTimeout(m.I),m.I=null)}n.isActive=function(){return!!this.g};function vr(m){return m.g?m.g.readyState:0}n.Z=function(){try{return 2<vr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(m){if(this.g){var I=this.g.responseText;return m&&I.indexOf(m)==0&&(I=I.substring(m.length)),ae(I)}};function uu(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.H){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function kc(m){const I={};m=(m.g&&2<=vr(m)&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<m.length;j++){if(w(m[j]))continue;var D=L(m[j]);const ve=D[0];if(D=D[1],typeof D!="string")continue;D=D.trim();const Te=I[ve]||[];I[ve]=Te,Te.push(D)}P(I,function(j){return j.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Vs(m,I,D){return D&&D.internalChannelParams&&D.internalChannelParams[m]||I}function Oc(m){this.Aa=0,this.i=[],this.j=new qr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Vs("failFast",!1,m),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Vs("baseRetryDelayMs",5e3,m),this.cb=Vs("retryDelaySeedMs",1e4,m),this.Wa=Vs("forwardChannelMaxRetries",2,m),this.wa=Vs("forwardChannelRequestTimeoutMs",2e4,m),this.pa=m&&m.xmlHttpFactory||void 0,this.Xa=m&&m.Tb||void 0,this.Ca=m&&m.useFetchStreams||!1,this.L=void 0,this.J=m&&m.supportsCrossDomainXhr||!1,this.K="",this.h=new Gt(m&&m.concurrentRequestLimit),this.Da=new X0,this.P=m&&m.fastHandshake||!1,this.O=m&&m.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=m&&m.Rb||!1,m&&m.xa&&this.j.xa(),m&&m.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&m&&m.detectBufferingProxy||!1,this.ja=void 0,m&&m.longPollingTimeout&&0<m.longPollingTimeout&&(this.ja=m.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Oc.prototype,n.la=8,n.G=1,n.connect=function(m,I,D,j){Vt(0),this.W=m,this.H=I||{},D&&j!==void 0&&(this.H.OSID=D,this.H.OAID=j),this.F=this.X,this.I=Bc(this,null,this.W),Ha(this)};function cu(m){if(Uc(m),m.G==3){var I=m.U++,D=et(m.I);if(ln(D,"SID",m.K),ln(D,"RID",I),ln(D,"TYPE","terminate"),hi(m,D),I=new O(m,m.j,I),I.L=2,I.v=Us(et(D)),D=!1,a.navigator&&a.navigator.sendBeacon)try{D=a.navigator.sendBeacon(I.v.toString(),"")}catch{}!D&&a.Image&&(new Image().src=I.v,D=!0),D||(I.g=fu(I.j,null),I.g.ea(I.v)),I.F=Date.now(),Ce(I)}jd(m)}function hu(m){m.g&&(ps(m),m.g.cancel(),m.g=null)}function Uc(m){hu(m),m.u&&(a.clearTimeout(m.u),m.u=null),ta(m),m.h.cancel(),m.s&&(typeof m.s=="number"&&a.clearTimeout(m.s),m.s=null)}function Ha(m){if(!pt(m.h)&&!m.s){m.s=!0;var I=m.Ga;ye||K(),G||(ye(),G=!0),Z.add(I,m),m.B=0}}function Ga(m,I){return at(m.h)>=m.h.j-(m.s?1:0)?!1:m.s?(m.i=I.D.concat(m.i),!0):m.G==1||m.G==2||m.B>=(m.Va?0:m.Wa)?!1:(m.s=ur(p(m.Ga,m,I),du(m,m.B)),m.B++,!0)}n.Ga=function(m){if(this.s)if(this.s=null,this.G==1){if(!m){this.U=Math.floor(1e5*Math.random()),m=this.U++;const ve=new O(this,this.j,m);let Te=this.o;if(this.S&&(Te?(Te=b(Te),A(Te,this.S)):Te=this.S),this.m!==null||this.O||(ve.H=Te,Te=null),this.P)e:{for(var I=0,D=0;D<this.i.length;D++){t:{var j=this.i[D];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(I+=j,4096<I){I=D;break e}if(I===4096||D===this.i.length-1){I=D+1;break e}}I=1e3}else I=1e3;I=to(this,ve,I),D=et(this.I),ln(D,"RID",m),ln(D,"CVER",22),this.D&&ln(D,"X-HTTP-Session-Id",this.D),hi(this,D),Te&&(this.O?I="headers="+encodeURIComponent(String(hs(Te)))+"&"+I:this.m&&ds(D,this.m,Te)),kt(this.h,ve),this.Ua&&ln(D,"TYPE","init"),this.P?(ln(D,"$req",I),ln(D,"SID","null"),ve.T=!0,re(ve,D,null)):re(ve,D,I),this.G=2}}else this.G==3&&(m?Li(this,m):this.i.length==0||pt(this.h)||Li(this))};function Li(m,I){var D;I?D=I.l:D=m.U++;const j=et(m.I);ln(j,"SID",m.K),ln(j,"RID",D),ln(j,"AID",m.T),hi(m,j),m.m&&m.o&&ds(j,m.m,m.o),D=new O(m,m.j,D,m.B+1),m.m===null&&(D.H=m.o),I&&(m.i=I.D.concat(m.i)),I=to(m,D,1e3),D.I=Math.round(.5*m.wa)+Math.round(.5*m.wa*Math.random()),kt(m.h,D),re(D,j,I)}function hi(m,I){m.H&&N(m.H,function(D,j){ln(I,j,D)}),m.l&&Le({},function(D,j){ln(I,j,D)})}function to(m,I,D){D=Math.min(m.i.length,D);var j=m.l?p(m.l.Na,m.l,m):null;e:{var ve=m.i;let Te=-1;for(;;){const nt=["count="+D];Te==-1?0<D?(Te=ve[0].g,nt.push("ofs="+Te)):Te=0:nt.push("ofs="+Te);let Tn=!0;for(let Mr=0;Mr<D;Mr++){let xn=ve[Mr].g;const Ar=ve[Mr].map;if(xn-=Te,0>xn)Te=Math.max(0,ve[Mr].g-100),Tn=!1;else try{Hd(Ar,nt,"req"+xn+"_")}catch{j&&j(Ar)}}if(Tn){j=nt.join("&");break e}}}return m=m.i.splice(0,D),I.D=m,j}function Fc(m){if(!m.g&&!m.u){m.Y=1;var I=m.Fa;ye||K(),G||(ye(),G=!0),Z.add(I,m),m.v=0}}function Vc(m){return m.g||m.u||3<=m.v?!1:(m.Y++,m.u=ur(p(m.Fa,m),du(m,m.v)),m.v++,!0)}n.Fa=function(){if(this.u=null,no(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var m=2*this.R;this.j.info("BP detection timer enabled: "+m),this.A=ur(p(this.ab,this),m)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Vt(10),hu(this),no(this))};function ps(m){m.A!=null&&(a.clearTimeout(m.A),m.A=null)}function no(m){m.g=new O(m,m.j,"rpc",m.Y),m.m===null&&(m.g.H=m.o),m.g.O=0;var I=et(m.qa);ln(I,"RID","rpc"),ln(I,"SID",m.K),ln(I,"AID",m.T),ln(I,"CI",m.F?"0":"1"),!m.F&&m.ja&&ln(I,"TO",m.ja),ln(I,"TYPE","xmlhttp"),hi(m,I),m.m&&m.o&&ds(I,m.m,m.o),m.L&&(m.g.I=m.L);var D=m.g;m=m.ia,D.L=1,D.v=Us(et(I)),D.m=null,D.P=!0,xe(D,m)}n.Za=function(){this.C!=null&&(this.C=null,hu(this),Vc(this),Vt(19))};function ta(m){m.C!=null&&(a.clearTimeout(m.C),m.C=null)}function Wd(m,I){var D=null;if(m.g==I){ta(m),ps(m),m.g=null;var j=2}else if(Jt(m.h,I))D=I.D,Wt(m.h,I),j=1;else return;if(m.G!=0){if(I.o)if(j==1){D=I.m?I.m.length:0,I=Date.now()-I.F;var ve=m.B;j=$t(),Qe(j,new $n(j,D)),Ha(m)}else Fc(m);else if(ve=I.s,ve==3||ve==0&&0<I.X||!(j==1&&Ga(m,I)||j==2&&Vc(m)))switch(D&&0<D.length&&(I=m.h,I.i=I.i.concat(D)),ve){case 1:To(m,5);break;case 4:To(m,10);break;case 3:To(m,6);break;default:To(m,2)}}}function du(m,I){let D=m.Ta+Math.floor(Math.random()*m.cb);return m.isActive()||(D*=2),D*I}function To(m,I){if(m.j.info("Error code "+I),I==2){var D=p(m.fb,m),j=m.Xa;const ve=!j;j=new rt(j||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||It(j,"https"),Us(j),ve?q0(j.toString(),D):Tr(j.toString(),D)}else Vt(2);m.G=0,m.l&&m.l.sa(I),jd(m),Uc(m)}n.fb=function(m){m?(this.j.info("Successfully pinged google.com"),Vt(2)):(this.j.info("Failed to ping google.com"),Vt(1))};function jd(m){if(m.G=0,m.ka=[],m.l){const I=Mn(m.h);(I.length!=0||m.i.length!=0)&&(x(m.ka,I),x(m.ka,m.i),m.h.i.length=0,S(m.i),m.i.length=0),m.l.ra()}}function Bc(m,I,D){var j=D instanceof rt?et(D):new rt(D);if(j.g!="")I&&(j.g=I+"."+j.g),Yt(j,j.s);else{var ve=a.location;j=ve.protocol,I=I?I+"."+ve.hostname:ve.hostname,ve=+ve.port;var Te=new rt(null);j&&It(Te,j),I&&(Te.g=I),ve&&Yt(Te,ve),D&&(Te.l=D),j=Te}return D=m.D,I=m.ya,D&&I&&ln(j,D,I),ln(j,"VER",m.la),hi(m,j),j}function fu(m,I,D){if(I&&!m.J)throw Error("Can't create secondary domain capable XhrIo object.");return I=m.Ca&&!m.pa?new Gn(new Dc({eb:D})):new Gn(m.pa),I.Ha(m.J),I}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function qd(){}n=qd.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function pu(){}pu.prototype.g=function(m,I){return new di(m,I)};function di(m,I){Xe.call(this),this.g=new Oc(I),this.l=m,this.h=I&&I.messageUrlParams||null,m=I&&I.messageHeaders||null,I&&I.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=I&&I.initMessageHeaders||null,I&&I.messageContentType&&(m?m["X-WebChannel-Content-Type"]=I.messageContentType:m={"X-WebChannel-Content-Type":I.messageContentType}),I&&I.va&&(m?m["X-WebChannel-Client-Profile"]=I.va:m={"X-WebChannel-Client-Profile":I.va}),this.g.S=m,(m=I&&I.Sb)&&!w(m)&&(this.g.m=m),this.v=I&&I.supportsCrossDomainXhr||!1,this.u=I&&I.sendRawJson||!1,(I=I&&I.httpSessionIdParam)&&!w(I)&&(this.g.D=I,m=this.h,m!==null&&I in m&&(m=this.h,I in m&&delete m[I])),this.j=new ms(this)}y(di,Xe),di.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},di.prototype.close=function(){cu(this.g)},di.prototype.o=function(m){var I=this.g;if(typeof m=="string"){var D={};D.__data__=m,m=D}else this.u&&(D={},D.__data__=ft(m),m=D);I.i.push(new Ut(I.Ya++,m)),I.G==3&&Ha(I)},di.prototype.N=function(){this.g.l=null,delete this.j,cu(this.g),delete this.g,di.aa.N.call(this)};function zc(m){Ne.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var I=m.__sm__;if(I){e:{for(const D in I){m=D;break e}m=void 0}(this.i=m)&&(m=this.i,I=I!==null&&m in I?I[m]:void 0),this.data=I}else this.data=m}y(zc,Ne);function na(){Ke.call(this),this.status=1}y(na,Ke);function ms(m){this.g=m}y(ms,qd),ms.prototype.ua=function(){Qe(this.g,"a")},ms.prototype.ta=function(m){Qe(this.g,new zc(m))},ms.prototype.sa=function(m){Qe(this.g,new na)},ms.prototype.ra=function(){Qe(this.g,"b")},pu.prototype.createWebChannel=pu.prototype.g,di.prototype.send=di.prototype.o,di.prototype.open=di.prototype.m,di.prototype.close=di.prototype.close,ZD=function(){return new pu},QD=function(){return $t()},KD=Ze,_S={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},us.NO_ERROR=0,us.TIMEOUT=8,us.HTTP_ERROR=6,m_=us,V.COMPLETE="complete",YD=V,q.EventType=J,J.OPEN="a",J.CLOSE="b",J.ERROR="c",J.MESSAGE="d",Xe.prototype.listen=Xe.prototype.K,Bf=q,Gn.prototype.listenOnce=Gn.prototype.L,Gn.prototype.getLastError=Gn.prototype.Ka,Gn.prototype.getLastErrorCode=Gn.prototype.Ba,Gn.prototype.getStatus=Gn.prototype.Z,Gn.prototype.getResponseJson=Gn.prototype.Oa,Gn.prototype.getResponseText=Gn.prototype.oa,Gn.prototype.send=Gn.prototype.ea,Gn.prototype.setWithCredentials=Gn.prototype.Ha,$D=Gn}).apply(typeof $g<"u"?$g:typeof self<"u"?self:typeof window<"u"?window:{});const Db="@firebase/firestore",kb="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ti.UNAUTHENTICATED=new Ti(null),Ti.GOOGLE_CREDENTIALS=new Ti("google-credentials-uid"),Ti.FIRST_PARTY=new Ti("first-party-uid"),Ti.MOCK_USER=new Ti("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ld="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gc=new A1("@firebase/firestore");function Eh(){return gc.logLevel}function Mt(n,...e){if(gc.logLevel<=wn.DEBUG){const t=e.map(B1);gc.debug(`Firestore (${Ld}): ${n}`,...t)}}function ba(n,...e){if(gc.logLevel<=wn.ERROR){const t=e.map(B1);gc.error(`Firestore (${Ld}): ${n}`,...t)}}function Bl(n,...e){if(gc.logLevel<=wn.WARN){const t=e.map(B1);gc.warn(`Firestore (${Ld}): ${n}`,...t)}}function B1(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jt(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,JD(n,r,t)}function JD(n,e,t){let r=`FIRESTORE (${Ld}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw ba(r),new Error(r)}function Cn(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||JD(e,i,r)}function nn(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class _t extends ka{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e3{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class SH{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ti.UNAUTHENTICATED))}shutdown(){}}class TH{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class MH{constructor(e){this.t=e,this.currentUser=Ti.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Cn(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let s=new zo;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new zo,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{Mt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Mt("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new zo)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Mt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Cn(typeof r.accessToken=="string",31837,{l:r}),new e3(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Cn(e===null||typeof e=="string",2055,{h:e}),new Ti(e)}}class AH{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ti.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class CH{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new AH(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Ti.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Ob{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class IH{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Es(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Cn(this.o===void 0,3512);const r=s=>{s.error!=null&&Mt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,Mt("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{Mt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):Mt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Ob(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Cn(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Ob(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bH(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t3(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=bH(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}}function mn(n,e){return n<e?-1:n>e?1:0}function yS(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return mn(r,i);{const s=t3(),o=RH(s.encode(Ub(n,t)),s.encode(Ub(e,t)));return o!==0?o:mn(r,i)}}t+=r>65535?2:1}return mn(n.length,e.length)}function Ub(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function RH(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return mn(n[t],e[t]);return mn(n.length,e.length)}function md(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fb="__name__";class No{constructor(e,t,r){t===void 0?t=0:t>e.length&&jt(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&jt(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return No.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof No?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=No.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return mn(e.length,t.length)}static compareSegments(e,t){const r=No.isNumericId(e),i=No.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?No.extractNumericId(e).compare(No.extractNumericId(t)):yS(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Pl.fromString(e.substring(4,e.length-2))}}class Hn extends No{construct(e,t,r){return new Hn(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new _t(Oe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new Hn(t)}static emptyPath(){return new Hn([])}}const PH=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class si extends No{construct(e,t,r){return new si(e,t,r)}static isValidIdentifier(e){return PH.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),si.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Fb}static keyField(){return new si([Fb])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new _t(Oe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new _t(Oe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new _t(Oe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new _t(Oe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new si(t)}static emptyPath(){return new si([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.path=e}static fromPath(e){return new zt(Hn.fromString(e))}static fromName(e){return new zt(Hn.fromString(e).popFirst(5))}static empty(){return new zt(Hn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Hn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Hn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new zt(new Hn(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n3(n,e,t){if(!t)throw new _t(Oe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function NH(n,e,t,r){if(e===!0&&r===!0)throw new _t(Oe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Vb(n){if(!zt.isDocumentKey(n))throw new _t(Oe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Bb(n){if(zt.isDocumentKey(n))throw new _t(Oe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function r3(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function $y(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":jt(12329,{type:typeof n})}function Cs(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new _t(Oe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=$y(n);throw new _t(Oe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Or(n,e){const t={typeString:n};return e&&(t.value=e),t}function Sm(n,e){if(!r3(n))throw new _t(Oe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new _t(Oe.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zb=-62135596800,Hb=1e6;class Kn{static now(){return Kn.fromMillis(Date.now())}static fromDate(e){return Kn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Hb);return new Kn(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new _t(Oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new _t(Oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<zb)throw new _t(Oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new _t(Oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Hb}_compareTo(e){return this.seconds===e.seconds?mn(this.nanoseconds,e.nanoseconds):mn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Kn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Sm(e,Kn._jsonSchema))return new Kn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-zb;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Kn._jsonSchemaVersion="firestore/timestamp/1.0",Kn._jsonSchema={type:Or("string",Kn._jsonSchemaVersion),seconds:Or("number"),nanoseconds:Or("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{static fromTimestamp(e){return new Kt(e)}static min(){return new Kt(new Kn(0,0))}static max(){return new Kt(new Kn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kp=-1;function LH(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Kt.fromTimestamp(r===1e9?new Kn(t+1,0):new Kn(t,r));return new zl(i,zt.empty(),e)}function DH(n){return new zl(n.readTime,n.key,kp)}class zl{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new zl(Kt.min(),zt.empty(),kp)}static max(){return new zl(Kt.max(),zt.empty(),kp)}}function kH(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=zt.comparator(n.documentKey,e.documentKey),t!==0?t:mn(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OH="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class UH{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dd(n){if(n.code!==Oe.FAILED_PRECONDITION||n.message!==OH)throw n;Mt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&jt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ge((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Ge?t:Ge.resolve(t)}catch(t){return Ge.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Ge.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Ge.reject(t)}static resolve(e){return new Ge((t,r)=>{t(e)})}static reject(e){return new Ge((t,r)=>{r(e)})}static waitFor(e){return new Ge((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},l=>r(l))}),o=!0,s===i&&t()})}static or(e){let t=Ge.resolve(!1);for(const r of e)t=t.next(i=>i?Ge.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new Ge((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;t(e[u]).next(d=>{o[u]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new Ge((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}function FH(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function kd(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this._e(r),this.ae=r=>t.writeSequenceNumber(r))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}Yy.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H1=-1;function Tm(n){return n==null}function ly(n){return n===0&&1/n==-1/0}function VH(n){return typeof n=="number"&&Number.isInteger(n)&&!ly(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i3="";function BH(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Gb(e)),e=zH(n.get(t),e);return Gb(e)}function zH(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case i3:t+="";break;default:t+=s}}return t}function Gb(n){return n+i3+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wb(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function eu(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function s3(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(e,t){this.comparator=e,this.root=t||ii.EMPTY}insert(e,t){return new lr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ii.BLACK,null,null))}remove(e){return new lr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ii.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Yg(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Yg(this.root,e,this.comparator,!1)}getReverseIterator(){return new Yg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Yg(this.root,e,this.comparator,!0)}}class Yg{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ii{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??ii.RED,this.left=i??ii.EMPTY,this.right=s??ii.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new ii(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ii.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return ii.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ii.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ii.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw jt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw jt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw jt(27949);return e+(this.isRed()?0:1)}}ii.EMPTY=null,ii.RED=!0,ii.BLACK=!1;ii.EMPTY=new class{constructor(){this.size=0}get key(){throw jt(57766)}get value(){throw jt(16141)}get color(){throw jt(16727)}get left(){throw jt(29726)}get right(){throw jt(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new ii(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e){this.comparator=e,this.data=new lr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new jb(this.data.getIterator())}getIteratorFrom(e){return new jb(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Gr)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Gr(this.comparator);return t.data=e,t}}class jb{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e){this.fields=e,e.sort(si.comparator)}static empty(){return new Ms([])}unionWith(e){let t=new Gr(si.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Ms(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return md(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o3 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new o3("Invalid base64 string: "+s):s}}(e);return new li(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new li(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return mn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}li.EMPTY_BYTE_STRING=new li("");const HH=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Hl(n){if(Cn(!!n,39018),typeof n=="string"){let e=0;const t=HH.exec(n);if(Cn(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:xr(n.seconds),nanos:xr(n.nanos)}}function xr(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Gl(n){return typeof n=="string"?li.fromBase64String(n):li.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a3="server_timestamp",l3="__type__",u3="__previous_value__",c3="__local_write_time__";function G1(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[l3])===null||t===void 0?void 0:t.stringValue)===a3}function Ky(n){const e=n.mapValue.fields[u3];return G1(e)?Ky(e):e}function Op(n){const e=Hl(n.mapValue.fields[c3].timestampValue);return new Kn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GH{constructor(e,t,r,i,s,o,a,l,u,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=d}}const uy="(default)";class Up{constructor(e,t){this.projectId=e,this.database=t||uy}static empty(){return new Up("","")}get isDefaultDatabase(){return this.database===uy}isEqual(e){return e instanceof Up&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h3="__type__",WH="__max__",Kg={mapValue:{}},d3="__vector__",cy="value";function Wl(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?G1(n)?4:qH(n)?9007199254740991:jH(n)?10:11:jt(28295,{value:n})}function $o(n,e){if(n===e)return!0;const t=Wl(n);if(t!==Wl(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Op(n).isEqual(Op(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Hl(i.timestampValue),a=Hl(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Gl(i.bytesValue).isEqual(Gl(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return xr(i.geoPointValue.latitude)===xr(s.geoPointValue.latitude)&&xr(i.geoPointValue.longitude)===xr(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return xr(i.integerValue)===xr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=xr(i.doubleValue),a=xr(s.doubleValue);return o===a?ly(o)===ly(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return md(n.arrayValue.values||[],e.arrayValue.values||[],$o);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(Wb(o)!==Wb(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!$o(o[l],a[l])))return!1;return!0}(n,e);default:return jt(52216,{left:n})}}function Fp(n,e){return(n.values||[]).find(t=>$o(t,e))!==void 0}function gd(n,e){if(n===e)return 0;const t=Wl(n),r=Wl(e);if(t!==r)return mn(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return mn(n.booleanValue,e.booleanValue);case 2:return function(s,o){const a=xr(s.integerValue||s.doubleValue),l=xr(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return qb(n.timestampValue,e.timestampValue);case 4:return qb(Op(n),Op(e));case 5:return yS(n.stringValue,e.stringValue);case 6:return function(s,o){const a=Gl(s),l=Gl(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const d=mn(a[u],l[u]);if(d!==0)return d}return mn(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const a=mn(xr(s.latitude),xr(o.latitude));return a!==0?a:mn(xr(s.longitude),xr(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Xb(n.arrayValue,e.arrayValue);case 10:return function(s,o){var a,l,u,d;const f=s.fields||{},p=o.fields||{},g=(a=f[cy])===null||a===void 0?void 0:a.arrayValue,y=(l=p[cy])===null||l===void 0?void 0:l.arrayValue,S=mn(((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0,((d=y==null?void 0:y.values)===null||d===void 0?void 0:d.length)||0);return S!==0?S:Xb(g,y)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===Kg.mapValue&&o===Kg.mapValue)return 0;if(s===Kg.mapValue)return 1;if(o===Kg.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},d=Object.keys(u);l.sort(),d.sort();for(let f=0;f<l.length&&f<d.length;++f){const p=yS(l[f],d[f]);if(p!==0)return p;const g=gd(a[l[f]],u[d[f]]);if(g!==0)return g}return mn(l.length,d.length)}(n.mapValue,e.mapValue);default:throw jt(23264,{le:t})}}function qb(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return mn(n,e);const t=Hl(n),r=Hl(e),i=mn(t.seconds,r.seconds);return i!==0?i:mn(t.nanos,r.nanos)}function Xb(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=gd(t[i],r[i]);if(s)return s}return mn(t.length,r.length)}function vd(n){return xS(n)}function xS(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Hl(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Gl(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return zt.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=xS(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${xS(t.fields[o])}`;return i+"}"}(n.mapValue):jt(61005,{value:n})}function g_(n){switch(Wl(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ky(n);return e?16+g_(e):16;case 5:return 2*n.stringValue.length;case 6:return Gl(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+g_(s),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return eu(r.fields,(s,o)=>{i+=s.length+g_(o)}),i}(n.mapValue);default:throw jt(13486,{value:n})}}function $b(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ES(n){return!!n&&"integerValue"in n}function W1(n){return!!n&&"arrayValue"in n}function Yb(n){return!!n&&"nullValue"in n}function Kb(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function v_(n){return!!n&&"mapValue"in n}function jH(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[h3])===null||t===void 0?void 0:t.stringValue)===d3}function rp(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return eu(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=rp(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=rp(n.arrayValue.values[t]);return e}return Object.assign({},n)}function qH(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===WH}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e){this.value=e}static empty(){return new Bi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!v_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=rp(t)}setAll(e){let t=si.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=rp(o):i.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());v_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return $o(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];v_(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){eu(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Bi(rp(this.value))}}function f3(n){const e=[];return eu(n.fields,(t,r)=>{const i=new si([t]);if(v_(r)){const s=f3(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Ms(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Jr(e,0,Kt.min(),Kt.min(),Kt.min(),Bi.empty(),0)}static newFoundDocument(e,t,r,i){return new Jr(e,1,t,Kt.min(),r,i,0)}static newNoDocument(e,t){return new Jr(e,2,t,Kt.min(),Kt.min(),Bi.empty(),0)}static newUnknownDocument(e,t){return new Jr(e,3,t,Kt.min(),Kt.min(),Bi.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Kt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Bi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Bi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Kt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Jr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Jr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hy{constructor(e,t){this.position=e,this.inclusive=t}}function Qb(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(s.field.isKeyField()?r=zt.comparator(zt.fromName(o.referenceValue),t.key):r=gd(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Zb(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!$o(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dy{constructor(e,t="asc"){this.field=e,this.dir=t}}function XH(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p3{}class Dr extends p3{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new YH(e,t,r):t==="array-contains"?new ZH(e,r):t==="in"?new JH(e,r):t==="not-in"?new eG(e,r):t==="array-contains-any"?new tG(e,r):new Dr(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new KH(e,r):new QH(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(gd(t,this.value)):t!==null&&Wl(this.value)===Wl(t)&&this.matchesComparison(gd(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return jt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Eo extends p3{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new Eo(e,t)}matches(e){return m3(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function m3(n){return n.op==="and"}function g3(n){return $H(n)&&m3(n)}function $H(n){for(const e of n.filters)if(e instanceof Eo)return!1;return!0}function wS(n){if(n instanceof Dr)return n.field.canonicalString()+n.op.toString()+vd(n.value);if(g3(n))return n.filters.map(e=>wS(e)).join(",");{const e=n.filters.map(t=>wS(t)).join(",");return`${n.op}(${e})`}}function v3(n,e){return n instanceof Dr?function(r,i){return i instanceof Dr&&r.op===i.op&&r.field.isEqual(i.field)&&$o(r.value,i.value)}(n,e):n instanceof Eo?function(r,i){return i instanceof Eo&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&v3(o,i.filters[a]),!0):!1}(n,e):void jt(19439)}function _3(n){return n instanceof Dr?function(t){return`${t.field.canonicalString()} ${t.op} ${vd(t.value)}`}(n):n instanceof Eo?function(t){return t.op.toString()+" {"+t.getFilters().map(_3).join(" ,")+"}"}(n):"Filter"}class YH extends Dr{constructor(e,t,r){super(e,t,r),this.key=zt.fromName(r.referenceValue)}matches(e){const t=zt.comparator(e.key,this.key);return this.matchesComparison(t)}}class KH extends Dr{constructor(e,t){super(e,"in",t),this.keys=y3("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class QH extends Dr{constructor(e,t){super(e,"not-in",t),this.keys=y3("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function y3(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>zt.fromName(r.referenceValue))}class ZH extends Dr{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return W1(t)&&Fp(t.arrayValue,this.value)}}class JH extends Dr{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Fp(this.value.arrayValue,t)}}class eG extends Dr{constructor(e,t){super(e,"not-in",t)}matches(e){if(Fp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Fp(this.value.arrayValue,t)}}class tG extends Dr{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!W1(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Fp(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nG{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Pe=null}}function Jb(n,e=null,t=[],r=[],i=null,s=null,o=null){return new nG(n,e,t,r,i,s,o)}function j1(n){const e=nn(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>wS(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Tm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>vd(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>vd(r)).join(",")),e.Pe=t}return e.Pe}function q1(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!XH(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!v3(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Zb(n.startAt,e.startAt)&&Zb(n.endAt,e.endAt)}function SS(n){return zt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function rG(n,e,t,r,i,s,o,a){return new Mm(n,e,t,r,i,s,o,a)}function Qy(n){return new Mm(n)}function eR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function x3(n){return n.collectionGroup!==null}function ip(n){const e=nn(n);if(e.Te===null){e.Te=[];const t=new Set;for(const s of e.explicitOrderBy)e.Te.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Gr(si.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Te.push(new dy(s,r))}),t.has(si.keyField().canonicalString())||e.Te.push(new dy(si.keyField(),r))}return e.Te}function Ho(n){const e=nn(n);return e.Ie||(e.Ie=iG(e,ip(n))),e.Ie}function iG(n,e){if(n.limitType==="F")return Jb(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new dy(i.field,s)});const t=n.endAt?new hy(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new hy(n.startAt.position,n.startAt.inclusive):null;return Jb(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function TS(n,e){const t=n.filters.concat([e]);return new Mm(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function MS(n,e,t){return new Mm(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Zy(n,e){return q1(Ho(n),Ho(e))&&n.limitType===e.limitType}function E3(n){return`${j1(Ho(n))}|lt:${n.limitType}`}function wh(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>_3(i)).join(", ")}]`),Tm(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>vd(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>vd(i)).join(",")),`Target(${r})`}(Ho(n))}; limitType=${n.limitType})`}function Jy(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):zt.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of ip(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=Qb(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,ip(r),i)||r.endAt&&!function(o,a,l){const u=Qb(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,ip(r),i))}(n,e)}function sG(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function w3(n){return(e,t)=>{let r=!1;for(const i of ip(n)){const s=oG(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function oG(n,e,t){const r=n.field.isKeyField()?zt.comparator(e.key,t.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?gd(l,u):jt(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return jt(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){eu(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return s3(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aG=new lr(zt.comparator);function Ra(){return aG}const S3=new lr(zt.comparator);function zf(...n){let e=S3;for(const t of n)e=e.insert(t.key,t);return e}function T3(n){let e=S3;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Xu(){return sp()}function M3(){return sp()}function sp(){return new Sc(n=>n.toString(),(n,e)=>n.isEqual(e))}const lG=new lr(zt.comparator),uG=new Gr(zt.comparator);function Sn(...n){let e=uG;for(const t of n)e=e.add(t);return e}const cG=new Gr(mn);function hG(){return cG}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X1(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ly(e)?"-0":e}}function A3(n){return{integerValue:""+n}}function dG(n,e){return VH(e)?A3(e):X1(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0{constructor(){this._=void 0}}function fG(n,e,t){return n instanceof Vp?function(i,s){const o={fields:{[l3]:{stringValue:a3},[c3]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&G1(s)&&(s=Ky(s)),s&&(o.fields[u3]=s),{mapValue:o}}(t,e):n instanceof Bp?I3(n,e):n instanceof zp?b3(n,e):function(i,s){const o=C3(i,s),a=tR(o)+tR(i.Ee);return ES(o)&&ES(i.Ee)?A3(a):X1(i.serializer,a)}(n,e)}function pG(n,e,t){return n instanceof Bp?I3(n,e):n instanceof zp?b3(n,e):t}function C3(n,e){return n instanceof fy?function(r){return ES(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Vp extends e0{}class Bp extends e0{constructor(e){super(),this.elements=e}}function I3(n,e){const t=R3(e);for(const r of n.elements)t.some(i=>$o(i,r))||t.push(r);return{arrayValue:{values:t}}}class zp extends e0{constructor(e){super(),this.elements=e}}function b3(n,e){let t=R3(e);for(const r of n.elements)t=t.filter(i=>!$o(i,r));return{arrayValue:{values:t}}}class fy extends e0{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function tR(n){return xr(n.integerValue||n.doubleValue)}function R3(n){return W1(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mG{constructor(e,t){this.field=e,this.transform=t}}function gG(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Bp&&i instanceof Bp||r instanceof zp&&i instanceof zp?md(r.elements,i.elements,$o):r instanceof fy&&i instanceof fy?$o(r.Ee,i.Ee):r instanceof Vp&&i instanceof Vp}(n.transform,e.transform)}class vG{constructor(e,t){this.version=e,this.transformResults=t}}class Ci{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ci}static exists(e){return new Ci(void 0,e)}static updateTime(e){return new Ci(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function __(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class t0{}function P3(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new n0(n.key,Ci.none()):new Am(n.key,n.data,Ci.none());{const t=n.data,r=Bi.empty();let i=new Gr(si.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new tu(n.key,r,new Ms(i.toArray()),Ci.none())}}function _G(n,e,t){n instanceof Am?function(i,s,o){const a=i.value.clone(),l=rR(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof tu?function(i,s,o){if(!__(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=rR(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(N3(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function op(n,e,t,r){return n instanceof Am?function(s,o,a,l){if(!__(s.precondition,o))return a;const u=s.value.clone(),d=iR(s.fieldTransforms,l,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof tu?function(s,o,a,l){if(!__(s.precondition,o))return a;const u=iR(s.fieldTransforms,l,o),d=o.data;return d.setAll(N3(s)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(s,o,a){return __(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function yG(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=C3(r.transform,i||null);s!=null&&(t===null&&(t=Bi.empty()),t.set(r.field,s))}return t||null}function nR(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&md(r,i,(s,o)=>gG(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Am extends t0{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class tu extends t0{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function N3(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function rR(n,e,t){const r=new Map;Cn(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,pG(o,a,t[i]))}return r}function iR(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,fG(s,o,e))}return r}class n0 extends t0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class L3 extends t0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xG{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&_G(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=op(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=op(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=M3();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;const l=P3(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(Kt.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Sn())}isEqual(e){return this.batchId===e.batchId&&md(this.mutations,e.mutations,(t,r)=>nR(t,r))&&md(this.baseMutations,e.baseMutations,(t,r)=>nR(t,r))}}class $1{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Cn(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let i=function(){return lG}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new $1(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EG{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wG{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pr,An;function D3(n){switch(n){case Oe.OK:return jt(64938);case Oe.CANCELLED:case Oe.UNKNOWN:case Oe.DEADLINE_EXCEEDED:case Oe.RESOURCE_EXHAUSTED:case Oe.INTERNAL:case Oe.UNAVAILABLE:case Oe.UNAUTHENTICATED:return!1;case Oe.INVALID_ARGUMENT:case Oe.NOT_FOUND:case Oe.ALREADY_EXISTS:case Oe.PERMISSION_DENIED:case Oe.FAILED_PRECONDITION:case Oe.ABORTED:case Oe.OUT_OF_RANGE:case Oe.UNIMPLEMENTED:case Oe.DATA_LOSS:return!0;default:return jt(15467,{code:n})}}function k3(n){if(n===void 0)return ba("GRPC error has no .code"),Oe.UNKNOWN;switch(n){case Pr.OK:return Oe.OK;case Pr.CANCELLED:return Oe.CANCELLED;case Pr.UNKNOWN:return Oe.UNKNOWN;case Pr.DEADLINE_EXCEEDED:return Oe.DEADLINE_EXCEEDED;case Pr.RESOURCE_EXHAUSTED:return Oe.RESOURCE_EXHAUSTED;case Pr.INTERNAL:return Oe.INTERNAL;case Pr.UNAVAILABLE:return Oe.UNAVAILABLE;case Pr.UNAUTHENTICATED:return Oe.UNAUTHENTICATED;case Pr.INVALID_ARGUMENT:return Oe.INVALID_ARGUMENT;case Pr.NOT_FOUND:return Oe.NOT_FOUND;case Pr.ALREADY_EXISTS:return Oe.ALREADY_EXISTS;case Pr.PERMISSION_DENIED:return Oe.PERMISSION_DENIED;case Pr.FAILED_PRECONDITION:return Oe.FAILED_PRECONDITION;case Pr.ABORTED:return Oe.ABORTED;case Pr.OUT_OF_RANGE:return Oe.OUT_OF_RANGE;case Pr.UNIMPLEMENTED:return Oe.UNIMPLEMENTED;case Pr.DATA_LOSS:return Oe.DATA_LOSS;default:return jt(39323,{code:n})}}(An=Pr||(Pr={}))[An.OK=0]="OK",An[An.CANCELLED=1]="CANCELLED",An[An.UNKNOWN=2]="UNKNOWN",An[An.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",An[An.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",An[An.NOT_FOUND=5]="NOT_FOUND",An[An.ALREADY_EXISTS=6]="ALREADY_EXISTS",An[An.PERMISSION_DENIED=7]="PERMISSION_DENIED",An[An.UNAUTHENTICATED=16]="UNAUTHENTICATED",An[An.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",An[An.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",An[An.ABORTED=10]="ABORTED",An[An.OUT_OF_RANGE=11]="OUT_OF_RANGE",An[An.UNIMPLEMENTED=12]="UNIMPLEMENTED",An[An.INTERNAL=13]="INTERNAL",An[An.UNAVAILABLE=14]="UNAVAILABLE",An[An.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SG=new Pl([4294967295,4294967295],0);function sR(n){const e=t3().encode(n),t=new XD;return t.update(e),new Uint8Array(t.digest())}function oR(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Pl([t,r],0),new Pl([i,s],0)]}class Y1{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Hf(`Invalid padding: ${t}`);if(r<0)throw new Hf(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Hf(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Hf(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Pl.fromNumber(this.fe)}pe(e,t,r){let i=e.add(t.multiply(Pl.fromNumber(r)));return i.compare(SG)===1&&(i=new Pl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=sR(e),[r,i]=oR(t);for(let s=0;s<this.hashCount;s++){const o=this.pe(r,i,s);if(!this.ye(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Y1(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.fe===0)return;const t=sR(e),[r,i]=oR(t);for(let s=0;s<this.hashCount;s++){const o=this.pe(r,i,s);this.we(o)}}we(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Hf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Cm.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new r0(Kt.min(),i,new lr(mn),Ra(),Sn())}}class Cm{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Cm(r,t,Sn(),Sn(),Sn())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.be=i}}class O3{constructor(e,t){this.targetId=e,this.De=t}}class U3{constructor(e,t,r=li.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class aR{constructor(){this.ve=0,this.Ce=lR(),this.Fe=li.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Sn(),t=Sn(),r=Sn();return this.Ce.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:jt(38017,{changeType:s})}}),new Cm(this.Fe,this.Me,e,t,r)}ke(){this.xe=!1,this.Ce=lR()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Cn(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class TG{constructor(e){this.We=e,this.Ge=new Map,this.ze=Ra(),this.je=Qg(),this.Je=Qg(),this.He=new lr(mn)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{const r=this.tt(t);switch(e.state){case 0:this.nt(t)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),r.Be(e.resumeToken));break;default:jt(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((r,i)=>{this.nt(i)&&t(i)})}it(e){const t=e.targetId,r=e.De.count,i=this.st(t);if(i){const s=i.target;if(SS(s))if(r===0){const o=new zt(s.path);this.Xe(t,o,Jr.newNoDocument(o,Kt.min()))}else Cn(r===1,20013,{expectedCount:r});else{const o=this.ot(t);if(o!==r){const a=this._t(e),l=a?this.ut(a,e,o):1;if(l!==0){this.rt(t);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,u)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let o,a;try{o=Gl(r).toUint8Array()}catch(l){if(l instanceof o3)return Bl("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Y1(o,i,s)}catch(l){return Bl(l instanceof Hf?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.fe===0?null:a}ut(e,t,r){return t.De.count===r-this.ht(e,t.targetId)?0:2}ht(e,t){const r=this.We.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const o=this.We.lt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Xe(t,s,null),i++)}),i}Pt(e){const t=new Map;this.Ge.forEach((s,o)=>{const a=this.st(o);if(a){if(s.current&&SS(a.target)){const l=new zt(a.target.path);this.Tt(l).has(o)||this.It(o,l)||this.Xe(o,l,Jr.newNoDocument(l,e))}s.Ne&&(t.set(o,s.Le()),s.ke())}});let r=Sn();this.Je.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.st(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ze.forEach((s,o)=>o.setReadTime(e));const i=new r0(e,t,this.He,this.ze,r);return this.ze=Ra(),this.je=Qg(),this.Je=Qg(),this.He=new lr(mn),i}Ze(e,t){if(!this.nt(e))return;const r=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,r),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,r){if(!this.nt(e))return;const i=this.tt(e);this.It(e,t)?i.qe(t,1):i.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),r&&(this.ze=this.ze.insert(t,r))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new aR,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Gr(mn),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Gr(mn),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||Mt("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new aR),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function Qg(){return new lr(zt.comparator)}function lR(){return new lr(zt.comparator)}const MG={asc:"ASCENDING",desc:"DESCENDING"},AG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},CG={and:"AND",or:"OR"};class IG{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function AS(n,e){return n.useProto3Json||Tm(e)?e:{value:e}}function py(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function F3(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function bG(n,e){return py(n,e.toTimestamp())}function Is(n){return Cn(!!n,49232),Kt.fromTimestamp(function(t){const r=Hl(t);return new Kn(r.seconds,r.nanos)}(n))}function K1(n,e){return CS(n,e).canonicalString()}function CS(n,e){const t=function(i){return new Hn(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function V3(n){const e=Hn.fromString(n);return Cn(j3(e),10190,{key:e.toString()}),e}function my(n,e){return K1(n.databaseId,e.path)}function ap(n,e){const t=V3(e);if(t.get(1)!==n.databaseId.projectId)throw new _t(Oe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new _t(Oe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new zt(z3(t))}function B3(n,e){return K1(n.databaseId,e)}function RG(n){const e=V3(n);return e.length===4?Hn.emptyPath():z3(e)}function IS(n){return new Hn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function z3(n){return Cn(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function uR(n,e,t){return{name:my(n,e),fields:t.value.mapValue.fields}}function PG(n,e){return"found"in e?function(r,i){Cn(!!i.found,43571),i.found.name,i.found.updateTime;const s=ap(r,i.found.name),o=Is(i.found.updateTime),a=i.found.createTime?Is(i.found.createTime):Kt.min(),l=new Bi({mapValue:{fields:i.found.fields}});return Jr.newFoundDocument(s,o,a,l)}(n,e):"missing"in e?function(r,i){Cn(!!i.missing,3894),Cn(!!i.readTime,22933);const s=ap(r,i.missing),o=Is(i.readTime);return Jr.newNoDocument(s,o)}(n,e):jt(7234,{result:e})}function NG(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:jt(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,d){return u.useProto3Json?(Cn(d===void 0||typeof d=="string",58123),li.fromBase64String(d||"")):(Cn(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),li.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const d=u.code===void 0?Oe.UNKNOWN:k3(u.code);return new _t(d,u.message||"")}(o);t=new U3(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=ap(n,r.document.name),s=Is(r.document.updateTime),o=r.document.createTime?Is(r.document.createTime):Kt.min(),a=new Bi({mapValue:{fields:r.document.fields}}),l=Jr.newFoundDocument(i,s,o,a),u=r.targetIds||[],d=r.removedTargetIds||[];t=new y_(u,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=ap(n,r.document),s=r.readTime?Is(r.readTime):Kt.min(),o=Jr.newNoDocument(i,s),a=r.removedTargetIds||[];t=new y_([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=ap(n,r.document),s=r.removedTargetIds||[];t=new y_([],s,i,null)}else{if(!("filter"in e))return jt(11601,{At:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new wG(i,s),a=r.targetId;t=new O3(a,o)}}return t}function H3(n,e){let t;if(e instanceof Am)t={update:uR(n,e.key,e.value)};else if(e instanceof n0)t={delete:my(n,e.key)};else if(e instanceof tu)t={update:uR(n,e.key,e.data),updateMask:zG(e.fieldMask)};else{if(!(e instanceof L3))return jt(16599,{Rt:e.type});t={verify:my(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Vp)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Bp)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof zp)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof fy)return{fieldPath:o.field.canonicalString(),increment:a.Ee};throw jt(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:bG(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:jt(27497)}(n,e.precondition)),t}function LG(n,e){return n&&n.length>0?(Cn(e!==void 0,14353),n.map(t=>function(i,s){let o=i.updateTime?Is(i.updateTime):Is(s);return o.isEqual(Kt.min())&&(o=Is(s)),new vG(o,i.transformResults||[])}(t,e))):[]}function DG(n,e){return{documents:[B3(n,e.path)]}}function kG(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=B3(n,i);const s=function(u){if(u.length!==0)return W3(Eo.create(u,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(d=>function(p){return{field:Sh(p.field),direction:FG(p.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=AS(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{Vt:t,parent:i}}function OG(n){let e=RG(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Cn(r===1,65062);const d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(f){const p=G3(f);return p instanceof Eo&&g3(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(p=>function(y){return new dy(Th(y.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(p))}(t.orderBy));let a=null;t.limit&&(a=function(f){let p;return p=typeof f=="object"?f.value:f,Tm(p)?null:p}(t.limit));let l=null;t.startAt&&(l=function(f){const p=!!f.before,g=f.values||[];return new hy(g,p)}(t.startAt));let u=null;return t.endAt&&(u=function(f){const p=!f.before,g=f.values||[];return new hy(g,p)}(t.endAt)),rG(e,i,o,s,a,"F",l,u)}function UG(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return jt(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function G3(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Th(t.unaryFilter.field);return Dr.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Th(t.unaryFilter.field);return Dr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Th(t.unaryFilter.field);return Dr.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Th(t.unaryFilter.field);return Dr.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return jt(61313);default:return jt(60726)}}(n):n.fieldFilter!==void 0?function(t){return Dr.create(Th(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return jt(58110);default:return jt(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Eo.create(t.compositeFilter.filters.map(r=>G3(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return jt(1026)}}(t.compositeFilter.op))}(n):jt(30097,{filter:n})}function FG(n){return MG[n]}function VG(n){return AG[n]}function BG(n){return CG[n]}function Sh(n){return{fieldPath:n.canonicalString()}}function Th(n){return si.fromServerFormat(n.fieldPath)}function W3(n){return n instanceof Dr?function(t){if(t.op==="=="){if(Kb(t.value))return{unaryFilter:{field:Sh(t.field),op:"IS_NAN"}};if(Yb(t.value))return{unaryFilter:{field:Sh(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Kb(t.value))return{unaryFilter:{field:Sh(t.field),op:"IS_NOT_NAN"}};if(Yb(t.value))return{unaryFilter:{field:Sh(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Sh(t.field),op:VG(t.op),value:t.value}}}(n):n instanceof Eo?function(t){const r=t.getFilters().map(i=>W3(i));return r.length===1?r[0]:{compositeFilter:{op:BG(t.op),filters:r}}}(n):jt(54877,{filter:n})}function zG(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function j3(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(e,t,r,i,s=Kt.min(),o=Kt.min(),a=li.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new _l(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new _l(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _l(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _l(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HG{constructor(e){this.gt=e}}function GG(n){const e=OG({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?MS(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WG{constructor(){this.Dn=new jG}addToCollectionParentIndex(e,t){return this.Dn.add(t),Ge.resolve()}getCollectionParents(e,t){return Ge.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return Ge.resolve()}deleteFieldIndex(e,t){return Ge.resolve()}deleteAllFieldIndexes(e){return Ge.resolve()}createTargetIndexes(e,t){return Ge.resolve()}getDocumentsMatchingTarget(e,t){return Ge.resolve(null)}getIndexType(e,t){return Ge.resolve(0)}getFieldIndexes(e,t){return Ge.resolve([])}getNextCollectionGroupToUpdate(e){return Ge.resolve(null)}getMinOffset(e,t){return Ge.resolve(zl.min())}getMinOffsetFromCollectionGroup(e,t){return Ge.resolve(zl.min())}updateCollectionGroup(e,t,r){return Ge.resolve()}updateIndexEntries(e,t){return Ge.resolve()}}class jG{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Gr(Hn.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Gr(Hn.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},q3=41943040;class ts{static withCacheSize(e){return new ts(e,ts.DEFAULT_COLLECTION_PERCENTILE,ts.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ts.DEFAULT_COLLECTION_PERCENTILE=10,ts.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ts.DEFAULT=new ts(q3,ts.DEFAULT_COLLECTION_PERCENTILE,ts.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ts.DISABLED=new ts(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new _d(0)}static ur(){return new _d(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hR="LruGarbageCollector",qG=1048576;function dR([n,e],[t,r]){const i=mn(n,t);return i===0?mn(e,r):i}class XG{constructor(e){this.Tr=e,this.buffer=new Gr(dR),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();dR(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class $G{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){Mt(hR,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){kd(t)?Mt(hR,"Ignoring IndexedDB error during garbage collection: ",t):await Dd(t)}await this.Rr(3e5)})}}class YG{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return Ge.resolve(Yy.ue);const r=new XG(t);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Mt("LruGarbageCollector","Garbage collection skipped; disabled"),Ge.resolve(cR)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Mt("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),cR):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,i,s,o,a,l,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(Mt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(s=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(u=Date.now(),Eh()<=wn.DEBUG&&Mt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(u-l)+`ms
Total Duration: ${u-d}ms`),Ge.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}}function KG(n,e){return new YG(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QG{constructor(){this.changes=new Sc(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Jr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?Ge.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZG{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JG{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&op(r.mutation,i,Ms.empty(),Kn.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Sn()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Sn()){const i=Xu();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=zf();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Xu();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Sn()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=Ra();const o=sp(),a=function(){return sp()}();return t.forEach((l,u)=>{const d=r.get(u.key);i.has(u.key)&&(d===void 0||d.mutation instanceof tu)?s=s.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),op(d.mutation,u,d.mutation.getFieldMask(),Kn.now())):o.set(u.key,Ms.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,d)=>o.set(u,d)),t.forEach((u,d)=>{var f;return a.set(u,new ZG(d,(f=o.get(u))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){const r=sp();let i=new lr((o,a)=>o-a),s=Sn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=t.get(l);if(u===null)return;let d=r.get(l)||Ms.empty();d=a.applyToLocalView(u,d),r.set(l,d);const f=(i.get(a.batchId)||Sn()).add(l);i=i.insert(a.batchId,f)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,d=l.value,f=M3();d.forEach(p=>{if(!s.has(p)){const g=P3(t.get(p),r.get(p));g!==null&&f.set(p,g),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return Ge.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return zt.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):x3(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):Ge.resolve(Xu());let a=kp,l=s;return o.next(u=>Ge.forEach(u,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(d)?Ge.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{l=l.insert(d,p)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Sn())).next(d=>({batchId:a,changes:T3(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new zt(t)).next(r=>{let i=zf();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=zf();return this.indexManager.getCollectionParents(e,s).next(a=>Ge.forEach(a,l=>{const u=function(f,p){return new Mm(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(d=>{d.forEach((f,p)=>{o=o.insert(f,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((l,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,Jr.newInvalidDocument(d)))});let a=zf();return o.forEach((l,u)=>{const d=s.get(l);d!==void 0&&op(d.mutation,u,Ms.empty(),Kn.now()),Jy(t,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e8{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return Ge.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Is(i.createTime)}}(t)),Ge.resolve()}getNamedQuery(e,t){return Ge.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,function(i){return{name:i.name,query:GG(i.bundledQuery),readTime:Is(i.readTime)}}(t)),Ge.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t8{constructor(){this.overlays=new lr(zt.comparator),this.kr=new Map}getOverlay(e,t){return Ge.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Xu();return Ge.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.wt(e,t,s)}),Ge.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.kr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(r)),Ge.resolve()}getOverlaysForCollection(e,t,r){const i=Xu(),s=t.length+1,o=new zt(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return Ge.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new lr((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let d=s.get(u.largestBatchId);d===null&&(d=Xu(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const a=Xu(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=i)););return Ge.resolve(a)}wt(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new EG(t,r));let s=this.kr.get(t);s===void 0&&(s=Sn(),this.kr.set(t,s)),this.kr.set(t,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n8{constructor(){this.sessionToken=li.EMPTY_BYTE_STRING}getSessionToken(e){return Ge.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ge.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q1{constructor(){this.qr=new Gr(Qr.Qr),this.$r=new Gr(Qr.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const r=new Qr(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Wr(new Qr(e,t))}Gr(e,t){e.forEach(r=>this.removeReference(r,t))}zr(e){const t=new zt(new Hn([])),r=new Qr(t,e),i=new Qr(t,e+1),s=[];return this.$r.forEachInRange([r,i],o=>{this.Wr(o),s.push(o.key)}),s}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new zt(new Hn([])),r=new Qr(t,e),i=new Qr(t,e+1);let s=Sn();return this.$r.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new Qr(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Qr{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return zt.comparator(e.key,t.key)||mn(e.Hr,t.Hr)}static Ur(e,t){return mn(e.Hr,t.Hr)||zt.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r8{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Gr(Qr.Qr)}checkEmpty(e){return Ge.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new xG(s,t,r,i);this.mutationQueue.push(o);for(const a of i)this.Yr=this.Yr.add(new Qr(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Ge.resolve(o)}lookupMutationBatch(e,t){return Ge.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.Xr(r),s=i<0?0:i;return Ge.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Ge.resolve(this.mutationQueue.length===0?H1:this.er-1)}getAllMutationBatches(e){return Ge.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Qr(t,0),i=new Qr(t,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([r,i],o=>{const a=this.Zr(o.Hr);s.push(a)}),Ge.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Gr(mn);return t.forEach(i=>{const s=new Qr(i,0),o=new Qr(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,o],a=>{r=r.add(a.Hr)})}),Ge.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;zt.isDocumentKey(s)||(s=s.child(""));const o=new Qr(new zt(s),0);let a=new Gr(mn);return this.Yr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.Hr)),!0)},o),Ge.resolve(this.ei(a))}ei(e){const t=[];return e.forEach(r=>{const i=this.Zr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Cn(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return Ge.forEach(t.mutations,i=>{const s=new Qr(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,t){const r=new Qr(t,0),i=this.Yr.firstAfterOrEqual(r);return Ge.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ge.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i8{constructor(e){this.ni=e,this.docs=function(){return new lr(zt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return Ge.resolve(r?r.document.mutableCopy():Jr.newInvalidDocument(t))}getEntries(e,t){let r=Ra();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Jr.newInvalidDocument(i))}),Ge.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Ra();const o=t.path,a=new zt(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:d}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||kH(DH(d),r)<=0||(i.has(d.key)||Jy(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return Ge.resolve(s)}getAllFromCollectionGroup(e,t,r,i){jt(9500)}ri(e,t){return Ge.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new s8(this)}getSize(e){return Ge.resolve(this.size)}}class s8 extends QG{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Or.addEntry(e,i)):this.Or.removeEntry(r)}),Ge.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o8{constructor(e){this.persistence=e,this.ii=new Sc(t=>j1(t),q1),this.lastRemoteSnapshotVersion=Kt.min(),this.highestTargetId=0,this.si=0,this.oi=new Q1,this.targetCount=0,this._i=_d.ar()}forEachTarget(e,t){return this.ii.forEach((r,i)=>t(i)),Ge.resolve()}getLastRemoteSnapshotVersion(e){return Ge.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ge.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),Ge.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),Ge.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new _d(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,Ge.resolve()}updateTargetData(e,t){return this.hr(t),Ge.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,Ge.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.ii.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.ii.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),Ge.waitFor(s).next(()=>i)}getTargetCount(e){return Ge.resolve(this.targetCount)}getTargetData(e,t){const r=this.ii.get(t)||null;return Ge.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),Ge.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),Ge.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),Ge.resolve()}getMatchingKeysForTargetId(e,t){const r=this.oi.Jr(t);return Ge.resolve(r)}containsKey(e,t){return Ge.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X3{constructor(e,t){this.ai={},this.overlays={},this.ui=new Yy(0),this.ci=!1,this.ci=!0,this.li=new n8,this.referenceDelegate=e(this),this.hi=new o8(this),this.indexManager=new WG,this.remoteDocumentCache=function(i){return new i8(i)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new HG(t),this.Ti=new e8(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new t8,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new r8(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){Mt("MemoryPersistence","Starting transaction:",e);const i=new a8(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(e,t){return Ge.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,t)))}}class a8 extends UH{constructor(e){super(),this.currentSequenceNumber=e}}class Z1{constructor(e){this.persistence=e,this.Ai=new Q1,this.Ri=null}static Vi(e){return new Z1(e)}get mi(){if(this.Ri)return this.Ri;throw jt(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),Ge.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),Ge.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),Ge.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(i=>this.mi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.mi.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ge.forEach(this.mi,r=>{const i=zt.fromPath(r);return this.fi(e,i).next(s=>{s||t.removeEntry(i,Kt.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return Ge.or([()=>Ge.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class gy{constructor(e,t){this.persistence=e,this.gi=new Sc(r=>BH(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=KG(this,t)}static Vi(e,t){return new gy(e,t)}Ii(){}di(e){return Ge.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}yr(e){let t=0;return this.gr(e,r=>{t++}).next(()=>t)}gr(e,t){return Ge.forEach(this.gi,(r,i)=>this.Sr(e,r,i).next(s=>s?Ge.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ri(e,o=>this.Sr(e,o,t).next(a=>{a||(r++,s.removeEntry(o,Kt.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),Ge.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),Ge.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),Ge.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),Ge.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=g_(e.data.value)),t}Sr(e,t,r){return Ge.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.gi.get(t);return Ge.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=i}static Es(e,t){let r=Sn(),i=Sn();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new J1(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l8{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u8{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return BB()?8:FH(Pi())>0?6:4}()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.ps(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ys(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new l8;return this.ws(e,t,o).next(a=>{if(s.result=a,this.Rs)return this.Ss(e,t,o,a.size)})}).next(()=>s.result)}Ss(e,t,r,i){return r.documentReadCount<this.Vs?(Eh()<=wn.DEBUG&&Mt("QueryEngine","SDK will not create cache indexes for query:",wh(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Ge.resolve()):(Eh()<=wn.DEBUG&&Mt("QueryEngine","Query:",wh(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(Eh()<=wn.DEBUG&&Mt("QueryEngine","The SDK decides to create cache indexes for query:",wh(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ho(t))):Ge.resolve())}ps(e,t){if(eR(t))return Ge.resolve(null);let r=Ho(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=MS(t,null,"F"),r=Ho(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Sn(...s);return this.gs.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.bs(t,a);return this.Ds(t,u,o,l.readTime)?this.ps(e,MS(t,null,"F")):this.vs(e,u,t,l)}))})))}ys(e,t,r,i){return eR(t)||i.isEqual(Kt.min())?Ge.resolve(null):this.gs.getDocuments(e,r).next(s=>{const o=this.bs(t,s);return this.Ds(t,o,r,i)?Ge.resolve(null):(Eh()<=wn.DEBUG&&Mt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),wh(t)),this.vs(e,o,t,LH(i,kp)).next(a=>a))})}bs(e,t){let r=new Gr(w3(e));return t.forEach((i,s)=>{Jy(e,s)&&(r=r.add(s))}),r}Ds(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ws(e,t,r){return Eh()<=wn.DEBUG&&Mt("QueryEngine","Using full collection scan to execute query:",wh(t)),this.gs.getDocumentsMatchingQuery(e,t,zl.min(),r)}vs(e,t,r,i){return this.gs.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eM="LocalStore",c8=3e8;class h8{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.Fs=new lr(mn),this.Ms=new Sc(s=>j1(s),q1),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new JG(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}}function d8(n,e,t,r){return new h8(n,e,t,r)}async function $3(n,e){const t=nn(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Ns(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=Sn();for(const u of i){o.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}for(const u of s){a.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(r,l).next(u=>({Bs:u,removedBatchIds:o,addedBatchIds:a}))})})}function f8(n,e){const t=nn(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.Os.newChangeBuffer({trackRemovals:!0});return function(a,l,u,d){const f=u.batch,p=f.keys();let g=Ge.resolve();return p.forEach(y=>{g=g.next(()=>d.getEntry(l,y)).next(S=>{const x=u.docVersions.get(y);Cn(x!==null,48541),S.version.compareTo(x)<0&&(f.applyToRemoteDocument(S,u),S.isValidDocument()&&(S.setReadTime(u.commitVersion),d.addEntry(S)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Sn();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Y3(n){const e=nn(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function p8(n,e){const t=nn(n),r=e.snapshotVersion;let i=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.Os.newChangeBuffer({trackRemovals:!0});i=t.Fs;const a=[];e.targetChanges.forEach((d,f)=>{const p=i.get(f);if(!p)return;a.push(t.hi.removeMatchingKeys(s,d.removedDocuments,f).next(()=>t.hi.addMatchingKeys(s,d.addedDocuments,f)));let g=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?g=g.withResumeToken(li.EMPTY_BYTE_STRING,Kt.min()).withLastLimboFreeSnapshotVersion(Kt.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,r)),i=i.insert(f,g),function(S,x,v){return S.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=c8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(p,g,d)&&a.push(t.hi.updateTargetData(s,g))});let l=Ra(),u=Sn();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(m8(s,o,e.documentUpdates).next(d=>{l=d.Ls,u=d.ks})),!r.isEqual(Kt.min())){const d=t.hi.getLastRemoteSnapshotVersion(s).next(f=>t.hi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return Ge.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(t.Fs=i,s))}function m8(n,e,t){let r=Sn(),i=Sn();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Ra();return t.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(Kt.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):Mt(eM,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{Ls:o,ks:i}})}function g8(n,e){const t=nn(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=H1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function v8(n,e){const t=nn(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.hi.getTargetData(r,e).next(s=>s?(i=s,Ge.resolve(i)):t.hi.allocateTargetId(r).next(o=>(i=new _l(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(r.targetId,r),t.Ms.set(e,r.targetId)),r})}async function bS(n,e,t){const r=nn(n),i=r.Fs.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!kd(o))throw o;Mt(eM,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(i.target)}function fR(n,e,t){const r=nn(n);let i=Kt.min(),s=Sn();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,d){const f=nn(l),p=f.Ms.get(d);return p!==void 0?Ge.resolve(f.Fs.get(p)):f.hi.getTargetData(u,d)}(r,o,Ho(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,t?i:Kt.min(),t?s:Sn())).next(a=>(_8(r,sG(e),a),{documents:a,qs:s})))}function _8(n,e,t){let r=n.xs.get(e)||Kt.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.xs.set(e,r)}class pR{constructor(){this.activeTargetIds=hG()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class y8{constructor(){this.Fo=new pR,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new pR,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x8{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mR="ConnectivityMonitor";class gR{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Mt(mR,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){Mt(mR,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zg=null;function RS(){return Zg===null?Zg=function(){return 268435456+Math.round(2147483648*Math.random())}():Zg++,"0x"+Zg.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mE="RestConnection",E8={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class w8{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===uy?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,s){const o=RS(),a=this.Go(e,t.toUriEncodedString());Mt(mE,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(l,i,s);const{host:u}=new URL(a),d=Rd(u);return this.jo(e,a,l,r,d).then(f=>(Mt(mE,`Received RPC '${e}' ${o}: `,f),f),f=>{throw Bl(mE,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}Jo(e,t,r,i,s,o){return this.Wo(e,t,r,i,s)}zo(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ld}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}Go(e,t){const r=E8[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S8{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yi="WebChannelConnection";class T8 extends w8{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,i,s){const o=RS();return new Promise((a,l)=>{const u=new $D;u.setWithCredentials(!0),u.listenOnce(YD.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case m_.NO_ERROR:const f=u.getResponseJson();Mt(yi,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case m_.TIMEOUT:Mt(yi,`RPC '${e}' ${o} timed out`),l(new _t(Oe.DEADLINE_EXCEEDED,"Request time out"));break;case m_.HTTP_ERROR:const p=u.getStatus();if(Mt(yi,`RPC '${e}' ${o} failed with status:`,p,"response text:",u.getResponseText()),p>0){let g=u.getResponseJson();Array.isArray(g)&&(g=g[0]);const y=g==null?void 0:g.error;if(y&&y.status&&y.message){const S=function(v){const w=v.toLowerCase().replace(/_/g,"-");return Object.values(Oe).indexOf(w)>=0?w:Oe.UNKNOWN}(y.status);l(new _t(S,y.message))}else l(new _t(Oe.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new _t(Oe.UNAVAILABLE,"Connection failed."));break;default:jt(9055,{c_:e,streamId:o,l_:u.getLastErrorCode(),h_:u.getLastError()})}}finally{Mt(yi,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(i);Mt(yi,`RPC '${e}' ${o} sending request:`,i),u.send(t,"POST",d,r,15)})}P_(e,t,r){const i=RS(),s=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=ZD(),a=QD(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.zo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const d=s.join("");Mt(yi,`Creating RPC '${e}' stream ${i}: ${d}`,l);const f=o.createWebChannel(d,l);this.T_(f);let p=!1,g=!1;const y=new S8({Ho:x=>{g?Mt(yi,`Not sending because RPC '${e}' stream ${i} is closed:`,x):(p||(Mt(yi,`Opening RPC '${e}' stream ${i} transport.`),f.open(),p=!0),Mt(yi,`RPC '${e}' stream ${i} sending:`,x),f.send(x))},Yo:()=>f.close()}),S=(x,v,w)=>{x.listen(v,T=>{try{w(T)}catch(R){setTimeout(()=>{throw R},0)}})};return S(f,Bf.EventType.OPEN,()=>{g||(Mt(yi,`RPC '${e}' stream ${i} transport opened.`),y.s_())}),S(f,Bf.EventType.CLOSE,()=>{g||(g=!0,Mt(yi,`RPC '${e}' stream ${i} transport closed`),y.__(),this.I_(f))}),S(f,Bf.EventType.ERROR,x=>{g||(g=!0,Bl(yi,`RPC '${e}' stream ${i} transport errored. Name:`,x.name,"Message:",x.message),y.__(new _t(Oe.UNAVAILABLE,"The operation could not be completed")))}),S(f,Bf.EventType.MESSAGE,x=>{var v;if(!g){const w=x.data[0];Cn(!!w,16349);const T=w,R=(T==null?void 0:T.error)||((v=T[0])===null||v===void 0?void 0:v.error);if(R){Mt(yi,`RPC '${e}' stream ${i} received error:`,R);const U=R.status;let N=function(M){const A=Pr[M];if(A!==void 0)return k3(A)}(U),P=R.message;N===void 0&&(N=Oe.INTERNAL,P="Unknown error status: "+U+" with message "+R.message),g=!0,y.__(new _t(N,P)),f.close()}else Mt(yi,`RPC '${e}' stream ${i} received:`,w),y.a_(w)}}),S(a,KD.STAT_EVENT,x=>{x.stat===_S.PROXY?Mt(yi,`RPC '${e}' stream ${i} detected buffering proxy`):x.stat===_S.NOPROXY&&Mt(yi,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.o_()},0),y}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}}function gE(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i0(n){return new IG(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tM{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=i,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,t-r);i>0&&Mt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vR="PersistentStream";class K3{constructor(e,t,r,i,s,o,a,l){this.Fi=e,this.w_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new tM(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===Oe.RESOURCE_EXHAUSTED?(ba(t.toString()),ba("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===Oe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===t&&this.W_(r,i)},r=>{e(()=>{const i=new _t(Oe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(e,t){const r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return Mt(vR,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(Mt(vR,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class M8 extends K3{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=NG(this.serializer,e),r=function(s){if(!("targetChange"in s))return Kt.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Kt.min():o.readTime?Is(o.readTime):Kt.min()}(e);return this.listener.J_(t,r)}H_(e){const t={};t.database=IS(this.serializer),t.addTarget=function(s,o){let a;const l=o.target;if(a=SS(l)?{documents:DG(s,l)}:{query:kG(s,l).Vt},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=F3(s,o.resumeToken);const u=AS(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(Kt.min())>0){a.readTime=py(s,o.snapshotVersion.toTimestamp());const u=AS(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=UG(this.serializer,e);r&&(t.labels=r),this.k_(t)}Y_(e){const t={};t.database=IS(this.serializer),t.removeTarget=e,this.k_(t)}}class A8 extends K3{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return Cn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Cn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){Cn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=LG(e.writeResults,e.commitTime),r=Is(e.commitTime);return this.listener.ta(r,t)}na(){const e={};e.database=IS(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>H3(this.serializer,r))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C8{}class I8 extends C8{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new _t(Oe.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(e,CS(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new _t(Oe.UNKNOWN,s.toString())})}Jo(e,t,r,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Jo(e,CS(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new _t(Oe.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class b8{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(ba(t),this._a=!1):Mt("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vc="RemoteStore";class R8{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(o=>{r.enqueueAndForget(async()=>{Tc(this)&&(Mt(vc,"Restarting streams for network reachability change."),await async function(l){const u=nn(l);u.Ia.add(4),await Im(u),u.Aa.set("Unknown"),u.Ia.delete(4),await s0(u)}(this))})}),this.Aa=new b8(r,i)}}async function s0(n){if(Tc(n))for(const e of n.da)await e(!0)}async function Im(n){for(const e of n.da)await e(!1)}function Q3(n,e){const t=nn(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),sM(t)?iM(t):Od(t).x_()&&rM(t,e))}function nM(n,e){const t=nn(n),r=Od(t);t.Ta.delete(e),r.x_()&&Z3(t,e),t.Ta.size===0&&(r.x_()?r.B_():Tc(t)&&t.Aa.set("Unknown"))}function rM(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Kt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Od(n).H_(e)}function Z3(n,e){n.Ra.$e(e),Od(n).Y_(e)}function iM(n){n.Ra=new TG({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),Od(n).start(),n.Aa.aa()}function sM(n){return Tc(n)&&!Od(n).M_()&&n.Ta.size>0}function Tc(n){return nn(n).Ia.size===0}function J3(n){n.Ra=void 0}async function P8(n){n.Aa.set("Online")}async function N8(n){n.Ta.forEach((e,t)=>{rM(n,e)})}async function L8(n,e){J3(n),sM(n)?(n.Aa.la(e),iM(n)):n.Aa.set("Unknown")}async function D8(n,e,t){if(n.Aa.set("Online"),e instanceof U3&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ta.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ta.delete(a),i.Ra.removeTarget(a))}(n,e)}catch(r){Mt(vc,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await vy(n,r)}else if(e instanceof y_?n.Ra.Ye(e):e instanceof O3?n.Ra.it(e):n.Ra.et(e),!t.isEqual(Kt.min()))try{const r=await Y3(n.localStore);t.compareTo(r)>=0&&await function(s,o){const a=s.Ra.Pt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.Ta.get(u);d&&s.Ta.set(u,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const d=s.Ta.get(l);if(!d)return;s.Ta.set(l,d.withResumeToken(li.EMPTY_BYTE_STRING,d.snapshotVersion)),Z3(s,l);const f=new _l(d.target,l,u,d.sequenceNumber);rM(s,f)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){Mt(vc,"Failed to raise snapshot:",r),await vy(n,r)}}async function vy(n,e,t){if(!kd(e))throw e;n.Ia.add(1),await Im(n),n.Aa.set("Offline"),t||(t=()=>Y3(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{Mt(vc,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await s0(n)})}function ek(n,e){return e().catch(t=>vy(n,t,e))}async function o0(n){const e=nn(n),t=jl(e);let r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:H1;for(;k8(e);)try{const i=await g8(e.localStore,r);if(i===null){e.Pa.length===0&&t.B_();break}r=i.batchId,O8(e,i)}catch(i){await vy(e,i)}tk(e)&&nk(e)}function k8(n){return Tc(n)&&n.Pa.length<10}function O8(n,e){n.Pa.push(e);const t=jl(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function tk(n){return Tc(n)&&!jl(n).M_()&&n.Pa.length>0}function nk(n){jl(n).start()}async function U8(n){jl(n).na()}async function F8(n){const e=jl(n);for(const t of n.Pa)e.X_(t.mutations)}async function V8(n,e,t){const r=n.Pa.shift(),i=$1.from(r,e,t);await ek(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await o0(n)}async function B8(n,e){e&&jl(n).Z_&&await async function(r,i){if(function(o){return D3(o)&&o!==Oe.ABORTED}(i.code)){const s=r.Pa.shift();jl(r).N_(),await ek(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await o0(r)}}(n,e),tk(n)&&nk(n)}async function _R(n,e){const t=nn(n);t.asyncQueue.verifyOperationInProgress(),Mt(vc,"RemoteStore received new credentials");const r=Tc(t);t.Ia.add(3),await Im(t),r&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await s0(t)}async function z8(n,e){const t=nn(n);e?(t.Ia.delete(2),await s0(t)):e||(t.Ia.add(2),await Im(t),t.Aa.set("Unknown"))}function Od(n){return n.Va||(n.Va=function(t,r,i){const s=nn(t);return s.ia(),new M8(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Zo:P8.bind(null,n),e_:N8.bind(null,n),n_:L8.bind(null,n),J_:D8.bind(null,n)}),n.da.push(async e=>{e?(n.Va.N_(),sM(n)?iM(n):n.Aa.set("Unknown")):(await n.Va.stop(),J3(n))})),n.Va}function jl(n){return n.ma||(n.ma=function(t,r,i){const s=nn(t);return s.ia(),new A8(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:U8.bind(null,n),n_:B8.bind(null,n),ea:F8.bind(null,n),ta:V8.bind(null,n)}),n.da.push(async e=>{e?(n.ma.N_(),await o0(n)):(await n.ma.stop(),n.Pa.length>0&&(Mt(vc,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))})),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oM{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new zo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,a=new oM(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new _t(Oe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function aM(n,e){if(ba("AsyncQueue",`${e}: ${n}`),kd(n))return new _t(Oe.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{static emptySet(e){return new id(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||zt.comparator(t.key,r.key):(t,r)=>zt.comparator(t.key,r.key),this.keyedMap=zf(),this.sortedSet=new lr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof id)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new id;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(){this.fa=new lr(zt.comparator)}track(e){const t=e.doc.key,r=this.fa.get(t);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(t,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(t):e.type===1&&r.type===2?this.fa=this.fa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):jt(63341,{At:e,ga:r}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal((t,r)=>{e.push(r)}),e}}class yd{constructor(e,t,r,i,s,o,a,l,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new yd(e,t,id.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Zy(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H8{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class G8{constructor(){this.queries=xR(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){const i=nn(t),s=i.queries;i.queries=xR(),s.forEach((o,a)=>{for(const l of a.wa)l.onError(r)})})(this,new _t(Oe.ABORTED,"Firestore shutting down"))}}function xR(){return new Sc(n=>E3(n),Zy)}async function lM(n,e){const t=nn(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.Sa()&&e.ba()&&(r=2):(s=new H8,r=e.ba()?0:1);try{switch(r){case 0:s.ya=await t.onListen(i,!0);break;case 1:s.ya=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const a=aM(o,`Initialization of query '${wh(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.wa.push(e),e.va(t.onlineState),s.ya&&e.Ca(s.ya)&&cM(t)}async function uM(n,e){const t=nn(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const o=s.wa.indexOf(e);o>=0&&(s.wa.splice(o,1),s.wa.length===0?i=e.ba()?0:1:!s.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function W8(n,e){const t=nn(n);let r=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const a of o.wa)a.Ca(i)&&(r=!0);o.ya=i}}r&&cM(t)}function j8(n,e,t){const r=nn(n),i=r.queries.get(e);if(i)for(const s of i.wa)s.onError(t);r.queries.delete(e)}function cM(n){n.Da.forEach(e=>{e.next()})}var PS,ER;(ER=PS||(PS={})).Fa="default",ER.Cache="cache";class hM{constructor(e,t,r){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new yd(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const r=t!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=yd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==PS.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e){this.key=e}}class ik{constructor(e){this.key=e}}class q8{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Sn(),this.mutatedKeys=Sn(),this.Xa=w3(e),this.eu=new id(this.Xa)}get tu(){return this.Ha}nu(e,t){const r=t?t.ru:new yR,i=t?t.eu:this.eu;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,f)=>{const p=i.get(d),g=Jy(this.query,f)?f:null,y=!!p&&this.mutatedKeys.has(p.key),S=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let x=!1;p&&g?p.data.isEqual(g.data)?y!==S&&(r.track({type:3,doc:g}),x=!0):this.iu(p,g)||(r.track({type:2,doc:g}),x=!0,(l&&this.Xa(g,l)>0||u&&this.Xa(g,u)<0)&&(a=!0)):!p&&g?(r.track({type:0,doc:g}),x=!0):p&&!g&&(r.track({type:1,doc:p}),x=!0,(l||u)&&(a=!0)),x&&(g?(o=o.add(g),s=S?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{eu:o,ru:r,Ds:a,mutatedKeys:s}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const o=e.ru.pa();o.sort((d,f)=>function(g,y){const S=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return jt(20277,{At:x})}};return S(g)-S(y)}(d.type,f.type)||this.Xa(d.doc,f.doc)),this.su(r),i=i!=null&&i;const a=t&&!i?this.ou():[],l=this.Za.size===0&&this.current&&!i?1:0,u=l!==this.Ya;return this.Ya=l,o.length!==0||u?{snapshot:new yd(this.query,e.eu,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:a}:{_u:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new yR,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=Sn(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});const t=[];return e.forEach(r=>{this.Za.has(r)||t.push(new ik(r))}),this.Za.forEach(r=>{e.has(r)||t.push(new rk(r))}),t}uu(e){this.Ha=e.qs,this.Za=Sn();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return yd.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const dM="SyncEngine";class X8{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class $8{constructor(e){this.key=e,this.lu=!1}}class Y8{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new Sc(a=>E3(a),Zy),this.Tu=new Map,this.Iu=new Set,this.du=new lr(zt.comparator),this.Eu=new Map,this.Au=new Q1,this.Ru={},this.Vu=new Map,this.mu=_d.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function K8(n,e,t=!0){const r=ck(n);let i;const s=r.Pu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=await sk(r,e,t,!0),i}async function Q8(n,e){const t=ck(n);await sk(t,e,!0,!1)}async function sk(n,e,t,r){const i=await v8(n.localStore,Ho(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let a;return r&&(a=await Z8(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&Q3(n.remoteStore,i),a}async function Z8(n,e,t,r,i){n.gu=(f,p,g)=>async function(S,x,v,w){let T=x.view.nu(v);T.Ds&&(T=await fR(S.localStore,x.query,!1).then(({documents:P})=>x.view.nu(P,T)));const R=w&&w.targetChanges.get(x.targetId),U=w&&w.targetMismatches.get(x.targetId)!=null,N=x.view.applyChanges(T,S.isPrimaryClient,R,U);return SR(S,x.targetId,N._u),N.snapshot}(n,f,p,g);const s=await fR(n.localStore,e,!0),o=new q8(e,s.qs),a=o.nu(s.documents),l=Cm.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=o.applyChanges(a,n.isPrimaryClient,l);SR(n,t,u._u);const d=new X8(e,t,o);return n.Pu.set(e,d),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),u.snapshot}async function J8(n,e,t){const r=nn(n),i=r.Pu.get(e),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(o=>!Zy(o,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await bS(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&nM(r.remoteStore,i.targetId),NS(r,i.targetId)}).catch(Dd)):(NS(r,i.targetId),await bS(r.localStore,i.targetId,!0))}async function eW(n,e){const t=nn(n),r=t.Pu.get(e),i=t.Tu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),nM(t.remoteStore,r.targetId))}async function tW(n,e,t){const r=lW(n);try{const i=await function(o,a){const l=nn(o),u=Kn.now(),d=a.reduce((g,y)=>g.add(y.key),Sn());let f,p;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let y=Ra(),S=Sn();return l.Os.getEntries(g,d).next(x=>{y=x,y.forEach((v,w)=>{w.isValidDocument()||(S=S.add(v))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,y)).next(x=>{f=x;const v=[];for(const w of a){const T=yG(w,f.get(w.key).overlayedDocument);T!=null&&v.push(new tu(w.key,T,f3(T.value.mapValue),Ci.exists(!0)))}return l.mutationQueue.addMutationBatch(g,u,v,a)}).next(x=>{p=x;const v=x.applyToLocalDocumentSet(f,S);return l.documentOverlayCache.saveOverlays(g,x.batchId,v)})}).then(()=>({batchId:p.batchId,changes:T3(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Ru[o.currentUser.toKey()];u||(u=new lr(mn)),u=u.insert(a,l),o.Ru[o.currentUser.toKey()]=u}(r,i.batchId,t),await bm(r,i.changes),await o0(r.remoteStore)}catch(i){const s=aM(i,"Failed to persist write");t.reject(s)}}async function ok(n,e){const t=nn(n);try{const r=await p8(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.Eu.get(s);o&&(Cn(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.lu=!0:i.modifiedDocuments.size>0?Cn(o.lu,14607):i.removedDocuments.size>0&&(Cn(o.lu,42227),o.lu=!1))}),await bm(t,r,e)}catch(r){await Dd(r)}}function wR(n,e,t){const r=nn(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Pu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=nn(o);l.onlineState=a;let u=!1;l.queries.forEach((d,f)=>{for(const p of f.wa)p.va(a)&&(u=!0)}),u&&cM(l)}(r.eventManager,e),i.length&&r.hu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function nW(n,e,t){const r=nn(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Eu.get(e),s=i&&i.key;if(s){let o=new lr(zt.comparator);o=o.insert(s,Jr.newNoDocument(s,Kt.min()));const a=Sn().add(s),l=new r0(Kt.min(),new Map,new lr(mn),o,a);await ok(r,l),r.du=r.du.remove(s),r.Eu.delete(e),fM(r)}else await bS(r.localStore,e,!1).then(()=>NS(r,e,t)).catch(Dd)}async function rW(n,e){const t=nn(n),r=e.batch.batchId;try{const i=await f8(t.localStore,e);lk(t,r,null),ak(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await bm(t,i)}catch(i){await Dd(i)}}async function iW(n,e,t){const r=nn(n);try{const i=await function(o,a){const l=nn(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return l.mutationQueue.lookupMutationBatch(u,a).next(f=>(Cn(f!==null,37113),d=f.keys(),l.mutationQueue.removeMutationBatch(u,f))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>l.localDocuments.getDocuments(u,d))})}(r.localStore,e);lk(r,e,t),ak(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await bm(r,i)}catch(i){await Dd(i)}}function ak(n,e){(n.Vu.get(e)||[]).forEach(t=>{t.resolve()}),n.Vu.delete(e)}function lk(n,e,t){const r=nn(n);let i=r.Ru[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ru[r.currentUser.toKey()]=i}}function NS(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Tu.get(e))n.Pu.delete(r),t&&n.hu.pu(r,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach(r=>{n.Au.containsKey(r)||uk(n,r)})}function uk(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(nM(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),fM(n))}function SR(n,e,t){for(const r of t)r instanceof rk?(n.Au.addReference(r.key,e),sW(n,r)):r instanceof ik?(Mt(dM,"Document no longer in limbo: "+r.key),n.Au.removeReference(r.key,e),n.Au.containsKey(r.key)||uk(n,r.key)):jt(19791,{yu:r})}function sW(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Iu.has(r)||(Mt(dM,"New document in limbo: "+t),n.Iu.add(r),fM(n))}function fM(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new zt(Hn.fromString(e)),r=n.mu.next();n.Eu.set(r,new $8(t)),n.du=n.du.insert(t,r),Q3(n.remoteStore,new _l(Ho(Qy(t.path)),r,"TargetPurposeLimboResolution",Yy.ue))}}async function bm(n,e,t){const r=nn(n),i=[],s=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((a,l)=>{o.push(r.gu(l,e,t).then(u=>{var d;if((u||t)&&r.isPrimaryClient){const f=u?!u.fromCache:(d=t==null?void 0:t.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(u){i.push(u);const f=J1.Es(l.targetId,u);s.push(f)}}))}),await Promise.all(o),r.hu.J_(i),await async function(l,u){const d=nn(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>Ge.forEach(u,p=>Ge.forEach(p.Is,g=>d.persistence.referenceDelegate.addReference(f,p.targetId,g)).next(()=>Ge.forEach(p.ds,g=>d.persistence.referenceDelegate.removeReference(f,p.targetId,g)))))}catch(f){if(!kd(f))throw f;Mt(eM,"Failed to update sequence numbers: "+f)}for(const f of u){const p=f.targetId;if(!f.fromCache){const g=d.Fs.get(p),y=g.snapshotVersion,S=g.withLastLimboFreeSnapshotVersion(y);d.Fs=d.Fs.insert(p,S)}}}(r.localStore,s))}async function oW(n,e){const t=nn(n);if(!t.currentUser.isEqual(e)){Mt(dM,"User change. New user:",e.toKey());const r=await $3(t.localStore,e);t.currentUser=e,function(s,o){s.Vu.forEach(a=>{a.forEach(l=>{l.reject(new _t(Oe.CANCELLED,o))})}),s.Vu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await bm(t,r.Bs)}}function aW(n,e){const t=nn(n),r=t.Eu.get(e);if(r&&r.lu)return Sn().add(r.key);{let i=Sn();const s=t.Tu.get(e);if(!s)return i;for(const o of s){const a=t.Pu.get(o);i=i.unionWith(a.view.tu)}return i}}function ck(n){const e=nn(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=ok.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=aW.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=nW.bind(null,e),e.hu.J_=W8.bind(null,e.eventManager),e.hu.pu=j8.bind(null,e.eventManager),e}function lW(n){const e=nn(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=rW.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=iW.bind(null,e),e}class _y{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=i0(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return d8(this.persistence,new u8,e.initialUser,this.serializer)}Du(e){return new X3(Z1.Vi,this.serializer)}bu(e){return new y8}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}_y.provider={build:()=>new _y};class uW extends _y{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){Cn(this.persistence.referenceDelegate instanceof gy,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new $G(r,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?ts.withCacheSize(this.cacheSizeBytes):ts.DEFAULT;return new X3(r=>gy.Vi(r,t),this.serializer)}}class LS{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>wR(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=oW.bind(null,this.syncEngine),await z8(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new G8}()}createDatastore(e){const t=i0(e.databaseInfo.databaseId),r=function(s){return new T8(s)}(e.databaseInfo);return function(s,o,a,l){return new I8(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,a){return new R8(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>wR(this.syncEngine,t,0),function(){return gR.C()?new gR:new x8}())}createSyncEngine(e,t){return function(i,s,o,a,l,u,d){const f=new Y8(i,s,o,a,l,u);return d&&(f.fu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=nn(i);Mt(vc,"RemoteStore shutting down."),s.Ia.add(5),await Im(s),s.Ea.shutdown(),s.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}LS.provider={build:()=>new LS};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pM{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):ba("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cW{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new _t(Oe.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(i,s){const o=nn(i),a={documents:s.map(f=>my(o.serializer,f))},l=await o.Jo("BatchGetDocuments",o.serializer.databaseId,Hn.emptyPath(),a,s.length),u=new Map;l.forEach(f=>{const p=PG(o.serializer,f);u.set(p.key.toString(),p)});const d=[];return s.forEach(f=>{const p=u.get(f.toString());Cn(!!p,55234,{key:f}),d.push(p)}),d}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new n0(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const i=zt.fromPath(r);this.mutations.push(new L3(i,this.precondition(i)))}),await async function(r,i){const s=nn(r),o={writes:i.map(a=>H3(s.serializer,a))};await s.Wo("Commit",s.serializer.databaseId,Hn.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw jt(50498,{Wu:e.constructor.name});t=Kt.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new _t(Oe.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Kt.min())?Ci.exists(!1):Ci.updateTime(t):Ci.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Kt.min()))throw new _t(Oe.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ci.updateTime(t)}return Ci.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hW{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Gu=r.maxAttempts,this.F_=new tM(this.asyncQueue,"transaction_retry")}zu(){this.Gu-=1,this.ju()}ju(){this.F_.g_(async()=>{const e=new cW(this.datastore),t=this.Ju(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Hu(i)}))}).catch(r=>{this.Hu(r)})})}Ju(e){try{const t=this.updateFunction(e);return!Tm(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Hu(e){this.Gu>0&&this.Yu(e)?(this.Gu-=1,this.asyncQueue.enqueueAndForget(()=>(this.ju(),Promise.resolve()))):this.deferred.reject(e)}Yu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!D3(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ql="FirestoreClient";class dW{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ti.UNAUTHENTICATED,this.clientId=z1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{Mt(ql,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Mt(ql,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new zo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=aM(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function vE(n,e){n.asyncQueue.verifyOperationInProgress(),Mt(ql,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await $3(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>{Bl("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then(()=>{Mt("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{Bl("Terminating Firestore due to IndexedDb database deletion failed",i)})}),n._offlineComponents=e}async function TR(n,e){n.asyncQueue.verifyOperationInProgress();const t=await fW(n);Mt(ql,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>_R(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>_R(e.remoteStore,i)),n._onlineComponents=e}async function fW(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Mt(ql,"Using user provided OfflineComponentProvider");try{await vE(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===Oe.FAILED_PRECONDITION||i.code===Oe.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Bl("Error using user provided cache. Falling back to memory cache: "+t),await vE(n,new _y)}}else Mt(ql,"Using default OfflineComponentProvider"),await vE(n,new uW(void 0));return n._offlineComponents}async function mM(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Mt(ql,"Using user provided OnlineComponentProvider"),await TR(n,n._uninitializedComponentsProvider._online)):(Mt(ql,"Using default OnlineComponentProvider"),await TR(n,new LS))),n._onlineComponents}function pW(n){return mM(n).then(e=>e.syncEngine)}function mW(n){return mM(n).then(e=>e.datastore)}async function yy(n){const e=await mM(n),t=e.eventManager;return t.onListen=K8.bind(null,e.syncEngine),t.onUnlisten=J8.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Q8.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=eW.bind(null,e.syncEngine),t}function gW(n,e,t={}){const r=new zo;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const d=new pM({next:p=>{d.Ou(),o.enqueueAndForget(()=>uM(s,f));const g=p.docs.has(a);!g&&p.fromCache?u.reject(new _t(Oe.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&l&&l.source==="server"?u.reject(new _t(Oe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),f=new hM(Qy(a.path),d,{includeMetadataChanges:!0,ka:!0});return lM(s,f)}(await yy(n),n.asyncQueue,e,t,r)),r.promise}function vW(n,e,t={}){const r=new zo;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const d=new pM({next:p=>{d.Ou(),o.enqueueAndForget(()=>uM(s,f)),p.fromCache&&l.source==="server"?u.reject(new _t(Oe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),f=new hM(a,d,{includeMetadataChanges:!0,ka:!0});return lM(s,f)}(await yy(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hk(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MR=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dk="firestore.googleapis.com",AR=!0;class CR{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new _t(Oe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=dk,this.ssl=AR}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:AR;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=q3;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<qG)throw new _t(Oe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}NH("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=hk((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new _t(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new _t(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new _t(Oe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class a0{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new CR({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new _t(Oe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new _t(Oe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new CR(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new SH;switch(r.type){case"firstParty":return new CH(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new _t(Oe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=MR.get(t);r&&(Mt("ComponentProvider","Removing Datastore"),MR.delete(t),r.terminate())}(this),Promise.resolve()}}function _W(n,e,t,r={}){var i;n=Cs(n,a0);const s=Rd(e),o=n._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:n._getEmulatorOptions()}),l=`${e}:${t}`;s&&(iD(`https://${l}`),sD("Firestore",!0)),o.host!==dk&&o.host!==l&&Bl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u=Object.assign(Object.assign({},o),{host:l,ssl:s,emulatorOptions:r});if(!dc(u,a)&&(n._setSettings(u),r.mockUserToken)){let d,f;if(typeof r.mockUserToken=="string")d=r.mockUserToken,f=Ti.MOCK_USER;else{d=PB(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new _t(Oe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Ti(p)}n._authCredentials=new TH(new e3(d,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mc{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Mc(this.firestore,e,this._query)}}class gr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Nl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new gr(this.firestore,e,this._key)}toJSON(){return{type:gr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Sm(t,gr._jsonSchema))return new gr(e,r||null,new zt(Hn.fromString(t.referencePath)))}}gr._jsonSchemaVersion="firestore/documentReference/1.0",gr._jsonSchema={type:Or("string",gr._jsonSchemaVersion),referencePath:Or("string")};class Nl extends Mc{constructor(e,t,r){super(e,t,Qy(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new gr(this.firestore,null,new zt(e))}withConverter(e){return new Nl(this.firestore,e,this._path)}}function fr(n,e,...t){if(n=Fr(n),n3("collection","path",e),n instanceof a0){const r=Hn.fromString(e,...t);return Bb(r),new Nl(n,null,r)}{if(!(n instanceof gr||n instanceof Nl))throw new _t(Oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Hn.fromString(e,...t));return Bb(r),new Nl(n.firestore,null,r)}}function Nn(n,e,...t){if(n=Fr(n),arguments.length===1&&(e=z1.newId()),n3("doc","path",e),n instanceof a0){const r=Hn.fromString(e,...t);return Vb(r),new gr(n,null,new zt(r))}{if(!(n instanceof gr||n instanceof Nl))throw new _t(Oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Hn.fromString(e,...t));return Vb(r),new gr(n.firestore,n instanceof Nl?n.converter:null,new zt(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IR="AsyncQueue";class bR{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new tM(this,"async_queue_retry"),this.oc=()=>{const r=gE();r&&Mt(IR,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;const t=gE();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=gE();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const t=new zo;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!kd(e))throw e;Mt(IR,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const t=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,ba("INTERNAL UNHANDLED ERROR: ",RR(r)),r}).then(r=>(this.nc=!1,r))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const i=oM.createAndSchedule(this,e,t,r,s=>this.lc(s));return this.ec.push(i),i}ac(){this.tc&&jt(47125,{hc:RR(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function RR(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PR(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}class Pa extends a0{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new bR,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new bR(e),this._firestoreClient=void 0,await e}}}function yW(n,e){const t=typeof n=="object"?n:uD(),r=typeof n=="string"?n:uy,i=I1(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=bB("firestore");s&&_W(i,...s)}return i}function Rm(n){if(n._terminated)throw new _t(Oe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||xW(n),n._firestoreClient}function xW(n){var e,t,r;const i=n._freezeSettings(),s=function(a,l,u,d){return new GH(a,l,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,hk(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new dW(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ws(li.fromBase64String(e))}catch(t){throw new _t(Oe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ws(li.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ws._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Sm(e,ws._jsonSchema))return ws.fromBase64String(e.bytes)}}ws._jsonSchemaVersion="firestore/bytes/1.0",ws._jsonSchema={type:Or("string",ws._jsonSchemaVersion),bytes:Or("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new _t(Oe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new si(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new _t(Oe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new _t(Oe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return mn(this._lat,e._lat)||mn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Go._jsonSchemaVersion}}static fromJSON(e){if(Sm(e,Go._jsonSchema))return new Go(e.latitude,e.longitude)}}Go._jsonSchemaVersion="firestore/geoPoint/1.0",Go._jsonSchema={type:Or("string",Go._jsonSchemaVersion),latitude:Or("number"),longitude:Or("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Wo._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Sm(e,Wo._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new Wo(e.vectorValues);throw new _t(Oe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Wo._jsonSchemaVersion="firestore/vectorValue/1.0",Wo._jsonSchema={type:Or("string",Wo._jsonSchemaVersion),vectorValues:Or("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EW=/^__.*__$/;class wW{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new tu(e,this.data,this.fieldMask,t,this.fieldTransforms):new Am(e,this.data,t,this.fieldTransforms)}}class fk{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new tu(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function pk(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw jt(40011,{Ec:n})}}class gM{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new gM(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.fc(e),i}gc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return xy(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(pk(this.Ec)&&EW.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class SW{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||i0(e)}Dc(e,t,r,i=!1){return new gM({Ec:e,methodName:t,bc:r,path:si.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function c0(n){const e=n._freezeSettings(),t=i0(n._databaseId);return new SW(n._databaseId,!!e.ignoreUndefinedProperties,t)}function vM(n,e,t,r,i,s={}){const o=n.Dc(s.merge||s.mergeFields?2:0,e,t,i);yM("Data must be an object, but it was:",o,r);const a=mk(r,o);let l,u;if(s.merge)l=new Ms(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const f of s.mergeFields){const p=DS(e,f,t);if(!o.contains(p))throw new _t(Oe.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);vk(d,p)||d.push(p)}l=new Ms(d),u=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,u=o.fieldTransforms;return new wW(new Bi(a),l,u)}class h0 extends u0{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof h0}}class _M extends u0{_toFieldTransform(e){return new mG(e.path,new Vp)}isEqual(e){return e instanceof _M}}function TW(n,e,t,r){const i=n.Dc(1,e,t);yM("Data must be an object, but it was:",i,r);const s=[],o=Bi.empty();eu(r,(l,u)=>{const d=xM(e,l,t);u=Fr(u);const f=i.gc(d);if(u instanceof h0)s.push(d);else{const p=Pm(u,f);p!=null&&(s.push(d),o.set(d,p))}});const a=new Ms(s);return new fk(o,a,i.fieldTransforms)}function MW(n,e,t,r,i,s){const o=n.Dc(1,e,t),a=[DS(e,r,t)],l=[i];if(s.length%2!=0)throw new _t(Oe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)a.push(DS(e,s[p])),l.push(s[p+1]);const u=[],d=Bi.empty();for(let p=a.length-1;p>=0;--p)if(!vk(u,a[p])){const g=a[p];let y=l[p];y=Fr(y);const S=o.gc(g);if(y instanceof h0)u.push(g);else{const x=Pm(y,S);x!=null&&(u.push(g),d.set(g,x))}}const f=new Ms(u);return new fk(d,f,o.fieldTransforms)}function AW(n,e,t,r=!1){return Pm(t,n.Dc(r?4:3,e))}function Pm(n,e){if(gk(n=Fr(n)))return yM("Unsupported field value:",e,n),mk(n,e);if(n instanceof u0)return function(r,i){if(!pk(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=Pm(a,i.yc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=Fr(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return dG(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Kn.fromDate(r);return{timestampValue:py(i.serializer,s)}}if(r instanceof Kn){const s=new Kn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:py(i.serializer,s)}}if(r instanceof Go)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ws)return{bytesValue:F3(i.serializer,r._byteString)};if(r instanceof gr){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:K1(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Wo)return function(o,a){return{mapValue:{fields:{[h3]:{stringValue:d3},[cy]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.wc("VectorValues must only contain numeric values.");return X1(a.serializer,u)})}}}}}}(r,i);throw i.wc(`Unsupported field value: ${$y(r)}`)}(n,e)}function mk(n,e){const t={};return s3(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):eu(n,(r,i)=>{const s=Pm(i,e.Vc(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function gk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Kn||n instanceof Go||n instanceof ws||n instanceof gr||n instanceof u0||n instanceof Wo)}function yM(n,e,t){if(!gk(t)||!r3(t)){const r=$y(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}function DS(n,e,t){if((e=Fr(e))instanceof l0)return e._internalPath;if(typeof e=="string")return xM(n,e);throw xy("Field path arguments must be of type string or ",n,!1,void 0,t)}const CW=new RegExp("[~\\*/\\[\\]]");function xM(n,e,t){if(e.search(CW)>=0)throw xy(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new l0(...e.split("."))._internalPath}catch{throw xy(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function xy(n,e,t,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new _t(Oe.INVALID_ARGUMENT,a+n+l)}function vk(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ey{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new gr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new IW(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(EM("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class IW extends Ey{data(){return super.data()}}function EM(n,e){return typeof e=="string"?xM(n,e):e instanceof l0?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _k(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new _t(Oe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class wM{}class bW extends wM{}function Ou(n,e,...t){let r=[];e instanceof wM&&r.push(e),r=r.concat(t),function(s){const o=s.filter(l=>l instanceof SM).length,a=s.filter(l=>l instanceof d0).length;if(o>1||o>0&&a>0)throw new _t(Oe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class d0 extends bW{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new d0(e,t,r)}_apply(e){const t=this._parse(e);return yk(e._query,t),new Mc(e.firestore,e.converter,TS(e._query,t))}_parse(e){const t=c0(e.firestore);return function(s,o,a,l,u,d,f){let p;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new _t(Oe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){LR(f,d);const y=[];for(const S of f)y.push(NR(l,s,S));p={arrayValue:{values:y}}}else p=NR(l,s,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||LR(f,d),p=AW(a,o,f,d==="in"||d==="not-in");return Dr.create(u,d,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Uu(n,e,t){const r=e,i=EM("where",n);return d0._create(i,r,t)}class SM extends wM{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new SM(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Eo.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)yk(o,l),o=TS(o,l)}(e._query,t),new Mc(e.firestore,e.converter,TS(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function NR(n,e,t){if(typeof(t=Fr(t))=="string"){if(t==="")throw new _t(Oe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!x3(e)&&t.indexOf("/")!==-1)throw new _t(Oe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Hn.fromString(t));if(!zt.isDocumentKey(r))throw new _t(Oe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return $b(n,new zt(r))}if(t instanceof gr)return $b(n,t._key);throw new _t(Oe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${$y(t)}.`)}function LR(n,e){if(!Array.isArray(n)||n.length===0)throw new _t(Oe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function yk(n,e){const t=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new _t(Oe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new _t(Oe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class xk{convertValue(e,t="none"){switch(Wl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return xr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Gl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw jt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return eu(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;const s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[cy].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>xr(o.doubleValue));return new Wo(s)}convertGeoPoint(e){return new Go(xr(e.latitude),xr(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Ky(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Op(e));default:return null}}convertTimestamp(e){const t=Hl(e);return new Kn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Hn.fromString(e);Cn(j3(r),9688,{name:e});const i=new Up(r.get(1),r.get(3)),s=new zt(r.popFirst(5));return i.isEqual(t)||ba(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TM(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class RW extends xk{constructor(e){super(),this.firestore=e}convertBytes(e){return new ws(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new gr(this.firestore,null,t)}}class zh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ll extends Ey{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new x_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(EM("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new _t(Oe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ll._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Ll._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ll._jsonSchema={type:Or("string",Ll._jsonSchemaVersion),bundleSource:Or("string","DocumentSnapshot"),bundleName:Or("string"),bundle:Or("string")};class x_ extends Ll{data(e={}){return super.data(e)}}class nc{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new zh(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new x_(this._firestore,this._userDataWriter,r.key,r,new zh(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new _t(Oe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new x_(i._firestore,i._userDataWriter,a.doc.key,a.doc,new zh(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new x_(i._firestore,i._userDataWriter,a.doc.key,a.doc,new zh(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,d=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:PW(a.type),doc:l,oldIndex:u,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new _t(Oe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=nc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=z1.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function PW(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return jt(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wu(n){n=Cs(n,gr);const e=Cs(n.firestore,Pa);return gW(Rm(e),n._key).then(t=>Ek(e,n,t))}nc._jsonSchemaVersion="firestore/querySnapshot/1.0",nc._jsonSchema={type:Or("string",nc._jsonSchemaVersion),bundleSource:Or("string","QuerySnapshot"),bundleName:Or("string"),bundle:Or("string")};class f0 extends xk{constructor(e){super(),this.firestore=e}convertBytes(e){return new ws(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new gr(this.firestore,null,t)}}function ol(n){n=Cs(n,Mc);const e=Cs(n.firestore,Pa),t=Rm(e),r=new f0(e);return _k(n._query),vW(t,n._query).then(i=>new nc(e,r,n,i))}function xi(n,e,t){n=Cs(n,gr);const r=Cs(n.firestore,Pa),i=TM(n.converter,e,t);return MM(r,[vM(c0(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Ci.none())])}function _f(n){return MM(Cs(n.firestore,Pa),[new n0(n._key,Ci.none())])}function Jg(n,e){const t=Cs(n.firestore,Pa),r=Nn(n),i=TM(n.converter,e);return MM(t,[vM(c0(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Ci.exists(!1))]).then(()=>r)}function Ro(n,...e){var t,r,i;n=Fr(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||PR(e[o])||(s=e[o++]);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(PR(e[o])){const f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(i=f.complete)===null||i===void 0?void 0:i.bind(f)}let l,u,d;if(n instanceof gr)u=Cs(n.firestore,Pa),d=Qy(n._key.path),l={next:f=>{e[o]&&e[o](Ek(u,n,f))},error:e[o+1],complete:e[o+2]};else{const f=Cs(n,Mc);u=Cs(f.firestore,Pa),d=f._query;const p=new f0(u);l={next:g=>{e[o]&&e[o](new nc(u,p,f,g))},error:e[o+1],complete:e[o+2]},_k(n._query)}return function(p,g,y,S){const x=new pM(S),v=new hM(g,x,y);return p.asyncQueue.enqueueAndForget(async()=>lM(await yy(p),v)),()=>{x.Ou(),p.asyncQueue.enqueueAndForget(async()=>uM(await yy(p),v))}}(Rm(u),d,a,l)}function MM(n,e){return function(r,i){const s=new zo;return r.asyncQueue.enqueueAndForget(async()=>tW(await pW(r),i,s)),s.promise}(Rm(n),e)}function Ek(n,e,t){const r=t.docs.get(e._key),i=new f0(n);return new Ll(n,i,e._key,r,new zh(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NW={maxAttempts:5};function Gf(n,e){if((n=Fr(n)).firestore!==e)throw new _t(Oe.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LW{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=c0(e)}get(e){const t=Gf(e,this._firestore),r=new RW(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||i.length!==1)return jt(24041);const s=i[0];if(s.isFoundDocument())return new Ey(this._firestore,r,s.key,s,t.converter);if(s.isNoDocument())return new Ey(this._firestore,r,t._key,null,t.converter);throw jt(18433,{doc:s})})}set(e,t,r){const i=Gf(e,this._firestore),s=TM(i.converter,t,r),o=vM(this._dataReader,"Transaction.set",i._key,s,i.converter!==null,r);return this._transaction.set(i._key,o),this}update(e,t,r,...i){const s=Gf(e,this._firestore);let o;return o=typeof(t=Fr(t))=="string"||t instanceof l0?MW(this._dataReader,"Transaction.update",s._key,t,r,i):TW(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this}delete(e){const t=Gf(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DW extends LW{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Gf(e,this._firestore),r=new f0(this._firestore);return super.get(e).then(i=>new Ll(this._firestore,r,t._key,i._document,new zh(!1,!1),t.converter))}}function _E(n,e,t){n=Cs(n,Pa);const r=Object.assign(Object.assign({},NW),t);return function(s){if(s.maxAttempts<1)throw new _t(Oe.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){const l=new zo;return s.asyncQueue.enqueueAndForget(async()=>{const u=await mW(s);new hW(s.asyncQueue,u,a,o,l).zu()}),l.promise}(Rm(n),i=>e(new DW(n,i)),r)}function io(){return new _M("serverTimestamp")}(function(e,t=!0){(function(i){Ld=i})(Pd),pd(new fc("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new Pa(new MH(r.getProvider("auth-internal")),new IH(o,r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new _t(Oe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Up(u.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Rl(Db,kb,e),Rl(Db,kb,"esm2017")})();var kW="firebase",OW="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Rl(kW,OW,"app");const UW=()=>{const n="AIzaSyCLR7MBl1_5TSH7tzaOGweS73Cb46DNC-w";return n.includes("\\nVITE_FIREBASE_")?n.split("\\n").map(e=>e.trim()).filter(e=>e.startsWith("VITE_FIREBASE_")&&e.includes("=")).reduce((e,t)=>{const[r,...i]=t.split("=");return e[r]=i.join("="),e},{}):{}},Qc=UW(),Fu={apiKey:Qc.VITE_FIREBASE_API_KEY??"AIzaSyCLR7MBl1_5TSH7tzaOGweS73Cb46DNC-w",authDomain:Qc.VITE_FIREBASE_AUTH_DOMAIN??"turnos-unica.firebaseapp.com",projectId:Qc.VITE_FIREBASE_PROJECT_ID??"turnos-unica",storageBucket:Qc.VITE_FIREBASE_STORAGE_BUCKET??"turnos-unica.firebasestorage.app",messagingSenderId:Qc.VITE_FIREBASE_MESSAGING_SENDER_ID??"930866361857",appId:Qc.VITE_FIREBASE_APP_ID??"1:930866361857:web:a597455da782e4435d7200"},DR=Object.entries(Fu).filter(([,n])=>!n).map(([n])=>n);DR.length>0&&console.error(`[Firebase] Faltan variables: ${DR.join(", ")}. Revis tu .env y asegurate de tener una variable por lnea.`);const FW={apiKey:Fu.apiKey,authDomain:Fu.authDomain,projectId:Fu.projectId,storageBucket:Fu.storageBucket,messagingSenderId:Fu.messagingSenderId,appId:Fu.appId},wk=lD(FW),Zc=EH(wk),Bt=yW(wk),Hh=["Dom","Lun","Mar","Mi","Jue","Vie","Sb"],Lo={0:{open:9,close:23},1:{open:9,close:23},2:{open:9,close:23},3:{open:9,close:23},4:{open:9,close:23},5:{open:9,close:24},6:{open:9,close:24}},ev={fullName:"",countryCode:"54",areaCode:"",phoneNumber:"",email:"",password:""},kR={email:"",password:""},Hp=n=>new Date(n.getTime()-n.getTimezoneOffset()*6e4).toISOString().slice(0,10),VW=(n=7)=>{const e=new Date;return e.setHours(0,0,0,0),Array.from({length:n},(t,r)=>{const i=new Date(e);return i.setDate(e.getDate()+r),Hp(i)})},BW=n=>new Date(`${n}T00:00:00`).toLocaleDateString("es-AR",{weekday:"long",day:"numeric",month:"long"}),zW=new Intl.DateTimeFormat("en-CA",{timeZone:"America/Argentina/Buenos_Aires",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}),AM=()=>{const n=zW.formatToParts(new Date),e=Object.fromEntries(n.map(t=>[t.type,t.value]));return{date:`${e.year}-${e.month}-${e.day}`,hour:Number(e.hour),minute:Number(e.minute)}},Mh=(n,e)=>{const t=AM();return n<t.date?!0:n>t.date?!1:e<t.hour||e===t.hour&&t.minute>0},HW=(n,e)=>{const t=AM();return n<t.date?!0:n>t.date?!1:e*60-(t.hour*60+t.minute)<=60},GW="https://launicafutbol550-stack.github.io/launicafutbol550-stack/assets/logo-BGaX0zI9.jpg";function WW(){return F.jsxs("header",{className:"hero",children:[F.jsx("img",{src:GW,alt:"Logo La nica",className:"logo"}),F.jsxs("div",{children:[F.jsx("p",{className:"eyebrow",children:"La nica  Complejo deportivo"}),F.jsx("h1",{children:"Turnos online"}),F.jsx("p",{style:{margin:"1px"},children:"Que no te ganen de mano!"}),F.jsx("p",{children:"Reserv tu cancha en segundos, con disponibilidad en tiempo real."})]})]})}const jW=[{id:"reservas",label:"Sacar Turno",hint:"Eleg da, cancha y horario",icon:""},{id:"mis-reservas",label:"Mis reservas",hint:"Gestion tus turnos",icon:""},{id:"registro",label:"Mi cuenta",hint:"Login, registro y perfil",icon:""},{id:"admin",label:"Administracin",hint:"Panel interno",icon:"",requiresAdmin:!0}];function qW({activeSection:n,onChangeSection:e,canAccessAdmin:t=!1}){const[r,i]=fe.useState(!1),s=!!t,o=jW.filter(l=>!l.requiresAdmin||s),a=l=>{e(l),i(!1)};return F.jsxs("nav",{className:"main-nav","aria-label":"Secciones principales",children:[F.jsx("button",{type:"button",className:r?"menu-toggle menu-toggle-open":"menu-toggle",onClick:()=>i(l=>!l),"aria-expanded":r,"aria-controls":"main-nav-items",children:" Men"}),F.jsx("div",{id:"main-nav-items",className:r?"main-nav-items main-nav-items-open":"main-nav-items",children:o.map(l=>F.jsxs("button",{type:"button",className:n===l.id?"nav-pill nav-pill-active":"nav-pill",onClick:()=>a(l.id),"aria-current":n===l.id?"page":void 0,title:l.hint,children:[F.jsxs("span",{className:"nav-pill-label",children:[l.icon," ",l.label]}),F.jsx("small",{className:"nav-pill-hint",children:l.hint})]},l.id))})]})}const OR=(n,e=0,t=0)=>{const r=String(e).padStart(2,"0"),i=String(t).padStart(2,"0");return new Date(`${n}T${r}:${i}:00-03:00`)},XW=(n=[])=>{const e=AM(),t=OR(e.date,e.hour,e.minute),r=n.map(d=>({...d,startsAt:OR(d.date,d.hour,0)})).filter(d=>d.startsAt.getTime()>t.getTime()).sort((d,f)=>d.startsAt.getTime()-f.startsAt.getTime());if(r.length===0)return null;const i=r[0],s=i.startsAt.getTime()-t.getTime(),o=Math.max(0,Math.floor(s/6e4)),a=Math.floor(o/(60*24)),l=Math.floor(o%(60*24)/60),u=o%60;return{booking:i,days:a,hours:l,minutes:u}};function $W({user:n,courtPrice:e,myBookings:t,selectedDate:r,upcomingDates:i,holidays:s,slotsByCourt:o,bookingsByCourtHour:a,onChangeDate:l,onBookSlot:u,onGoLogin:d,onGoRegister:f,bookingInProgress:p}){const[y,S]=fe.useState(()=>Date.now()),[x,v]=fe.useState({}),w=i.indexOf(r),T=w>0,R=w<i.length-1,U=s.includes(r),N=new Date(`${r}T00:00:00`).getDay(),P=Math.round(e/14),b=Math.round(e/12);fe.useEffect(()=>{const A=window.setInterval(()=>{S(Date.now())},6e4);return()=>window.clearInterval(A)},[]),fe.useEffect(()=>{v({})},[r]);const M=fe.useMemo(()=>XW(t),[t,y]);return F.jsxs("section",{className:"card landing-card",children:[n&&M&&F.jsxs("div",{className:"next-booking-alert",role:"status","aria-live":"polite",children:[" Ya tens un turno reservado: faltan ",F.jsx("strong",{children:M.days})," das,",F.jsxs("strong",{children:[" ",M.hours]})," horas y ",F.jsx("strong",{children:M.minutes})," minutos para tu prximo turno."]}),F.jsxs("details",{className:"booking-info",open:!0,children:[F.jsx("summary",{children:" Informacin importante del turno"}),F.jsxs("div",{className:"booking-info-content",children:[F.jsxs("p",{children:[F.jsx("strong",{children:"Valor del turno:"})," $",e.toLocaleString("es-AR"),"."]}),F.jsxs("p",{children:["Se divide entre todos los jugadores: 7 vs 7 = $",P.toLocaleString("es-AR")," por persona, 6 vs 6 = $",b.toLocaleString("es-AR")," por persona y as sucesivamente."]}),F.jsx("p",{children:"El mismo da del turno (10:00 a 12:00 hs) enviamos mensaje de confirmacin."}),F.jsx("p",{children:"El turno queda a nombre de una persona responsable que confirma, abona el total y entrega las pecheras al finalizar."}),F.jsxs("p",{children:[F.jsx("strong",{children:"Pagos:"})," efectivo (todos le pagan a una sola persona) o transferencia (todos a una misma cuenta, que es la nica que transfiere a La nica Quequn). No se reciben pagos individuales."]})]})]}),F.jsxs("div",{className:"landing-topbar",children:[F.jsxs("div",{children:[F.jsx("h2",{children:"Disponibilidad por cancha"}),F.jsx("p",{className:"date-title",children:BW(r)})]}),!n&&F.jsxs("div",{className:"landing-actions",children:[F.jsx("button",{type:"button",className:"btn-secondary",onClick:d,children:"Iniciar sesin"}),F.jsx("button",{type:"button",onClick:f,children:"Registrarse"})]})]}),F.jsxs("div",{className:"week-nav",children:[F.jsx("button",{type:"button",className:"btn-secondary week-nav-step","aria-label":"Ir al da anterior",onClick:()=>l(i[w-1]),disabled:!T,children:""}),F.jsx("div",{className:"week-chips",role:"tablist","aria-label":"Prximos siete das",children:i.map(A=>(()=>{const L=new Date(`${A}T00:00:00`),z=L.toLocaleDateString("es-AR",{month:"short"}).replace(".","").slice(0,3);return F.jsxs("button",{type:"button",role:"tab","aria-selected":A===r,className:A===r?"day-chip day-chip-active":"day-chip",onClick:()=>l(A),children:[F.jsx("span",{className:"day-chip-weekday",children:Hh[L.getDay()].slice(0,3)}),F.jsx("span",{className:"day-chip-date",children:`${A.slice(8)} ${z}`})]},A)})())}),F.jsx("button",{type:"button",className:"btn-secondary week-nav-step","aria-label":"Ir al da siguiente",onClick:()=>l(i[w+1]),disabled:!R,children:""})]}),U&&F.jsx("p",{className:"holiday-alert",children:"Este da es feriado. No hay turnos disponibles."}),!U&&o.map(A=>F.jsxs("article",{className:"court-block",children:[F.jsx("h3",{children:A.name}),F.jsxs("div",{className:"slot-grid",children:[A.hours.length===0&&F.jsxs("p",{children:["Sin horarios configurados para ",Hh[N],"."]}),A.hours.slice(0,x[A.id]??5).map(L=>{const z=`${A.id}-${L}`,B=a[z];return F.jsxs("button",{type:"button",disabled:!!B||p,className:B?"slot slot-booked":"slot slot-open",onClick:()=>u(A.id,L),children:[L,":00 ",B?" Reservado":" Disponible",B!=null&&B.userName?`  ${B.userName}`:""]},z)})]}),A.hours.length>(x[A.id]??5)&&F.jsx("button",{type:"button",className:"btn-secondary slot-more-btn",onClick:()=>{v(L=>({...L,[A.id]:(L[A.id]??5)+5}))},children:"Ver ms turnos"})]},A.id)),F.jsxs("div",{className:"beelup-cta",children:[F.jsx("p",{children:"Record que pods ver el video de tus partidos en Beelup buscando La nica Quequn."}),F.jsx("a",{href:"https://beelup.com/ar",target:"_blank",rel:"noreferrer",className:"beelup-link",children:"Ver en Beelup"})]})]})}function YW({user:n,profile:e,profileDraft:t,authView:r,authError:i,loginData:s,registerData:o,onChangeAuthView:a,onChangeLogin:l,onChangeRegister:u,onChangeProfileDraft:d,onLogin:f,onRecoverPassword:p,onRegister:g,onGoogleLogin:y,onSaveProfile:S,onLogout:x,onStartEditProfile:v,onCancelEditProfile:w,editingProfile:T,profileComplete:R,authLoading:U}){const[N,P]=fe.useState(!1),[b,M]=fe.useState(!1);return F.jsxs("section",{className:"card auth-card",children:[!n&&F.jsxs("div",{className:"auth-flow",children:[F.jsx("p",{className:"auth-helper",children:"Si no tenes cuenta completa tus datos, solo te toma 1 minuto."}),F.jsxs("div",{className:"auth-switch",children:[F.jsx("button",{type:"button",className:r==="register"?"auth-tab auth-tab-active":"auth-tab",onClick:()=>a("register"),children:"Registrarse"}),F.jsx("button",{type:"button",className:r==="login"?"auth-tab auth-tab-active":"auth-tab",onClick:()=>a("login"),children:"Iniciar sesin"})]}),r==="login"?F.jsxs("form",{onSubmit:f,className:"profile-form",children:[F.jsx("input",{type:"email",placeholder:"Correo electrnico",value:s.email,onChange:A=>l("email",A.target.value),autoComplete:"email",required:!0}),F.jsxs("div",{className:"password-field",children:[F.jsx("input",{type:N?"text":"password",placeholder:"Contrasea",value:s.password,onChange:A=>l("password",A.target.value),autoComplete:"current-password",required:!0}),F.jsx("button",{type:"button",className:"btn-secondary password-toggle",onClick:()=>P(A=>!A),children:N?"Ocultar":"Ver"})]}),F.jsx("button",{type:"submit",disabled:U,children:U?"Ingresando":"Iniciar sesin"}),F.jsx("button",{type:"button",className:"btn-link",onClick:p,disabled:U,children:"Olvid mi contrasea"})]}):F.jsxs("form",{onSubmit:g,className:"profile-form",children:[F.jsx("input",{type:"text",placeholder:"Nombre y apellido",value:o.fullName,onChange:A=>u("fullName",A.target.value),autoComplete:"name",required:!0}),F.jsxs("div",{className:"phone-grid",children:[F.jsx("select",{value:o.countryCode,onChange:A=>u("countryCode",A.target.value),required:!0,children:F.jsx("option",{value:"54",children:"+54 Argentina"})}),F.jsx("input",{type:"tel",placeholder:"Cdigo rea (2262)",value:o.areaCode,onChange:A=>u("areaCode",A.target.value.replace(/\D/g,"")),inputMode:"numeric",required:!0}),F.jsx("input",{type:"tel",placeholder:"Nmero",value:o.phoneNumber,onChange:A=>u("phoneNumber",A.target.value.replace(/\D/g,"")),inputMode:"numeric",required:!0})]}),F.jsx("small",{className:"field-hint",children:"Ejemplo: +54 2262 451123"}),F.jsx("input",{type:"email",placeholder:"Correo electrnico",value:o.email,onChange:A=>u("email",A.target.value),autoComplete:"email",required:!0}),F.jsxs("div",{className:"password-field",children:[F.jsx("input",{type:b?"text":"password",placeholder:"Contrasea (mnimo 6 caracteres)",value:o.password,onChange:A=>u("password",A.target.value),autoComplete:"new-password",required:!0,minLength:6}),F.jsx("button",{type:"button",className:"btn-secondary password-toggle",onClick:()=>M(A=>!A),children:b?"Ocultar":"Ver"}),F.jsx("br",{}),F.jsx("small",{children:"Eleg una contrasea, si la olvidas podrs recuperarla con tu correo"})]}),F.jsx("button",{type:"submit",disabled:U,children:U?"Creando cuenta":"Registrarme"})]})]}),n&&!R&&F.jsxs("form",{onSubmit:S,className:"profile-form",children:[F.jsx("h3",{children:"Complet tu perfil"}),F.jsx("input",{type:"text",placeholder:"Nombre y apellido",value:t.fullName,onChange:A=>d("fullName",A.target.value),required:!0}),F.jsxs("div",{className:"phone-grid",children:[F.jsx("select",{value:t.countryCode,onChange:A=>d("countryCode",A.target.value),required:!0,children:F.jsx("option",{value:"54",children:"54 AR"})}),F.jsx("input",{type:"tel",placeholder:"Cdigo rea (2262)",value:t.areaCode,onChange:A=>d("areaCode",A.target.value.replace(/\D/g,"")),required:!0}),F.jsx("input",{type:"tel",placeholder:"Nmero",value:t.phoneNumber,onChange:A=>d("phoneNumber",A.target.value.replace(/\D/g,"")),required:!0})]}),F.jsx("button",{type:"submit",children:"Guardar perfil"})]}),n&&R&&!T&&F.jsxs("div",{className:"profile-summary",children:[F.jsxs("p",{children:["Sesin iniciada como ",F.jsx("strong",{children:`${e.firstName} ${e.lastName}`})]}),F.jsxs("p",{children:["Email: ",e.email]}),F.jsxs("p",{children:["Telfono: ",e.phone]}),F.jsx("button",{type:"button",onClick:v,children:"Modificar nombre, apellido o telfono"}),F.jsx("button",{type:"button",className:"btn-secondary",onClick:x,children:"Cerrar sesin"})]}),n&&R&&T&&F.jsxs("form",{onSubmit:S,className:"profile-form",children:[F.jsx("h3",{children:"Editar datos de cuenta"}),F.jsx("input",{type:"text",placeholder:"Nombre y apellido",value:t.fullName,onChange:A=>d("fullName",A.target.value),required:!0}),F.jsxs("div",{className:"phone-grid",children:[F.jsx("select",{value:t.countryCode,onChange:A=>d("countryCode",A.target.value),required:!0,children:F.jsx("option",{value:"54",children:"54 AR"})}),F.jsx("input",{type:"tel",placeholder:"Cdigo rea (2262)",value:t.areaCode,onChange:A=>d("areaCode",A.target.value.replace(/\D/g,"")),required:!0}),F.jsx("input",{type:"tel",placeholder:"Nmero",value:t.phoneNumber,onChange:A=>d("phoneNumber",A.target.value.replace(/\D/g,"")),required:!0})]}),F.jsxs("div",{className:"profile-form-actions",children:[F.jsx("button",{type:"submit",children:"Guardar cambios"}),F.jsx("button",{type:"button",className:"btn-secondary",onClick:w,children:"Cancelar"})]})]}),i&&F.jsx("p",{className:"error",children:i})]})}/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Nm="160",Vu={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Bu={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Sk=0,kS=1,Tk=2,KW=3,Mk=0,p0=1,lp=2,co=3,Na=0,Hi=1,mo=2,QW=2,jo=0,rc=1,OS=2,US=3,FS=4,Ak=5,ml=100,Ck=101,Ik=102,VS=103,BS=104,bk=200,Rk=201,Pk=202,Nk=203,wy=204,Sy=205,Lk=206,Dk=207,kk=208,Ok=209,Uk=210,Fk=211,Vk=212,Bk=213,zk=214,Hk=0,Gk=1,Wk=2,Gp=3,jk=4,qk=5,Xk=6,$k=7,Lm=0,Yk=1,Kk=2,qo=0,Qk=1,Zk=2,Jk=3,CM=4,eO=5,tO=6,zS="attached",nO="detached",Xl=300,Yo=301,$l=302,xd=303,Wp=304,Ud=306,jp=1e3,er=1001,qp=1002,Er=1003,Ty=1004,ZW=1004,up=1005,JW=1005,kn=1006,IM=1007,e9=1007,Yl=1008,HS=1008,bs=1009,bM=1010,RM=1011,m0=1012,g0=1013,ko=1014,Ur=1015,ei=1016,PM=1017,NM=1018,Dl=1020,rO=1021,kr=1023,iO=1024,sO=1025,kl=1026,_c=1027,LM=1028,DM=1029,oO=1030,kM=1031,OM=1033,E_=33776,w_=33777,S_=33778,T_=33779,GS=35840,WS=35841,jS=35842,qS=35843,UM=36196,XS=37492,$S=37496,YS=37808,KS=37809,QS=37810,ZS=37811,JS=37812,eT=37813,tT=37814,nT=37815,rT=37816,iT=37817,sT=37818,oT=37819,aT=37820,lT=37821,M_=36492,uT=36494,cT=36495,aO=36283,hT=36284,dT=36285,fT=36286,lO=2200,uO=2201,cO=2202,Xp=2300,$p=2301,A_=2302,$u=2400,Yu=2401,Yp=2402,v0=2500,FM=2501,t9=0,n9=1,r9=2,VM=3e3,Ol=3001,hO=3200,dO=3201,nu=0,fO=1,Ss="",Nr="srgb",Ls="srgb-linear",_0="display-p3",Dm="display-p3-linear",Kp="linear",jn="srgb",Qp="rec709",Zp="p3",i9=0,zu=7680,s9=7681,o9=7682,a9=7683,l9=34055,u9=34056,c9=5386,h9=512,d9=513,f9=514,p9=515,m9=516,g9=517,v9=518,pT=519,pO=512,mO=513,gO=514,BM=515,vO=516,_O=517,yO=518,xO=519,Jp=35044,_9=35048,y9=35040,x9=35045,E9=35049,w9=35041,S9=35046,T9=35050,M9=35042,A9="100",mT="300 es",My=1035,vo=2e3,Ed=2001;let Va=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,e);e.target=null}}};const Ei=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let UR=1234567;const ic=Math.PI/180,wd=180/Math.PI;function Rs(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Ei[n&255]+Ei[n>>8&255]+Ei[n>>16&255]+Ei[n>>24&255]+"-"+Ei[e&255]+Ei[e>>8&255]+"-"+Ei[e>>16&15|64]+Ei[e>>24&255]+"-"+Ei[t&63|128]+Ei[t>>8&255]+"-"+Ei[t>>16&255]+Ei[t>>24&255]+Ei[r&255]+Ei[r>>8&255]+Ei[r>>16&255]+Ei[r>>24&255]).toLowerCase()}function mr(n,e,t){return Math.max(e,Math.min(t,n))}function zM(n,e){return(n%e+e)%e}function C9(n,e,t,r,i){return r+(n-e)*(i-r)/(t-e)}function I9(n,e,t){return n!==e?(t-n)/(e-n):0}function cp(n,e,t){return(1-t)*n+t*e}function b9(n,e,t,r){return cp(n,e,1-Math.exp(-t*r))}function R9(n,e=1){return e-Math.abs(zM(n,e*2)-e)}function P9(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function N9(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function L9(n,e){return n+Math.floor(Math.random()*(e-n+1))}function D9(n,e){return n+Math.random()*(e-n)}function k9(n){return n*(.5-Math.random())}function O9(n){n!==void 0&&(UR=n);let e=UR+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function U9(n){return n*ic}function F9(n){return n*wd}function gT(n){return(n&n-1)===0&&n!==0}function V9(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Ay(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function B9(n,e,t,r,i){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),u=s((e+r)/2),d=o((e+r)/2),f=s((e-r)/2),p=o((e-r)/2),g=s((r-e)/2),y=o((r-e)/2);switch(i){case"XYX":n.set(a*d,l*f,l*p,a*u);break;case"YZY":n.set(l*p,a*d,l*f,a*u);break;case"ZXZ":n.set(l*f,l*p,a*d,a*u);break;case"XZX":n.set(a*d,l*y,l*g,a*u);break;case"YXY":n.set(l*g,a*d,l*y,a*u);break;case"ZYZ":n.set(l*y,l*g,a*d,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function is(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function cn(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const EO={DEG2RAD:ic,RAD2DEG:wd,generateUUID:Rs,clamp:mr,euclideanModulo:zM,mapLinear:C9,inverseLerp:I9,lerp:cp,damp:b9,pingpong:R9,smoothstep:P9,smootherstep:N9,randInt:L9,randFloat:D9,randFloatSpread:k9,seededRandom:O9,degToRad:U9,radToDeg:F9,isPowerOfTwo:gT,ceilPowerOfTwo:V9,floorPowerOfTwo:Ay,setQuaternionFromProperEuler:B9,normalize:cn,denormalize:is};class Ue{constructor(e=0,t=0){Ue.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(mr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),i=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*r-o*i+e.x,this.y=s*i+o*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class fn{constructor(e,t,r,i,s,o,a,l,u){fn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,o,a,l,u)}set(e,t,r,i,s,o,a,l,u){const d=this.elements;return d[0]=e,d[1]=i,d[2]=a,d[3]=t,d[4]=s,d[5]=l,d[6]=r,d[7]=o,d[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],a=r[3],l=r[6],u=r[1],d=r[4],f=r[7],p=r[2],g=r[5],y=r[8],S=i[0],x=i[3],v=i[6],w=i[1],T=i[4],R=i[7],U=i[2],N=i[5],P=i[8];return s[0]=o*S+a*w+l*U,s[3]=o*x+a*T+l*N,s[6]=o*v+a*R+l*P,s[1]=u*S+d*w+f*U,s[4]=u*x+d*T+f*N,s[7]=u*v+d*R+f*P,s[2]=p*S+g*w+y*U,s[5]=p*x+g*T+y*N,s[8]=p*v+g*R+y*P,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],d=e[8];return t*o*d-t*a*u-r*s*d+r*a*l+i*s*u-i*o*l}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],d=e[8],f=d*o-a*u,p=a*l-d*s,g=u*s-o*l,y=t*f+r*p+i*g;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);const S=1/y;return e[0]=f*S,e[1]=(i*u-d*r)*S,e[2]=(a*r-i*o)*S,e[3]=p*S,e[4]=(d*t-i*l)*S,e[5]=(i*s-a*t)*S,e[6]=g*S,e[7]=(r*l-u*t)*S,e[8]=(o*t-r*s)*S,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,s,o,a){const l=Math.cos(s),u=Math.sin(s);return this.set(r*l,r*u,-r*(l*o+u*a)+o+e,-i*u,i*l,-i*(-u*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(yE.makeScale(e,t)),this}rotate(e){return this.premultiply(yE.makeRotation(-e)),this}translate(e,t){return this.premultiply(yE.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const yE=new fn;function wO(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const z9={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Gh(n,e){return new z9[n](e)}function em(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function SO(){const n=em("canvas");return n.style.display="block",n}const FR={};function hp(n){n in FR||(FR[n]=!0,console.warn(n))}const VR=new fn().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),BR=new fn().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),tv={[Ls]:{transfer:Kp,primaries:Qp,toReference:n=>n,fromReference:n=>n},[Nr]:{transfer:jn,primaries:Qp,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[Dm]:{transfer:Kp,primaries:Zp,toReference:n=>n.applyMatrix3(BR),fromReference:n=>n.applyMatrix3(VR)},[_0]:{transfer:jn,primaries:Zp,toReference:n=>n.convertSRGBToLinear().applyMatrix3(BR),fromReference:n=>n.applyMatrix3(VR).convertLinearToSRGB()}},H9=new Set([Ls,Dm]),Fn={enabled:!0,_workingColorSpace:Ls,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!H9.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const r=tv[e].toReference,i=tv[t].fromReference;return i(r(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return tv[n].primaries},getTransfer:function(n){return n===Ss?Kp:tv[n].transfer}};function sd(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function xE(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Jc;class HM{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Jc===void 0&&(Jc=em("canvas")),Jc.width=e.width,Jc.height=e.height;const r=Jc.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=Jc}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=em("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),s=i.data;for(let o=0;o<s.length;o++)s[o]=sd(s[o]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(sd(t[r]/255)*255):t[r]=sd(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let G9=0;class Ku{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:G9++}),this.uuid=Rs(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let o=0,a=i.length;o<a;o++)i[o].isDataTexture?s.push(EE(i[o].image)):s.push(EE(i[o]))}else s=EE(i);r.url=s}return t||(e.images[this.uuid]=r),r}}function EE(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?HM.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let W9=0;class Un extends Va{constructor(e=Un.DEFAULT_IMAGE,t=Un.DEFAULT_MAPPING,r=er,i=er,s=kn,o=Yl,a=kr,l=bs,u=Un.DEFAULT_ANISOTROPY,d=Ss){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:W9++}),this.uuid=Rs(),this.name="",this.source=new Ku(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=o,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Ue(0,0),this.repeat=new Ue(1,1),this.center=new Ue(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new fn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof d=="string"?this.colorSpace=d:(hp("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=d===Ol?Nr:Ss),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Xl)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case jp:e.x=e.x-Math.floor(e.x);break;case er:e.x=e.x<0?0:1;break;case qp:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case jp:e.y=e.y-Math.floor(e.y);break;case er:e.y=e.y<0?0:1;break;case qp:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return hp("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Nr?Ol:VM}set encoding(e){hp("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===Ol?Nr:Ss}}Un.DEFAULT_IMAGE=null;Un.DEFAULT_MAPPING=Xl;Un.DEFAULT_ANISOTROPY=1;class Vn{constructor(e=0,t=0,r=0,i=1){Vn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*i+o[12]*s,this.y=o[1]*t+o[5]*r+o[9]*i+o[13]*s,this.z=o[2]*t+o[6]*r+o[10]*i+o[14]*s,this.w=o[3]*t+o[7]*r+o[11]*i+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,s;const l=e.elements,u=l[0],d=l[4],f=l[8],p=l[1],g=l[5],y=l[9],S=l[2],x=l[6],v=l[10];if(Math.abs(d-p)<.01&&Math.abs(f-S)<.01&&Math.abs(y-x)<.01){if(Math.abs(d+p)<.1&&Math.abs(f+S)<.1&&Math.abs(y+x)<.1&&Math.abs(u+g+v-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const T=(u+1)/2,R=(g+1)/2,U=(v+1)/2,N=(d+p)/4,P=(f+S)/4,b=(y+x)/4;return T>R&&T>U?T<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(T),i=N/r,s=P/r):R>U?R<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(R),r=N/i,s=b/i):U<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(U),r=P/s,i=b/s),this.set(r,i,s,t),this}let w=Math.sqrt((x-y)*(x-y)+(f-S)*(f-S)+(p-d)*(p-d));return Math.abs(w)<.001&&(w=1),this.x=(x-y)/w,this.y=(f-S)/w,this.z=(p-d)/w,this.w=Math.acos((u+g+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class TO extends Va{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Vn(0,0,e,t),this.scissorTest=!1,this.viewport=new Vn(0,0,e,t);const i={width:e,height:t,depth:1};r.encoding!==void 0&&(hp("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),r.colorSpace=r.encoding===Ol?Nr:Ss),r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:kn,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},r),this.texture=new Un(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps,this.texture.internalFormat=r.internalFormat,this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Ku(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Wi extends TO{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class y0 extends Un{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Er,this.minFilter=Er,this.wrapR=er,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class j9 extends Wi{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLArrayRenderTarget=!0,this.depth=r,this.texture=new y0(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class GM extends Un{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Er,this.minFilter=Er,this.wrapR=er,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class q9 extends Wi{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGL3DRenderTarget=!0,this.depth=r,this.texture=new GM(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class X9 extends Wi{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<r;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,s=this.texture.length;i<s;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=r;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,r=e.texture.length;t<r;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class Ii{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,s,o,a){let l=r[i+0],u=r[i+1],d=r[i+2],f=r[i+3];const p=s[o+0],g=s[o+1],y=s[o+2],S=s[o+3];if(a===0){e[t+0]=l,e[t+1]=u,e[t+2]=d,e[t+3]=f;return}if(a===1){e[t+0]=p,e[t+1]=g,e[t+2]=y,e[t+3]=S;return}if(f!==S||l!==p||u!==g||d!==y){let x=1-a;const v=l*p+u*g+d*y+f*S,w=v>=0?1:-1,T=1-v*v;if(T>Number.EPSILON){const U=Math.sqrt(T),N=Math.atan2(U,v*w);x=Math.sin(x*N)/U,a=Math.sin(a*N)/U}const R=a*w;if(l=l*x+p*R,u=u*x+g*R,d=d*x+y*R,f=f*x+S*R,x===1-a){const U=1/Math.sqrt(l*l+u*u+d*d+f*f);l*=U,u*=U,d*=U,f*=U}}e[t]=l,e[t+1]=u,e[t+2]=d,e[t+3]=f}static multiplyQuaternionsFlat(e,t,r,i,s,o){const a=r[i],l=r[i+1],u=r[i+2],d=r[i+3],f=s[o],p=s[o+1],g=s[o+2],y=s[o+3];return e[t]=a*y+d*f+l*g-u*p,e[t+1]=l*y+d*p+u*f-a*g,e[t+2]=u*y+d*g+a*p-l*f,e[t+3]=d*y-a*f-l*p-u*g,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const r=e._x,i=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,u=a(r/2),d=a(i/2),f=a(s/2),p=l(r/2),g=l(i/2),y=l(s/2);switch(o){case"XYZ":this._x=p*d*f+u*g*y,this._y=u*g*f-p*d*y,this._z=u*d*y+p*g*f,this._w=u*d*f-p*g*y;break;case"YXZ":this._x=p*d*f+u*g*y,this._y=u*g*f-p*d*y,this._z=u*d*y-p*g*f,this._w=u*d*f+p*g*y;break;case"ZXY":this._x=p*d*f-u*g*y,this._y=u*g*f+p*d*y,this._z=u*d*y+p*g*f,this._w=u*d*f-p*g*y;break;case"ZYX":this._x=p*d*f-u*g*y,this._y=u*g*f+p*d*y,this._z=u*d*y-p*g*f,this._w=u*d*f+p*g*y;break;case"YZX":this._x=p*d*f+u*g*y,this._y=u*g*f+p*d*y,this._z=u*d*y-p*g*f,this._w=u*d*f-p*g*y;break;case"XZY":this._x=p*d*f-u*g*y,this._y=u*g*f-p*d*y,this._z=u*d*y+p*g*f,this._w=u*d*f+p*g*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],s=t[8],o=t[1],a=t[5],l=t[9],u=t[2],d=t[6],f=t[10],p=r+a+f;if(p>0){const g=.5/Math.sqrt(p+1);this._w=.25/g,this._x=(d-l)*g,this._y=(s-u)*g,this._z=(o-i)*g}else if(r>a&&r>f){const g=2*Math.sqrt(1+r-a-f);this._w=(d-l)/g,this._x=.25*g,this._y=(i+o)/g,this._z=(s+u)/g}else if(a>f){const g=2*Math.sqrt(1+a-r-f);this._w=(s-u)/g,this._x=(i+o)/g,this._y=.25*g,this._z=(l+d)/g}else{const g=2*Math.sqrt(1+f-r-a);this._w=(o-i)/g,this._x=(s+u)/g,this._y=(l+d)/g,this._z=.25*g}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(mr(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,s=e._z,o=e._w,a=t._x,l=t._y,u=t._z,d=t._w;return this._x=r*d+o*a+i*u-s*l,this._y=i*d+o*l+s*a-r*u,this._z=s*d+o*u+r*l-i*a,this._w=o*d-r*a-i*l-s*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,i=this._y,s=this._z,o=this._w;let a=o*e._w+r*e._x+i*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=r,this._y=i,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const g=1-t;return this._w=g*o+t*this._w,this._x=g*r+t*this._x,this._y=g*i+t*this._y,this._z=g*s+t*this._z,this.normalize(),this}const u=Math.sqrt(l),d=Math.atan2(u,a),f=Math.sin((1-t)*d)/u,p=Math.sin(t*d)/u;return this._w=o*f+this._w*p,this._x=r*f+this._x*p,this._y=i*f+this._y*p,this._z=s*f+this._z*p,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(s),r*Math.cos(s),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Q{constructor(e=0,t=0,r=0){Q.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(zR.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(zR.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6]*i,this.y=s[1]*t+s[4]*r+s[7]*i,this.z=s[2]*t+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=e.elements,o=1/(s[3]*t+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*r+s[8]*i+s[12])*o,this.y=(s[1]*t+s[5]*r+s[9]*i+s[13])*o,this.z=(s[2]*t+s[6]*r+s[10]*i+s[14])*o,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,s=e.x,o=e.y,a=e.z,l=e.w,u=2*(o*i-a*r),d=2*(a*t-s*i),f=2*(s*r-o*t);return this.x=t+l*u+o*f-a*d,this.y=r+l*d+a*u-s*f,this.z=i+l*f+s*d-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i,this.y=s[1]*t+s[5]*r+s[9]*i,this.z=s[2]*t+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=i*l-s*a,this.y=s*o-r*l,this.z=r*a-i*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return wE.copy(this).projectOnVector(e),this.sub(wE)}reflect(e){return this.sub(wE.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(mr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const wE=new Q,zR=new Ii;class Gi{constructor(e=new Q(1/0,1/0,1/0),t=new Q(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(so.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(so.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=so.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const s=r.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,so):so.fromBufferAttribute(s,o),so.applyMatrix4(e.matrixWorld),this.expandByPoint(so);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),nv.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),nv.copy(r.boundingBox)),nv.applyMatrix4(e.matrixWorld),this.union(nv)}const i=e.children;for(let s=0,o=i.length;s<o;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,so),so.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(yf),rv.subVectors(this.max,yf),eh.subVectors(e.a,yf),th.subVectors(e.b,yf),nh.subVectors(e.c,yf),Za.subVectors(th,eh),Ja.subVectors(nh,th),Su.subVectors(eh,nh);let t=[0,-Za.z,Za.y,0,-Ja.z,Ja.y,0,-Su.z,Su.y,Za.z,0,-Za.x,Ja.z,0,-Ja.x,Su.z,0,-Su.x,-Za.y,Za.x,0,-Ja.y,Ja.x,0,-Su.y,Su.x,0];return!SE(t,eh,th,nh,rv)||(t=[1,0,0,0,1,0,0,0,1],!SE(t,eh,th,nh,rv))?!1:(iv.crossVectors(Za,Ja),t=[iv.x,iv.y,iv.z],SE(t,eh,th,nh,rv))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,so).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(so).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(sa[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),sa[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),sa[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),sa[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),sa[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),sa[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),sa[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),sa[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(sa),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const sa=[new Q,new Q,new Q,new Q,new Q,new Q,new Q,new Q],so=new Q,nv=new Gi,eh=new Q,th=new Q,nh=new Q,Za=new Q,Ja=new Q,Su=new Q,yf=new Q,rv=new Q,iv=new Q,Tu=new Q;function SE(n,e,t,r,i){for(let s=0,o=n.length-3;s<=o;s+=3){Tu.fromArray(n,s);const a=i.x*Math.abs(Tu.x)+i.y*Math.abs(Tu.y)+i.z*Math.abs(Tu.z),l=e.dot(Tu),u=t.dot(Tu),d=r.dot(Tu);if(Math.max(-Math.max(l,u,d),Math.min(l,u,d))>a)return!1}return!0}const $9=new Gi,xf=new Q,TE=new Q;class bi{constructor(e=new Q,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):$9.setFromPoints(e).getCenter(r);let i=0;for(let s=0,o=e.length;s<o;s++)i=Math.max(i,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;xf.subVectors(e,this.center);const t=xf.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(xf,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(TE.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(xf.copy(e.center).add(TE)),this.expandByPoint(xf.copy(e.center).sub(TE))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const oa=new Q,ME=new Q,sv=new Q,el=new Q,AE=new Q,ov=new Q,CE=new Q;class Ac{constructor(e=new Q,t=new Q(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,oa)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=oa.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(oa.copy(this.origin).addScaledVector(this.direction,t),oa.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){ME.copy(e).add(t).multiplyScalar(.5),sv.copy(t).sub(e).normalize(),el.copy(this.origin).sub(ME);const s=e.distanceTo(t)*.5,o=-this.direction.dot(sv),a=el.dot(this.direction),l=-el.dot(sv),u=el.lengthSq(),d=Math.abs(1-o*o);let f,p,g,y;if(d>0)if(f=o*l-a,p=o*a-l,y=s*d,f>=0)if(p>=-y)if(p<=y){const S=1/d;f*=S,p*=S,g=f*(f+o*p+2*a)+p*(o*f+p+2*l)+u}else p=s,f=Math.max(0,-(o*p+a)),g=-f*f+p*(p+2*l)+u;else p=-s,f=Math.max(0,-(o*p+a)),g=-f*f+p*(p+2*l)+u;else p<=-y?(f=Math.max(0,-(-o*s+a)),p=f>0?-s:Math.min(Math.max(-s,-l),s),g=-f*f+p*(p+2*l)+u):p<=y?(f=0,p=Math.min(Math.max(-s,-l),s),g=p*(p+2*l)+u):(f=Math.max(0,-(o*s+a)),p=f>0?s:Math.min(Math.max(-s,-l),s),g=-f*f+p*(p+2*l)+u);else p=o>0?-s:s,f=Math.max(0,-(o*p+a)),g=-f*f+p*(p+2*l)+u;return r&&r.copy(this.origin).addScaledVector(this.direction,f),i&&i.copy(ME).addScaledVector(sv,p),g}intersectSphere(e,t){oa.subVectors(e.center,this.origin);const r=oa.dot(this.direction),i=oa.dot(oa)-r*r,s=e.radius*e.radius;if(i>s)return null;const o=Math.sqrt(s-i),a=r-o,l=r+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,s,o,a,l;const u=1/this.direction.x,d=1/this.direction.y,f=1/this.direction.z,p=this.origin;return u>=0?(r=(e.min.x-p.x)*u,i=(e.max.x-p.x)*u):(r=(e.max.x-p.x)*u,i=(e.min.x-p.x)*u),d>=0?(s=(e.min.y-p.y)*d,o=(e.max.y-p.y)*d):(s=(e.max.y-p.y)*d,o=(e.min.y-p.y)*d),r>o||s>i||((s>r||isNaN(r))&&(r=s),(o<i||isNaN(i))&&(i=o),f>=0?(a=(e.min.z-p.z)*f,l=(e.max.z-p.z)*f):(a=(e.max.z-p.z)*f,l=(e.min.z-p.z)*f),r>l||a>i)||((a>r||r!==r)&&(r=a),(l<i||i!==i)&&(i=l),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,oa)!==null}intersectTriangle(e,t,r,i,s){AE.subVectors(t,e),ov.subVectors(r,e),CE.crossVectors(AE,ov);let o=this.direction.dot(CE),a;if(o>0){if(i)return null;a=1}else if(o<0)a=-1,o=-o;else return null;el.subVectors(this.origin,e);const l=a*this.direction.dot(ov.crossVectors(el,ov));if(l<0)return null;const u=a*this.direction.dot(AE.cross(el));if(u<0||l+u>o)return null;const d=-a*el.dot(CE);return d<0?null:this.at(d/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class en{constructor(e,t,r,i,s,o,a,l,u,d,f,p,g,y,S,x){en.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,o,a,l,u,d,f,p,g,y,S,x)}set(e,t,r,i,s,o,a,l,u,d,f,p,g,y,S,x){const v=this.elements;return v[0]=e,v[4]=t,v[8]=r,v[12]=i,v[1]=s,v[5]=o,v[9]=a,v[13]=l,v[2]=u,v[6]=d,v[10]=f,v[14]=p,v[3]=g,v[7]=y,v[11]=S,v[15]=x,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new en().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,i=1/rh.setFromMatrixColumn(e,0).length(),s=1/rh.setFromMatrixColumn(e,1).length(),o=1/rh.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=0,t[8]=r[8]*o,t[9]=r[9]*o,t[10]=r[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,i=e.y,s=e.z,o=Math.cos(r),a=Math.sin(r),l=Math.cos(i),u=Math.sin(i),d=Math.cos(s),f=Math.sin(s);if(e.order==="XYZ"){const p=o*d,g=o*f,y=a*d,S=a*f;t[0]=l*d,t[4]=-l*f,t[8]=u,t[1]=g+y*u,t[5]=p-S*u,t[9]=-a*l,t[2]=S-p*u,t[6]=y+g*u,t[10]=o*l}else if(e.order==="YXZ"){const p=l*d,g=l*f,y=u*d,S=u*f;t[0]=p+S*a,t[4]=y*a-g,t[8]=o*u,t[1]=o*f,t[5]=o*d,t[9]=-a,t[2]=g*a-y,t[6]=S+p*a,t[10]=o*l}else if(e.order==="ZXY"){const p=l*d,g=l*f,y=u*d,S=u*f;t[0]=p-S*a,t[4]=-o*f,t[8]=y+g*a,t[1]=g+y*a,t[5]=o*d,t[9]=S-p*a,t[2]=-o*u,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const p=o*d,g=o*f,y=a*d,S=a*f;t[0]=l*d,t[4]=y*u-g,t[8]=p*u+S,t[1]=l*f,t[5]=S*u+p,t[9]=g*u-y,t[2]=-u,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const p=o*l,g=o*u,y=a*l,S=a*u;t[0]=l*d,t[4]=S-p*f,t[8]=y*f+g,t[1]=f,t[5]=o*d,t[9]=-a*d,t[2]=-u*d,t[6]=g*f+y,t[10]=p-S*f}else if(e.order==="XZY"){const p=o*l,g=o*u,y=a*l,S=a*u;t[0]=l*d,t[4]=-f,t[8]=u*d,t[1]=p*f+S,t[5]=o*d,t[9]=g*f-y,t[2]=y*f-g,t[6]=a*d,t[10]=S*f+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Y9,e,K9)}lookAt(e,t,r){const i=this.elements;return _s.subVectors(e,t),_s.lengthSq()===0&&(_s.z=1),_s.normalize(),tl.crossVectors(r,_s),tl.lengthSq()===0&&(Math.abs(r.z)===1?_s.x+=1e-4:_s.z+=1e-4,_s.normalize(),tl.crossVectors(r,_s)),tl.normalize(),av.crossVectors(_s,tl),i[0]=tl.x,i[4]=av.x,i[8]=_s.x,i[1]=tl.y,i[5]=av.y,i[9]=_s.y,i[2]=tl.z,i[6]=av.z,i[10]=_s.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],a=r[4],l=r[8],u=r[12],d=r[1],f=r[5],p=r[9],g=r[13],y=r[2],S=r[6],x=r[10],v=r[14],w=r[3],T=r[7],R=r[11],U=r[15],N=i[0],P=i[4],b=i[8],M=i[12],A=i[1],L=i[5],z=i[9],B=i[13],$=i[2],he=i[6],te=i[10],ye=i[14],G=i[3],Z=i[7],K=i[11],ce=i[15];return s[0]=o*N+a*A+l*$+u*G,s[4]=o*P+a*L+l*he+u*Z,s[8]=o*b+a*z+l*te+u*K,s[12]=o*M+a*B+l*ye+u*ce,s[1]=d*N+f*A+p*$+g*G,s[5]=d*P+f*L+p*he+g*Z,s[9]=d*b+f*z+p*te+g*K,s[13]=d*M+f*B+p*ye+g*ce,s[2]=y*N+S*A+x*$+v*G,s[6]=y*P+S*L+x*he+v*Z,s[10]=y*b+S*z+x*te+v*K,s[14]=y*M+S*B+x*ye+v*ce,s[3]=w*N+T*A+R*$+U*G,s[7]=w*P+T*L+R*he+U*Z,s[11]=w*b+T*z+R*te+U*K,s[15]=w*M+T*B+R*ye+U*ce,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],s=e[12],o=e[1],a=e[5],l=e[9],u=e[13],d=e[2],f=e[6],p=e[10],g=e[14],y=e[3],S=e[7],x=e[11],v=e[15];return y*(+s*l*f-i*u*f-s*a*p+r*u*p+i*a*g-r*l*g)+S*(+t*l*g-t*u*p+s*o*p-i*o*g+i*u*d-s*l*d)+x*(+t*u*f-t*a*g-s*o*f+r*o*g+s*a*d-r*u*d)+v*(-i*a*d-t*l*f+t*a*p+i*o*f-r*o*p+r*l*d)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],d=e[8],f=e[9],p=e[10],g=e[11],y=e[12],S=e[13],x=e[14],v=e[15],w=f*x*u-S*p*u+S*l*g-a*x*g-f*l*v+a*p*v,T=y*p*u-d*x*u-y*l*g+o*x*g+d*l*v-o*p*v,R=d*S*u-y*f*u+y*a*g-o*S*g-d*a*v+o*f*v,U=y*f*l-d*S*l-y*a*p+o*S*p+d*a*x-o*f*x,N=t*w+r*T+i*R+s*U;if(N===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const P=1/N;return e[0]=w*P,e[1]=(S*p*s-f*x*s-S*i*g+r*x*g+f*i*v-r*p*v)*P,e[2]=(a*x*s-S*l*s+S*i*u-r*x*u-a*i*v+r*l*v)*P,e[3]=(f*l*s-a*p*s-f*i*u+r*p*u+a*i*g-r*l*g)*P,e[4]=T*P,e[5]=(d*x*s-y*p*s+y*i*g-t*x*g-d*i*v+t*p*v)*P,e[6]=(y*l*s-o*x*s-y*i*u+t*x*u+o*i*v-t*l*v)*P,e[7]=(o*p*s-d*l*s+d*i*u-t*p*u-o*i*g+t*l*g)*P,e[8]=R*P,e[9]=(y*f*s-d*S*s-y*r*g+t*S*g+d*r*v-t*f*v)*P,e[10]=(o*S*s-y*a*s+y*r*u-t*S*u-o*r*v+t*a*v)*P,e[11]=(d*a*s-o*f*s-d*r*u+t*f*u+o*r*g-t*a*g)*P,e[12]=U*P,e[13]=(d*S*i-y*f*i+y*r*p-t*S*p-d*r*x+t*f*x)*P,e[14]=(y*a*i-o*S*i-y*r*l+t*S*l+o*r*x-t*a*x)*P,e[15]=(o*f*i-d*a*i+d*r*l-t*f*l-o*r*p+t*a*p)*P,this}scale(e){const t=this.elements,r=e.x,i=e.y,s=e.z;return t[0]*=r,t[4]*=i,t[8]*=s,t[1]*=r,t[5]*=i,t[9]*=s,t[2]*=r,t[6]*=i,t[10]*=s,t[3]*=r,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),s=1-r,o=e.x,a=e.y,l=e.z,u=s*o,d=s*a;return this.set(u*o+r,u*a-i*l,u*l+i*a,0,u*a+i*l,d*a+r,d*l-i*o,0,u*l-i*a,d*l+i*o,s*l*l+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,s,o){return this.set(1,r,s,0,e,1,o,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,u=s+s,d=o+o,f=a+a,p=s*u,g=s*d,y=s*f,S=o*d,x=o*f,v=a*f,w=l*u,T=l*d,R=l*f,U=r.x,N=r.y,P=r.z;return i[0]=(1-(S+v))*U,i[1]=(g+R)*U,i[2]=(y-T)*U,i[3]=0,i[4]=(g-R)*N,i[5]=(1-(p+v))*N,i[6]=(x+w)*N,i[7]=0,i[8]=(y+T)*P,i[9]=(x-w)*P,i[10]=(1-(p+S))*P,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;let s=rh.set(i[0],i[1],i[2]).length();const o=rh.set(i[4],i[5],i[6]).length(),a=rh.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],oo.copy(this);const u=1/s,d=1/o,f=1/a;return oo.elements[0]*=u,oo.elements[1]*=u,oo.elements[2]*=u,oo.elements[4]*=d,oo.elements[5]*=d,oo.elements[6]*=d,oo.elements[8]*=f,oo.elements[9]*=f,oo.elements[10]*=f,t.setFromRotationMatrix(oo),r.x=s,r.y=o,r.z=a,this}makePerspective(e,t,r,i,s,o,a=vo){const l=this.elements,u=2*s/(t-e),d=2*s/(r-i),f=(t+e)/(t-e),p=(r+i)/(r-i);let g,y;if(a===vo)g=-(o+s)/(o-s),y=-2*o*s/(o-s);else if(a===Ed)g=-o/(o-s),y=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=u,l[4]=0,l[8]=f,l[12]=0,l[1]=0,l[5]=d,l[9]=p,l[13]=0,l[2]=0,l[6]=0,l[10]=g,l[14]=y,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,r,i,s,o,a=vo){const l=this.elements,u=1/(t-e),d=1/(r-i),f=1/(o-s),p=(t+e)*u,g=(r+i)*d;let y,S;if(a===vo)y=(o+s)*f,S=-2*f;else if(a===Ed)y=s*f,S=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-p,l[1]=0,l[5]=2*d,l[9]=0,l[13]=-g,l[2]=0,l[6]=0,l[10]=S,l[14]=-y,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const rh=new Q,oo=new en,Y9=new Q(0,0,0),K9=new Q(1,1,1),tl=new Q,av=new Q,_s=new Q,HR=new en,GR=new Ii;class km{constructor(e=0,t=0,r=0,i=km.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,s=i[0],o=i[4],a=i[8],l=i[1],u=i[5],d=i[9],f=i[2],p=i[6],g=i[10];switch(t){case"XYZ":this._y=Math.asin(mr(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-d,g),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(p,u),this._z=0);break;case"YXZ":this._x=Math.asin(-mr(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(a,g),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-f,s),this._z=0);break;case"ZXY":this._x=Math.asin(mr(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-f,g),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-mr(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(p,g),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(mr(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-f,s)):(this._x=0,this._y=Math.atan2(a,g));break;case"XZY":this._z=Math.asin(-mr(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(p,u),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-d,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return HR.makeRotationFromQuaternion(e),this.setFromRotationMatrix(HR,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return GR.setFromEuler(this),this.setFromQuaternion(GR,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}km.DEFAULT_ORDER="XYZ";class sc{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Q9=0;const WR=new Q,ih=new Ii,aa=new en,lv=new Q,Ef=new Q,Z9=new Q,J9=new Ii,jR=new Q(1,0,0),qR=new Q(0,1,0),XR=new Q(0,0,1),ej={type:"added"},tj={type:"removed"};class Ln extends Va{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Q9++}),this.uuid=Rs(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ln.DEFAULT_UP.clone();const e=new Q,t=new km,r=new Ii,i=new Q(1,1,1);function s(){r.setFromEuler(t,!1)}function o(){t.setFromQuaternion(r,void 0,!1)}t._onChange(s),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new en},normalMatrix:{value:new fn}}),this.matrix=new en,this.matrixWorld=new en,this.matrixAutoUpdate=Ln.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Ln.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new sc,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return ih.setFromAxisAngle(e,t),this.quaternion.multiply(ih),this}rotateOnWorldAxis(e,t){return ih.setFromAxisAngle(e,t),this.quaternion.premultiply(ih),this}rotateX(e){return this.rotateOnAxis(jR,e)}rotateY(e){return this.rotateOnAxis(qR,e)}rotateZ(e){return this.rotateOnAxis(XR,e)}translateOnAxis(e,t){return WR.copy(e).applyQuaternion(this.quaternion),this.position.add(WR.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(jR,e)}translateY(e){return this.translateOnAxis(qR,e)}translateZ(e){return this.translateOnAxis(XR,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(aa.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?lv.copy(e):lv.set(e,t,r);const i=this.parent;this.updateWorldMatrix(!0,!1),Ef.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?aa.lookAt(Ef,lv,this.up):aa.lookAt(lv,Ef,this.up),this.quaternion.setFromRotationMatrix(aa),i&&(aa.extractRotation(i.matrixWorld),ih.setFromRotationMatrix(aa),this.quaternion.premultiply(ih.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(ej)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(tj)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),aa.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),aa.multiply(e.parent.matrixWorld)),e.applyMatrix4(aa),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){const o=this.children[r].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);const i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ef,e,Z9),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ef,J9,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++){const s=t[r];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let s=0,o=i.length;s<o;s++){const a=i[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),i.maxGeometryCount=this._maxGeometryCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let u=0,d=l.length;u<d;u++){const f=l[u];s(e.shapes,f)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,u=this.material.length;l<u;l++)a.push(s(e.materials,this.material[l]));i.material=a}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];i.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),u=o(e.textures),d=o(e.images),f=o(e.shapes),p=o(e.skeletons),g=o(e.animations),y=o(e.nodes);a.length>0&&(r.geometries=a),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),d.length>0&&(r.images=d),f.length>0&&(r.shapes=f),p.length>0&&(r.skeletons=p),g.length>0&&(r.animations=g),y.length>0&&(r.nodes=y)}return r.object=i,r;function o(a){const l=[];for(const u in a){const d=a[u];delete d.metadata,l.push(d)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}Ln.DEFAULT_UP=new Q(0,1,0);Ln.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ln.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const ao=new Q,la=new Q,IE=new Q,ua=new Q,sh=new Q,oh=new Q,$R=new Q,bE=new Q,RE=new Q,PE=new Q;let uv=!1;class rs{constructor(e=new Q,t=new Q,r=new Q){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),ao.subVectors(e,t),i.cross(ao);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,r,i,s){ao.subVectors(i,t),la.subVectors(r,t),IE.subVectors(e,t);const o=ao.dot(ao),a=ao.dot(la),l=ao.dot(IE),u=la.dot(la),d=la.dot(IE),f=o*u-a*a;if(f===0)return s.set(0,0,0),null;const p=1/f,g=(u*l-a*d)*p,y=(o*d-a*l)*p;return s.set(1-g-y,y,g)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,ua)===null?!1:ua.x>=0&&ua.y>=0&&ua.x+ua.y<=1}static getUV(e,t,r,i,s,o,a,l){return uv===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),uv=!0),this.getInterpolation(e,t,r,i,s,o,a,l)}static getInterpolation(e,t,r,i,s,o,a,l){return this.getBarycoord(e,t,r,i,ua)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,ua.x),l.addScaledVector(o,ua.y),l.addScaledVector(a,ua.z),l)}static isFrontFacing(e,t,r,i){return ao.subVectors(r,t),la.subVectors(e,t),ao.cross(la).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ao.subVectors(this.c,this.b),la.subVectors(this.a,this.b),ao.cross(la).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return rs.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return rs.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,i,s){return uv===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),uv=!0),rs.getInterpolation(e,this.a,this.b,this.c,t,r,i,s)}getInterpolation(e,t,r,i,s){return rs.getInterpolation(e,this.a,this.b,this.c,t,r,i,s)}containsPoint(e){return rs.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return rs.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,i=this.b,s=this.c;let o,a;sh.subVectors(i,r),oh.subVectors(s,r),bE.subVectors(e,r);const l=sh.dot(bE),u=oh.dot(bE);if(l<=0&&u<=0)return t.copy(r);RE.subVectors(e,i);const d=sh.dot(RE),f=oh.dot(RE);if(d>=0&&f<=d)return t.copy(i);const p=l*f-d*u;if(p<=0&&l>=0&&d<=0)return o=l/(l-d),t.copy(r).addScaledVector(sh,o);PE.subVectors(e,s);const g=sh.dot(PE),y=oh.dot(PE);if(y>=0&&g<=y)return t.copy(s);const S=g*u-l*y;if(S<=0&&u>=0&&y<=0)return a=u/(u-y),t.copy(r).addScaledVector(oh,a);const x=d*y-g*f;if(x<=0&&f-d>=0&&g-y>=0)return $R.subVectors(s,i),a=(f-d)/(f-d+(g-y)),t.copy(i).addScaledVector($R,a);const v=1/(x+S+p);return o=S*v,a=p*v,t.copy(r).addScaledVector(sh,o).addScaledVector(oh,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const MO={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},nl={h:0,s:0,l:0},cv={h:0,s:0,l:0};function NE(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class Tt{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Nr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Fn.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=Fn.workingColorSpace){return this.r=e,this.g=t,this.b=r,Fn.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=Fn.workingColorSpace){if(e=zM(e,1),t=mr(t,0,1),r=mr(r,0,1),t===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+t):r+t-r*t,o=2*r-s;this.r=NE(o,s,e+1/3),this.g=NE(o,s,e),this.b=NE(o,s,e-1/3)}return Fn.toWorkingColorSpace(this,i),this}setStyle(e,t=Nr){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=i[1],a=i[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Nr){const r=MO[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=sd(e.r),this.g=sd(e.g),this.b=sd(e.b),this}copyLinearToSRGB(e){return this.r=xE(e.r),this.g=xE(e.g),this.b=xE(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Nr){return Fn.fromWorkingColorSpace(wi.copy(this),e),Math.round(mr(wi.r*255,0,255))*65536+Math.round(mr(wi.g*255,0,255))*256+Math.round(mr(wi.b*255,0,255))}getHexString(e=Nr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Fn.workingColorSpace){Fn.fromWorkingColorSpace(wi.copy(this),t);const r=wi.r,i=wi.g,s=wi.b,o=Math.max(r,i,s),a=Math.min(r,i,s);let l,u;const d=(a+o)/2;if(a===o)l=0,u=0;else{const f=o-a;switch(u=d<=.5?f/(o+a):f/(2-o-a),o){case r:l=(i-s)/f+(i<s?6:0);break;case i:l=(s-r)/f+2;break;case s:l=(r-i)/f+4;break}l/=6}return e.h=l,e.s=u,e.l=d,e}getRGB(e,t=Fn.workingColorSpace){return Fn.fromWorkingColorSpace(wi.copy(this),t),e.r=wi.r,e.g=wi.g,e.b=wi.b,e}getStyle(e=Nr){Fn.fromWorkingColorSpace(wi.copy(this),e);const t=wi.r,r=wi.g,i=wi.b;return e!==Nr?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(e,t,r){return this.getHSL(nl),this.setHSL(nl.h+e,nl.s+t,nl.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(nl),e.getHSL(cv);const r=cp(nl.h,cv.h,t),i=cp(nl.s,cv.s,t),s=cp(nl.l,cv.l,t);return this.setHSL(r,i,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,i=this.b,s=e.elements;return this.r=s[0]*t+s[3]*r+s[6]*i,this.g=s[1]*t+s[4]*r+s[7]*i,this.b=s[2]*t+s[5]*r+s[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const wi=new Tt;Tt.NAMES=MO;let nj=0;class ui extends Va{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:nj++}),this.uuid=Rs(),this.name="",this.type="Material",this.blending=rc,this.side=Na,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=wy,this.blendDst=Sy,this.blendEquation=ml,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Tt(0,0,0),this.blendAlpha=0,this.depthFunc=Gp,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=pT,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=zu,this.stencilZFail=zu,this.stencilZPass=zu,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==rc&&(r.blending=this.blending),this.side!==Na&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==wy&&(r.blendSrc=this.blendSrc),this.blendDst!==Sy&&(r.blendDst=this.blendDst),this.blendEquation!==ml&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==Gp&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==pT&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==zu&&(r.stencilFail=this.stencilFail),this.stencilZFail!==zu&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==zu&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=i(e.textures),o=i(e.images);s.length>0&&(r.textures=s),o.length>0&&(r.images=o)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const i=t.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=t[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Ba extends ui{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Tt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Lm,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const ma=rj();function rj(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),r=new Uint32Array(512),i=new Uint32Array(512);for(let l=0;l<256;++l){const u=l-127;u<-27?(r[l]=0,r[l|256]=32768,i[l]=24,i[l|256]=24):u<-14?(r[l]=1024>>-u-14,r[l|256]=1024>>-u-14|32768,i[l]=-u-1,i[l|256]=-u-1):u<=15?(r[l]=u+15<<10,r[l|256]=u+15<<10|32768,i[l]=13,i[l|256]=13):u<128?(r[l]=31744,r[l|256]=64512,i[l]=24,i[l|256]=24):(r[l]=31744,r[l|256]=64512,i[l]=13,i[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let u=l<<13,d=0;for(;!(u&8388608);)u<<=1,d-=8388608;u&=-8388609,d+=947912704,s[l]=u|d}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:r,shiftTable:i,mantissaTable:s,exponentTable:o,offsetTable:a}}function es(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=mr(n,-65504,65504),ma.floatView[0]=n;const e=ma.uint32View[0],t=e>>23&511;return ma.baseTable[t]+((e&8388607)>>ma.shiftTable[t])}function Wf(n){const e=n>>10;return ma.uint32View[0]=ma.mantissaTable[ma.offsetTable[e]+(n&1023)]+ma.exponentTable[e],ma.floatView[0]}const Qu={toHalfFloat:es,fromHalfFloat:Wf},Rr=new Q,hv=new Ue;class zn{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=Jp,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Ur,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)hv.fromBufferAttribute(this,t),hv.applyMatrix3(e),this.setXY(t,hv.x,hv.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Rr.fromBufferAttribute(this,t),Rr.applyMatrix3(e),this.setXYZ(t,Rr.x,Rr.y,Rr.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Rr.fromBufferAttribute(this,t),Rr.applyMatrix4(e),this.setXYZ(t,Rr.x,Rr.y,Rr.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Rr.fromBufferAttribute(this,t),Rr.applyNormalMatrix(e),this.setXYZ(t,Rr.x,Rr.y,Rr.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Rr.fromBufferAttribute(this,t),Rr.transformDirection(e),this.setXYZ(t,Rr.x,Rr.y,Rr.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=is(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=cn(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=is(t,this.array)),t}setX(e,t){return this.normalized&&(t=cn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=is(t,this.array)),t}setY(e,t){return this.normalized&&(t=cn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=is(t,this.array)),t}setZ(e,t){return this.normalized&&(t=cn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=is(t,this.array)),t}setW(e,t){return this.normalized&&(t=cn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=cn(t,this.array),r=cn(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=cn(t,this.array),r=cn(r,this.array),i=cn(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=cn(t,this.array),r=cn(r,this.array),i=cn(i,this.array),s=cn(s,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Jp&&(e.usage=this.usage),e}}class ij extends zn{constructor(e,t,r){super(new Int8Array(e),t,r)}}class sj extends zn{constructor(e,t,r){super(new Uint8Array(e),t,r)}}class oj extends zn{constructor(e,t,r){super(new Uint8ClampedArray(e),t,r)}}class aj extends zn{constructor(e,t,r){super(new Int16Array(e),t,r)}}class WM extends zn{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class lj extends zn{constructor(e,t,r){super(new Int32Array(e),t,r)}}class jM extends zn{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class uj extends zn{constructor(e,t,r){super(new Uint16Array(e),t,r),this.isFloat16BufferAttribute=!0}getX(e){let t=Wf(this.array[e*this.itemSize]);return this.normalized&&(t=is(t,this.array)),t}setX(e,t){return this.normalized&&(t=cn(t,this.array)),this.array[e*this.itemSize]=es(t),this}getY(e){let t=Wf(this.array[e*this.itemSize+1]);return this.normalized&&(t=is(t,this.array)),t}setY(e,t){return this.normalized&&(t=cn(t,this.array)),this.array[e*this.itemSize+1]=es(t),this}getZ(e){let t=Wf(this.array[e*this.itemSize+2]);return this.normalized&&(t=is(t,this.array)),t}setZ(e,t){return this.normalized&&(t=cn(t,this.array)),this.array[e*this.itemSize+2]=es(t),this}getW(e){let t=Wf(this.array[e*this.itemSize+3]);return this.normalized&&(t=is(t,this.array)),t}setW(e,t){return this.normalized&&(t=cn(t,this.array)),this.array[e*this.itemSize+3]=es(t),this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=cn(t,this.array),r=cn(r,this.array)),this.array[e+0]=es(t),this.array[e+1]=es(r),this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=cn(t,this.array),r=cn(r,this.array),i=cn(i,this.array)),this.array[e+0]=es(t),this.array[e+1]=es(r),this.array[e+2]=es(i),this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=cn(t,this.array),r=cn(r,this.array),i=cn(i,this.array),s=cn(s,this.array)),this.array[e+0]=es(t),this.array[e+1]=es(r),this.array[e+2]=es(i),this.array[e+3]=es(s),this}}class Lt extends zn{constructor(e,t,r){super(new Float32Array(e),t,r)}}class cj extends zn{constructor(e,t,r){super(new Float64Array(e),t,r)}}let hj=0;const js=new en,LE=new Ln,ah=new Q,ys=new Gi,wf=new Gi,Kr=new Q;class hn extends Va{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:hj++}),this.uuid=Rs(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(wO(e)?jM:WM)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new fn().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return js.makeRotationFromQuaternion(e),this.applyMatrix4(js),this}rotateX(e){return js.makeRotationX(e),this.applyMatrix4(js),this}rotateY(e){return js.makeRotationY(e),this.applyMatrix4(js),this}rotateZ(e){return js.makeRotationZ(e),this.applyMatrix4(js),this}translate(e,t,r){return js.makeTranslation(e,t,r),this.applyMatrix4(js),this}scale(e,t,r){return js.makeScale(e,t,r),this.applyMatrix4(js),this}lookAt(e){return LE.lookAt(e),LE.updateMatrix(),this.applyMatrix4(LE.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ah).negate(),this.translate(ah.x,ah.y,ah.z),this}setFromPoints(e){const t=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Lt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Gi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Q(-1/0,-1/0,-1/0),new Q(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){const s=t[r];ys.setFromBufferAttribute(s),this.morphTargetsRelative?(Kr.addVectors(this.boundingBox.min,ys.min),this.boundingBox.expandByPoint(Kr),Kr.addVectors(this.boundingBox.max,ys.max),this.boundingBox.expandByPoint(Kr)):(this.boundingBox.expandByPoint(ys.min),this.boundingBox.expandByPoint(ys.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new bi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Q,1/0);return}if(e){const r=this.boundingSphere.center;if(ys.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];wf.setFromBufferAttribute(a),this.morphTargetsRelative?(Kr.addVectors(ys.min,wf.min),ys.expandByPoint(Kr),Kr.addVectors(ys.max,wf.max),ys.expandByPoint(Kr)):(ys.expandByPoint(wf.min),ys.expandByPoint(wf.max))}ys.getCenter(r);let i=0;for(let s=0,o=e.count;s<o;s++)Kr.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared(Kr));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let u=0,d=a.count;u<d;u++)Kr.fromBufferAttribute(a,u),l&&(ah.fromBufferAttribute(e,u),Kr.add(ah)),i=Math.max(i,r.distanceToSquared(Kr))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=e.array,i=t.position.array,s=t.normal.array,o=t.uv.array,a=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new zn(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,u=[],d=[];for(let A=0;A<a;A++)u[A]=new Q,d[A]=new Q;const f=new Q,p=new Q,g=new Q,y=new Ue,S=new Ue,x=new Ue,v=new Q,w=new Q;function T(A,L,z){f.fromArray(i,A*3),p.fromArray(i,L*3),g.fromArray(i,z*3),y.fromArray(o,A*2),S.fromArray(o,L*2),x.fromArray(o,z*2),p.sub(f),g.sub(f),S.sub(y),x.sub(y);const B=1/(S.x*x.y-x.x*S.y);isFinite(B)&&(v.copy(p).multiplyScalar(x.y).addScaledVector(g,-S.y).multiplyScalar(B),w.copy(g).multiplyScalar(S.x).addScaledVector(p,-x.x).multiplyScalar(B),u[A].add(v),u[L].add(v),u[z].add(v),d[A].add(w),d[L].add(w),d[z].add(w))}let R=this.groups;R.length===0&&(R=[{start:0,count:r.length}]);for(let A=0,L=R.length;A<L;++A){const z=R[A],B=z.start,$=z.count;for(let he=B,te=B+$;he<te;he+=3)T(r[he+0],r[he+1],r[he+2])}const U=new Q,N=new Q,P=new Q,b=new Q;function M(A){P.fromArray(s,A*3),b.copy(P);const L=u[A];U.copy(L),U.sub(P.multiplyScalar(P.dot(L))).normalize(),N.crossVectors(b,L);const B=N.dot(d[A])<0?-1:1;l[A*4]=U.x,l[A*4+1]=U.y,l[A*4+2]=U.z,l[A*4+3]=B}for(let A=0,L=R.length;A<L;++A){const z=R[A],B=z.start,$=z.count;for(let he=B,te=B+$;he<te;he+=3)M(r[he+0]),M(r[he+1]),M(r[he+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new zn(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let p=0,g=r.count;p<g;p++)r.setXYZ(p,0,0,0);const i=new Q,s=new Q,o=new Q,a=new Q,l=new Q,u=new Q,d=new Q,f=new Q;if(e)for(let p=0,g=e.count;p<g;p+=3){const y=e.getX(p+0),S=e.getX(p+1),x=e.getX(p+2);i.fromBufferAttribute(t,y),s.fromBufferAttribute(t,S),o.fromBufferAttribute(t,x),d.subVectors(o,s),f.subVectors(i,s),d.cross(f),a.fromBufferAttribute(r,y),l.fromBufferAttribute(r,S),u.fromBufferAttribute(r,x),a.add(d),l.add(d),u.add(d),r.setXYZ(y,a.x,a.y,a.z),r.setXYZ(S,l.x,l.y,l.z),r.setXYZ(x,u.x,u.y,u.z)}else for(let p=0,g=t.count;p<g;p+=3)i.fromBufferAttribute(t,p+0),s.fromBufferAttribute(t,p+1),o.fromBufferAttribute(t,p+2),d.subVectors(o,s),f.subVectors(i,s),d.cross(f),r.setXYZ(p+0,d.x,d.y,d.z),r.setXYZ(p+1,d.x,d.y,d.z),r.setXYZ(p+2,d.x,d.y,d.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)Kr.fromBufferAttribute(e,t),Kr.normalize(),e.setXYZ(t,Kr.x,Kr.y,Kr.z)}toNonIndexed(){function e(a,l){const u=a.array,d=a.itemSize,f=a.normalized,p=new u.constructor(l.length*d);let g=0,y=0;for(let S=0,x=l.length;S<x;S++){a.isInterleavedBufferAttribute?g=l[S]*a.data.stride+a.offset:g=l[S]*d;for(let v=0;v<d;v++)p[y++]=u[g++]}return new zn(p,d,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new hn,r=this.index.array,i=this.attributes;for(const a in i){const l=i[a],u=e(l,r);t.setAttribute(a,u)}const s=this.morphAttributes;for(const a in s){const l=[],u=s[a];for(let d=0,f=u.length;d<f;d++){const p=u[d],g=e(p,r);l.push(g)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const u=o[a];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const l in r){const u=r[l];e.data.attributes[l]=u.toJSON(e.data)}const i={};let s=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],d=[];for(let f=0,p=u.length;f<p;f++){const g=u[f];d.push(g.toJSON(e.data))}d.length>0&&(i[l]=d,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(t));const i=e.attributes;for(const u in i){const d=i[u];this.setAttribute(u,d.clone(t))}const s=e.morphAttributes;for(const u in s){const d=[],f=s[u];for(let p=0,g=f.length;p<g;p++)d.push(f[p].clone(t));this.morphAttributes[u]=d}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let u=0,d=o.length;u<d;u++){const f=o[u];this.addGroup(f.start,f.count,f.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const YR=new en,Mu=new Ac,dv=new bi,KR=new Q,lh=new Q,uh=new Q,ch=new Q,DE=new Q,fv=new Q,pv=new Ue,mv=new Ue,gv=new Ue,QR=new Q,ZR=new Q,JR=new Q,vv=new Q,_v=new Q;class sr extends Ln{constructor(e=new hn,t=new Ba){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const r=this.geometry,i=r.attributes.position,s=r.morphAttributes.position,o=r.morphTargetsRelative;t.fromBufferAttribute(i,e);const a=this.morphTargetInfluences;if(s&&a){fv.set(0,0,0);for(let l=0,u=s.length;l<u;l++){const d=a[l],f=s[l];d!==0&&(DE.fromBufferAttribute(f,e),o?fv.addScaledVector(DE,d):fv.addScaledVector(DE.sub(t),d))}t.add(fv)}return t}raycast(e,t){const r=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),dv.copy(r.boundingSphere),dv.applyMatrix4(s),Mu.copy(e.ray).recast(e.near),!(dv.containsPoint(Mu.origin)===!1&&(Mu.intersectSphere(dv,KR)===null||Mu.origin.distanceToSquared(KR)>(e.far-e.near)**2))&&(YR.copy(s).invert(),Mu.copy(e.ray).applyMatrix4(YR),!(r.boundingBox!==null&&Mu.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,t,Mu)))}_computeIntersections(e,t,r){let i;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,u=s.attributes.uv,d=s.attributes.uv1,f=s.attributes.normal,p=s.groups,g=s.drawRange;if(a!==null)if(Array.isArray(o))for(let y=0,S=p.length;y<S;y++){const x=p[y],v=o[x.materialIndex],w=Math.max(x.start,g.start),T=Math.min(a.count,Math.min(x.start+x.count,g.start+g.count));for(let R=w,U=T;R<U;R+=3){const N=a.getX(R),P=a.getX(R+1),b=a.getX(R+2);i=yv(this,v,e,r,u,d,f,N,P,b),i&&(i.faceIndex=Math.floor(R/3),i.face.materialIndex=x.materialIndex,t.push(i))}}else{const y=Math.max(0,g.start),S=Math.min(a.count,g.start+g.count);for(let x=y,v=S;x<v;x+=3){const w=a.getX(x),T=a.getX(x+1),R=a.getX(x+2);i=yv(this,o,e,r,u,d,f,w,T,R),i&&(i.faceIndex=Math.floor(x/3),t.push(i))}}else if(l!==void 0)if(Array.isArray(o))for(let y=0,S=p.length;y<S;y++){const x=p[y],v=o[x.materialIndex],w=Math.max(x.start,g.start),T=Math.min(l.count,Math.min(x.start+x.count,g.start+g.count));for(let R=w,U=T;R<U;R+=3){const N=R,P=R+1,b=R+2;i=yv(this,v,e,r,u,d,f,N,P,b),i&&(i.faceIndex=Math.floor(R/3),i.face.materialIndex=x.materialIndex,t.push(i))}}else{const y=Math.max(0,g.start),S=Math.min(l.count,g.start+g.count);for(let x=y,v=S;x<v;x+=3){const w=x,T=x+1,R=x+2;i=yv(this,o,e,r,u,d,f,w,T,R),i&&(i.faceIndex=Math.floor(x/3),t.push(i))}}}}function dj(n,e,t,r,i,s,o,a){let l;if(e.side===Hi?l=r.intersectTriangle(o,s,i,!0,a):l=r.intersectTriangle(i,s,o,e.side===Na,a),l===null)return null;_v.copy(a),_v.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(_v);return u<t.near||u>t.far?null:{distance:u,point:_v.clone(),object:n}}function yv(n,e,t,r,i,s,o,a,l,u){n.getVertexPosition(a,lh),n.getVertexPosition(l,uh),n.getVertexPosition(u,ch);const d=dj(n,e,t,r,lh,uh,ch,vv);if(d){i&&(pv.fromBufferAttribute(i,a),mv.fromBufferAttribute(i,l),gv.fromBufferAttribute(i,u),d.uv=rs.getInterpolation(vv,lh,uh,ch,pv,mv,gv,new Ue)),s&&(pv.fromBufferAttribute(s,a),mv.fromBufferAttribute(s,l),gv.fromBufferAttribute(s,u),d.uv1=rs.getInterpolation(vv,lh,uh,ch,pv,mv,gv,new Ue),d.uv2=d.uv1),o&&(QR.fromBufferAttribute(o,a),ZR.fromBufferAttribute(o,l),JR.fromBufferAttribute(o,u),d.normal=rs.getInterpolation(vv,lh,uh,ch,QR,ZR,JR,new Q),d.normal.dot(r.direction)>0&&d.normal.multiplyScalar(-1));const f={a,b:l,c:u,normal:new Q,materialIndex:0};rs.getNormal(lh,uh,ch,f.normal),d.face=f}return d}class Cc extends hn{constructor(e=1,t=1,r=1,i=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:s,depthSegments:o};const a=this;i=Math.floor(i),s=Math.floor(s),o=Math.floor(o);const l=[],u=[],d=[],f=[];let p=0,g=0;y("z","y","x",-1,-1,r,t,e,o,s,0),y("z","y","x",1,-1,r,t,-e,o,s,1),y("x","z","y",1,1,e,r,t,i,o,2),y("x","z","y",1,-1,e,r,-t,i,o,3),y("x","y","z",1,-1,e,t,r,i,s,4),y("x","y","z",-1,-1,e,t,-r,i,s,5),this.setIndex(l),this.setAttribute("position",new Lt(u,3)),this.setAttribute("normal",new Lt(d,3)),this.setAttribute("uv",new Lt(f,2));function y(S,x,v,w,T,R,U,N,P,b,M){const A=R/P,L=U/b,z=R/2,B=U/2,$=N/2,he=P+1,te=b+1;let ye=0,G=0;const Z=new Q;for(let K=0;K<te;K++){const ce=K*L-B;for(let de=0;de<he;de++){const ue=de*A-z;Z[S]=ue*w,Z[x]=ce*T,Z[v]=$,u.push(Z.x,Z.y,Z.z),Z[S]=0,Z[x]=0,Z[v]=N>0?1:-1,d.push(Z.x,Z.y,Z.z),f.push(de/P),f.push(1-K/b),ye+=1}}for(let K=0;K<b;K++)for(let ce=0;ce<P;ce++){const de=p+ce+he*K,ue=p+ce+he*(K+1),Ee=p+(ce+1)+he*(K+1),Fe=p+(ce+1)+he*K;l.push(de,ue,Fe),l.push(ue,Ee,Fe),G+=6}a.addGroup(g,G,M),g+=G,p+=ye}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Cc(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Sd(n){const e={};for(const t in n){e[t]={};for(const r in n[t]){const i=n[t][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=i.clone():Array.isArray(i)?e[t][r]=i.slice():e[t][r]=i}}return e}function Fi(n){const e={};for(let t=0;t<n.length;t++){const r=Sd(n[t]);for(const i in r)e[i]=r[i]}return e}function fj(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function AO(n){return n.getRenderTarget()===null?n.outputColorSpace:Fn.workingColorSpace}const CO={clone:Sd,merge:Fi};var pj=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,mj=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ji extends ui{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=pj,this.fragmentShader=mj,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Sd(e.uniforms),this.uniformsGroups=fj(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const o=this.uniforms[i].value;o&&o.isTexture?t.uniforms[i]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[i]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[i]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[i]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[i]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[i]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[i]={type:"m4",value:o.toArray()}:t.uniforms[i]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class Om extends Ln{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new en,this.projectionMatrix=new en,this.projectionMatrixInverse=new en,this.coordinateSystem=vo}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Sr extends Om{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=wd*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(ic*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return wd*2*Math.atan(Math.tan(ic*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,i,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(ic*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,s=-.5*i;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,u=o.fullHeight;s+=o.offsetX*i/l,t-=o.offsetY*r/u,i*=o.width/l,r*=o.height/u}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const hh=-90,dh=1;class IO extends Ln{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new Sr(hh,dh,e,t);i.layers=this.layers,this.add(i);const s=new Sr(hh,dh,e,t);s.layers=this.layers,this.add(s);const o=new Sr(hh,dh,e,t);o.layers=this.layers,this.add(o);const a=new Sr(hh,dh,e,t);a.layers=this.layers,this.add(a);const l=new Sr(hh,dh,e,t);l.layers=this.layers,this.add(l);const u=new Sr(hh,dh,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[r,i,s,o,a,l]=t;for(const u of t)this.remove(u);if(e===vo)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===Ed)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of t)this.add(u),u.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,u,d]=this.children,f=e.getRenderTarget(),p=e.getActiveCubeFace(),g=e.getActiveMipmapLevel(),y=e.xr.enabled;e.xr.enabled=!1;const S=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,i),e.render(t,s),e.setRenderTarget(r,1,i),e.render(t,o),e.setRenderTarget(r,2,i),e.render(t,a),e.setRenderTarget(r,3,i),e.render(t,l),e.setRenderTarget(r,4,i),e.render(t,u),r.texture.generateMipmaps=S,e.setRenderTarget(r,5,i),e.render(t,d),e.setRenderTarget(f,p,g),e.xr.enabled=y,r.texture.needsPMREMUpdate=!0}}class Um extends Un{constructor(e,t,r,i,s,o,a,l,u,d){e=e!==void 0?e:[],t=t!==void 0?t:Yo,super(e,t,r,i,s,o,a,l,u,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class qM extends Wi{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];t.encoding!==void 0&&(hp("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Ol?Nr:Ss),this.texture=new Um(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:kn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new Cc(5,5,5),s=new ji({name:"CubemapFromEquirect",uniforms:Sd(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Hi,blending:jo});s.uniforms.tEquirect.value=t;const o=new sr(i,s),a=t.minFilter;return t.minFilter===Yl&&(t.minFilter=kn),new IO(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,r,i){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,r,i);e.setRenderTarget(s)}}const kE=new Q,gj=new Q,vj=new fn;class fa{constructor(e=new Q(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const i=kE.subVectors(r,t).cross(gj.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(kE),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(e.start).addScaledVector(r,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||vj.getNormalMatrix(e),i=this.coplanarPoint(kE).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Au=new bi,xv=new Q;class Fm{constructor(e=new fa,t=new fa,r=new fa,i=new fa,s=new fa,o=new fa){this.planes=[e,t,r,i,s,o]}set(e,t,r,i,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(i),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=vo){const r=this.planes,i=e.elements,s=i[0],o=i[1],a=i[2],l=i[3],u=i[4],d=i[5],f=i[6],p=i[7],g=i[8],y=i[9],S=i[10],x=i[11],v=i[12],w=i[13],T=i[14],R=i[15];if(r[0].setComponents(l-s,p-u,x-g,R-v).normalize(),r[1].setComponents(l+s,p+u,x+g,R+v).normalize(),r[2].setComponents(l+o,p+d,x+y,R+w).normalize(),r[3].setComponents(l-o,p-d,x-y,R-w).normalize(),r[4].setComponents(l-a,p-f,x-S,R-T).normalize(),t===vo)r[5].setComponents(l+a,p+f,x+S,R+T).normalize();else if(t===Ed)r[5].setComponents(a,f,S,T).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Au.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Au.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Au)}intersectsSprite(e){return Au.center.set(0,0,0),Au.radius=.7071067811865476,Au.applyMatrix4(e.matrixWorld),this.intersectsSphere(Au)}intersectsSphere(e){const t=this.planes,r=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const i=t[r];if(xv.x=i.normal.x>0?e.max.x:e.min.x,xv.y=i.normal.y>0?e.max.y:e.min.y,xv.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(xv)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function bO(){let n=null,e=!1,t=null,r=null;function i(s,o){t(s,o),r=n.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(r=n.requestAnimationFrame(i),e=!0)},stop:function(){n.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function _j(n,e){const t=e.isWebGL2,r=new WeakMap;function i(u,d){const f=u.array,p=u.usage,g=f.byteLength,y=n.createBuffer();n.bindBuffer(d,y),n.bufferData(d,f,p),u.onUploadCallback();let S;if(f instanceof Float32Array)S=n.FLOAT;else if(f instanceof Uint16Array)if(u.isFloat16BufferAttribute)if(t)S=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else S=n.UNSIGNED_SHORT;else if(f instanceof Int16Array)S=n.SHORT;else if(f instanceof Uint32Array)S=n.UNSIGNED_INT;else if(f instanceof Int32Array)S=n.INT;else if(f instanceof Int8Array)S=n.BYTE;else if(f instanceof Uint8Array)S=n.UNSIGNED_BYTE;else if(f instanceof Uint8ClampedArray)S=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+f);return{buffer:y,type:S,bytesPerElement:f.BYTES_PER_ELEMENT,version:u.version,size:g}}function s(u,d,f){const p=d.array,g=d._updateRange,y=d.updateRanges;if(n.bindBuffer(f,u),g.count===-1&&y.length===0&&n.bufferSubData(f,0,p),y.length!==0){for(let S=0,x=y.length;S<x;S++){const v=y[S];t?n.bufferSubData(f,v.start*p.BYTES_PER_ELEMENT,p,v.start,v.count):n.bufferSubData(f,v.start*p.BYTES_PER_ELEMENT,p.subarray(v.start,v.start+v.count))}d.clearUpdateRanges()}g.count!==-1&&(t?n.bufferSubData(f,g.offset*p.BYTES_PER_ELEMENT,p,g.offset,g.count):n.bufferSubData(f,g.offset*p.BYTES_PER_ELEMENT,p.subarray(g.offset,g.offset+g.count)),g.count=-1),d.onUploadCallback()}function o(u){return u.isInterleavedBufferAttribute&&(u=u.data),r.get(u)}function a(u){u.isInterleavedBufferAttribute&&(u=u.data);const d=r.get(u);d&&(n.deleteBuffer(d.buffer),r.delete(u))}function l(u,d){if(u.isGLBufferAttribute){const p=r.get(u);(!p||p.version<u.version)&&r.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}u.isInterleavedBufferAttribute&&(u=u.data);const f=r.get(u);if(f===void 0)r.set(u,i(u,d));else if(f.version<u.version){if(f.size!==u.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");s(f.buffer,u,d),f.version=u.version}}return{get:o,remove:a,update:l}}class ru extends hn{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};const s=e/2,o=t/2,a=Math.floor(r),l=Math.floor(i),u=a+1,d=l+1,f=e/a,p=t/l,g=[],y=[],S=[],x=[];for(let v=0;v<d;v++){const w=v*p-o;for(let T=0;T<u;T++){const R=T*f-s;y.push(R,-w,0),S.push(0,0,1),x.push(T/a),x.push(1-v/l)}}for(let v=0;v<l;v++)for(let w=0;w<a;w++){const T=w+u*v,R=w+u*(v+1),U=w+1+u*(v+1),N=w+1+u*v;g.push(T,R,N),g.push(R,U,N)}this.setIndex(g),this.setAttribute("position",new Lt(y,3)),this.setAttribute("normal",new Lt(S,3)),this.setAttribute("uv",new Lt(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ru(e.width,e.height,e.widthSegments,e.heightSegments)}}var yj=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,xj=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Ej=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,wj=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Sj=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,Tj=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Mj=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Aj=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Cj=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Ij=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,bj=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,Rj=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Pj=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,Nj=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Lj=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Dj=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,kj=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Oj=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Uj=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Fj=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Vj=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Bj=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,zj=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Hj=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Gj=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Wj=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,jj=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,qj=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Xj=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,$j=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Yj="gl_FragColor = linearToOutputTexel( gl_FragColor );",Kj=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,Qj=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Zj=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Jj=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,e7=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,t7=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,n7=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,r7=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,i7=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,s7=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,o7=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,a7=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,l7=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,u7=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,c7=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,h7=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,d7=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,f7=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,p7=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,m7=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,g7=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,v7=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,_7=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,y7=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,x7=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,E7=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,w7=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,S7=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,T7=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,M7=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,A7=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,C7=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,I7=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,b7=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,R7=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,P7=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,N7=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,L7=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,D7=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,k7=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,O7=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,U7=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,F7=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,V7=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,B7=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,z7=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,H7=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,G7=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,W7=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,j7=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,q7=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,X7=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,$7=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Y7=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,K7=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Q7=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Z7=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,J7=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,eq=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,tq=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,nq=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,rq=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,iq=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,sq=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,oq=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,aq=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,lq=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,uq=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,cq=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,hq=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color *= toneMappingExposure;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	return color;
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,dq=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,fq=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,pq=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,mq=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,gq=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,vq=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const _q=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,yq=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,xq=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Eq=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,wq=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Sq=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Tq=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Mq=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Aq=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Cq=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Iq=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,bq=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Rq=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Pq=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Nq=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Lq=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Dq=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,kq=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Oq=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Uq=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Fq=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Vq=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Bq=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,zq=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Hq=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Gq=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Wq=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,jq=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,qq=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Xq=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,$q=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Yq=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Kq=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Qq=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,un={alphahash_fragment:yj,alphahash_pars_fragment:xj,alphamap_fragment:Ej,alphamap_pars_fragment:wj,alphatest_fragment:Sj,alphatest_pars_fragment:Tj,aomap_fragment:Mj,aomap_pars_fragment:Aj,batching_pars_vertex:Cj,batching_vertex:Ij,begin_vertex:bj,beginnormal_vertex:Rj,bsdfs:Pj,iridescence_fragment:Nj,bumpmap_pars_fragment:Lj,clipping_planes_fragment:Dj,clipping_planes_pars_fragment:kj,clipping_planes_pars_vertex:Oj,clipping_planes_vertex:Uj,color_fragment:Fj,color_pars_fragment:Vj,color_pars_vertex:Bj,color_vertex:zj,common:Hj,cube_uv_reflection_fragment:Gj,defaultnormal_vertex:Wj,displacementmap_pars_vertex:jj,displacementmap_vertex:qj,emissivemap_fragment:Xj,emissivemap_pars_fragment:$j,colorspace_fragment:Yj,colorspace_pars_fragment:Kj,envmap_fragment:Qj,envmap_common_pars_fragment:Zj,envmap_pars_fragment:Jj,envmap_pars_vertex:e7,envmap_physical_pars_fragment:d7,envmap_vertex:t7,fog_vertex:n7,fog_pars_vertex:r7,fog_fragment:i7,fog_pars_fragment:s7,gradientmap_pars_fragment:o7,lightmap_fragment:a7,lightmap_pars_fragment:l7,lights_lambert_fragment:u7,lights_lambert_pars_fragment:c7,lights_pars_begin:h7,lights_toon_fragment:f7,lights_toon_pars_fragment:p7,lights_phong_fragment:m7,lights_phong_pars_fragment:g7,lights_physical_fragment:v7,lights_physical_pars_fragment:_7,lights_fragment_begin:y7,lights_fragment_maps:x7,lights_fragment_end:E7,logdepthbuf_fragment:w7,logdepthbuf_pars_fragment:S7,logdepthbuf_pars_vertex:T7,logdepthbuf_vertex:M7,map_fragment:A7,map_pars_fragment:C7,map_particle_fragment:I7,map_particle_pars_fragment:b7,metalnessmap_fragment:R7,metalnessmap_pars_fragment:P7,morphcolor_vertex:N7,morphnormal_vertex:L7,morphtarget_pars_vertex:D7,morphtarget_vertex:k7,normal_fragment_begin:O7,normal_fragment_maps:U7,normal_pars_fragment:F7,normal_pars_vertex:V7,normal_vertex:B7,normalmap_pars_fragment:z7,clearcoat_normal_fragment_begin:H7,clearcoat_normal_fragment_maps:G7,clearcoat_pars_fragment:W7,iridescence_pars_fragment:j7,opaque_fragment:q7,packing:X7,premultiplied_alpha_fragment:$7,project_vertex:Y7,dithering_fragment:K7,dithering_pars_fragment:Q7,roughnessmap_fragment:Z7,roughnessmap_pars_fragment:J7,shadowmap_pars_fragment:eq,shadowmap_pars_vertex:tq,shadowmap_vertex:nq,shadowmask_pars_fragment:rq,skinbase_vertex:iq,skinning_pars_vertex:sq,skinning_vertex:oq,skinnormal_vertex:aq,specularmap_fragment:lq,specularmap_pars_fragment:uq,tonemapping_fragment:cq,tonemapping_pars_fragment:hq,transmission_fragment:dq,transmission_pars_fragment:fq,uv_pars_fragment:pq,uv_pars_vertex:mq,uv_vertex:gq,worldpos_vertex:vq,background_vert:_q,background_frag:yq,backgroundCube_vert:xq,backgroundCube_frag:Eq,cube_vert:wq,cube_frag:Sq,depth_vert:Tq,depth_frag:Mq,distanceRGBA_vert:Aq,distanceRGBA_frag:Cq,equirect_vert:Iq,equirect_frag:bq,linedashed_vert:Rq,linedashed_frag:Pq,meshbasic_vert:Nq,meshbasic_frag:Lq,meshlambert_vert:Dq,meshlambert_frag:kq,meshmatcap_vert:Oq,meshmatcap_frag:Uq,meshnormal_vert:Fq,meshnormal_frag:Vq,meshphong_vert:Bq,meshphong_frag:zq,meshphysical_vert:Hq,meshphysical_frag:Gq,meshtoon_vert:Wq,meshtoon_frag:jq,points_vert:qq,points_frag:Xq,shadow_vert:$q,shadow_frag:Yq,sprite_vert:Kq,sprite_frag:Qq},dt={common:{diffuse:{value:new Tt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new fn},alphaMap:{value:null},alphaMapTransform:{value:new fn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new fn}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new fn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new fn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new fn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new fn},normalScale:{value:new Ue(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new fn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new fn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new fn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new fn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Tt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Tt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new fn},alphaTest:{value:0},uvTransform:{value:new fn}},sprite:{diffuse:{value:new Tt(16777215)},opacity:{value:1},center:{value:new Ue(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new fn},alphaMap:{value:null},alphaMapTransform:{value:new fn},alphaTest:{value:0}}},po={basic:{uniforms:Fi([dt.common,dt.specularmap,dt.envmap,dt.aomap,dt.lightmap,dt.fog]),vertexShader:un.meshbasic_vert,fragmentShader:un.meshbasic_frag},lambert:{uniforms:Fi([dt.common,dt.specularmap,dt.envmap,dt.aomap,dt.lightmap,dt.emissivemap,dt.bumpmap,dt.normalmap,dt.displacementmap,dt.fog,dt.lights,{emissive:{value:new Tt(0)}}]),vertexShader:un.meshlambert_vert,fragmentShader:un.meshlambert_frag},phong:{uniforms:Fi([dt.common,dt.specularmap,dt.envmap,dt.aomap,dt.lightmap,dt.emissivemap,dt.bumpmap,dt.normalmap,dt.displacementmap,dt.fog,dt.lights,{emissive:{value:new Tt(0)},specular:{value:new Tt(1118481)},shininess:{value:30}}]),vertexShader:un.meshphong_vert,fragmentShader:un.meshphong_frag},standard:{uniforms:Fi([dt.common,dt.envmap,dt.aomap,dt.lightmap,dt.emissivemap,dt.bumpmap,dt.normalmap,dt.displacementmap,dt.roughnessmap,dt.metalnessmap,dt.fog,dt.lights,{emissive:{value:new Tt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:un.meshphysical_vert,fragmentShader:un.meshphysical_frag},toon:{uniforms:Fi([dt.common,dt.aomap,dt.lightmap,dt.emissivemap,dt.bumpmap,dt.normalmap,dt.displacementmap,dt.gradientmap,dt.fog,dt.lights,{emissive:{value:new Tt(0)}}]),vertexShader:un.meshtoon_vert,fragmentShader:un.meshtoon_frag},matcap:{uniforms:Fi([dt.common,dt.bumpmap,dt.normalmap,dt.displacementmap,dt.fog,{matcap:{value:null}}]),vertexShader:un.meshmatcap_vert,fragmentShader:un.meshmatcap_frag},points:{uniforms:Fi([dt.points,dt.fog]),vertexShader:un.points_vert,fragmentShader:un.points_frag},dashed:{uniforms:Fi([dt.common,dt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:un.linedashed_vert,fragmentShader:un.linedashed_frag},depth:{uniforms:Fi([dt.common,dt.displacementmap]),vertexShader:un.depth_vert,fragmentShader:un.depth_frag},normal:{uniforms:Fi([dt.common,dt.bumpmap,dt.normalmap,dt.displacementmap,{opacity:{value:1}}]),vertexShader:un.meshnormal_vert,fragmentShader:un.meshnormal_frag},sprite:{uniforms:Fi([dt.sprite,dt.fog]),vertexShader:un.sprite_vert,fragmentShader:un.sprite_frag},background:{uniforms:{uvTransform:{value:new fn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:un.background_vert,fragmentShader:un.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:un.backgroundCube_vert,fragmentShader:un.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:un.cube_vert,fragmentShader:un.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:un.equirect_vert,fragmentShader:un.equirect_frag},distanceRGBA:{uniforms:Fi([dt.common,dt.displacementmap,{referencePosition:{value:new Q},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:un.distanceRGBA_vert,fragmentShader:un.distanceRGBA_frag},shadow:{uniforms:Fi([dt.lights,dt.fog,{color:{value:new Tt(0)},opacity:{value:1}}]),vertexShader:un.shadow_vert,fragmentShader:un.shadow_frag}};po.physical={uniforms:Fi([po.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new fn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new fn},clearcoatNormalScale:{value:new Ue(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new fn},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new fn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new fn},sheen:{value:0},sheenColor:{value:new Tt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new fn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new fn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new fn},transmissionSamplerSize:{value:new Ue},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new fn},attenuationDistance:{value:0},attenuationColor:{value:new Tt(0)},specularColor:{value:new Tt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new fn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new fn},anisotropyVector:{value:new Ue},anisotropyMap:{value:null},anisotropyMapTransform:{value:new fn}}]),vertexShader:un.meshphysical_vert,fragmentShader:un.meshphysical_frag};const Ev={r:0,b:0,g:0};function Zq(n,e,t,r,i,s,o){const a=new Tt(0);let l=s===!0?0:1,u,d,f=null,p=0,g=null;function y(x,v){let w=!1,T=v.isScene===!0?v.background:null;T&&T.isTexture&&(T=(v.backgroundBlurriness>0?t:e).get(T)),T===null?S(a,l):T&&T.isColor&&(S(T,1),w=!0);const R=n.xr.getEnvironmentBlendMode();R==="additive"?r.buffers.color.setClear(0,0,0,1,o):R==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,o),(n.autoClear||w)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),T&&(T.isCubeTexture||T.mapping===Ud)?(d===void 0&&(d=new sr(new Cc(1,1,1),new ji({name:"BackgroundCubeMaterial",uniforms:Sd(po.backgroundCube.uniforms),vertexShader:po.backgroundCube.vertexShader,fragmentShader:po.backgroundCube.fragmentShader,side:Hi,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(U,N,P){this.matrixWorld.copyPosition(P.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(d)),d.material.uniforms.envMap.value=T,d.material.uniforms.flipEnvMap.value=T.isCubeTexture&&T.isRenderTargetTexture===!1?-1:1,d.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,d.material.toneMapped=Fn.getTransfer(T.colorSpace)!==jn,(f!==T||p!==T.version||g!==n.toneMapping)&&(d.material.needsUpdate=!0,f=T,p=T.version,g=n.toneMapping),d.layers.enableAll(),x.unshift(d,d.geometry,d.material,0,0,null)):T&&T.isTexture&&(u===void 0&&(u=new sr(new ru(2,2),new ji({name:"BackgroundMaterial",uniforms:Sd(po.background.uniforms),vertexShader:po.background.vertexShader,fragmentShader:po.background.fragmentShader,side:Na,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(u)),u.material.uniforms.t2D.value=T,u.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,u.material.toneMapped=Fn.getTransfer(T.colorSpace)!==jn,T.matrixAutoUpdate===!0&&T.updateMatrix(),u.material.uniforms.uvTransform.value.copy(T.matrix),(f!==T||p!==T.version||g!==n.toneMapping)&&(u.material.needsUpdate=!0,f=T,p=T.version,g=n.toneMapping),u.layers.enableAll(),x.unshift(u,u.geometry,u.material,0,0,null))}function S(x,v){x.getRGB(Ev,AO(n)),r.buffers.color.setClear(Ev.r,Ev.g,Ev.b,v,o)}return{getClearColor:function(){return a},setClearColor:function(x,v=1){a.set(x),l=v,S(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(x){l=x,S(a,l)},render:y}}function Jq(n,e,t,r){const i=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=r.isWebGL2?null:e.get("OES_vertex_array_object"),o=r.isWebGL2||s!==null,a={},l=x(null);let u=l,d=!1;function f($,he,te,ye,G){let Z=!1;if(o){const K=S(ye,te,he);u!==K&&(u=K,g(u.object)),Z=v($,ye,te,G),Z&&w($,ye,te,G)}else{const K=he.wireframe===!0;(u.geometry!==ye.id||u.program!==te.id||u.wireframe!==K)&&(u.geometry=ye.id,u.program=te.id,u.wireframe=K,Z=!0)}G!==null&&t.update(G,n.ELEMENT_ARRAY_BUFFER),(Z||d)&&(d=!1,b($,he,te,ye),G!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(G).buffer))}function p(){return r.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}function g($){return r.isWebGL2?n.bindVertexArray($):s.bindVertexArrayOES($)}function y($){return r.isWebGL2?n.deleteVertexArray($):s.deleteVertexArrayOES($)}function S($,he,te){const ye=te.wireframe===!0;let G=a[$.id];G===void 0&&(G={},a[$.id]=G);let Z=G[he.id];Z===void 0&&(Z={},G[he.id]=Z);let K=Z[ye];return K===void 0&&(K=x(p()),Z[ye]=K),K}function x($){const he=[],te=[],ye=[];for(let G=0;G<i;G++)he[G]=0,te[G]=0,ye[G]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:he,enabledAttributes:te,attributeDivisors:ye,object:$,attributes:{},index:null}}function v($,he,te,ye){const G=u.attributes,Z=he.attributes;let K=0;const ce=te.getAttributes();for(const de in ce)if(ce[de].location>=0){const Ee=G[de];let Fe=Z[de];if(Fe===void 0&&(de==="instanceMatrix"&&$.instanceMatrix&&(Fe=$.instanceMatrix),de==="instanceColor"&&$.instanceColor&&(Fe=$.instanceColor)),Ee===void 0||Ee.attribute!==Fe||Fe&&Ee.data!==Fe.data)return!0;K++}return u.attributesNum!==K||u.index!==ye}function w($,he,te,ye){const G={},Z=he.attributes;let K=0;const ce=te.getAttributes();for(const de in ce)if(ce[de].location>=0){let Ee=Z[de];Ee===void 0&&(de==="instanceMatrix"&&$.instanceMatrix&&(Ee=$.instanceMatrix),de==="instanceColor"&&$.instanceColor&&(Ee=$.instanceColor));const Fe={};Fe.attribute=Ee,Ee&&Ee.data&&(Fe.data=Ee.data),G[de]=Fe,K++}u.attributes=G,u.attributesNum=K,u.index=ye}function T(){const $=u.newAttributes;for(let he=0,te=$.length;he<te;he++)$[he]=0}function R($){U($,0)}function U($,he){const te=u.newAttributes,ye=u.enabledAttributes,G=u.attributeDivisors;te[$]=1,ye[$]===0&&(n.enableVertexAttribArray($),ye[$]=1),G[$]!==he&&((r.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"]($,he),G[$]=he)}function N(){const $=u.newAttributes,he=u.enabledAttributes;for(let te=0,ye=he.length;te<ye;te++)he[te]!==$[te]&&(n.disableVertexAttribArray(te),he[te]=0)}function P($,he,te,ye,G,Z,K){K===!0?n.vertexAttribIPointer($,he,te,G,Z):n.vertexAttribPointer($,he,te,ye,G,Z)}function b($,he,te,ye){if(r.isWebGL2===!1&&($.isInstancedMesh||ye.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;T();const G=ye.attributes,Z=te.getAttributes(),K=he.defaultAttributeValues;for(const ce in Z){const de=Z[ce];if(de.location>=0){let ue=G[ce];if(ue===void 0&&(ce==="instanceMatrix"&&$.instanceMatrix&&(ue=$.instanceMatrix),ce==="instanceColor"&&$.instanceColor&&(ue=$.instanceColor)),ue!==void 0){const Ee=ue.normalized,Fe=ue.itemSize,ke=t.get(ue);if(ke===void 0)continue;const Ye=ke.buffer,Ct=ke.type,Dt=ke.bytesPerElement,gt=r.isWebGL2===!0&&(Ct===n.INT||Ct===n.UNSIGNED_INT||ue.gpuType===g0);if(ue.isInterleavedBufferAttribute){const vt=ue.data,ie=vt.stride,Be=ue.offset;if(vt.isInstancedInterleavedBuffer){for(let Ae=0;Ae<de.locationSize;Ae++)U(de.location+Ae,vt.meshPerAttribute);$.isInstancedMesh!==!0&&ye._maxInstanceCount===void 0&&(ye._maxInstanceCount=vt.meshPerAttribute*vt.count)}else for(let Ae=0;Ae<de.locationSize;Ae++)R(de.location+Ae);n.bindBuffer(n.ARRAY_BUFFER,Ye);for(let Ae=0;Ae<de.locationSize;Ae++)P(de.location+Ae,Fe/de.locationSize,Ct,Ee,ie*Dt,(Be+Fe/de.locationSize*Ae)*Dt,gt)}else{if(ue.isInstancedBufferAttribute){for(let vt=0;vt<de.locationSize;vt++)U(de.location+vt,ue.meshPerAttribute);$.isInstancedMesh!==!0&&ye._maxInstanceCount===void 0&&(ye._maxInstanceCount=ue.meshPerAttribute*ue.count)}else for(let vt=0;vt<de.locationSize;vt++)R(de.location+vt);n.bindBuffer(n.ARRAY_BUFFER,Ye);for(let vt=0;vt<de.locationSize;vt++)P(de.location+vt,Fe/de.locationSize,Ct,Ee,Fe*Dt,Fe/de.locationSize*vt*Dt,gt)}}else if(K!==void 0){const Ee=K[ce];if(Ee!==void 0)switch(Ee.length){case 2:n.vertexAttrib2fv(de.location,Ee);break;case 3:n.vertexAttrib3fv(de.location,Ee);break;case 4:n.vertexAttrib4fv(de.location,Ee);break;default:n.vertexAttrib1fv(de.location,Ee)}}}}N()}function M(){z();for(const $ in a){const he=a[$];for(const te in he){const ye=he[te];for(const G in ye)y(ye[G].object),delete ye[G];delete he[te]}delete a[$]}}function A($){if(a[$.id]===void 0)return;const he=a[$.id];for(const te in he){const ye=he[te];for(const G in ye)y(ye[G].object),delete ye[G];delete he[te]}delete a[$.id]}function L($){for(const he in a){const te=a[he];if(te[$.id]===void 0)continue;const ye=te[$.id];for(const G in ye)y(ye[G].object),delete ye[G];delete te[$.id]}}function z(){B(),d=!0,u!==l&&(u=l,g(u.object))}function B(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:f,reset:z,resetDefaultState:B,dispose:M,releaseStatesOfGeometry:A,releaseStatesOfProgram:L,initAttributes:T,enableAttribute:R,disableUnusedAttributes:N}}function eX(n,e,t,r){const i=r.isWebGL2;let s;function o(d){s=d}function a(d,f){n.drawArrays(s,d,f),t.update(f,s,1)}function l(d,f,p){if(p===0)return;let g,y;if(i)g=n,y="drawArraysInstanced";else if(g=e.get("ANGLE_instanced_arrays"),y="drawArraysInstancedANGLE",g===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}g[y](s,d,f,p),t.update(f,s,p)}function u(d,f,p){if(p===0)return;const g=e.get("WEBGL_multi_draw");if(g===null)for(let y=0;y<p;y++)this.render(d[y],f[y]);else{g.multiDrawArraysWEBGL(s,d,0,f,0,p);let y=0;for(let S=0;S<p;S++)y+=f[S];t.update(y,s,1)}}this.setMode=o,this.render=a,this.renderInstances=l,this.renderMultiDraw=u}function tX(n,e,t){let r;function i(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const P=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(P.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function s(P){if(P==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";P="mediump"}return P==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext";let a=t.precision!==void 0?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const u=o||e.has("WEBGL_draw_buffers"),d=t.logarithmicDepthBuffer===!0,f=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),p=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),g=n.getParameter(n.MAX_TEXTURE_SIZE),y=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),S=n.getParameter(n.MAX_VERTEX_ATTRIBS),x=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),v=n.getParameter(n.MAX_VARYING_VECTORS),w=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),T=p>0,R=o||e.has("OES_texture_float"),U=T&&R,N=o?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:u,getMaxAnisotropy:i,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:d,maxTextures:f,maxVertexTextures:p,maxTextureSize:g,maxCubemapSize:y,maxAttributes:S,maxVertexUniforms:x,maxVaryings:v,maxFragmentUniforms:w,vertexTextures:T,floatFragmentTextures:R,floatVertexTextures:U,maxSamples:N}}function nX(n){const e=this;let t=null,r=0,i=!1,s=!1;const o=new fa,a=new fn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(f,p){const g=f.length!==0||p||r!==0||i;return i=p,r=f.length,g},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(f,p){t=d(f,p,0)},this.setState=function(f,p,g){const y=f.clippingPlanes,S=f.clipIntersection,x=f.clipShadows,v=n.get(f);if(!i||y===null||y.length===0||s&&!x)s?d(null):u();else{const w=s?0:r,T=w*4;let R=v.clippingState||null;l.value=R,R=d(y,p,T,g);for(let U=0;U!==T;++U)R[U]=t[U];v.clippingState=R,this.numIntersection=S?this.numPlanes:0,this.numPlanes+=w}};function u(){l.value!==t&&(l.value=t,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function d(f,p,g,y){const S=f!==null?f.length:0;let x=null;if(S!==0){if(x=l.value,y!==!0||x===null){const v=g+S*4,w=p.matrixWorldInverse;a.getNormalMatrix(w),(x===null||x.length<v)&&(x=new Float32Array(v));for(let T=0,R=g;T!==S;++T,R+=4)o.copy(f[T]).applyMatrix4(w,a),o.normal.toArray(x,R),x[R+3]=o.constant}l.value=x,l.needsUpdate=!0}return e.numPlanes=S,e.numIntersection=0,x}}function rX(n){let e=new WeakMap;function t(o,a){return a===xd?o.mapping=Yo:a===Wp&&(o.mapping=$l),o}function r(o){if(o&&o.isTexture){const a=o.mapping;if(a===xd||a===Wp)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const u=new qM(l.height/2);return u.fromEquirectangularTexture(n,o),e.set(o,u),o.addEventListener("dispose",i),t(u.texture,o.mapping)}else return null}}return o}function i(o){const a=o.target;a.removeEventListener("dispose",i);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}class wa extends Om{constructor(e=-1,t=1,r=1,i=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=r-e,o=r+e,a=i+t,l=i-t;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,o=s+u*this.view.width,a-=d*this.view.offsetY,l=a-d*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const Wh=4,eP=[.125,.215,.35,.446,.526,.582],Gu=20,OE=new wa,tP=new Tt;let UE=null,FE=0,VE=0;const Hu=(1+Math.sqrt(5))/2,fh=1/Hu,nP=[new Q(1,1,1),new Q(-1,1,1),new Q(1,1,-1),new Q(-1,1,-1),new Q(0,Hu,fh),new Q(0,Hu,-fh),new Q(fh,0,Hu),new Q(-fh,0,Hu),new Q(Hu,fh,0),new Q(-Hu,fh,0)];class vT{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){UE=this._renderer.getRenderTarget(),FE=this._renderer.getActiveCubeFace(),VE=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,r,i,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=sP(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=iP(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(UE,FE,VE),e.scissorTest=!1,wv(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Yo||e.mapping===$l?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),UE=this._renderer.getRenderTarget(),FE=this._renderer.getActiveCubeFace(),VE=this._renderer.getActiveMipmapLevel();const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:kn,minFilter:kn,generateMipmaps:!1,type:ei,format:kr,colorSpace:Ls,depthBuffer:!1},i=rP(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=rP(e,t,r);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=iX(s)),this._blurMaterial=sX(s,e,t)}return i}_compileMaterial(e){const t=new sr(this._lodPlanes[0],e);this._renderer.compile(t,OE)}_sceneToCubeUV(e,t,r,i){const a=new Sr(90,1,t,r),l=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],d=this._renderer,f=d.autoClear,p=d.toneMapping;d.getClearColor(tP),d.toneMapping=qo,d.autoClear=!1;const g=new Ba({name:"PMREM.Background",side:Hi,depthWrite:!1,depthTest:!1}),y=new sr(new Cc,g);let S=!1;const x=e.background;x?x.isColor&&(g.color.copy(x),e.background=null,S=!0):(g.color.copy(tP),S=!0);for(let v=0;v<6;v++){const w=v%3;w===0?(a.up.set(0,l[v],0),a.lookAt(u[v],0,0)):w===1?(a.up.set(0,0,l[v]),a.lookAt(0,u[v],0)):(a.up.set(0,l[v],0),a.lookAt(0,0,u[v]));const T=this._cubeSize;wv(i,w*T,v>2?T:0,T,T),d.setRenderTarget(i),S&&d.render(y,a),d.render(e,a)}y.geometry.dispose(),y.material.dispose(),d.toneMapping=p,d.autoClear=f,e.background=x}_textureToCubeUV(e,t){const r=this._renderer,i=e.mapping===Yo||e.mapping===$l;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=sP()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=iP());const s=i?this._cubemapMaterial:this._equirectMaterial,o=new sr(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;wv(t,0,0,3*l,2*l),r.setRenderTarget(t),r.render(o,OE)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){const s=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),o=nP[(i-1)%nP.length];this._blur(e,i-1,i,s,o)}t.autoClear=r}_blur(e,t,r,i,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,r,i,"latitudinal",s),this._halfBlur(o,e,r,r,i,"longitudinal",s)}_halfBlur(e,t,r,i,s,o,a){const l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const d=3,f=new sr(this._lodPlanes[i],u),p=u.uniforms,g=this._sizeLods[r]-1,y=isFinite(s)?Math.PI/(2*g):2*Math.PI/(2*Gu-1),S=s/y,x=isFinite(s)?1+Math.floor(d*S):Gu;x>Gu&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${x} samples when the maximum is set to ${Gu}`);const v=[];let w=0;for(let P=0;P<Gu;++P){const b=P/S,M=Math.exp(-b*b/2);v.push(M),P===0?w+=M:P<x&&(w+=2*M)}for(let P=0;P<v.length;P++)v[P]=v[P]/w;p.envMap.value=e.texture,p.samples.value=x,p.weights.value=v,p.latitudinal.value=o==="latitudinal",a&&(p.poleAxis.value=a);const{_lodMax:T}=this;p.dTheta.value=y,p.mipInt.value=T-r;const R=this._sizeLods[i],U=3*R*(i>T-Wh?i-T+Wh:0),N=4*(this._cubeSize-R);wv(t,U,N,3*R,2*R),l.setRenderTarget(t),l.render(f,OE)}}function iX(n){const e=[],t=[],r=[];let i=n;const s=n-Wh+1+eP.length;for(let o=0;o<s;o++){const a=Math.pow(2,i);t.push(a);let l=1/a;o>n-Wh?l=eP[o-n+Wh-1]:o===0&&(l=0),r.push(l);const u=1/(a-2),d=-u,f=1+u,p=[d,d,f,d,f,f,d,d,f,f,d,f],g=6,y=6,S=3,x=2,v=1,w=new Float32Array(S*y*g),T=new Float32Array(x*y*g),R=new Float32Array(v*y*g);for(let N=0;N<g;N++){const P=N%3*2/3-1,b=N>2?0:-1,M=[P,b,0,P+2/3,b,0,P+2/3,b+1,0,P,b,0,P+2/3,b+1,0,P,b+1,0];w.set(M,S*y*N),T.set(p,x*y*N);const A=[N,N,N,N,N,N];R.set(A,v*y*N)}const U=new hn;U.setAttribute("position",new zn(w,S)),U.setAttribute("uv",new zn(T,x)),U.setAttribute("faceIndex",new zn(R,v)),e.push(U),i>Wh&&i--}return{lodPlanes:e,sizeLods:t,sigmas:r}}function rP(n,e,t){const r=new Wi(n,e,t);return r.texture.mapping=Ud,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function wv(n,e,t,r,i){n.viewport.set(e,t,r,i),n.scissor.set(e,t,r,i)}function sX(n,e,t){const r=new Float32Array(Gu),i=new Q(0,1,0);return new ji({name:"SphericalGaussianBlur",defines:{n:Gu,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:XM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:jo,depthTest:!1,depthWrite:!1})}function iP(){return new ji({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:XM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:jo,depthTest:!1,depthWrite:!1})}function sP(){return new ji({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:XM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:jo,depthTest:!1,depthWrite:!1})}function XM(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function oX(n){let e=new WeakMap,t=null;function r(a){if(a&&a.isTexture){const l=a.mapping,u=l===xd||l===Wp,d=l===Yo||l===$l;if(u||d)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let f=e.get(a);return t===null&&(t=new vT(n)),f=u?t.fromEquirectangular(a,f):t.fromCubemap(a,f),e.set(a,f),f.texture}else{if(e.has(a))return e.get(a).texture;{const f=a.image;if(u&&f&&f.height>0||d&&f&&i(f)){t===null&&(t=new vT(n));const p=u?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,p),a.addEventListener("dispose",s),p.texture}else return null}}}return a}function i(a){let l=0;const u=6;for(let d=0;d<u;d++)a[d]!==void 0&&l++;return l===u}function s(a){const l=a.target;l.removeEventListener("dispose",s);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:o}}function aX(n){const e={};function t(r){if(e[r]!==void 0)return e[r];let i;switch(r){case"WEBGL_depth_texture":i=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=n.getExtension(r)}return e[r]=i,i}return{has:function(r){return t(r)!==null},init:function(r){r.isWebGL2?(t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance")):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(r){const i=t(r);return i===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function lX(n,e,t,r){const i={},s=new WeakMap;function o(f){const p=f.target;p.index!==null&&e.remove(p.index);for(const y in p.attributes)e.remove(p.attributes[y]);for(const y in p.morphAttributes){const S=p.morphAttributes[y];for(let x=0,v=S.length;x<v;x++)e.remove(S[x])}p.removeEventListener("dispose",o),delete i[p.id];const g=s.get(p);g&&(e.remove(g),s.delete(p)),r.releaseStatesOfGeometry(p),p.isInstancedBufferGeometry===!0&&delete p._maxInstanceCount,t.memory.geometries--}function a(f,p){return i[p.id]===!0||(p.addEventListener("dispose",o),i[p.id]=!0,t.memory.geometries++),p}function l(f){const p=f.attributes;for(const y in p)e.update(p[y],n.ARRAY_BUFFER);const g=f.morphAttributes;for(const y in g){const S=g[y];for(let x=0,v=S.length;x<v;x++)e.update(S[x],n.ARRAY_BUFFER)}}function u(f){const p=[],g=f.index,y=f.attributes.position;let S=0;if(g!==null){const w=g.array;S=g.version;for(let T=0,R=w.length;T<R;T+=3){const U=w[T+0],N=w[T+1],P=w[T+2];p.push(U,N,N,P,P,U)}}else if(y!==void 0){const w=y.array;S=y.version;for(let T=0,R=w.length/3-1;T<R;T+=3){const U=T+0,N=T+1,P=T+2;p.push(U,N,N,P,P,U)}}else return;const x=new(wO(p)?jM:WM)(p,1);x.version=S;const v=s.get(f);v&&e.remove(v),s.set(f,x)}function d(f){const p=s.get(f);if(p){const g=f.index;g!==null&&p.version<g.version&&u(f)}else u(f);return s.get(f)}return{get:a,update:l,getWireframeAttribute:d}}function uX(n,e,t,r){const i=r.isWebGL2;let s;function o(g){s=g}let a,l;function u(g){a=g.type,l=g.bytesPerElement}function d(g,y){n.drawElements(s,y,a,g*l),t.update(y,s,1)}function f(g,y,S){if(S===0)return;let x,v;if(i)x=n,v="drawElementsInstanced";else if(x=e.get("ANGLE_instanced_arrays"),v="drawElementsInstancedANGLE",x===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}x[v](s,y,a,g*l,S),t.update(y,s,S)}function p(g,y,S){if(S===0)return;const x=e.get("WEBGL_multi_draw");if(x===null)for(let v=0;v<S;v++)this.render(g[v]/l,y[v]);else{x.multiDrawElementsWEBGL(s,y,0,a,g,0,S);let v=0;for(let w=0;w<S;w++)v+=y[w];t.update(v,s,1)}}this.setMode=o,this.setIndex=u,this.render=d,this.renderInstances=f,this.renderMultiDraw=p}function cX(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:r}}function hX(n,e){return n[0]-e[0]}function dX(n,e){return Math.abs(e[1])-Math.abs(n[1])}function fX(n,e,t){const r={},i=new Float32Array(8),s=new WeakMap,o=new Vn,a=[];for(let u=0;u<8;u++)a[u]=[u,0];function l(u,d,f){const p=u.morphTargetInfluences;if(e.isWebGL2===!0){const y=d.morphAttributes.position||d.morphAttributes.normal||d.morphAttributes.color,S=y!==void 0?y.length:0;let x=s.get(d);if(x===void 0||x.count!==S){let he=function(){B.dispose(),s.delete(d),d.removeEventListener("dispose",he)};var g=he;x!==void 0&&x.texture.dispose();const T=d.morphAttributes.position!==void 0,R=d.morphAttributes.normal!==void 0,U=d.morphAttributes.color!==void 0,N=d.morphAttributes.position||[],P=d.morphAttributes.normal||[],b=d.morphAttributes.color||[];let M=0;T===!0&&(M=1),R===!0&&(M=2),U===!0&&(M=3);let A=d.attributes.position.count*M,L=1;A>e.maxTextureSize&&(L=Math.ceil(A/e.maxTextureSize),A=e.maxTextureSize);const z=new Float32Array(A*L*4*S),B=new y0(z,A,L,S);B.type=Ur,B.needsUpdate=!0;const $=M*4;for(let te=0;te<S;te++){const ye=N[te],G=P[te],Z=b[te],K=A*L*4*te;for(let ce=0;ce<ye.count;ce++){const de=ce*$;T===!0&&(o.fromBufferAttribute(ye,ce),z[K+de+0]=o.x,z[K+de+1]=o.y,z[K+de+2]=o.z,z[K+de+3]=0),R===!0&&(o.fromBufferAttribute(G,ce),z[K+de+4]=o.x,z[K+de+5]=o.y,z[K+de+6]=o.z,z[K+de+7]=0),U===!0&&(o.fromBufferAttribute(Z,ce),z[K+de+8]=o.x,z[K+de+9]=o.y,z[K+de+10]=o.z,z[K+de+11]=Z.itemSize===4?o.w:1)}}x={count:S,texture:B,size:new Ue(A,L)},s.set(d,x),d.addEventListener("dispose",he)}let v=0;for(let T=0;T<p.length;T++)v+=p[T];const w=d.morphTargetsRelative?1:1-v;f.getUniforms().setValue(n,"morphTargetBaseInfluence",w),f.getUniforms().setValue(n,"morphTargetInfluences",p),f.getUniforms().setValue(n,"morphTargetsTexture",x.texture,t),f.getUniforms().setValue(n,"morphTargetsTextureSize",x.size)}else{const y=p===void 0?0:p.length;let S=r[d.id];if(S===void 0||S.length!==y){S=[];for(let R=0;R<y;R++)S[R]=[R,0];r[d.id]=S}for(let R=0;R<y;R++){const U=S[R];U[0]=R,U[1]=p[R]}S.sort(dX);for(let R=0;R<8;R++)R<y&&S[R][1]?(a[R][0]=S[R][0],a[R][1]=S[R][1]):(a[R][0]=Number.MAX_SAFE_INTEGER,a[R][1]=0);a.sort(hX);const x=d.morphAttributes.position,v=d.morphAttributes.normal;let w=0;for(let R=0;R<8;R++){const U=a[R],N=U[0],P=U[1];N!==Number.MAX_SAFE_INTEGER&&P?(x&&d.getAttribute("morphTarget"+R)!==x[N]&&d.setAttribute("morphTarget"+R,x[N]),v&&d.getAttribute("morphNormal"+R)!==v[N]&&d.setAttribute("morphNormal"+R,v[N]),i[R]=P,w+=P):(x&&d.hasAttribute("morphTarget"+R)===!0&&d.deleteAttribute("morphTarget"+R),v&&d.hasAttribute("morphNormal"+R)===!0&&d.deleteAttribute("morphNormal"+R),i[R]=0)}const T=d.morphTargetsRelative?1:1-w;f.getUniforms().setValue(n,"morphTargetBaseInfluence",T),f.getUniforms().setValue(n,"morphTargetInfluences",i)}}return{update:l}}function pX(n,e,t,r){let i=new WeakMap;function s(l){const u=r.render.frame,d=l.geometry,f=e.get(l,d);if(i.get(f)!==u&&(e.update(f),i.set(f,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),i.get(l)!==u&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),i.set(l,u))),l.isSkinnedMesh){const p=l.skeleton;i.get(p)!==u&&(p.update(),i.set(p,u))}return f}function o(){i=new WeakMap}function a(l){const u=l.target;u.removeEventListener("dispose",a),t.remove(u.instanceMatrix),u.instanceColor!==null&&t.remove(u.instanceColor)}return{update:s,dispose:o}}class $M extends Un{constructor(e,t,r,i,s,o,a,l,u,d){if(d=d!==void 0?d:kl,d!==kl&&d!==_c)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&d===kl&&(r=ko),r===void 0&&d===_c&&(r=Dl),super(null,i,s,o,a,l,d,r,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:Er,this.minFilter=l!==void 0?l:Er,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const RO=new Un,PO=new $M(1,1);PO.compareFunction=BM;const NO=new y0,LO=new GM,DO=new Um,oP=[],aP=[],lP=new Float32Array(16),uP=new Float32Array(9),cP=new Float32Array(4);function Fd(n,e,t){const r=n[0];if(r<=0||r>0)return n;const i=e*t;let s=oP[i];if(s===void 0&&(s=new Float32Array(i),oP[i]=s),e!==0){r.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function Wr(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function jr(n,e){for(let t=0,r=e.length;t<r;t++)n[t]=e[t]}function x0(n,e){let t=aP[e];t===void 0&&(t=new Int32Array(e),aP[e]=t);for(let r=0;r!==e;++r)t[r]=n.allocateTextureUnit();return t}function mX(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function gX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Wr(t,e))return;n.uniform2fv(this.addr,e),jr(t,e)}}function vX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Wr(t,e))return;n.uniform3fv(this.addr,e),jr(t,e)}}function _X(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Wr(t,e))return;n.uniform4fv(this.addr,e),jr(t,e)}}function yX(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Wr(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),jr(t,e)}else{if(Wr(t,r))return;cP.set(r),n.uniformMatrix2fv(this.addr,!1,cP),jr(t,r)}}function xX(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Wr(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),jr(t,e)}else{if(Wr(t,r))return;uP.set(r),n.uniformMatrix3fv(this.addr,!1,uP),jr(t,r)}}function EX(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Wr(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),jr(t,e)}else{if(Wr(t,r))return;lP.set(r),n.uniformMatrix4fv(this.addr,!1,lP),jr(t,r)}}function wX(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function SX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Wr(t,e))return;n.uniform2iv(this.addr,e),jr(t,e)}}function TX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Wr(t,e))return;n.uniform3iv(this.addr,e),jr(t,e)}}function MX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Wr(t,e))return;n.uniform4iv(this.addr,e),jr(t,e)}}function AX(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function CX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Wr(t,e))return;n.uniform2uiv(this.addr,e),jr(t,e)}}function IX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Wr(t,e))return;n.uniform3uiv(this.addr,e),jr(t,e)}}function bX(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Wr(t,e))return;n.uniform4uiv(this.addr,e),jr(t,e)}}function RX(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i);const s=this.type===n.SAMPLER_2D_SHADOW?PO:RO;t.setTexture2D(e||s,i)}function PX(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture3D(e||LO,i)}function NX(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTextureCube(e||DO,i)}function LX(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture2DArray(e||NO,i)}function DX(n){switch(n){case 5126:return mX;case 35664:return gX;case 35665:return vX;case 35666:return _X;case 35674:return yX;case 35675:return xX;case 35676:return EX;case 5124:case 35670:return wX;case 35667:case 35671:return SX;case 35668:case 35672:return TX;case 35669:case 35673:return MX;case 5125:return AX;case 36294:return CX;case 36295:return IX;case 36296:return bX;case 35678:case 36198:case 36298:case 36306:case 35682:return RX;case 35679:case 36299:case 36307:return PX;case 35680:case 36300:case 36308:case 36293:return NX;case 36289:case 36303:case 36311:case 36292:return LX}}function kX(n,e){n.uniform1fv(this.addr,e)}function OX(n,e){const t=Fd(e,this.size,2);n.uniform2fv(this.addr,t)}function UX(n,e){const t=Fd(e,this.size,3);n.uniform3fv(this.addr,t)}function FX(n,e){const t=Fd(e,this.size,4);n.uniform4fv(this.addr,t)}function VX(n,e){const t=Fd(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function BX(n,e){const t=Fd(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function zX(n,e){const t=Fd(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function HX(n,e){n.uniform1iv(this.addr,e)}function GX(n,e){n.uniform2iv(this.addr,e)}function WX(n,e){n.uniform3iv(this.addr,e)}function jX(n,e){n.uniform4iv(this.addr,e)}function qX(n,e){n.uniform1uiv(this.addr,e)}function XX(n,e){n.uniform2uiv(this.addr,e)}function $X(n,e){n.uniform3uiv(this.addr,e)}function YX(n,e){n.uniform4uiv(this.addr,e)}function KX(n,e,t){const r=this.cache,i=e.length,s=x0(t,i);Wr(r,s)||(n.uniform1iv(this.addr,s),jr(r,s));for(let o=0;o!==i;++o)t.setTexture2D(e[o]||RO,s[o])}function QX(n,e,t){const r=this.cache,i=e.length,s=x0(t,i);Wr(r,s)||(n.uniform1iv(this.addr,s),jr(r,s));for(let o=0;o!==i;++o)t.setTexture3D(e[o]||LO,s[o])}function ZX(n,e,t){const r=this.cache,i=e.length,s=x0(t,i);Wr(r,s)||(n.uniform1iv(this.addr,s),jr(r,s));for(let o=0;o!==i;++o)t.setTextureCube(e[o]||DO,s[o])}function JX(n,e,t){const r=this.cache,i=e.length,s=x0(t,i);Wr(r,s)||(n.uniform1iv(this.addr,s),jr(r,s));for(let o=0;o!==i;++o)t.setTexture2DArray(e[o]||NO,s[o])}function e$(n){switch(n){case 5126:return kX;case 35664:return OX;case 35665:return UX;case 35666:return FX;case 35674:return VX;case 35675:return BX;case 35676:return zX;case 5124:case 35670:return HX;case 35667:case 35671:return GX;case 35668:case 35672:return WX;case 35669:case 35673:return jX;case 5125:return qX;case 36294:return XX;case 36295:return $X;case 36296:return YX;case 35678:case 36198:case 36298:case 36306:case 35682:return KX;case 35679:case 36299:case 36307:return QX;case 35680:case 36300:case 36308:case 36293:return ZX;case 36289:case 36303:case 36311:case 36292:return JX}}class t${constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=DX(t.type)}}class n${constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=e$(t.type)}}class r${constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const i=this.seq;for(let s=0,o=i.length;s!==o;++s){const a=i[s];a.setValue(e,t[a.id],r)}}}const BE=/(\w+)(\])?(\[|\.)?/g;function hP(n,e){n.seq.push(e),n.map[e.id]=e}function i$(n,e,t){const r=n.name,i=r.length;for(BE.lastIndex=0;;){const s=BE.exec(r),o=BE.lastIndex;let a=s[1];const l=s[2]==="]",u=s[3];if(l&&(a=a|0),u===void 0||u==="["&&o+2===i){hP(t,u===void 0?new t$(a,n,e):new n$(a,n,e));break}else{let f=t.map[a];f===void 0&&(f=new r$(a),hP(t,f)),t=f}}}class C_{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){const s=e.getActiveUniform(t,i),o=e.getUniformLocation(t,s.name);i$(s,o,this)}}setValue(e,t,r,i){const s=this.map[t];s!==void 0&&s.setValue(e,r,i)}setOptional(e,t,r){const i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=r[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,i)}}static seqWithValue(e,t){const r=[];for(let i=0,s=e.length;i!==s;++i){const o=e[i];o.id in t&&r.push(o)}return r}}function dP(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}const s$=37297;let o$=0;function a$(n,e){const t=n.split(`
`),r=[],i=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=i;o<s;o++){const a=o+1;r.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return r.join(`
`)}function l$(n){const e=Fn.getPrimaries(Fn.workingColorSpace),t=Fn.getPrimaries(n);let r;switch(e===t?r="":e===Zp&&t===Qp?r="LinearDisplayP3ToLinearSRGB":e===Qp&&t===Zp&&(r="LinearSRGBToLinearDisplayP3"),n){case Ls:case Dm:return[r,"LinearTransferOETF"];case Nr:case _0:return[r,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[r,"LinearTransferOETF"]}}function fP(n,e,t){const r=n.getShaderParameter(e,n.COMPILE_STATUS),i=n.getShaderInfoLog(e).trim();if(r&&i==="")return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+i+`

`+a$(n.getShaderSource(e),o)}else return i}function u$(n,e){const t=l$(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function c$(n,e){let t;switch(e){case Qk:t="Linear";break;case Zk:t="Reinhard";break;case Jk:t="OptimizedCineon";break;case CM:t="ACESFilmic";break;case tO:t="AgX";break;case eO:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function h$(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(jh).join(`
`)}function d$(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":""].filter(jh).join(`
`)}function f$(n){const e=[];for(const t in n){const r=n[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function p$(n,e){const t={},r=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const s=n.getActiveAttrib(e,i),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function jh(n){return n!==""}function pP(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function mP(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const m$=/^[ \t]*#include +<([\w\d./]+)>/gm;function _T(n){return n.replace(m$,v$)}const g$=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function v$(n,e){let t=un[e];if(t===void 0){const r=g$.get(e);if(r!==void 0)t=un[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return _T(t)}const _$=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function gP(n){return n.replace(_$,y$)}function y$(n,e,t,r){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function vP(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function x$(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===p0?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===lp?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===co&&(e="SHADOWMAP_TYPE_VSM"),e}function E$(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Yo:case $l:e="ENVMAP_TYPE_CUBE";break;case Ud:e="ENVMAP_TYPE_CUBE_UV";break}return e}function w$(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case $l:e="ENVMAP_MODE_REFRACTION";break}return e}function S$(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Lm:e="ENVMAP_BLENDING_MULTIPLY";break;case Yk:e="ENVMAP_BLENDING_MIX";break;case Kk:e="ENVMAP_BLENDING_ADD";break}return e}function T$(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:r,maxMip:t}}function M$(n,e,t,r){const i=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=x$(t),u=E$(t),d=w$(t),f=S$(t),p=T$(t),g=t.isWebGL2?"":h$(t),y=d$(t),S=f$(s),x=i.createProgram();let v,w,T=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(v=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S].filter(jh).join(`
`),v.length>0&&(v+=`
`),w=[g,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S].filter(jh).join(`
`),w.length>0&&(w+=`
`)):(v=[vP(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(jh).join(`
`),w=[g,vP(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",t.envMap?"#define "+f:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==qo?"#define TONE_MAPPING":"",t.toneMapping!==qo?un.tonemapping_pars_fragment:"",t.toneMapping!==qo?c$("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",un.colorspace_pars_fragment,u$("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(jh).join(`
`)),o=_T(o),o=pP(o,t),o=mP(o,t),a=_T(a),a=pP(a,t),a=mP(a,t),o=gP(o),a=gP(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(T=`#version 300 es
`,v=[y,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+v,w=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===mT?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===mT?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+w);const R=T+v+o,U=T+w+a,N=dP(i,i.VERTEX_SHADER,R),P=dP(i,i.FRAGMENT_SHADER,U);i.attachShader(x,N),i.attachShader(x,P),t.index0AttributeName!==void 0?i.bindAttribLocation(x,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(x,0,"position"),i.linkProgram(x);function b(z){if(n.debug.checkShaderErrors){const B=i.getProgramInfoLog(x).trim(),$=i.getShaderInfoLog(N).trim(),he=i.getShaderInfoLog(P).trim();let te=!0,ye=!0;if(i.getProgramParameter(x,i.LINK_STATUS)===!1)if(te=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(i,x,N,P);else{const G=fP(i,N,"vertex"),Z=fP(i,P,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(x,i.VALIDATE_STATUS)+`

Program Info Log: `+B+`
`+G+`
`+Z)}else B!==""?console.warn("THREE.WebGLProgram: Program Info Log:",B):($===""||he==="")&&(ye=!1);ye&&(z.diagnostics={runnable:te,programLog:B,vertexShader:{log:$,prefix:v},fragmentShader:{log:he,prefix:w}})}i.deleteShader(N),i.deleteShader(P),M=new C_(i,x),A=p$(i,x)}let M;this.getUniforms=function(){return M===void 0&&b(this),M};let A;this.getAttributes=function(){return A===void 0&&b(this),A};let L=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return L===!1&&(L=i.getProgramParameter(x,s$)),L},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(x),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=o$++,this.cacheKey=e,this.usedTimes=1,this.program=x,this.vertexShader=N,this.fragmentShader=P,this}let A$=0;class C${constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(r),o=this._getShaderCacheForMaterial(e);return o.has(i)===!1&&(o.add(i),i.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return r===void 0&&(r=new I$(e),t.set(e,r)),r}}class I${constructor(e){this.id=A$++,this.code=e,this.usedTimes=0}}function b$(n,e,t,r,i,s,o){const a=new sc,l=new C$,u=[],d=i.isWebGL2,f=i.logarithmicDepthBuffer,p=i.vertexTextures;let g=i.precision;const y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function S(M){return M===0?"uv":`uv${M}`}function x(M,A,L,z,B){const $=z.fog,he=B.geometry,te=M.isMeshStandardMaterial?z.environment:null,ye=(M.isMeshStandardMaterial?t:e).get(M.envMap||te),G=ye&&ye.mapping===Ud?ye.image.height:null,Z=y[M.type];M.precision!==null&&(g=i.getMaxPrecision(M.precision),g!==M.precision&&console.warn("THREE.WebGLProgram.getParameters:",M.precision,"not supported, using",g,"instead."));const K=he.morphAttributes.position||he.morphAttributes.normal||he.morphAttributes.color,ce=K!==void 0?K.length:0;let de=0;he.morphAttributes.position!==void 0&&(de=1),he.morphAttributes.normal!==void 0&&(de=2),he.morphAttributes.color!==void 0&&(de=3);let ue,Ee,Fe,ke;if(Z){const gn=po[Z];ue=gn.vertexShader,Ee=gn.fragmentShader}else ue=M.vertexShader,Ee=M.fragmentShader,l.update(M),Fe=l.getVertexShaderID(M),ke=l.getFragmentShaderID(M);const Ye=n.getRenderTarget(),Ct=B.isInstancedMesh===!0,Dt=B.isBatchedMesh===!0,gt=!!M.map,vt=!!M.matcap,ie=!!ye,Be=!!M.aoMap,Ae=!!M.lightMap,We=!!M.bumpMap,be=!!M.normalMap,At=!!M.displacementMap,st=!!M.emissiveMap,W=!!M.metalnessMap,H=!!M.roughnessMap,_e=M.anisotropy>0,Ve=M.clearcoat>0,ze=M.iridescence>0,De=M.sheen>0,yt=M.transmission>0,Xe=_e&&!!M.anisotropyMap,Qe=Ve&&!!M.clearcoatMap,lt=Ve&&!!M.clearcoatNormalMap,Nt=Ve&&!!M.clearcoatRoughnessMap,He=ze&&!!M.iridescenceMap,tn=ze&&!!M.iridescenceThicknessMap,Ht=De&&!!M.sheenColorMap,xt=De&&!!M.sheenRoughnessMap,ct=!!M.specularMap,ft=!!M.specularColorMap,ae=!!M.specularIntensityMap,Se=yt&&!!M.transmissionMap,Je=yt&&!!M.thicknessMap,ut=!!M.gradientMap,q=!!M.alphaMap,J=M.alphaTest>0,Ne=!!M.alphaHash,Ke=!!M.extensions,Ze=!!he.attributes.uv1,ot=!!he.attributes.uv2,$t=!!he.attributes.uv3;let rn=qo;return M.toneMapped&&(Ye===null||Ye.isXRRenderTarget===!0)&&(rn=n.toneMapping),{isWebGL2:d,shaderID:Z,shaderType:M.type,shaderName:M.name,vertexShader:ue,fragmentShader:Ee,defines:M.defines,customVertexShaderID:Fe,customFragmentShaderID:ke,isRawShaderMaterial:M.isRawShaderMaterial===!0,glslVersion:M.glslVersion,precision:g,batching:Dt,instancing:Ct,instancingColor:Ct&&B.instanceColor!==null,supportsVertexTextures:p,outputColorSpace:Ye===null?n.outputColorSpace:Ye.isXRRenderTarget===!0?Ye.texture.colorSpace:Ls,map:gt,matcap:vt,envMap:ie,envMapMode:ie&&ye.mapping,envMapCubeUVHeight:G,aoMap:Be,lightMap:Ae,bumpMap:We,normalMap:be,displacementMap:p&&At,emissiveMap:st,normalMapObjectSpace:be&&M.normalMapType===fO,normalMapTangentSpace:be&&M.normalMapType===nu,metalnessMap:W,roughnessMap:H,anisotropy:_e,anisotropyMap:Xe,clearcoat:Ve,clearcoatMap:Qe,clearcoatNormalMap:lt,clearcoatRoughnessMap:Nt,iridescence:ze,iridescenceMap:He,iridescenceThicknessMap:tn,sheen:De,sheenColorMap:Ht,sheenRoughnessMap:xt,specularMap:ct,specularColorMap:ft,specularIntensityMap:ae,transmission:yt,transmissionMap:Se,thicknessMap:Je,gradientMap:ut,opaque:M.transparent===!1&&M.blending===rc,alphaMap:q,alphaTest:J,alphaHash:Ne,combine:M.combine,mapUv:gt&&S(M.map.channel),aoMapUv:Be&&S(M.aoMap.channel),lightMapUv:Ae&&S(M.lightMap.channel),bumpMapUv:We&&S(M.bumpMap.channel),normalMapUv:be&&S(M.normalMap.channel),displacementMapUv:At&&S(M.displacementMap.channel),emissiveMapUv:st&&S(M.emissiveMap.channel),metalnessMapUv:W&&S(M.metalnessMap.channel),roughnessMapUv:H&&S(M.roughnessMap.channel),anisotropyMapUv:Xe&&S(M.anisotropyMap.channel),clearcoatMapUv:Qe&&S(M.clearcoatMap.channel),clearcoatNormalMapUv:lt&&S(M.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Nt&&S(M.clearcoatRoughnessMap.channel),iridescenceMapUv:He&&S(M.iridescenceMap.channel),iridescenceThicknessMapUv:tn&&S(M.iridescenceThicknessMap.channel),sheenColorMapUv:Ht&&S(M.sheenColorMap.channel),sheenRoughnessMapUv:xt&&S(M.sheenRoughnessMap.channel),specularMapUv:ct&&S(M.specularMap.channel),specularColorMapUv:ft&&S(M.specularColorMap.channel),specularIntensityMapUv:ae&&S(M.specularIntensityMap.channel),transmissionMapUv:Se&&S(M.transmissionMap.channel),thicknessMapUv:Je&&S(M.thicknessMap.channel),alphaMapUv:q&&S(M.alphaMap.channel),vertexTangents:!!he.attributes.tangent&&(be||_e),vertexColors:M.vertexColors,vertexAlphas:M.vertexColors===!0&&!!he.attributes.color&&he.attributes.color.itemSize===4,vertexUv1s:Ze,vertexUv2s:ot,vertexUv3s:$t,pointsUvs:B.isPoints===!0&&!!he.attributes.uv&&(gt||q),fog:!!$,useFog:M.fog===!0,fogExp2:$&&$.isFogExp2,flatShading:M.flatShading===!0,sizeAttenuation:M.sizeAttenuation===!0,logarithmicDepthBuffer:f,skinning:B.isSkinnedMesh===!0,morphTargets:he.morphAttributes.position!==void 0,morphNormals:he.morphAttributes.normal!==void 0,morphColors:he.morphAttributes.color!==void 0,morphTargetsCount:ce,morphTextureStride:de,numDirLights:A.directional.length,numPointLights:A.point.length,numSpotLights:A.spot.length,numSpotLightMaps:A.spotLightMap.length,numRectAreaLights:A.rectArea.length,numHemiLights:A.hemi.length,numDirLightShadows:A.directionalShadowMap.length,numPointLightShadows:A.pointShadowMap.length,numSpotLightShadows:A.spotShadowMap.length,numSpotLightShadowsWithMaps:A.numSpotLightShadowsWithMaps,numLightProbes:A.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:M.dithering,shadowMapEnabled:n.shadowMap.enabled&&L.length>0,shadowMapType:n.shadowMap.type,toneMapping:rn,useLegacyLights:n._useLegacyLights,decodeVideoTexture:gt&&M.map.isVideoTexture===!0&&Fn.getTransfer(M.map.colorSpace)===jn,premultipliedAlpha:M.premultipliedAlpha,doubleSided:M.side===mo,flipSided:M.side===Hi,useDepthPacking:M.depthPacking>=0,depthPacking:M.depthPacking||0,index0AttributeName:M.index0AttributeName,extensionDerivatives:Ke&&M.extensions.derivatives===!0,extensionFragDepth:Ke&&M.extensions.fragDepth===!0,extensionDrawBuffers:Ke&&M.extensions.drawBuffers===!0,extensionShaderTextureLOD:Ke&&M.extensions.shaderTextureLOD===!0,extensionClipCullDistance:Ke&&M.extensions.clipCullDistance&&r.has("WEBGL_clip_cull_distance"),rendererExtensionFragDepth:d||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||r.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:M.customProgramCacheKey()}}function v(M){const A=[];if(M.shaderID?A.push(M.shaderID):(A.push(M.customVertexShaderID),A.push(M.customFragmentShaderID)),M.defines!==void 0)for(const L in M.defines)A.push(L),A.push(M.defines[L]);return M.isRawShaderMaterial===!1&&(w(A,M),T(A,M),A.push(n.outputColorSpace)),A.push(M.customProgramCacheKey),A.join()}function w(M,A){M.push(A.precision),M.push(A.outputColorSpace),M.push(A.envMapMode),M.push(A.envMapCubeUVHeight),M.push(A.mapUv),M.push(A.alphaMapUv),M.push(A.lightMapUv),M.push(A.aoMapUv),M.push(A.bumpMapUv),M.push(A.normalMapUv),M.push(A.displacementMapUv),M.push(A.emissiveMapUv),M.push(A.metalnessMapUv),M.push(A.roughnessMapUv),M.push(A.anisotropyMapUv),M.push(A.clearcoatMapUv),M.push(A.clearcoatNormalMapUv),M.push(A.clearcoatRoughnessMapUv),M.push(A.iridescenceMapUv),M.push(A.iridescenceThicknessMapUv),M.push(A.sheenColorMapUv),M.push(A.sheenRoughnessMapUv),M.push(A.specularMapUv),M.push(A.specularColorMapUv),M.push(A.specularIntensityMapUv),M.push(A.transmissionMapUv),M.push(A.thicknessMapUv),M.push(A.combine),M.push(A.fogExp2),M.push(A.sizeAttenuation),M.push(A.morphTargetsCount),M.push(A.morphAttributeCount),M.push(A.numDirLights),M.push(A.numPointLights),M.push(A.numSpotLights),M.push(A.numSpotLightMaps),M.push(A.numHemiLights),M.push(A.numRectAreaLights),M.push(A.numDirLightShadows),M.push(A.numPointLightShadows),M.push(A.numSpotLightShadows),M.push(A.numSpotLightShadowsWithMaps),M.push(A.numLightProbes),M.push(A.shadowMapType),M.push(A.toneMapping),M.push(A.numClippingPlanes),M.push(A.numClipIntersection),M.push(A.depthPacking)}function T(M,A){a.disableAll(),A.isWebGL2&&a.enable(0),A.supportsVertexTextures&&a.enable(1),A.instancing&&a.enable(2),A.instancingColor&&a.enable(3),A.matcap&&a.enable(4),A.envMap&&a.enable(5),A.normalMapObjectSpace&&a.enable(6),A.normalMapTangentSpace&&a.enable(7),A.clearcoat&&a.enable(8),A.iridescence&&a.enable(9),A.alphaTest&&a.enable(10),A.vertexColors&&a.enable(11),A.vertexAlphas&&a.enable(12),A.vertexUv1s&&a.enable(13),A.vertexUv2s&&a.enable(14),A.vertexUv3s&&a.enable(15),A.vertexTangents&&a.enable(16),A.anisotropy&&a.enable(17),A.alphaHash&&a.enable(18),A.batching&&a.enable(19),M.push(a.mask),a.disableAll(),A.fog&&a.enable(0),A.useFog&&a.enable(1),A.flatShading&&a.enable(2),A.logarithmicDepthBuffer&&a.enable(3),A.skinning&&a.enable(4),A.morphTargets&&a.enable(5),A.morphNormals&&a.enable(6),A.morphColors&&a.enable(7),A.premultipliedAlpha&&a.enable(8),A.shadowMapEnabled&&a.enable(9),A.useLegacyLights&&a.enable(10),A.doubleSided&&a.enable(11),A.flipSided&&a.enable(12),A.useDepthPacking&&a.enable(13),A.dithering&&a.enable(14),A.transmission&&a.enable(15),A.sheen&&a.enable(16),A.opaque&&a.enable(17),A.pointsUvs&&a.enable(18),A.decodeVideoTexture&&a.enable(19),M.push(a.mask)}function R(M){const A=y[M.type];let L;if(A){const z=po[A];L=CO.clone(z.uniforms)}else L=M.uniforms;return L}function U(M,A){let L;for(let z=0,B=u.length;z<B;z++){const $=u[z];if($.cacheKey===A){L=$,++L.usedTimes;break}}return L===void 0&&(L=new M$(n,A,M,s),u.push(L)),L}function N(M){if(--M.usedTimes===0){const A=u.indexOf(M);u[A]=u[u.length-1],u.pop(),M.destroy()}}function P(M){l.remove(M)}function b(){l.dispose()}return{getParameters:x,getProgramCacheKey:v,getUniforms:R,acquireProgram:U,releaseProgram:N,releaseShaderCache:P,programs:u,dispose:b}}function R$(){let n=new WeakMap;function e(s){let o=n.get(s);return o===void 0&&(o={},n.set(s,o)),o}function t(s){n.delete(s)}function r(s,o,a){n.get(s)[o]=a}function i(){n=new WeakMap}return{get:e,remove:t,update:r,dispose:i}}function P$(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function _P(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function yP(){const n=[];let e=0;const t=[],r=[],i=[];function s(){e=0,t.length=0,r.length=0,i.length=0}function o(f,p,g,y,S,x){let v=n[e];return v===void 0?(v={id:f.id,object:f,geometry:p,material:g,groupOrder:y,renderOrder:f.renderOrder,z:S,group:x},n[e]=v):(v.id=f.id,v.object=f,v.geometry=p,v.material=g,v.groupOrder=y,v.renderOrder=f.renderOrder,v.z=S,v.group=x),e++,v}function a(f,p,g,y,S,x){const v=o(f,p,g,y,S,x);g.transmission>0?r.push(v):g.transparent===!0?i.push(v):t.push(v)}function l(f,p,g,y,S,x){const v=o(f,p,g,y,S,x);g.transmission>0?r.unshift(v):g.transparent===!0?i.unshift(v):t.unshift(v)}function u(f,p){t.length>1&&t.sort(f||P$),r.length>1&&r.sort(p||_P),i.length>1&&i.sort(p||_P)}function d(){for(let f=e,p=n.length;f<p;f++){const g=n[f];if(g.id===null)break;g.id=null,g.object=null,g.geometry=null,g.material=null,g.group=null}}return{opaque:t,transmissive:r,transparent:i,init:s,push:a,unshift:l,finish:d,sort:u}}function N$(){let n=new WeakMap;function e(r,i){const s=n.get(r);let o;return s===void 0?(o=new yP,n.set(r,[o])):i>=s.length?(o=new yP,s.push(o)):o=s[i],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function L$(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Q,color:new Tt};break;case"SpotLight":t={position:new Q,direction:new Q,color:new Tt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Q,color:new Tt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Q,skyColor:new Tt,groundColor:new Tt};break;case"RectAreaLight":t={color:new Tt,position:new Q,halfWidth:new Q,halfHeight:new Q};break}return n[e.id]=t,t}}}function D$(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ue};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ue};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ue,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let k$=0;function O$(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function U$(n,e){const t=new L$,r=D$(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let d=0;d<9;d++)i.probe.push(new Q);const s=new Q,o=new en,a=new en;function l(d,f){let p=0,g=0,y=0;for(let z=0;z<9;z++)i.probe[z].set(0,0,0);let S=0,x=0,v=0,w=0,T=0,R=0,U=0,N=0,P=0,b=0,M=0;d.sort(O$);const A=f===!0?Math.PI:1;for(let z=0,B=d.length;z<B;z++){const $=d[z],he=$.color,te=$.intensity,ye=$.distance,G=$.shadow&&$.shadow.map?$.shadow.map.texture:null;if($.isAmbientLight)p+=he.r*te*A,g+=he.g*te*A,y+=he.b*te*A;else if($.isLightProbe){for(let Z=0;Z<9;Z++)i.probe[Z].addScaledVector($.sh.coefficients[Z],te);M++}else if($.isDirectionalLight){const Z=t.get($);if(Z.color.copy($.color).multiplyScalar($.intensity*A),$.castShadow){const K=$.shadow,ce=r.get($);ce.shadowBias=K.bias,ce.shadowNormalBias=K.normalBias,ce.shadowRadius=K.radius,ce.shadowMapSize=K.mapSize,i.directionalShadow[S]=ce,i.directionalShadowMap[S]=G,i.directionalShadowMatrix[S]=$.shadow.matrix,R++}i.directional[S]=Z,S++}else if($.isSpotLight){const Z=t.get($);Z.position.setFromMatrixPosition($.matrixWorld),Z.color.copy(he).multiplyScalar(te*A),Z.distance=ye,Z.coneCos=Math.cos($.angle),Z.penumbraCos=Math.cos($.angle*(1-$.penumbra)),Z.decay=$.decay,i.spot[v]=Z;const K=$.shadow;if($.map&&(i.spotLightMap[P]=$.map,P++,K.updateMatrices($),$.castShadow&&b++),i.spotLightMatrix[v]=K.matrix,$.castShadow){const ce=r.get($);ce.shadowBias=K.bias,ce.shadowNormalBias=K.normalBias,ce.shadowRadius=K.radius,ce.shadowMapSize=K.mapSize,i.spotShadow[v]=ce,i.spotShadowMap[v]=G,N++}v++}else if($.isRectAreaLight){const Z=t.get($);Z.color.copy(he).multiplyScalar(te),Z.halfWidth.set($.width*.5,0,0),Z.halfHeight.set(0,$.height*.5,0),i.rectArea[w]=Z,w++}else if($.isPointLight){const Z=t.get($);if(Z.color.copy($.color).multiplyScalar($.intensity*A),Z.distance=$.distance,Z.decay=$.decay,$.castShadow){const K=$.shadow,ce=r.get($);ce.shadowBias=K.bias,ce.shadowNormalBias=K.normalBias,ce.shadowRadius=K.radius,ce.shadowMapSize=K.mapSize,ce.shadowCameraNear=K.camera.near,ce.shadowCameraFar=K.camera.far,i.pointShadow[x]=ce,i.pointShadowMap[x]=G,i.pointShadowMatrix[x]=$.shadow.matrix,U++}i.point[x]=Z,x++}else if($.isHemisphereLight){const Z=t.get($);Z.skyColor.copy($.color).multiplyScalar(te*A),Z.groundColor.copy($.groundColor).multiplyScalar(te*A),i.hemi[T]=Z,T++}}w>0&&(e.isWebGL2?n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=dt.LTC_FLOAT_1,i.rectAreaLTC2=dt.LTC_FLOAT_2):(i.rectAreaLTC1=dt.LTC_HALF_1,i.rectAreaLTC2=dt.LTC_HALF_2):n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=dt.LTC_FLOAT_1,i.rectAreaLTC2=dt.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(i.rectAreaLTC1=dt.LTC_HALF_1,i.rectAreaLTC2=dt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=p,i.ambient[1]=g,i.ambient[2]=y;const L=i.hash;(L.directionalLength!==S||L.pointLength!==x||L.spotLength!==v||L.rectAreaLength!==w||L.hemiLength!==T||L.numDirectionalShadows!==R||L.numPointShadows!==U||L.numSpotShadows!==N||L.numSpotMaps!==P||L.numLightProbes!==M)&&(i.directional.length=S,i.spot.length=v,i.rectArea.length=w,i.point.length=x,i.hemi.length=T,i.directionalShadow.length=R,i.directionalShadowMap.length=R,i.pointShadow.length=U,i.pointShadowMap.length=U,i.spotShadow.length=N,i.spotShadowMap.length=N,i.directionalShadowMatrix.length=R,i.pointShadowMatrix.length=U,i.spotLightMatrix.length=N+P-b,i.spotLightMap.length=P,i.numSpotLightShadowsWithMaps=b,i.numLightProbes=M,L.directionalLength=S,L.pointLength=x,L.spotLength=v,L.rectAreaLength=w,L.hemiLength=T,L.numDirectionalShadows=R,L.numPointShadows=U,L.numSpotShadows=N,L.numSpotMaps=P,L.numLightProbes=M,i.version=k$++)}function u(d,f){let p=0,g=0,y=0,S=0,x=0;const v=f.matrixWorldInverse;for(let w=0,T=d.length;w<T;w++){const R=d[w];if(R.isDirectionalLight){const U=i.directional[p];U.direction.setFromMatrixPosition(R.matrixWorld),s.setFromMatrixPosition(R.target.matrixWorld),U.direction.sub(s),U.direction.transformDirection(v),p++}else if(R.isSpotLight){const U=i.spot[y];U.position.setFromMatrixPosition(R.matrixWorld),U.position.applyMatrix4(v),U.direction.setFromMatrixPosition(R.matrixWorld),s.setFromMatrixPosition(R.target.matrixWorld),U.direction.sub(s),U.direction.transformDirection(v),y++}else if(R.isRectAreaLight){const U=i.rectArea[S];U.position.setFromMatrixPosition(R.matrixWorld),U.position.applyMatrix4(v),a.identity(),o.copy(R.matrixWorld),o.premultiply(v),a.extractRotation(o),U.halfWidth.set(R.width*.5,0,0),U.halfHeight.set(0,R.height*.5,0),U.halfWidth.applyMatrix4(a),U.halfHeight.applyMatrix4(a),S++}else if(R.isPointLight){const U=i.point[g];U.position.setFromMatrixPosition(R.matrixWorld),U.position.applyMatrix4(v),g++}else if(R.isHemisphereLight){const U=i.hemi[x];U.direction.setFromMatrixPosition(R.matrixWorld),U.direction.transformDirection(v),x++}}}return{setup:l,setupView:u,state:i}}function xP(n,e){const t=new U$(n,e),r=[],i=[];function s(){r.length=0,i.length=0}function o(f){r.push(f)}function a(f){i.push(f)}function l(f){t.setup(r,f)}function u(f){t.setupView(r,f)}return{init:s,state:{lightsArray:r,shadowsArray:i,lights:t},setupLights:l,setupLightsView:u,pushLight:o,pushShadow:a}}function F$(n,e){let t=new WeakMap;function r(s,o=0){const a=t.get(s);let l;return a===void 0?(l=new xP(n,e),t.set(s,[l])):o>=a.length?(l=new xP(n,e),a.push(l)):l=a[o],l}function i(){t=new WeakMap}return{get:r,dispose:i}}class E0 extends ui{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=hO,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class YM extends ui{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const V$=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,B$=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function z$(n,e,t){let r=new Fm;const i=new Ue,s=new Ue,o=new Vn,a=new E0({depthPacking:dO}),l=new YM,u={},d=t.maxTextureSize,f={[Na]:Hi,[Hi]:Na,[mo]:mo},p=new ji({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ue},radius:{value:4}},vertexShader:V$,fragmentShader:B$}),g=p.clone();g.defines.HORIZONTAL_PASS=1;const y=new hn;y.setAttribute("position",new zn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const S=new sr(y,p),x=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=p0;let v=this.type;this.render=function(N,P,b){if(x.enabled===!1||x.autoUpdate===!1&&x.needsUpdate===!1||N.length===0)return;const M=n.getRenderTarget(),A=n.getActiveCubeFace(),L=n.getActiveMipmapLevel(),z=n.state;z.setBlending(jo),z.buffers.color.setClear(1,1,1,1),z.buffers.depth.setTest(!0),z.setScissorTest(!1);const B=v!==co&&this.type===co,$=v===co&&this.type!==co;for(let he=0,te=N.length;he<te;he++){const ye=N[he],G=ye.shadow;if(G===void 0){console.warn("THREE.WebGLShadowMap:",ye,"has no shadow.");continue}if(G.autoUpdate===!1&&G.needsUpdate===!1)continue;i.copy(G.mapSize);const Z=G.getFrameExtents();if(i.multiply(Z),s.copy(G.mapSize),(i.x>d||i.y>d)&&(i.x>d&&(s.x=Math.floor(d/Z.x),i.x=s.x*Z.x,G.mapSize.x=s.x),i.y>d&&(s.y=Math.floor(d/Z.y),i.y=s.y*Z.y,G.mapSize.y=s.y)),G.map===null||B===!0||$===!0){const ce=this.type!==co?{minFilter:Er,magFilter:Er}:{};G.map!==null&&G.map.dispose(),G.map=new Wi(i.x,i.y,ce),G.map.texture.name=ye.name+".shadowMap",G.camera.updateProjectionMatrix()}n.setRenderTarget(G.map),n.clear();const K=G.getViewportCount();for(let ce=0;ce<K;ce++){const de=G.getViewport(ce);o.set(s.x*de.x,s.y*de.y,s.x*de.z,s.y*de.w),z.viewport(o),G.updateMatrices(ye,ce),r=G.getFrustum(),R(P,b,G.camera,ye,this.type)}G.isPointLightShadow!==!0&&this.type===co&&w(G,b),G.needsUpdate=!1}v=this.type,x.needsUpdate=!1,n.setRenderTarget(M,A,L)};function w(N,P){const b=e.update(S);p.defines.VSM_SAMPLES!==N.blurSamples&&(p.defines.VSM_SAMPLES=N.blurSamples,g.defines.VSM_SAMPLES=N.blurSamples,p.needsUpdate=!0,g.needsUpdate=!0),N.mapPass===null&&(N.mapPass=new Wi(i.x,i.y)),p.uniforms.shadow_pass.value=N.map.texture,p.uniforms.resolution.value=N.mapSize,p.uniforms.radius.value=N.radius,n.setRenderTarget(N.mapPass),n.clear(),n.renderBufferDirect(P,null,b,p,S,null),g.uniforms.shadow_pass.value=N.mapPass.texture,g.uniforms.resolution.value=N.mapSize,g.uniforms.radius.value=N.radius,n.setRenderTarget(N.map),n.clear(),n.renderBufferDirect(P,null,b,g,S,null)}function T(N,P,b,M){let A=null;const L=b.isPointLight===!0?N.customDistanceMaterial:N.customDepthMaterial;if(L!==void 0)A=L;else if(A=b.isPointLight===!0?l:a,n.localClippingEnabled&&P.clipShadows===!0&&Array.isArray(P.clippingPlanes)&&P.clippingPlanes.length!==0||P.displacementMap&&P.displacementScale!==0||P.alphaMap&&P.alphaTest>0||P.map&&P.alphaTest>0){const z=A.uuid,B=P.uuid;let $=u[z];$===void 0&&($={},u[z]=$);let he=$[B];he===void 0&&(he=A.clone(),$[B]=he,P.addEventListener("dispose",U)),A=he}if(A.visible=P.visible,A.wireframe=P.wireframe,M===co?A.side=P.shadowSide!==null?P.shadowSide:P.side:A.side=P.shadowSide!==null?P.shadowSide:f[P.side],A.alphaMap=P.alphaMap,A.alphaTest=P.alphaTest,A.map=P.map,A.clipShadows=P.clipShadows,A.clippingPlanes=P.clippingPlanes,A.clipIntersection=P.clipIntersection,A.displacementMap=P.displacementMap,A.displacementScale=P.displacementScale,A.displacementBias=P.displacementBias,A.wireframeLinewidth=P.wireframeLinewidth,A.linewidth=P.linewidth,b.isPointLight===!0&&A.isMeshDistanceMaterial===!0){const z=n.properties.get(A);z.light=b}return A}function R(N,P,b,M,A){if(N.visible===!1)return;if(N.layers.test(P.layers)&&(N.isMesh||N.isLine||N.isPoints)&&(N.castShadow||N.receiveShadow&&A===co)&&(!N.frustumCulled||r.intersectsObject(N))){N.modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,N.matrixWorld);const B=e.update(N),$=N.material;if(Array.isArray($)){const he=B.groups;for(let te=0,ye=he.length;te<ye;te++){const G=he[te],Z=$[G.materialIndex];if(Z&&Z.visible){const K=T(N,Z,M,A);N.onBeforeShadow(n,N,P,b,B,K,G),n.renderBufferDirect(b,null,B,K,N,G),N.onAfterShadow(n,N,P,b,B,K,G)}}}else if($.visible){const he=T(N,$,M,A);N.onBeforeShadow(n,N,P,b,B,he,null),n.renderBufferDirect(b,null,B,he,N,null),N.onAfterShadow(n,N,P,b,B,he,null)}}const z=N.children;for(let B=0,$=z.length;B<$;B++)R(z[B],P,b,M,A)}function U(N){N.target.removeEventListener("dispose",U);for(const b in u){const M=u[b],A=N.target.uuid;A in M&&(M[A].dispose(),delete M[A])}}}function H$(n,e,t){const r=t.isWebGL2;function i(){let J=!1;const Ne=new Vn;let Ke=null;const Ze=new Vn(0,0,0,0);return{setMask:function(ot){Ke!==ot&&!J&&(n.colorMask(ot,ot,ot,ot),Ke=ot)},setLocked:function(ot){J=ot},setClear:function(ot,$t,rn,sn,gn){gn===!0&&(ot*=sn,$t*=sn,rn*=sn),Ne.set(ot,$t,rn,sn),Ze.equals(Ne)===!1&&(n.clearColor(ot,$t,rn,sn),Ze.copy(Ne))},reset:function(){J=!1,Ke=null,Ze.set(-1,0,0,0)}}}function s(){let J=!1,Ne=null,Ke=null,Ze=null;return{setTest:function(ot){ot?Dt(n.DEPTH_TEST):gt(n.DEPTH_TEST)},setMask:function(ot){Ne!==ot&&!J&&(n.depthMask(ot),Ne=ot)},setFunc:function(ot){if(Ke!==ot){switch(ot){case Hk:n.depthFunc(n.NEVER);break;case Gk:n.depthFunc(n.ALWAYS);break;case Wk:n.depthFunc(n.LESS);break;case Gp:n.depthFunc(n.LEQUAL);break;case jk:n.depthFunc(n.EQUAL);break;case qk:n.depthFunc(n.GEQUAL);break;case Xk:n.depthFunc(n.GREATER);break;case $k:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Ke=ot}},setLocked:function(ot){J=ot},setClear:function(ot){Ze!==ot&&(n.clearDepth(ot),Ze=ot)},reset:function(){J=!1,Ne=null,Ke=null,Ze=null}}}function o(){let J=!1,Ne=null,Ke=null,Ze=null,ot=null,$t=null,rn=null,sn=null,gn=null;return{setTest:function(Vt){J||(Vt?Dt(n.STENCIL_TEST):gt(n.STENCIL_TEST))},setMask:function(Vt){Ne!==Vt&&!J&&(n.stencilMask(Vt),Ne=Vt)},setFunc:function(Vt,$n,ur){(Ke!==Vt||Ze!==$n||ot!==ur)&&(n.stencilFunc(Vt,$n,ur),Ke=Vt,Ze=$n,ot=ur)},setOp:function(Vt,$n,ur){($t!==Vt||rn!==$n||sn!==ur)&&(n.stencilOp(Vt,$n,ur),$t=Vt,rn=$n,sn=ur)},setLocked:function(Vt){J=Vt},setClear:function(Vt){gn!==Vt&&(n.clearStencil(Vt),gn=Vt)},reset:function(){J=!1,Ne=null,Ke=null,Ze=null,ot=null,$t=null,rn=null,sn=null,gn=null}}}const a=new i,l=new s,u=new o,d=new WeakMap,f=new WeakMap;let p={},g={},y=new WeakMap,S=[],x=null,v=!1,w=null,T=null,R=null,U=null,N=null,P=null,b=null,M=new Tt(0,0,0),A=0,L=!1,z=null,B=null,$=null,he=null,te=null;const ye=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let G=!1,Z=0;const K=n.getParameter(n.VERSION);K.indexOf("WebGL")!==-1?(Z=parseFloat(/^WebGL (\d)/.exec(K)[1]),G=Z>=1):K.indexOf("OpenGL ES")!==-1&&(Z=parseFloat(/^OpenGL ES (\d)/.exec(K)[1]),G=Z>=2);let ce=null,de={};const ue=n.getParameter(n.SCISSOR_BOX),Ee=n.getParameter(n.VIEWPORT),Fe=new Vn().fromArray(ue),ke=new Vn().fromArray(Ee);function Ye(J,Ne,Ke,Ze){const ot=new Uint8Array(4),$t=n.createTexture();n.bindTexture(J,$t),n.texParameteri(J,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(J,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let rn=0;rn<Ke;rn++)r&&(J===n.TEXTURE_3D||J===n.TEXTURE_2D_ARRAY)?n.texImage3D(Ne,0,n.RGBA,1,1,Ze,0,n.RGBA,n.UNSIGNED_BYTE,ot):n.texImage2D(Ne+rn,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,ot);return $t}const Ct={};Ct[n.TEXTURE_2D]=Ye(n.TEXTURE_2D,n.TEXTURE_2D,1),Ct[n.TEXTURE_CUBE_MAP]=Ye(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),r&&(Ct[n.TEXTURE_2D_ARRAY]=Ye(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Ct[n.TEXTURE_3D]=Ye(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),u.setClear(0),Dt(n.DEPTH_TEST),l.setFunc(Gp),st(!1),W(kS),Dt(n.CULL_FACE),be(jo);function Dt(J){p[J]!==!0&&(n.enable(J),p[J]=!0)}function gt(J){p[J]!==!1&&(n.disable(J),p[J]=!1)}function vt(J,Ne){return g[J]!==Ne?(n.bindFramebuffer(J,Ne),g[J]=Ne,r&&(J===n.DRAW_FRAMEBUFFER&&(g[n.FRAMEBUFFER]=Ne),J===n.FRAMEBUFFER&&(g[n.DRAW_FRAMEBUFFER]=Ne)),!0):!1}function ie(J,Ne){let Ke=S,Ze=!1;if(J)if(Ke=y.get(Ne),Ke===void 0&&(Ke=[],y.set(Ne,Ke)),J.isWebGLMultipleRenderTargets){const ot=J.texture;if(Ke.length!==ot.length||Ke[0]!==n.COLOR_ATTACHMENT0){for(let $t=0,rn=ot.length;$t<rn;$t++)Ke[$t]=n.COLOR_ATTACHMENT0+$t;Ke.length=ot.length,Ze=!0}}else Ke[0]!==n.COLOR_ATTACHMENT0&&(Ke[0]=n.COLOR_ATTACHMENT0,Ze=!0);else Ke[0]!==n.BACK&&(Ke[0]=n.BACK,Ze=!0);Ze&&(t.isWebGL2?n.drawBuffers(Ke):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Ke))}function Be(J){return x!==J?(n.useProgram(J),x=J,!0):!1}const Ae={[ml]:n.FUNC_ADD,[Ck]:n.FUNC_SUBTRACT,[Ik]:n.FUNC_REVERSE_SUBTRACT};if(r)Ae[VS]=n.MIN,Ae[BS]=n.MAX;else{const J=e.get("EXT_blend_minmax");J!==null&&(Ae[VS]=J.MIN_EXT,Ae[BS]=J.MAX_EXT)}const We={[bk]:n.ZERO,[Rk]:n.ONE,[Pk]:n.SRC_COLOR,[wy]:n.SRC_ALPHA,[Uk]:n.SRC_ALPHA_SATURATE,[kk]:n.DST_COLOR,[Lk]:n.DST_ALPHA,[Nk]:n.ONE_MINUS_SRC_COLOR,[Sy]:n.ONE_MINUS_SRC_ALPHA,[Ok]:n.ONE_MINUS_DST_COLOR,[Dk]:n.ONE_MINUS_DST_ALPHA,[Fk]:n.CONSTANT_COLOR,[Vk]:n.ONE_MINUS_CONSTANT_COLOR,[Bk]:n.CONSTANT_ALPHA,[zk]:n.ONE_MINUS_CONSTANT_ALPHA};function be(J,Ne,Ke,Ze,ot,$t,rn,sn,gn,Vt){if(J===jo){v===!0&&(gt(n.BLEND),v=!1);return}if(v===!1&&(Dt(n.BLEND),v=!0),J!==Ak){if(J!==w||Vt!==L){if((T!==ml||N!==ml)&&(n.blendEquation(n.FUNC_ADD),T=ml,N=ml),Vt)switch(J){case rc:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case OS:n.blendFunc(n.ONE,n.ONE);break;case US:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case FS:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",J);break}else switch(J){case rc:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case OS:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case US:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case FS:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",J);break}R=null,U=null,P=null,b=null,M.set(0,0,0),A=0,w=J,L=Vt}return}ot=ot||Ne,$t=$t||Ke,rn=rn||Ze,(Ne!==T||ot!==N)&&(n.blendEquationSeparate(Ae[Ne],Ae[ot]),T=Ne,N=ot),(Ke!==R||Ze!==U||$t!==P||rn!==b)&&(n.blendFuncSeparate(We[Ke],We[Ze],We[$t],We[rn]),R=Ke,U=Ze,P=$t,b=rn),(sn.equals(M)===!1||gn!==A)&&(n.blendColor(sn.r,sn.g,sn.b,gn),M.copy(sn),A=gn),w=J,L=!1}function At(J,Ne){J.side===mo?gt(n.CULL_FACE):Dt(n.CULL_FACE);let Ke=J.side===Hi;Ne&&(Ke=!Ke),st(Ke),J.blending===rc&&J.transparent===!1?be(jo):be(J.blending,J.blendEquation,J.blendSrc,J.blendDst,J.blendEquationAlpha,J.blendSrcAlpha,J.blendDstAlpha,J.blendColor,J.blendAlpha,J.premultipliedAlpha),l.setFunc(J.depthFunc),l.setTest(J.depthTest),l.setMask(J.depthWrite),a.setMask(J.colorWrite);const Ze=J.stencilWrite;u.setTest(Ze),Ze&&(u.setMask(J.stencilWriteMask),u.setFunc(J.stencilFunc,J.stencilRef,J.stencilFuncMask),u.setOp(J.stencilFail,J.stencilZFail,J.stencilZPass)),_e(J.polygonOffset,J.polygonOffsetFactor,J.polygonOffsetUnits),J.alphaToCoverage===!0?Dt(n.SAMPLE_ALPHA_TO_COVERAGE):gt(n.SAMPLE_ALPHA_TO_COVERAGE)}function st(J){z!==J&&(J?n.frontFace(n.CW):n.frontFace(n.CCW),z=J)}function W(J){J!==Sk?(Dt(n.CULL_FACE),J!==B&&(J===kS?n.cullFace(n.BACK):J===Tk?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):gt(n.CULL_FACE),B=J}function H(J){J!==$&&(G&&n.lineWidth(J),$=J)}function _e(J,Ne,Ke){J?(Dt(n.POLYGON_OFFSET_FILL),(he!==Ne||te!==Ke)&&(n.polygonOffset(Ne,Ke),he=Ne,te=Ke)):gt(n.POLYGON_OFFSET_FILL)}function Ve(J){J?Dt(n.SCISSOR_TEST):gt(n.SCISSOR_TEST)}function ze(J){J===void 0&&(J=n.TEXTURE0+ye-1),ce!==J&&(n.activeTexture(J),ce=J)}function De(J,Ne,Ke){Ke===void 0&&(ce===null?Ke=n.TEXTURE0+ye-1:Ke=ce);let Ze=de[Ke];Ze===void 0&&(Ze={type:void 0,texture:void 0},de[Ke]=Ze),(Ze.type!==J||Ze.texture!==Ne)&&(ce!==Ke&&(n.activeTexture(Ke),ce=Ke),n.bindTexture(J,Ne||Ct[J]),Ze.type=J,Ze.texture=Ne)}function yt(){const J=de[ce];J!==void 0&&J.type!==void 0&&(n.bindTexture(J.type,null),J.type=void 0,J.texture=void 0)}function Xe(){try{n.compressedTexImage2D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Qe(){try{n.compressedTexImage3D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function lt(){try{n.texSubImage2D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Nt(){try{n.texSubImage3D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function He(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function tn(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Ht(){try{n.texStorage2D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function xt(){try{n.texStorage3D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function ct(){try{n.texImage2D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function ft(){try{n.texImage3D.apply(n,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function ae(J){Fe.equals(J)===!1&&(n.scissor(J.x,J.y,J.z,J.w),Fe.copy(J))}function Se(J){ke.equals(J)===!1&&(n.viewport(J.x,J.y,J.z,J.w),ke.copy(J))}function Je(J,Ne){let Ke=f.get(Ne);Ke===void 0&&(Ke=new WeakMap,f.set(Ne,Ke));let Ze=Ke.get(J);Ze===void 0&&(Ze=n.getUniformBlockIndex(Ne,J.name),Ke.set(J,Ze))}function ut(J,Ne){const Ze=f.get(Ne).get(J);d.get(Ne)!==Ze&&(n.uniformBlockBinding(Ne,Ze,J.__bindingPointIndex),d.set(Ne,Ze))}function q(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),r===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),p={},ce=null,de={},g={},y=new WeakMap,S=[],x=null,v=!1,w=null,T=null,R=null,U=null,N=null,P=null,b=null,M=new Tt(0,0,0),A=0,L=!1,z=null,B=null,$=null,he=null,te=null,Fe.set(0,0,n.canvas.width,n.canvas.height),ke.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),u.reset()}return{buffers:{color:a,depth:l,stencil:u},enable:Dt,disable:gt,bindFramebuffer:vt,drawBuffers:ie,useProgram:Be,setBlending:be,setMaterial:At,setFlipSided:st,setCullFace:W,setLineWidth:H,setPolygonOffset:_e,setScissorTest:Ve,activeTexture:ze,bindTexture:De,unbindTexture:yt,compressedTexImage2D:Xe,compressedTexImage3D:Qe,texImage2D:ct,texImage3D:ft,updateUBOMapping:Je,uniformBlockBinding:ut,texStorage2D:Ht,texStorage3D:xt,texSubImage2D:lt,texSubImage3D:Nt,compressedTexSubImage2D:He,compressedTexSubImage3D:tn,scissor:ae,viewport:Se,reset:q}}function G$(n,e,t,r,i,s,o){const a=i.isWebGL2,l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,u=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),d=new WeakMap;let f;const p=new WeakMap;let g=!1;try{g=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(W,H){return g?new OffscreenCanvas(W,H):em("canvas")}function S(W,H,_e,Ve){let ze=1;if((W.width>Ve||W.height>Ve)&&(ze=Ve/Math.max(W.width,W.height)),ze<1||H===!0)if(typeof HTMLImageElement<"u"&&W instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&W instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&W instanceof ImageBitmap){const De=H?Ay:Math.floor,yt=De(ze*W.width),Xe=De(ze*W.height);f===void 0&&(f=y(yt,Xe));const Qe=_e?y(yt,Xe):f;return Qe.width=yt,Qe.height=Xe,Qe.getContext("2d").drawImage(W,0,0,yt,Xe),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+W.width+"x"+W.height+") to ("+yt+"x"+Xe+")."),Qe}else return"data"in W&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+W.width+"x"+W.height+")."),W;return W}function x(W){return gT(W.width)&&gT(W.height)}function v(W){return a?!1:W.wrapS!==er||W.wrapT!==er||W.minFilter!==Er&&W.minFilter!==kn}function w(W,H){return W.generateMipmaps&&H&&W.minFilter!==Er&&W.minFilter!==kn}function T(W){n.generateMipmap(W)}function R(W,H,_e,Ve,ze=!1){if(a===!1)return H;if(W!==null){if(n[W]!==void 0)return n[W];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+W+"'")}let De=H;if(H===n.RED&&(_e===n.FLOAT&&(De=n.R32F),_e===n.HALF_FLOAT&&(De=n.R16F),_e===n.UNSIGNED_BYTE&&(De=n.R8)),H===n.RED_INTEGER&&(_e===n.UNSIGNED_BYTE&&(De=n.R8UI),_e===n.UNSIGNED_SHORT&&(De=n.R16UI),_e===n.UNSIGNED_INT&&(De=n.R32UI),_e===n.BYTE&&(De=n.R8I),_e===n.SHORT&&(De=n.R16I),_e===n.INT&&(De=n.R32I)),H===n.RG&&(_e===n.FLOAT&&(De=n.RG32F),_e===n.HALF_FLOAT&&(De=n.RG16F),_e===n.UNSIGNED_BYTE&&(De=n.RG8)),H===n.RGBA){const yt=ze?Kp:Fn.getTransfer(Ve);_e===n.FLOAT&&(De=n.RGBA32F),_e===n.HALF_FLOAT&&(De=n.RGBA16F),_e===n.UNSIGNED_BYTE&&(De=yt===jn?n.SRGB8_ALPHA8:n.RGBA8),_e===n.UNSIGNED_SHORT_4_4_4_4&&(De=n.RGBA4),_e===n.UNSIGNED_SHORT_5_5_5_1&&(De=n.RGB5_A1)}return(De===n.R16F||De===n.R32F||De===n.RG16F||De===n.RG32F||De===n.RGBA16F||De===n.RGBA32F)&&e.get("EXT_color_buffer_float"),De}function U(W,H,_e){return w(W,_e)===!0||W.isFramebufferTexture&&W.minFilter!==Er&&W.minFilter!==kn?Math.log2(Math.max(H.width,H.height))+1:W.mipmaps!==void 0&&W.mipmaps.length>0?W.mipmaps.length:W.isCompressedTexture&&Array.isArray(W.image)?H.mipmaps.length:1}function N(W){return W===Er||W===Ty||W===up?n.NEAREST:n.LINEAR}function P(W){const H=W.target;H.removeEventListener("dispose",P),M(H),H.isVideoTexture&&d.delete(H)}function b(W){const H=W.target;H.removeEventListener("dispose",b),L(H)}function M(W){const H=r.get(W);if(H.__webglInit===void 0)return;const _e=W.source,Ve=p.get(_e);if(Ve){const ze=Ve[H.__cacheKey];ze.usedTimes--,ze.usedTimes===0&&A(W),Object.keys(Ve).length===0&&p.delete(_e)}r.remove(W)}function A(W){const H=r.get(W);n.deleteTexture(H.__webglTexture);const _e=W.source,Ve=p.get(_e);delete Ve[H.__cacheKey],o.memory.textures--}function L(W){const H=W.texture,_e=r.get(W),Ve=r.get(H);if(Ve.__webglTexture!==void 0&&(n.deleteTexture(Ve.__webglTexture),o.memory.textures--),W.depthTexture&&W.depthTexture.dispose(),W.isWebGLCubeRenderTarget)for(let ze=0;ze<6;ze++){if(Array.isArray(_e.__webglFramebuffer[ze]))for(let De=0;De<_e.__webglFramebuffer[ze].length;De++)n.deleteFramebuffer(_e.__webglFramebuffer[ze][De]);else n.deleteFramebuffer(_e.__webglFramebuffer[ze]);_e.__webglDepthbuffer&&n.deleteRenderbuffer(_e.__webglDepthbuffer[ze])}else{if(Array.isArray(_e.__webglFramebuffer))for(let ze=0;ze<_e.__webglFramebuffer.length;ze++)n.deleteFramebuffer(_e.__webglFramebuffer[ze]);else n.deleteFramebuffer(_e.__webglFramebuffer);if(_e.__webglDepthbuffer&&n.deleteRenderbuffer(_e.__webglDepthbuffer),_e.__webglMultisampledFramebuffer&&n.deleteFramebuffer(_e.__webglMultisampledFramebuffer),_e.__webglColorRenderbuffer)for(let ze=0;ze<_e.__webglColorRenderbuffer.length;ze++)_e.__webglColorRenderbuffer[ze]&&n.deleteRenderbuffer(_e.__webglColorRenderbuffer[ze]);_e.__webglDepthRenderbuffer&&n.deleteRenderbuffer(_e.__webglDepthRenderbuffer)}if(W.isWebGLMultipleRenderTargets)for(let ze=0,De=H.length;ze<De;ze++){const yt=r.get(H[ze]);yt.__webglTexture&&(n.deleteTexture(yt.__webglTexture),o.memory.textures--),r.remove(H[ze])}r.remove(H),r.remove(W)}let z=0;function B(){z=0}function $(){const W=z;return W>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+W+" texture units while this GPU supports only "+i.maxTextures),z+=1,W}function he(W){const H=[];return H.push(W.wrapS),H.push(W.wrapT),H.push(W.wrapR||0),H.push(W.magFilter),H.push(W.minFilter),H.push(W.anisotropy),H.push(W.internalFormat),H.push(W.format),H.push(W.type),H.push(W.generateMipmaps),H.push(W.premultiplyAlpha),H.push(W.flipY),H.push(W.unpackAlignment),H.push(W.colorSpace),H.join()}function te(W,H){const _e=r.get(W);if(W.isVideoTexture&&At(W),W.isRenderTargetTexture===!1&&W.version>0&&_e.__version!==W.version){const Ve=W.image;if(Ve===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Ve.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Fe(_e,W,H);return}}t.bindTexture(n.TEXTURE_2D,_e.__webglTexture,n.TEXTURE0+H)}function ye(W,H){const _e=r.get(W);if(W.version>0&&_e.__version!==W.version){Fe(_e,W,H);return}t.bindTexture(n.TEXTURE_2D_ARRAY,_e.__webglTexture,n.TEXTURE0+H)}function G(W,H){const _e=r.get(W);if(W.version>0&&_e.__version!==W.version){Fe(_e,W,H);return}t.bindTexture(n.TEXTURE_3D,_e.__webglTexture,n.TEXTURE0+H)}function Z(W,H){const _e=r.get(W);if(W.version>0&&_e.__version!==W.version){ke(_e,W,H);return}t.bindTexture(n.TEXTURE_CUBE_MAP,_e.__webglTexture,n.TEXTURE0+H)}const K={[jp]:n.REPEAT,[er]:n.CLAMP_TO_EDGE,[qp]:n.MIRRORED_REPEAT},ce={[Er]:n.NEAREST,[Ty]:n.NEAREST_MIPMAP_NEAREST,[up]:n.NEAREST_MIPMAP_LINEAR,[kn]:n.LINEAR,[IM]:n.LINEAR_MIPMAP_NEAREST,[Yl]:n.LINEAR_MIPMAP_LINEAR},de={[pO]:n.NEVER,[xO]:n.ALWAYS,[mO]:n.LESS,[BM]:n.LEQUAL,[gO]:n.EQUAL,[yO]:n.GEQUAL,[vO]:n.GREATER,[_O]:n.NOTEQUAL};function ue(W,H,_e){if(_e?(n.texParameteri(W,n.TEXTURE_WRAP_S,K[H.wrapS]),n.texParameteri(W,n.TEXTURE_WRAP_T,K[H.wrapT]),(W===n.TEXTURE_3D||W===n.TEXTURE_2D_ARRAY)&&n.texParameteri(W,n.TEXTURE_WRAP_R,K[H.wrapR]),n.texParameteri(W,n.TEXTURE_MAG_FILTER,ce[H.magFilter]),n.texParameteri(W,n.TEXTURE_MIN_FILTER,ce[H.minFilter])):(n.texParameteri(W,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(W,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(W===n.TEXTURE_3D||W===n.TEXTURE_2D_ARRAY)&&n.texParameteri(W,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(H.wrapS!==er||H.wrapT!==er)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(W,n.TEXTURE_MAG_FILTER,N(H.magFilter)),n.texParameteri(W,n.TEXTURE_MIN_FILTER,N(H.minFilter)),H.minFilter!==Er&&H.minFilter!==kn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),H.compareFunction&&(n.texParameteri(W,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(W,n.TEXTURE_COMPARE_FUNC,de[H.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const Ve=e.get("EXT_texture_filter_anisotropic");if(H.magFilter===Er||H.minFilter!==up&&H.minFilter!==Yl||H.type===Ur&&e.has("OES_texture_float_linear")===!1||a===!1&&H.type===ei&&e.has("OES_texture_half_float_linear")===!1)return;(H.anisotropy>1||r.get(H).__currentAnisotropy)&&(n.texParameterf(W,Ve.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(H.anisotropy,i.getMaxAnisotropy())),r.get(H).__currentAnisotropy=H.anisotropy)}}function Ee(W,H){let _e=!1;W.__webglInit===void 0&&(W.__webglInit=!0,H.addEventListener("dispose",P));const Ve=H.source;let ze=p.get(Ve);ze===void 0&&(ze={},p.set(Ve,ze));const De=he(H);if(De!==W.__cacheKey){ze[De]===void 0&&(ze[De]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,_e=!0),ze[De].usedTimes++;const yt=ze[W.__cacheKey];yt!==void 0&&(ze[W.__cacheKey].usedTimes--,yt.usedTimes===0&&A(H)),W.__cacheKey=De,W.__webglTexture=ze[De].texture}return _e}function Fe(W,H,_e){let Ve=n.TEXTURE_2D;(H.isDataArrayTexture||H.isCompressedArrayTexture)&&(Ve=n.TEXTURE_2D_ARRAY),H.isData3DTexture&&(Ve=n.TEXTURE_3D);const ze=Ee(W,H),De=H.source;t.bindTexture(Ve,W.__webglTexture,n.TEXTURE0+_e);const yt=r.get(De);if(De.version!==yt.__version||ze===!0){t.activeTexture(n.TEXTURE0+_e);const Xe=Fn.getPrimaries(Fn.workingColorSpace),Qe=H.colorSpace===Ss?null:Fn.getPrimaries(H.colorSpace),lt=H.colorSpace===Ss||Xe===Qe?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,H.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,H.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,H.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,lt);const Nt=v(H)&&x(H.image)===!1;let He=S(H.image,Nt,!1,i.maxTextureSize);He=st(H,He);const tn=x(He)||a,Ht=s.convert(H.format,H.colorSpace);let xt=s.convert(H.type),ct=R(H.internalFormat,Ht,xt,H.colorSpace,H.isVideoTexture);ue(Ve,H,tn);let ft;const ae=H.mipmaps,Se=a&&H.isVideoTexture!==!0&&ct!==UM,Je=yt.__version===void 0||ze===!0,ut=U(H,He,tn);if(H.isDepthTexture)ct=n.DEPTH_COMPONENT,a?H.type===Ur?ct=n.DEPTH_COMPONENT32F:H.type===ko?ct=n.DEPTH_COMPONENT24:H.type===Dl?ct=n.DEPTH24_STENCIL8:ct=n.DEPTH_COMPONENT16:H.type===Ur&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),H.format===kl&&ct===n.DEPTH_COMPONENT&&H.type!==m0&&H.type!==ko&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),H.type=ko,xt=s.convert(H.type)),H.format===_c&&ct===n.DEPTH_COMPONENT&&(ct=n.DEPTH_STENCIL,H.type!==Dl&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),H.type=Dl,xt=s.convert(H.type))),Je&&(Se?t.texStorage2D(n.TEXTURE_2D,1,ct,He.width,He.height):t.texImage2D(n.TEXTURE_2D,0,ct,He.width,He.height,0,Ht,xt,null));else if(H.isDataTexture)if(ae.length>0&&tn){Se&&Je&&t.texStorage2D(n.TEXTURE_2D,ut,ct,ae[0].width,ae[0].height);for(let q=0,J=ae.length;q<J;q++)ft=ae[q],Se?t.texSubImage2D(n.TEXTURE_2D,q,0,0,ft.width,ft.height,Ht,xt,ft.data):t.texImage2D(n.TEXTURE_2D,q,ct,ft.width,ft.height,0,Ht,xt,ft.data);H.generateMipmaps=!1}else Se?(Je&&t.texStorage2D(n.TEXTURE_2D,ut,ct,He.width,He.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,He.width,He.height,Ht,xt,He.data)):t.texImage2D(n.TEXTURE_2D,0,ct,He.width,He.height,0,Ht,xt,He.data);else if(H.isCompressedTexture)if(H.isCompressedArrayTexture){Se&&Je&&t.texStorage3D(n.TEXTURE_2D_ARRAY,ut,ct,ae[0].width,ae[0].height,He.depth);for(let q=0,J=ae.length;q<J;q++)ft=ae[q],H.format!==kr?Ht!==null?Se?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,q,0,0,0,ft.width,ft.height,He.depth,Ht,ft.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,q,ct,ft.width,ft.height,He.depth,0,ft.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Se?t.texSubImage3D(n.TEXTURE_2D_ARRAY,q,0,0,0,ft.width,ft.height,He.depth,Ht,xt,ft.data):t.texImage3D(n.TEXTURE_2D_ARRAY,q,ct,ft.width,ft.height,He.depth,0,Ht,xt,ft.data)}else{Se&&Je&&t.texStorage2D(n.TEXTURE_2D,ut,ct,ae[0].width,ae[0].height);for(let q=0,J=ae.length;q<J;q++)ft=ae[q],H.format!==kr?Ht!==null?Se?t.compressedTexSubImage2D(n.TEXTURE_2D,q,0,0,ft.width,ft.height,Ht,ft.data):t.compressedTexImage2D(n.TEXTURE_2D,q,ct,ft.width,ft.height,0,ft.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Se?t.texSubImage2D(n.TEXTURE_2D,q,0,0,ft.width,ft.height,Ht,xt,ft.data):t.texImage2D(n.TEXTURE_2D,q,ct,ft.width,ft.height,0,Ht,xt,ft.data)}else if(H.isDataArrayTexture)Se?(Je&&t.texStorage3D(n.TEXTURE_2D_ARRAY,ut,ct,He.width,He.height,He.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,He.width,He.height,He.depth,Ht,xt,He.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,ct,He.width,He.height,He.depth,0,Ht,xt,He.data);else if(H.isData3DTexture)Se?(Je&&t.texStorage3D(n.TEXTURE_3D,ut,ct,He.width,He.height,He.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,He.width,He.height,He.depth,Ht,xt,He.data)):t.texImage3D(n.TEXTURE_3D,0,ct,He.width,He.height,He.depth,0,Ht,xt,He.data);else if(H.isFramebufferTexture){if(Je)if(Se)t.texStorage2D(n.TEXTURE_2D,ut,ct,He.width,He.height);else{let q=He.width,J=He.height;for(let Ne=0;Ne<ut;Ne++)t.texImage2D(n.TEXTURE_2D,Ne,ct,q,J,0,Ht,xt,null),q>>=1,J>>=1}}else if(ae.length>0&&tn){Se&&Je&&t.texStorage2D(n.TEXTURE_2D,ut,ct,ae[0].width,ae[0].height);for(let q=0,J=ae.length;q<J;q++)ft=ae[q],Se?t.texSubImage2D(n.TEXTURE_2D,q,0,0,Ht,xt,ft):t.texImage2D(n.TEXTURE_2D,q,ct,Ht,xt,ft);H.generateMipmaps=!1}else Se?(Je&&t.texStorage2D(n.TEXTURE_2D,ut,ct,He.width,He.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ht,xt,He)):t.texImage2D(n.TEXTURE_2D,0,ct,Ht,xt,He);w(H,tn)&&T(Ve),yt.__version=De.version,H.onUpdate&&H.onUpdate(H)}W.__version=H.version}function ke(W,H,_e){if(H.image.length!==6)return;const Ve=Ee(W,H),ze=H.source;t.bindTexture(n.TEXTURE_CUBE_MAP,W.__webglTexture,n.TEXTURE0+_e);const De=r.get(ze);if(ze.version!==De.__version||Ve===!0){t.activeTexture(n.TEXTURE0+_e);const yt=Fn.getPrimaries(Fn.workingColorSpace),Xe=H.colorSpace===Ss?null:Fn.getPrimaries(H.colorSpace),Qe=H.colorSpace===Ss||yt===Xe?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,H.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,H.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,H.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Qe);const lt=H.isCompressedTexture||H.image[0].isCompressedTexture,Nt=H.image[0]&&H.image[0].isDataTexture,He=[];for(let q=0;q<6;q++)!lt&&!Nt?He[q]=S(H.image[q],!1,!0,i.maxCubemapSize):He[q]=Nt?H.image[q].image:H.image[q],He[q]=st(H,He[q]);const tn=He[0],Ht=x(tn)||a,xt=s.convert(H.format,H.colorSpace),ct=s.convert(H.type),ft=R(H.internalFormat,xt,ct,H.colorSpace),ae=a&&H.isVideoTexture!==!0,Se=De.__version===void 0||Ve===!0;let Je=U(H,tn,Ht);ue(n.TEXTURE_CUBE_MAP,H,Ht);let ut;if(lt){ae&&Se&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Je,ft,tn.width,tn.height);for(let q=0;q<6;q++){ut=He[q].mipmaps;for(let J=0;J<ut.length;J++){const Ne=ut[J];H.format!==kr?xt!==null?ae?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,J,0,0,Ne.width,Ne.height,xt,Ne.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,J,ft,Ne.width,Ne.height,0,Ne.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ae?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,J,0,0,Ne.width,Ne.height,xt,ct,Ne.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,J,ft,Ne.width,Ne.height,0,xt,ct,Ne.data)}}}else{ut=H.mipmaps,ae&&Se&&(ut.length>0&&Je++,t.texStorage2D(n.TEXTURE_CUBE_MAP,Je,ft,He[0].width,He[0].height));for(let q=0;q<6;q++)if(Nt){ae?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,0,0,He[q].width,He[q].height,xt,ct,He[q].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,ft,He[q].width,He[q].height,0,xt,ct,He[q].data);for(let J=0;J<ut.length;J++){const Ke=ut[J].image[q].image;ae?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,J+1,0,0,Ke.width,Ke.height,xt,ct,Ke.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,J+1,ft,Ke.width,Ke.height,0,xt,ct,Ke.data)}}else{ae?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,0,0,xt,ct,He[q]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,ft,xt,ct,He[q]);for(let J=0;J<ut.length;J++){const Ne=ut[J];ae?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,J+1,0,0,xt,ct,Ne.image[q]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,J+1,ft,xt,ct,Ne.image[q])}}}w(H,Ht)&&T(n.TEXTURE_CUBE_MAP),De.__version=ze.version,H.onUpdate&&H.onUpdate(H)}W.__version=H.version}function Ye(W,H,_e,Ve,ze,De){const yt=s.convert(_e.format,_e.colorSpace),Xe=s.convert(_e.type),Qe=R(_e.internalFormat,yt,Xe,_e.colorSpace);if(!r.get(H).__hasExternalTextures){const Nt=Math.max(1,H.width>>De),He=Math.max(1,H.height>>De);ze===n.TEXTURE_3D||ze===n.TEXTURE_2D_ARRAY?t.texImage3D(ze,De,Qe,Nt,He,H.depth,0,yt,Xe,null):t.texImage2D(ze,De,Qe,Nt,He,0,yt,Xe,null)}t.bindFramebuffer(n.FRAMEBUFFER,W),be(H)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Ve,ze,r.get(_e).__webglTexture,0,We(H)):(ze===n.TEXTURE_2D||ze>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&ze<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,Ve,ze,r.get(_e).__webglTexture,De),t.bindFramebuffer(n.FRAMEBUFFER,null)}function Ct(W,H,_e){if(n.bindRenderbuffer(n.RENDERBUFFER,W),H.depthBuffer&&!H.stencilBuffer){let Ve=a===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(_e||be(H)){const ze=H.depthTexture;ze&&ze.isDepthTexture&&(ze.type===Ur?Ve=n.DEPTH_COMPONENT32F:ze.type===ko&&(Ve=n.DEPTH_COMPONENT24));const De=We(H);be(H)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,De,Ve,H.width,H.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,De,Ve,H.width,H.height)}else n.renderbufferStorage(n.RENDERBUFFER,Ve,H.width,H.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,W)}else if(H.depthBuffer&&H.stencilBuffer){const Ve=We(H);_e&&be(H)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,Ve,n.DEPTH24_STENCIL8,H.width,H.height):be(H)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Ve,n.DEPTH24_STENCIL8,H.width,H.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,H.width,H.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,W)}else{const Ve=H.isWebGLMultipleRenderTargets===!0?H.texture:[H.texture];for(let ze=0;ze<Ve.length;ze++){const De=Ve[ze],yt=s.convert(De.format,De.colorSpace),Xe=s.convert(De.type),Qe=R(De.internalFormat,yt,Xe,De.colorSpace),lt=We(H);_e&&be(H)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,lt,Qe,H.width,H.height):be(H)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,lt,Qe,H.width,H.height):n.renderbufferStorage(n.RENDERBUFFER,Qe,H.width,H.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function Dt(W,H){if(H&&H.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,W),!(H.depthTexture&&H.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(H.depthTexture).__webglTexture||H.depthTexture.image.width!==H.width||H.depthTexture.image.height!==H.height)&&(H.depthTexture.image.width=H.width,H.depthTexture.image.height=H.height,H.depthTexture.needsUpdate=!0),te(H.depthTexture,0);const Ve=r.get(H.depthTexture).__webglTexture,ze=We(H);if(H.depthTexture.format===kl)be(H)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Ve,0,ze):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Ve,0);else if(H.depthTexture.format===_c)be(H)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Ve,0,ze):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Ve,0);else throw new Error("Unknown depthTexture format")}function gt(W){const H=r.get(W),_e=W.isWebGLCubeRenderTarget===!0;if(W.depthTexture&&!H.__autoAllocateDepthBuffer){if(_e)throw new Error("target.depthTexture not supported in Cube render targets");Dt(H.__webglFramebuffer,W)}else if(_e){H.__webglDepthbuffer=[];for(let Ve=0;Ve<6;Ve++)t.bindFramebuffer(n.FRAMEBUFFER,H.__webglFramebuffer[Ve]),H.__webglDepthbuffer[Ve]=n.createRenderbuffer(),Ct(H.__webglDepthbuffer[Ve],W,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,H.__webglFramebuffer),H.__webglDepthbuffer=n.createRenderbuffer(),Ct(H.__webglDepthbuffer,W,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function vt(W,H,_e){const Ve=r.get(W);H!==void 0&&Ye(Ve.__webglFramebuffer,W,W.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),_e!==void 0&&gt(W)}function ie(W){const H=W.texture,_e=r.get(W),Ve=r.get(H);W.addEventListener("dispose",b),W.isWebGLMultipleRenderTargets!==!0&&(Ve.__webglTexture===void 0&&(Ve.__webglTexture=n.createTexture()),Ve.__version=H.version,o.memory.textures++);const ze=W.isWebGLCubeRenderTarget===!0,De=W.isWebGLMultipleRenderTargets===!0,yt=x(W)||a;if(ze){_e.__webglFramebuffer=[];for(let Xe=0;Xe<6;Xe++)if(a&&H.mipmaps&&H.mipmaps.length>0){_e.__webglFramebuffer[Xe]=[];for(let Qe=0;Qe<H.mipmaps.length;Qe++)_e.__webglFramebuffer[Xe][Qe]=n.createFramebuffer()}else _e.__webglFramebuffer[Xe]=n.createFramebuffer()}else{if(a&&H.mipmaps&&H.mipmaps.length>0){_e.__webglFramebuffer=[];for(let Xe=0;Xe<H.mipmaps.length;Xe++)_e.__webglFramebuffer[Xe]=n.createFramebuffer()}else _e.__webglFramebuffer=n.createFramebuffer();if(De)if(i.drawBuffers){const Xe=W.texture;for(let Qe=0,lt=Xe.length;Qe<lt;Qe++){const Nt=r.get(Xe[Qe]);Nt.__webglTexture===void 0&&(Nt.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&W.samples>0&&be(W)===!1){const Xe=De?H:[H];_e.__webglMultisampledFramebuffer=n.createFramebuffer(),_e.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,_e.__webglMultisampledFramebuffer);for(let Qe=0;Qe<Xe.length;Qe++){const lt=Xe[Qe];_e.__webglColorRenderbuffer[Qe]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,_e.__webglColorRenderbuffer[Qe]);const Nt=s.convert(lt.format,lt.colorSpace),He=s.convert(lt.type),tn=R(lt.internalFormat,Nt,He,lt.colorSpace,W.isXRRenderTarget===!0),Ht=We(W);n.renderbufferStorageMultisample(n.RENDERBUFFER,Ht,tn,W.width,W.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Qe,n.RENDERBUFFER,_e.__webglColorRenderbuffer[Qe])}n.bindRenderbuffer(n.RENDERBUFFER,null),W.depthBuffer&&(_e.__webglDepthRenderbuffer=n.createRenderbuffer(),Ct(_e.__webglDepthRenderbuffer,W,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(ze){t.bindTexture(n.TEXTURE_CUBE_MAP,Ve.__webglTexture),ue(n.TEXTURE_CUBE_MAP,H,yt);for(let Xe=0;Xe<6;Xe++)if(a&&H.mipmaps&&H.mipmaps.length>0)for(let Qe=0;Qe<H.mipmaps.length;Qe++)Ye(_e.__webglFramebuffer[Xe][Qe],W,H,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Xe,Qe);else Ye(_e.__webglFramebuffer[Xe],W,H,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Xe,0);w(H,yt)&&T(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(De){const Xe=W.texture;for(let Qe=0,lt=Xe.length;Qe<lt;Qe++){const Nt=Xe[Qe],He=r.get(Nt);t.bindTexture(n.TEXTURE_2D,He.__webglTexture),ue(n.TEXTURE_2D,Nt,yt),Ye(_e.__webglFramebuffer,W,Nt,n.COLOR_ATTACHMENT0+Qe,n.TEXTURE_2D,0),w(Nt,yt)&&T(n.TEXTURE_2D)}t.unbindTexture()}else{let Xe=n.TEXTURE_2D;if((W.isWebGL3DRenderTarget||W.isWebGLArrayRenderTarget)&&(a?Xe=W.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Xe,Ve.__webglTexture),ue(Xe,H,yt),a&&H.mipmaps&&H.mipmaps.length>0)for(let Qe=0;Qe<H.mipmaps.length;Qe++)Ye(_e.__webglFramebuffer[Qe],W,H,n.COLOR_ATTACHMENT0,Xe,Qe);else Ye(_e.__webglFramebuffer,W,H,n.COLOR_ATTACHMENT0,Xe,0);w(H,yt)&&T(Xe),t.unbindTexture()}W.depthBuffer&&gt(W)}function Be(W){const H=x(W)||a,_e=W.isWebGLMultipleRenderTargets===!0?W.texture:[W.texture];for(let Ve=0,ze=_e.length;Ve<ze;Ve++){const De=_e[Ve];if(w(De,H)){const yt=W.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Xe=r.get(De).__webglTexture;t.bindTexture(yt,Xe),T(yt),t.unbindTexture()}}}function Ae(W){if(a&&W.samples>0&&be(W)===!1){const H=W.isWebGLMultipleRenderTargets?W.texture:[W.texture],_e=W.width,Ve=W.height;let ze=n.COLOR_BUFFER_BIT;const De=[],yt=W.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Xe=r.get(W),Qe=W.isWebGLMultipleRenderTargets===!0;if(Qe)for(let lt=0;lt<H.length;lt++)t.bindFramebuffer(n.FRAMEBUFFER,Xe.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+lt,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Xe.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+lt,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Xe.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Xe.__webglFramebuffer);for(let lt=0;lt<H.length;lt++){De.push(n.COLOR_ATTACHMENT0+lt),W.depthBuffer&&De.push(yt);const Nt=Xe.__ignoreDepthValues!==void 0?Xe.__ignoreDepthValues:!1;if(Nt===!1&&(W.depthBuffer&&(ze|=n.DEPTH_BUFFER_BIT),W.stencilBuffer&&(ze|=n.STENCIL_BUFFER_BIT)),Qe&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Xe.__webglColorRenderbuffer[lt]),Nt===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[yt]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[yt])),Qe){const He=r.get(H[lt]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,He,0)}n.blitFramebuffer(0,0,_e,Ve,0,0,_e,Ve,ze,n.NEAREST),u&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,De)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Qe)for(let lt=0;lt<H.length;lt++){t.bindFramebuffer(n.FRAMEBUFFER,Xe.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+lt,n.RENDERBUFFER,Xe.__webglColorRenderbuffer[lt]);const Nt=r.get(H[lt]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Xe.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+lt,n.TEXTURE_2D,Nt,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Xe.__webglMultisampledFramebuffer)}}function We(W){return Math.min(i.maxSamples,W.samples)}function be(W){const H=r.get(W);return a&&W.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&H.__useRenderToTexture!==!1}function At(W){const H=o.render.frame;d.get(W)!==H&&(d.set(W,H),W.update())}function st(W,H){const _e=W.colorSpace,Ve=W.format,ze=W.type;return W.isCompressedTexture===!0||W.isVideoTexture===!0||W.format===My||_e!==Ls&&_e!==Ss&&(Fn.getTransfer(_e)===jn?a===!1?e.has("EXT_sRGB")===!0&&Ve===kr?(W.format=My,W.minFilter=kn,W.generateMipmaps=!1):H=HM.sRGBToLinear(H):(Ve!==kr||ze!==bs)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",_e)),H}this.allocateTextureUnit=$,this.resetTextureUnits=B,this.setTexture2D=te,this.setTexture2DArray=ye,this.setTexture3D=G,this.setTextureCube=Z,this.rebindTextures=vt,this.setupRenderTarget=ie,this.updateRenderTargetMipmap=Be,this.updateMultisampleRenderTarget=Ae,this.setupDepthRenderbuffer=gt,this.setupFrameBufferTexture=Ye,this.useMultisampledRTT=be}function kO(n,e,t){const r=t.isWebGL2;function i(s,o=Ss){let a;const l=Fn.getTransfer(o);if(s===bs)return n.UNSIGNED_BYTE;if(s===PM)return n.UNSIGNED_SHORT_4_4_4_4;if(s===NM)return n.UNSIGNED_SHORT_5_5_5_1;if(s===bM)return n.BYTE;if(s===RM)return n.SHORT;if(s===m0)return n.UNSIGNED_SHORT;if(s===g0)return n.INT;if(s===ko)return n.UNSIGNED_INT;if(s===Ur)return n.FLOAT;if(s===ei)return r?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===rO)return n.ALPHA;if(s===kr)return n.RGBA;if(s===iO)return n.LUMINANCE;if(s===sO)return n.LUMINANCE_ALPHA;if(s===kl)return n.DEPTH_COMPONENT;if(s===_c)return n.DEPTH_STENCIL;if(s===My)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===LM)return n.RED;if(s===DM)return n.RED_INTEGER;if(s===oO)return n.RG;if(s===kM)return n.RG_INTEGER;if(s===OM)return n.RGBA_INTEGER;if(s===E_||s===w_||s===S_||s===T_)if(l===jn)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===E_)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===w_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===S_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===T_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===E_)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===w_)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===S_)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===T_)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===GS||s===WS||s===jS||s===qS)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===GS)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===WS)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===jS)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===qS)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===UM)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===XS||s===$S)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===XS)return l===jn?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===$S)return l===jn?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===YS||s===KS||s===QS||s===ZS||s===JS||s===eT||s===tT||s===nT||s===rT||s===iT||s===sT||s===oT||s===aT||s===lT)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===YS)return l===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===KS)return l===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===QS)return l===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===ZS)return l===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===JS)return l===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===eT)return l===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===tT)return l===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===nT)return l===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===rT)return l===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===iT)return l===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===sT)return l===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===oT)return l===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===aT)return l===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===lT)return l===jn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===M_||s===uT||s===cT)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===M_)return l===jn?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===uT)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===cT)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===aO||s===hT||s===dT||s===fT)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===M_)return a.COMPRESSED_RED_RGTC1_EXT;if(s===hT)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===dT)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===fT)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Dl?r?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):n[s]!==void 0?n[s]:null}return{convert:i}}class OO extends Sr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class qh extends Ln{constructor(){super(),this.isGroup=!0,this.type="Group"}}const W$={type:"move"};class zE{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new qh,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new qh,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Q,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Q),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new qh,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Q,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Q),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,s=null,o=null;const a=this._targetRay,l=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(const S of e.hand.values()){const x=t.getJointPose(S,r),v=this._getHandJoint(u,S);x!==null&&(v.matrix.fromArray(x.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.matrixWorldNeedsUpdate=!0,v.jointRadius=x.radius),v.visible=x!==null}const d=u.joints["index-finger-tip"],f=u.joints["thumb-tip"],p=d.position.distanceTo(f.position),g=.02,y=.005;u.inputState.pinching&&p>g+y?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&p<=g-y&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,r),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&s!==null&&(i=s),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(W$)))}return a!==null&&(a.visible=i!==null),l!==null&&(l.visible=s!==null),u!==null&&(u.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const r=new qh;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}class j$ extends Va{constructor(e,t){super();const r=this;let i=null,s=1,o=null,a="local-floor",l=1,u=null,d=null,f=null,p=null,g=null,y=null;const S=t.getContextAttributes();let x=null,v=null;const w=[],T=[],R=new Ue;let U=null;const N=new Sr;N.layers.enable(1),N.viewport=new Vn;const P=new Sr;P.layers.enable(2),P.viewport=new Vn;const b=[N,P],M=new OO;M.layers.enable(1),M.layers.enable(2);let A=null,L=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ue){let Ee=w[ue];return Ee===void 0&&(Ee=new zE,w[ue]=Ee),Ee.getTargetRaySpace()},this.getControllerGrip=function(ue){let Ee=w[ue];return Ee===void 0&&(Ee=new zE,w[ue]=Ee),Ee.getGripSpace()},this.getHand=function(ue){let Ee=w[ue];return Ee===void 0&&(Ee=new zE,w[ue]=Ee),Ee.getHandSpace()};function z(ue){const Ee=T.indexOf(ue.inputSource);if(Ee===-1)return;const Fe=w[Ee];Fe!==void 0&&(Fe.update(ue.inputSource,ue.frame,u||o),Fe.dispatchEvent({type:ue.type,data:ue.inputSource}))}function B(){i.removeEventListener("select",z),i.removeEventListener("selectstart",z),i.removeEventListener("selectend",z),i.removeEventListener("squeeze",z),i.removeEventListener("squeezestart",z),i.removeEventListener("squeezeend",z),i.removeEventListener("end",B),i.removeEventListener("inputsourceschange",$);for(let ue=0;ue<w.length;ue++){const Ee=T[ue];Ee!==null&&(T[ue]=null,w[ue].disconnect(Ee))}A=null,L=null,e.setRenderTarget(x),g=null,p=null,f=null,i=null,v=null,de.stop(),r.isPresenting=!1,e.setPixelRatio(U),e.setSize(R.width,R.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ue){s=ue,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ue){a=ue,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(ue){u=ue},this.getBaseLayer=function(){return p!==null?p:g},this.getBinding=function(){return f},this.getFrame=function(){return y},this.getSession=function(){return i},this.setSession=async function(ue){if(i=ue,i!==null){if(x=e.getRenderTarget(),i.addEventListener("select",z),i.addEventListener("selectstart",z),i.addEventListener("selectend",z),i.addEventListener("squeeze",z),i.addEventListener("squeezestart",z),i.addEventListener("squeezeend",z),i.addEventListener("end",B),i.addEventListener("inputsourceschange",$),S.xrCompatible!==!0&&await t.makeXRCompatible(),U=e.getPixelRatio(),e.getSize(R),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const Ee={antialias:i.renderState.layers===void 0?S.antialias:!0,alpha:!0,depth:S.depth,stencil:S.stencil,framebufferScaleFactor:s};g=new XRWebGLLayer(i,t,Ee),i.updateRenderState({baseLayer:g}),e.setPixelRatio(1),e.setSize(g.framebufferWidth,g.framebufferHeight,!1),v=new Wi(g.framebufferWidth,g.framebufferHeight,{format:kr,type:bs,colorSpace:e.outputColorSpace,stencilBuffer:S.stencil})}else{let Ee=null,Fe=null,ke=null;S.depth&&(ke=S.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Ee=S.stencil?_c:kl,Fe=S.stencil?Dl:ko);const Ye={colorFormat:t.RGBA8,depthFormat:ke,scaleFactor:s};f=new XRWebGLBinding(i,t),p=f.createProjectionLayer(Ye),i.updateRenderState({layers:[p]}),e.setPixelRatio(1),e.setSize(p.textureWidth,p.textureHeight,!1),v=new Wi(p.textureWidth,p.textureHeight,{format:kr,type:bs,depthTexture:new $M(p.textureWidth,p.textureHeight,Fe,void 0,void 0,void 0,void 0,void 0,void 0,Ee),stencilBuffer:S.stencil,colorSpace:e.outputColorSpace,samples:S.antialias?4:0});const Ct=e.properties.get(v);Ct.__ignoreDepthValues=p.ignoreDepthValues}v.isXRRenderTarget=!0,this.setFoveation(l),u=null,o=await i.requestReferenceSpace(a),de.setContext(i),de.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode};function $(ue){for(let Ee=0;Ee<ue.removed.length;Ee++){const Fe=ue.removed[Ee],ke=T.indexOf(Fe);ke>=0&&(T[ke]=null,w[ke].disconnect(Fe))}for(let Ee=0;Ee<ue.added.length;Ee++){const Fe=ue.added[Ee];let ke=T.indexOf(Fe);if(ke===-1){for(let Ct=0;Ct<w.length;Ct++)if(Ct>=T.length){T.push(Fe),ke=Ct;break}else if(T[Ct]===null){T[Ct]=Fe,ke=Ct;break}if(ke===-1)break}const Ye=w[ke];Ye&&Ye.connect(Fe)}}const he=new Q,te=new Q;function ye(ue,Ee,Fe){he.setFromMatrixPosition(Ee.matrixWorld),te.setFromMatrixPosition(Fe.matrixWorld);const ke=he.distanceTo(te),Ye=Ee.projectionMatrix.elements,Ct=Fe.projectionMatrix.elements,Dt=Ye[14]/(Ye[10]-1),gt=Ye[14]/(Ye[10]+1),vt=(Ye[9]+1)/Ye[5],ie=(Ye[9]-1)/Ye[5],Be=(Ye[8]-1)/Ye[0],Ae=(Ct[8]+1)/Ct[0],We=Dt*Be,be=Dt*Ae,At=ke/(-Be+Ae),st=At*-Be;Ee.matrixWorld.decompose(ue.position,ue.quaternion,ue.scale),ue.translateX(st),ue.translateZ(At),ue.matrixWorld.compose(ue.position,ue.quaternion,ue.scale),ue.matrixWorldInverse.copy(ue.matrixWorld).invert();const W=Dt+At,H=gt+At,_e=We-st,Ve=be+(ke-st),ze=vt*gt/H*W,De=ie*gt/H*W;ue.projectionMatrix.makePerspective(_e,Ve,ze,De,W,H),ue.projectionMatrixInverse.copy(ue.projectionMatrix).invert()}function G(ue,Ee){Ee===null?ue.matrixWorld.copy(ue.matrix):ue.matrixWorld.multiplyMatrices(Ee.matrixWorld,ue.matrix),ue.matrixWorldInverse.copy(ue.matrixWorld).invert()}this.updateCamera=function(ue){if(i===null)return;M.near=P.near=N.near=ue.near,M.far=P.far=N.far=ue.far,(A!==M.near||L!==M.far)&&(i.updateRenderState({depthNear:M.near,depthFar:M.far}),A=M.near,L=M.far);const Ee=ue.parent,Fe=M.cameras;G(M,Ee);for(let ke=0;ke<Fe.length;ke++)G(Fe[ke],Ee);Fe.length===2?ye(M,N,P):M.projectionMatrix.copy(N.projectionMatrix),Z(ue,M,Ee)};function Z(ue,Ee,Fe){Fe===null?ue.matrix.copy(Ee.matrixWorld):(ue.matrix.copy(Fe.matrixWorld),ue.matrix.invert(),ue.matrix.multiply(Ee.matrixWorld)),ue.matrix.decompose(ue.position,ue.quaternion,ue.scale),ue.updateMatrixWorld(!0),ue.projectionMatrix.copy(Ee.projectionMatrix),ue.projectionMatrixInverse.copy(Ee.projectionMatrixInverse),ue.isPerspectiveCamera&&(ue.fov=wd*2*Math.atan(1/ue.projectionMatrix.elements[5]),ue.zoom=1)}this.getCamera=function(){return M},this.getFoveation=function(){if(!(p===null&&g===null))return l},this.setFoveation=function(ue){l=ue,p!==null&&(p.fixedFoveation=ue),g!==null&&g.fixedFoveation!==void 0&&(g.fixedFoveation=ue)};let K=null;function ce(ue,Ee){if(d=Ee.getViewerPose(u||o),y=Ee,d!==null){const Fe=d.views;g!==null&&(e.setRenderTargetFramebuffer(v,g.framebuffer),e.setRenderTarget(v));let ke=!1;Fe.length!==M.cameras.length&&(M.cameras.length=0,ke=!0);for(let Ye=0;Ye<Fe.length;Ye++){const Ct=Fe[Ye];let Dt=null;if(g!==null)Dt=g.getViewport(Ct);else{const vt=f.getViewSubImage(p,Ct);Dt=vt.viewport,Ye===0&&(e.setRenderTargetTextures(v,vt.colorTexture,p.ignoreDepthValues?void 0:vt.depthStencilTexture),e.setRenderTarget(v))}let gt=b[Ye];gt===void 0&&(gt=new Sr,gt.layers.enable(Ye),gt.viewport=new Vn,b[Ye]=gt),gt.matrix.fromArray(Ct.transform.matrix),gt.matrix.decompose(gt.position,gt.quaternion,gt.scale),gt.projectionMatrix.fromArray(Ct.projectionMatrix),gt.projectionMatrixInverse.copy(gt.projectionMatrix).invert(),gt.viewport.set(Dt.x,Dt.y,Dt.width,Dt.height),Ye===0&&(M.matrix.copy(gt.matrix),M.matrix.decompose(M.position,M.quaternion,M.scale)),ke===!0&&M.cameras.push(gt)}}for(let Fe=0;Fe<w.length;Fe++){const ke=T[Fe],Ye=w[Fe];ke!==null&&Ye!==void 0&&Ye.update(ke,Ee,u||o)}K&&K(ue,Ee),Ee.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:Ee}),y=null}const de=new bO;de.setAnimationLoop(ce),this.setAnimationLoop=function(ue){K=ue},this.dispose=function(){}}}function q$(n,e){function t(x,v){x.matrixAutoUpdate===!0&&x.updateMatrix(),v.value.copy(x.matrix)}function r(x,v){v.color.getRGB(x.fogColor.value,AO(n)),v.isFog?(x.fogNear.value=v.near,x.fogFar.value=v.far):v.isFogExp2&&(x.fogDensity.value=v.density)}function i(x,v,w,T,R){v.isMeshBasicMaterial||v.isMeshLambertMaterial?s(x,v):v.isMeshToonMaterial?(s(x,v),f(x,v)):v.isMeshPhongMaterial?(s(x,v),d(x,v)):v.isMeshStandardMaterial?(s(x,v),p(x,v),v.isMeshPhysicalMaterial&&g(x,v,R)):v.isMeshMatcapMaterial?(s(x,v),y(x,v)):v.isMeshDepthMaterial?s(x,v):v.isMeshDistanceMaterial?(s(x,v),S(x,v)):v.isMeshNormalMaterial?s(x,v):v.isLineBasicMaterial?(o(x,v),v.isLineDashedMaterial&&a(x,v)):v.isPointsMaterial?l(x,v,w,T):v.isSpriteMaterial?u(x,v):v.isShadowMaterial?(x.color.value.copy(v.color),x.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}function s(x,v){x.opacity.value=v.opacity,v.color&&x.diffuse.value.copy(v.color),v.emissive&&x.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(x.map.value=v.map,t(v.map,x.mapTransform)),v.alphaMap&&(x.alphaMap.value=v.alphaMap,t(v.alphaMap,x.alphaMapTransform)),v.bumpMap&&(x.bumpMap.value=v.bumpMap,t(v.bumpMap,x.bumpMapTransform),x.bumpScale.value=v.bumpScale,v.side===Hi&&(x.bumpScale.value*=-1)),v.normalMap&&(x.normalMap.value=v.normalMap,t(v.normalMap,x.normalMapTransform),x.normalScale.value.copy(v.normalScale),v.side===Hi&&x.normalScale.value.negate()),v.displacementMap&&(x.displacementMap.value=v.displacementMap,t(v.displacementMap,x.displacementMapTransform),x.displacementScale.value=v.displacementScale,x.displacementBias.value=v.displacementBias),v.emissiveMap&&(x.emissiveMap.value=v.emissiveMap,t(v.emissiveMap,x.emissiveMapTransform)),v.specularMap&&(x.specularMap.value=v.specularMap,t(v.specularMap,x.specularMapTransform)),v.alphaTest>0&&(x.alphaTest.value=v.alphaTest);const w=e.get(v).envMap;if(w&&(x.envMap.value=w,x.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,x.reflectivity.value=v.reflectivity,x.ior.value=v.ior,x.refractionRatio.value=v.refractionRatio),v.lightMap){x.lightMap.value=v.lightMap;const T=n._useLegacyLights===!0?Math.PI:1;x.lightMapIntensity.value=v.lightMapIntensity*T,t(v.lightMap,x.lightMapTransform)}v.aoMap&&(x.aoMap.value=v.aoMap,x.aoMapIntensity.value=v.aoMapIntensity,t(v.aoMap,x.aoMapTransform))}function o(x,v){x.diffuse.value.copy(v.color),x.opacity.value=v.opacity,v.map&&(x.map.value=v.map,t(v.map,x.mapTransform))}function a(x,v){x.dashSize.value=v.dashSize,x.totalSize.value=v.dashSize+v.gapSize,x.scale.value=v.scale}function l(x,v,w,T){x.diffuse.value.copy(v.color),x.opacity.value=v.opacity,x.size.value=v.size*w,x.scale.value=T*.5,v.map&&(x.map.value=v.map,t(v.map,x.uvTransform)),v.alphaMap&&(x.alphaMap.value=v.alphaMap,t(v.alphaMap,x.alphaMapTransform)),v.alphaTest>0&&(x.alphaTest.value=v.alphaTest)}function u(x,v){x.diffuse.value.copy(v.color),x.opacity.value=v.opacity,x.rotation.value=v.rotation,v.map&&(x.map.value=v.map,t(v.map,x.mapTransform)),v.alphaMap&&(x.alphaMap.value=v.alphaMap,t(v.alphaMap,x.alphaMapTransform)),v.alphaTest>0&&(x.alphaTest.value=v.alphaTest)}function d(x,v){x.specular.value.copy(v.specular),x.shininess.value=Math.max(v.shininess,1e-4)}function f(x,v){v.gradientMap&&(x.gradientMap.value=v.gradientMap)}function p(x,v){x.metalness.value=v.metalness,v.metalnessMap&&(x.metalnessMap.value=v.metalnessMap,t(v.metalnessMap,x.metalnessMapTransform)),x.roughness.value=v.roughness,v.roughnessMap&&(x.roughnessMap.value=v.roughnessMap,t(v.roughnessMap,x.roughnessMapTransform)),e.get(v).envMap&&(x.envMapIntensity.value=v.envMapIntensity)}function g(x,v,w){x.ior.value=v.ior,v.sheen>0&&(x.sheenColor.value.copy(v.sheenColor).multiplyScalar(v.sheen),x.sheenRoughness.value=v.sheenRoughness,v.sheenColorMap&&(x.sheenColorMap.value=v.sheenColorMap,t(v.sheenColorMap,x.sheenColorMapTransform)),v.sheenRoughnessMap&&(x.sheenRoughnessMap.value=v.sheenRoughnessMap,t(v.sheenRoughnessMap,x.sheenRoughnessMapTransform))),v.clearcoat>0&&(x.clearcoat.value=v.clearcoat,x.clearcoatRoughness.value=v.clearcoatRoughness,v.clearcoatMap&&(x.clearcoatMap.value=v.clearcoatMap,t(v.clearcoatMap,x.clearcoatMapTransform)),v.clearcoatRoughnessMap&&(x.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap,t(v.clearcoatRoughnessMap,x.clearcoatRoughnessMapTransform)),v.clearcoatNormalMap&&(x.clearcoatNormalMap.value=v.clearcoatNormalMap,t(v.clearcoatNormalMap,x.clearcoatNormalMapTransform),x.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),v.side===Hi&&x.clearcoatNormalScale.value.negate())),v.iridescence>0&&(x.iridescence.value=v.iridescence,x.iridescenceIOR.value=v.iridescenceIOR,x.iridescenceThicknessMinimum.value=v.iridescenceThicknessRange[0],x.iridescenceThicknessMaximum.value=v.iridescenceThicknessRange[1],v.iridescenceMap&&(x.iridescenceMap.value=v.iridescenceMap,t(v.iridescenceMap,x.iridescenceMapTransform)),v.iridescenceThicknessMap&&(x.iridescenceThicknessMap.value=v.iridescenceThicknessMap,t(v.iridescenceThicknessMap,x.iridescenceThicknessMapTransform))),v.transmission>0&&(x.transmission.value=v.transmission,x.transmissionSamplerMap.value=w.texture,x.transmissionSamplerSize.value.set(w.width,w.height),v.transmissionMap&&(x.transmissionMap.value=v.transmissionMap,t(v.transmissionMap,x.transmissionMapTransform)),x.thickness.value=v.thickness,v.thicknessMap&&(x.thicknessMap.value=v.thicknessMap,t(v.thicknessMap,x.thicknessMapTransform)),x.attenuationDistance.value=v.attenuationDistance,x.attenuationColor.value.copy(v.attenuationColor)),v.anisotropy>0&&(x.anisotropyVector.value.set(v.anisotropy*Math.cos(v.anisotropyRotation),v.anisotropy*Math.sin(v.anisotropyRotation)),v.anisotropyMap&&(x.anisotropyMap.value=v.anisotropyMap,t(v.anisotropyMap,x.anisotropyMapTransform))),x.specularIntensity.value=v.specularIntensity,x.specularColor.value.copy(v.specularColor),v.specularColorMap&&(x.specularColorMap.value=v.specularColorMap,t(v.specularColorMap,x.specularColorMapTransform)),v.specularIntensityMap&&(x.specularIntensityMap.value=v.specularIntensityMap,t(v.specularIntensityMap,x.specularIntensityMapTransform))}function y(x,v){v.matcap&&(x.matcap.value=v.matcap)}function S(x,v){const w=e.get(v).light;x.referencePosition.value.setFromMatrixPosition(w.matrixWorld),x.nearDistance.value=w.shadow.camera.near,x.farDistance.value=w.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function X$(n,e,t,r){let i={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(w,T){const R=T.program;r.uniformBlockBinding(w,R)}function u(w,T){let R=i[w.id];R===void 0&&(y(w),R=d(w),i[w.id]=R,w.addEventListener("dispose",x));const U=T.program;r.updateUBOMapping(w,U);const N=e.render.frame;s[w.id]!==N&&(p(w),s[w.id]=N)}function d(w){const T=f();w.__bindingPointIndex=T;const R=n.createBuffer(),U=w.__size,N=w.usage;return n.bindBuffer(n.UNIFORM_BUFFER,R),n.bufferData(n.UNIFORM_BUFFER,U,N),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,T,R),R}function f(){for(let w=0;w<a;w++)if(o.indexOf(w)===-1)return o.push(w),w;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function p(w){const T=i[w.id],R=w.uniforms,U=w.__cache;n.bindBuffer(n.UNIFORM_BUFFER,T);for(let N=0,P=R.length;N<P;N++){const b=Array.isArray(R[N])?R[N]:[R[N]];for(let M=0,A=b.length;M<A;M++){const L=b[M];if(g(L,N,M,U)===!0){const z=L.__offset,B=Array.isArray(L.value)?L.value:[L.value];let $=0;for(let he=0;he<B.length;he++){const te=B[he],ye=S(te);typeof te=="number"||typeof te=="boolean"?(L.__data[0]=te,n.bufferSubData(n.UNIFORM_BUFFER,z+$,L.__data)):te.isMatrix3?(L.__data[0]=te.elements[0],L.__data[1]=te.elements[1],L.__data[2]=te.elements[2],L.__data[3]=0,L.__data[4]=te.elements[3],L.__data[5]=te.elements[4],L.__data[6]=te.elements[5],L.__data[7]=0,L.__data[8]=te.elements[6],L.__data[9]=te.elements[7],L.__data[10]=te.elements[8],L.__data[11]=0):(te.toArray(L.__data,$),$+=ye.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,z,L.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function g(w,T,R,U){const N=w.value,P=T+"_"+R;if(U[P]===void 0)return typeof N=="number"||typeof N=="boolean"?U[P]=N:U[P]=N.clone(),!0;{const b=U[P];if(typeof N=="number"||typeof N=="boolean"){if(b!==N)return U[P]=N,!0}else if(b.equals(N)===!1)return b.copy(N),!0}return!1}function y(w){const T=w.uniforms;let R=0;const U=16;for(let P=0,b=T.length;P<b;P++){const M=Array.isArray(T[P])?T[P]:[T[P]];for(let A=0,L=M.length;A<L;A++){const z=M[A],B=Array.isArray(z.value)?z.value:[z.value];for(let $=0,he=B.length;$<he;$++){const te=B[$],ye=S(te),G=R%U;G!==0&&U-G<ye.boundary&&(R+=U-G),z.__data=new Float32Array(ye.storage/Float32Array.BYTES_PER_ELEMENT),z.__offset=R,R+=ye.storage}}}const N=R%U;return N>0&&(R+=U-N),w.__size=R,w.__cache={},this}function S(w){const T={boundary:0,storage:0};return typeof w=="number"||typeof w=="boolean"?(T.boundary=4,T.storage=4):w.isVector2?(T.boundary=8,T.storage=8):w.isVector3||w.isColor?(T.boundary=16,T.storage=12):w.isVector4?(T.boundary=16,T.storage=16):w.isMatrix3?(T.boundary=48,T.storage=48):w.isMatrix4?(T.boundary=64,T.storage=64):w.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",w),T}function x(w){const T=w.target;T.removeEventListener("dispose",x);const R=o.indexOf(T.__bindingPointIndex);o.splice(R,1),n.deleteBuffer(i[T.id]),delete i[T.id],delete s[T.id]}function v(){for(const w in i)n.deleteBuffer(i[w]);o=[],i={},s={}}return{bind:l,update:u,dispose:v}}class w0{constructor(e={}){const{canvas:t=SO(),context:r=null,depth:i=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:d="default",failIfMajorPerformanceCaveat:f=!1}=e;this.isWebGLRenderer=!0;let p;r!==null?p=r.getContextAttributes().alpha:p=o;const g=new Uint32Array(4),y=new Int32Array(4);let S=null,x=null;const v=[],w=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Nr,this._useLegacyLights=!1,this.toneMapping=qo,this.toneMappingExposure=1;const T=this;let R=!1,U=0,N=0,P=null,b=-1,M=null;const A=new Vn,L=new Vn;let z=null;const B=new Tt(0);let $=0,he=t.width,te=t.height,ye=1,G=null,Z=null;const K=new Vn(0,0,he,te),ce=new Vn(0,0,he,te);let de=!1;const ue=new Fm;let Ee=!1,Fe=!1,ke=null;const Ye=new en,Ct=new Ue,Dt=new Q,gt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function vt(){return P===null?ye:1}let ie=r;function Be(O,Y){for(let ee=0;ee<O.length;ee++){const se=O[ee],re=t.getContext(se,Y);if(re!==null)return re}return null}try{const O={alpha:!0,depth:i,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:d,failIfMajorPerformanceCaveat:f};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Nm}`),t.addEventListener("webglcontextlost",q,!1),t.addEventListener("webglcontextrestored",J,!1),t.addEventListener("webglcontextcreationerror",Ne,!1),ie===null){const Y=["webgl2","webgl","experimental-webgl"];if(T.isWebGL1Renderer===!0&&Y.shift(),ie=Be(Y,O),ie===null)throw Be(Y)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&ie instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),ie.getShaderPrecisionFormat===void 0&&(ie.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(O){throw console.error("THREE.WebGLRenderer: "+O.message),O}let Ae,We,be,At,st,W,H,_e,Ve,ze,De,yt,Xe,Qe,lt,Nt,He,tn,Ht,xt,ct,ft,ae,Se;function Je(){Ae=new aX(ie),We=new tX(ie,Ae,e),Ae.init(We),ft=new kO(ie,Ae,We),be=new H$(ie,Ae,We),At=new cX(ie),st=new R$,W=new G$(ie,Ae,be,st,We,ft,At),H=new rX(T),_e=new oX(T),Ve=new _j(ie,We),ae=new Jq(ie,Ae,Ve,We),ze=new lX(ie,Ve,At,ae),De=new pX(ie,ze,Ve,At),Ht=new fX(ie,We,W),Nt=new nX(st),yt=new b$(T,H,_e,Ae,We,ae,Nt),Xe=new q$(T,st),Qe=new N$,lt=new F$(Ae,We),tn=new Zq(T,H,_e,be,De,p,l),He=new z$(T,De,We),Se=new X$(ie,At,We,be),xt=new eX(ie,Ae,At,We),ct=new uX(ie,Ae,At,We),At.programs=yt.programs,T.capabilities=We,T.extensions=Ae,T.properties=st,T.renderLists=Qe,T.shadowMap=He,T.state=be,T.info=At}Je();const ut=new j$(T,ie);this.xr=ut,this.getContext=function(){return ie},this.getContextAttributes=function(){return ie.getContextAttributes()},this.forceContextLoss=function(){const O=Ae.get("WEBGL_lose_context");O&&O.loseContext()},this.forceContextRestore=function(){const O=Ae.get("WEBGL_lose_context");O&&O.restoreContext()},this.getPixelRatio=function(){return ye},this.setPixelRatio=function(O){O!==void 0&&(ye=O,this.setSize(he,te,!1))},this.getSize=function(O){return O.set(he,te)},this.setSize=function(O,Y,ee=!0){if(ut.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}he=O,te=Y,t.width=Math.floor(O*ye),t.height=Math.floor(Y*ye),ee===!0&&(t.style.width=O+"px",t.style.height=Y+"px"),this.setViewport(0,0,O,Y)},this.getDrawingBufferSize=function(O){return O.set(he*ye,te*ye).floor()},this.setDrawingBufferSize=function(O,Y,ee){he=O,te=Y,ye=ee,t.width=Math.floor(O*ee),t.height=Math.floor(Y*ee),this.setViewport(0,0,O,Y)},this.getCurrentViewport=function(O){return O.copy(A)},this.getViewport=function(O){return O.copy(K)},this.setViewport=function(O,Y,ee,se){O.isVector4?K.set(O.x,O.y,O.z,O.w):K.set(O,Y,ee,se),be.viewport(A.copy(K).multiplyScalar(ye).floor())},this.getScissor=function(O){return O.copy(ce)},this.setScissor=function(O,Y,ee,se){O.isVector4?ce.set(O.x,O.y,O.z,O.w):ce.set(O,Y,ee,se),be.scissor(L.copy(ce).multiplyScalar(ye).floor())},this.getScissorTest=function(){return de},this.setScissorTest=function(O){be.setScissorTest(de=O)},this.setOpaqueSort=function(O){G=O},this.setTransparentSort=function(O){Z=O},this.getClearColor=function(O){return O.copy(tn.getClearColor())},this.setClearColor=function(){tn.setClearColor.apply(tn,arguments)},this.getClearAlpha=function(){return tn.getClearAlpha()},this.setClearAlpha=function(){tn.setClearAlpha.apply(tn,arguments)},this.clear=function(O=!0,Y=!0,ee=!0){let se=0;if(O){let re=!1;if(P!==null){const xe=P.texture.format;re=xe===OM||xe===kM||xe===DM}if(re){const xe=P.texture.type,Me=xe===bs||xe===ko||xe===m0||xe===Dl||xe===PM||xe===NM,Re=tn.getClearColor(),Ce=tn.getClearAlpha(),Et=Re.r,je=Re.g,$e=Re.b;Me?(g[0]=Et,g[1]=je,g[2]=$e,g[3]=Ce,ie.clearBufferuiv(ie.COLOR,0,g)):(y[0]=Et,y[1]=je,y[2]=$e,y[3]=Ce,ie.clearBufferiv(ie.COLOR,0,y))}else se|=ie.COLOR_BUFFER_BIT}Y&&(se|=ie.DEPTH_BUFFER_BIT),ee&&(se|=ie.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),ie.clear(se)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",q,!1),t.removeEventListener("webglcontextrestored",J,!1),t.removeEventListener("webglcontextcreationerror",Ne,!1),Qe.dispose(),lt.dispose(),st.dispose(),H.dispose(),_e.dispose(),De.dispose(),ae.dispose(),Se.dispose(),yt.dispose(),ut.dispose(),ut.removeEventListener("sessionstart",gn),ut.removeEventListener("sessionend",Vt),ke&&(ke.dispose(),ke=null),$n.stop()};function q(O){O.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),R=!0}function J(){console.log("THREE.WebGLRenderer: Context Restored."),R=!1;const O=At.autoReset,Y=He.enabled,ee=He.autoUpdate,se=He.needsUpdate,re=He.type;Je(),At.autoReset=O,He.enabled=Y,He.autoUpdate=ee,He.needsUpdate=se,He.type=re}function Ne(O){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",O.statusMessage)}function Ke(O){const Y=O.target;Y.removeEventListener("dispose",Ke),Ze(Y)}function Ze(O){ot(O),st.remove(O)}function ot(O){const Y=st.get(O).programs;Y!==void 0&&(Y.forEach(function(ee){yt.releaseProgram(ee)}),O.isShaderMaterial&&yt.releaseShaderCache(O))}this.renderBufferDirect=function(O,Y,ee,se,re,xe){Y===null&&(Y=gt);const Me=re.isMesh&&re.matrixWorld.determinant()<0,Re=V(O,Y,ee,se,re);be.setMaterial(se,Me);let Ce=ee.index,Et=1;if(se.wireframe===!0){if(Ce=ze.getWireframeAttribute(ee),Ce===void 0)return;Et=2}const je=ee.drawRange,$e=ee.attributes.position;let mt=je.start*Et,Pt=(je.start+je.count)*Et;xe!==null&&(mt=Math.max(mt,xe.start*Et),Pt=Math.min(Pt,(xe.start+xe.count)*Et)),Ce!==null?(mt=Math.max(mt,0),Pt=Math.min(Pt,Ce.count)):$e!=null&&(mt=Math.max(mt,0),Pt=Math.min(Pt,$e.count));const Ut=Pt-mt;if(Ut<0||Ut===1/0)return;ae.setup(re,se,Re,ee,Ce);let Gt,pt=xt;if(Ce!==null&&(Gt=Ve.get(Ce),pt=ct,pt.setIndex(Gt)),re.isMesh)se.wireframe===!0?(be.setLineWidth(se.wireframeLinewidth*vt()),pt.setMode(ie.LINES)):pt.setMode(ie.TRIANGLES);else if(re.isLine){let at=se.linewidth;at===void 0&&(at=1),be.setLineWidth(at*vt()),re.isLineSegments?pt.setMode(ie.LINES):re.isLineLoop?pt.setMode(ie.LINE_LOOP):pt.setMode(ie.LINE_STRIP)}else re.isPoints?pt.setMode(ie.POINTS):re.isSprite&&pt.setMode(ie.TRIANGLES);if(re.isBatchedMesh)pt.renderMultiDraw(re._multiDrawStarts,re._multiDrawCounts,re._multiDrawCount);else if(re.isInstancedMesh)pt.renderInstances(mt,Ut,re.count);else if(ee.isInstancedBufferGeometry){const at=ee._maxInstanceCount!==void 0?ee._maxInstanceCount:1/0,Jt=Math.min(ee.instanceCount,at);pt.renderInstances(mt,Ut,Jt)}else pt.render(mt,Ut)};function $t(O,Y,ee){O.transparent===!0&&O.side===mo&&O.forceSinglePass===!1?(O.side=Hi,O.needsUpdate=!0,Zt(O,Y,ee),O.side=Na,O.needsUpdate=!0,Zt(O,Y,ee),O.side=mo):Zt(O,Y,ee)}this.compile=function(O,Y,ee=null){ee===null&&(ee=O),x=lt.get(ee),x.init(),w.push(x),ee.traverseVisible(function(re){re.isLight&&re.layers.test(Y.layers)&&(x.pushLight(re),re.castShadow&&x.pushShadow(re))}),O!==ee&&O.traverseVisible(function(re){re.isLight&&re.layers.test(Y.layers)&&(x.pushLight(re),re.castShadow&&x.pushShadow(re))}),x.setupLights(T._useLegacyLights);const se=new Set;return O.traverse(function(re){const xe=re.material;if(xe)if(Array.isArray(xe))for(let Me=0;Me<xe.length;Me++){const Re=xe[Me];$t(Re,ee,re),se.add(Re)}else $t(xe,ee,re),se.add(xe)}),w.pop(),x=null,se},this.compileAsync=function(O,Y,ee=null){const se=this.compile(O,Y,ee);return new Promise(re=>{function xe(){if(se.forEach(function(Me){st.get(Me).currentProgram.isReady()&&se.delete(Me)}),se.size===0){re(O);return}setTimeout(xe,10)}Ae.get("KHR_parallel_shader_compile")!==null?xe():setTimeout(xe,10)})};let rn=null;function sn(O){rn&&rn(O)}function gn(){$n.stop()}function Vt(){$n.start()}const $n=new bO;$n.setAnimationLoop(sn),typeof self<"u"&&$n.setContext(self),this.setAnimationLoop=function(O){rn=O,ut.setAnimationLoop(O),O===null?$n.stop():$n.start()},ut.addEventListener("sessionstart",gn),ut.addEventListener("sessionend",Vt),this.render=function(O,Y){if(Y!==void 0&&Y.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(R===!0)return;O.matrixWorldAutoUpdate===!0&&O.updateMatrixWorld(),Y.parent===null&&Y.matrixWorldAutoUpdate===!0&&Y.updateMatrixWorld(),ut.enabled===!0&&ut.isPresenting===!0&&(ut.cameraAutoUpdate===!0&&ut.updateCamera(Y),Y=ut.getCamera()),O.isScene===!0&&O.onBeforeRender(T,O,Y,P),x=lt.get(O,w.length),x.init(),w.push(x),Ye.multiplyMatrices(Y.projectionMatrix,Y.matrixWorldInverse),ue.setFromProjectionMatrix(Ye),Fe=this.localClippingEnabled,Ee=Nt.init(this.clippingPlanes,Fe),S=Qe.get(O,v.length),S.init(),v.push(S),ur(O,Y,0,T.sortObjects),S.finish(),T.sortObjects===!0&&S.sort(G,Z),this.info.render.frame++,Ee===!0&&Nt.beginShadows();const ee=x.state.shadowsArray;if(He.render(ee,O,Y),Ee===!0&&Nt.endShadows(),this.info.autoReset===!0&&this.info.reset(),tn.render(S,O),x.setupLights(T._useLegacyLights),Y.isArrayCamera){const se=Y.cameras;for(let re=0,xe=se.length;re<xe;re++){const Me=se[re];qr(S,O,Me,Me.viewport)}}else qr(S,O,Y);P!==null&&(W.updateMultisampleRenderTarget(P),W.updateRenderTargetMipmap(P)),O.isScene===!0&&O.onAfterRender(T,O,Y),ae.resetDefaultState(),b=-1,M=null,w.pop(),w.length>0?x=w[w.length-1]:x=null,v.pop(),v.length>0?S=v[v.length-1]:S=null};function ur(O,Y,ee,se){if(O.visible===!1)return;if(O.layers.test(Y.layers)){if(O.isGroup)ee=O.renderOrder;else if(O.isLOD)O.autoUpdate===!0&&O.update(Y);else if(O.isLight)x.pushLight(O),O.castShadow&&x.pushShadow(O);else if(O.isSprite){if(!O.frustumCulled||ue.intersectsSprite(O)){se&&Dt.setFromMatrixPosition(O.matrixWorld).applyMatrix4(Ye);const Me=De.update(O),Re=O.material;Re.visible&&S.push(O,Me,Re,ee,Dt.z,null)}}else if((O.isMesh||O.isLine||O.isPoints)&&(!O.frustumCulled||ue.intersectsObject(O))){const Me=De.update(O),Re=O.material;if(se&&(O.boundingSphere!==void 0?(O.boundingSphere===null&&O.computeBoundingSphere(),Dt.copy(O.boundingSphere.center)):(Me.boundingSphere===null&&Me.computeBoundingSphere(),Dt.copy(Me.boundingSphere.center)),Dt.applyMatrix4(O.matrixWorld).applyMatrix4(Ye)),Array.isArray(Re)){const Ce=Me.groups;for(let Et=0,je=Ce.length;Et<je;Et++){const $e=Ce[Et],mt=Re[$e.materialIndex];mt&&mt.visible&&S.push(O,Me,mt,ee,Dt.z,$e)}}else Re.visible&&S.push(O,Me,Re,ee,Dt.z,null)}}const xe=O.children;for(let Me=0,Re=xe.length;Me<Re;Me++)ur(xe[Me],Y,ee,se)}function qr(O,Y,ee,se){const re=O.opaque,xe=O.transmissive,Me=O.transparent;x.setupLightsView(ee),Ee===!0&&Nt.setGlobalState(T.clippingPlanes,ee),xe.length>0&&eo(re,xe,Y,ee),se&&be.viewport(A.copy(se)),re.length>0&&ci(re,Y,ee),xe.length>0&&ci(xe,Y,ee),Me.length>0&&ci(Me,Y,ee),be.buffers.depth.setTest(!0),be.buffers.depth.setMask(!0),be.buffers.color.setMask(!0),be.setPolygonOffset(!1)}function eo(O,Y,ee,se){if((ee.isScene===!0?ee.overrideMaterial:null)!==null)return;const xe=We.isWebGL2;ke===null&&(ke=new Wi(1,1,{generateMipmaps:!0,type:Ae.has("EXT_color_buffer_half_float")?ei:bs,minFilter:Yl,samples:xe?4:0})),T.getDrawingBufferSize(Ct),xe?ke.setSize(Ct.x,Ct.y):ke.setSize(Ay(Ct.x),Ay(Ct.y));const Me=T.getRenderTarget();T.setRenderTarget(ke),T.getClearColor(B),$=T.getClearAlpha(),$<1&&T.setClearColor(16777215,.5),T.clear();const Re=T.toneMapping;T.toneMapping=qo,ci(O,ee,se),W.updateMultisampleRenderTarget(ke),W.updateRenderTargetMipmap(ke);let Ce=!1;for(let Et=0,je=Y.length;Et<je;Et++){const $e=Y[Et],mt=$e.object,Pt=$e.geometry,Ut=$e.material,Gt=$e.group;if(Ut.side===mo&&mt.layers.test(se.layers)){const pt=Ut.side;Ut.side=Hi,Ut.needsUpdate=!0,tr(mt,ee,se,Pt,Ut,Gt),Ut.side=pt,Ut.needsUpdate=!0,Ce=!0}}Ce===!0&&(W.updateMultisampleRenderTarget(ke),W.updateRenderTargetMipmap(ke)),T.setRenderTarget(Me),T.setClearColor(B,$),T.toneMapping=Re}function ci(O,Y,ee){const se=Y.isScene===!0?Y.overrideMaterial:null;for(let re=0,xe=O.length;re<xe;re++){const Me=O[re],Re=Me.object,Ce=Me.geometry,Et=se===null?Me.material:se,je=Me.group;Re.layers.test(ee.layers)&&tr(Re,Y,ee,Ce,Et,je)}}function tr(O,Y,ee,se,re,xe){O.onBeforeRender(T,Y,ee,se,re,xe),O.modelViewMatrix.multiplyMatrices(ee.matrixWorldInverse,O.matrixWorld),O.normalMatrix.getNormalMatrix(O.modelViewMatrix),re.onBeforeRender(T,Y,ee,se,O,xe),re.transparent===!0&&re.side===mo&&re.forceSinglePass===!1?(re.side=Hi,re.needsUpdate=!0,T.renderBufferDirect(ee,Y,se,re,O,xe),re.side=Na,re.needsUpdate=!0,T.renderBufferDirect(ee,Y,se,re,O,xe),re.side=mo):T.renderBufferDirect(ee,Y,se,re,O,xe),O.onAfterRender(T,Y,ee,se,re,xe)}function Zt(O,Y,ee){Y.isScene!==!0&&(Y=gt);const se=st.get(O),re=x.state.lights,xe=x.state.shadowsArray,Me=re.state.version,Re=yt.getParameters(O,re.state,xe,Y,ee),Ce=yt.getProgramCacheKey(Re);let Et=se.programs;se.environment=O.isMeshStandardMaterial?Y.environment:null,se.fog=Y.fog,se.envMap=(O.isMeshStandardMaterial?_e:H).get(O.envMap||se.environment),Et===void 0&&(O.addEventListener("dispose",Ke),Et=new Map,se.programs=Et);let je=Et.get(Ce);if(je!==void 0){if(se.currentProgram===je&&se.lightsStateVersion===Me)return us(O,Re),je}else Re.uniforms=yt.getUniforms(O),O.onBuild(ee,Re,T),O.onBeforeCompile(Re,T),je=yt.acquireProgram(Re,Ce),Et.set(Ce,je),se.uniforms=Re.uniforms;const $e=se.uniforms;return(!O.isShaderMaterial&&!O.isRawShaderMaterial||O.clipping===!0)&&($e.clippingPlanes=Nt.uniform),us(O,Re),se.needsLights=le(O),se.lightsStateVersion=Me,se.needsLights&&($e.ambientLightColor.value=re.state.ambient,$e.lightProbe.value=re.state.probe,$e.directionalLights.value=re.state.directional,$e.directionalLightShadows.value=re.state.directionalShadow,$e.spotLights.value=re.state.spot,$e.spotLightShadows.value=re.state.spotShadow,$e.rectAreaLights.value=re.state.rectArea,$e.ltc_1.value=re.state.rectAreaLTC1,$e.ltc_2.value=re.state.rectAreaLTC2,$e.pointLights.value=re.state.point,$e.pointLightShadows.value=re.state.pointShadow,$e.hemisphereLights.value=re.state.hemi,$e.directionalShadowMap.value=re.state.directionalShadowMap,$e.directionalShadowMatrix.value=re.state.directionalShadowMatrix,$e.spotShadowMap.value=re.state.spotShadowMap,$e.spotLightMatrix.value=re.state.spotLightMatrix,$e.spotLightMap.value=re.state.spotLightMap,$e.pointShadowMap.value=re.state.pointShadowMap,$e.pointShadowMatrix.value=re.state.pointShadowMatrix),se.currentProgram=je,se.uniformsList=null,je}function Os(O){if(O.uniformsList===null){const Y=O.currentProgram.getUniforms();O.uniformsList=C_.seqWithValue(Y.seq,O.uniforms)}return O.uniformsList}function us(O,Y){const ee=st.get(O);ee.outputColorSpace=Y.outputColorSpace,ee.batching=Y.batching,ee.instancing=Y.instancing,ee.instancingColor=Y.instancingColor,ee.skinning=Y.skinning,ee.morphTargets=Y.morphTargets,ee.morphNormals=Y.morphNormals,ee.morphColors=Y.morphColors,ee.morphTargetsCount=Y.morphTargetsCount,ee.numClippingPlanes=Y.numClippingPlanes,ee.numIntersection=Y.numClipIntersection,ee.vertexAlphas=Y.vertexAlphas,ee.vertexTangents=Y.vertexTangents,ee.toneMapping=Y.toneMapping}function V(O,Y,ee,se,re){Y.isScene!==!0&&(Y=gt),W.resetTextureUnits();const xe=Y.fog,Me=se.isMeshStandardMaterial?Y.environment:null,Re=P===null?T.outputColorSpace:P.isXRRenderTarget===!0?P.texture.colorSpace:Ls,Ce=(se.isMeshStandardMaterial?_e:H).get(se.envMap||Me),Et=se.vertexColors===!0&&!!ee.attributes.color&&ee.attributes.color.itemSize===4,je=!!ee.attributes.tangent&&(!!se.normalMap||se.anisotropy>0),$e=!!ee.morphAttributes.position,mt=!!ee.morphAttributes.normal,Pt=!!ee.morphAttributes.color;let Ut=qo;se.toneMapped&&(P===null||P.isXRRenderTarget===!0)&&(Ut=T.toneMapping);const Gt=ee.morphAttributes.position||ee.morphAttributes.normal||ee.morphAttributes.color,pt=Gt!==void 0?Gt.length:0,at=st.get(se),Jt=x.state.lights;if(Ee===!0&&(Fe===!0||O!==M)){const rt=O===M&&se.id===b;Nt.setState(se,O,rt)}let kt=!1;se.version===at.__version?(at.needsLights&&at.lightsStateVersion!==Jt.state.version||at.outputColorSpace!==Re||re.isBatchedMesh&&at.batching===!1||!re.isBatchedMesh&&at.batching===!0||re.isInstancedMesh&&at.instancing===!1||!re.isInstancedMesh&&at.instancing===!0||re.isSkinnedMesh&&at.skinning===!1||!re.isSkinnedMesh&&at.skinning===!0||re.isInstancedMesh&&at.instancingColor===!0&&re.instanceColor===null||re.isInstancedMesh&&at.instancingColor===!1&&re.instanceColor!==null||at.envMap!==Ce||se.fog===!0&&at.fog!==xe||at.numClippingPlanes!==void 0&&(at.numClippingPlanes!==Nt.numPlanes||at.numIntersection!==Nt.numIntersection)||at.vertexAlphas!==Et||at.vertexTangents!==je||at.morphTargets!==$e||at.morphNormals!==mt||at.morphColors!==Pt||at.toneMapping!==Ut||We.isWebGL2===!0&&at.morphTargetsCount!==pt)&&(kt=!0):(kt=!0,at.__version=se.version);let Wt=at.currentProgram;kt===!0&&(Wt=Zt(se,Y,re));let Mn=!1,oe=!1,ge=!1;const Le=Wt.getUniforms(),qe=at.uniforms;if(be.useProgram(Wt.program)&&(Mn=!0,oe=!0,ge=!0),se.id!==b&&(b=se.id,oe=!0),Mn||M!==O){Le.setValue(ie,"projectionMatrix",O.projectionMatrix),Le.setValue(ie,"viewMatrix",O.matrixWorldInverse);const rt=Le.map.cameraPosition;rt!==void 0&&rt.setValue(ie,Dt.setFromMatrixPosition(O.matrixWorld)),We.logarithmicDepthBuffer&&Le.setValue(ie,"logDepthBufFC",2/(Math.log(O.far+1)/Math.LN2)),(se.isMeshPhongMaterial||se.isMeshToonMaterial||se.isMeshLambertMaterial||se.isMeshBasicMaterial||se.isMeshStandardMaterial||se.isShaderMaterial)&&Le.setValue(ie,"isOrthographic",O.isOrthographicCamera===!0),M!==O&&(M=O,oe=!0,ge=!0)}if(re.isSkinnedMesh){Le.setOptional(ie,re,"bindMatrix"),Le.setOptional(ie,re,"bindMatrixInverse");const rt=re.skeleton;rt&&(We.floatVertexTextures?(rt.boneTexture===null&&rt.computeBoneTexture(),Le.setValue(ie,"boneTexture",rt.boneTexture,W)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}re.isBatchedMesh&&(Le.setOptional(ie,re,"batchingTexture"),Le.setValue(ie,"batchingTexture",re._matricesTexture,W));const ht=ee.morphAttributes;if((ht.position!==void 0||ht.normal!==void 0||ht.color!==void 0&&We.isWebGL2===!0)&&Ht.update(re,ee,Wt),(oe||at.receiveShadow!==re.receiveShadow)&&(at.receiveShadow=re.receiveShadow,Le.setValue(ie,"receiveShadow",re.receiveShadow)),se.isMeshGouraudMaterial&&se.envMap!==null&&(qe.envMap.value=Ce,qe.flipEnvMap.value=Ce.isCubeTexture&&Ce.isRenderTargetTexture===!1?-1:1),oe&&(Le.setValue(ie,"toneMappingExposure",T.toneMappingExposure),at.needsLights&&X(qe,ge),xe&&se.fog===!0&&Xe.refreshFogUniforms(qe,xe),Xe.refreshMaterialUniforms(qe,se,ye,te,ke),C_.upload(ie,Os(at),qe,W)),se.isShaderMaterial&&se.uniformsNeedUpdate===!0&&(C_.upload(ie,Os(at),qe,W),se.uniformsNeedUpdate=!1),se.isSpriteMaterial&&Le.setValue(ie,"center",re.center),Le.setValue(ie,"modelViewMatrix",re.modelViewMatrix),Le.setValue(ie,"normalMatrix",re.normalMatrix),Le.setValue(ie,"modelMatrix",re.matrixWorld),se.isShaderMaterial||se.isRawShaderMaterial){const rt=se.uniformsGroups;for(let et=0,It=rt.length;et<It;et++)if(We.isWebGL2){const Yt=rt[et];Se.update(Yt,Wt),Se.bind(Yt,Wt)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Wt}function X(O,Y){O.ambientLightColor.needsUpdate=Y,O.lightProbe.needsUpdate=Y,O.directionalLights.needsUpdate=Y,O.directionalLightShadows.needsUpdate=Y,O.pointLights.needsUpdate=Y,O.pointLightShadows.needsUpdate=Y,O.spotLights.needsUpdate=Y,O.spotLightShadows.needsUpdate=Y,O.rectAreaLights.needsUpdate=Y,O.hemisphereLights.needsUpdate=Y}function le(O){return O.isMeshLambertMaterial||O.isMeshToonMaterial||O.isMeshPhongMaterial||O.isMeshStandardMaterial||O.isShadowMaterial||O.isShaderMaterial&&O.lights===!0}this.getActiveCubeFace=function(){return U},this.getActiveMipmapLevel=function(){return N},this.getRenderTarget=function(){return P},this.setRenderTargetTextures=function(O,Y,ee){st.get(O.texture).__webglTexture=Y,st.get(O.depthTexture).__webglTexture=ee;const se=st.get(O);se.__hasExternalTextures=!0,se.__hasExternalTextures&&(se.__autoAllocateDepthBuffer=ee===void 0,se.__autoAllocateDepthBuffer||Ae.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),se.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(O,Y){const ee=st.get(O);ee.__webglFramebuffer=Y,ee.__useDefaultFramebuffer=Y===void 0},this.setRenderTarget=function(O,Y=0,ee=0){P=O,U=Y,N=ee;let se=!0,re=null,xe=!1,Me=!1;if(O){const Ce=st.get(O);Ce.__useDefaultFramebuffer!==void 0?(be.bindFramebuffer(ie.FRAMEBUFFER,null),se=!1):Ce.__webglFramebuffer===void 0?W.setupRenderTarget(O):Ce.__hasExternalTextures&&W.rebindTextures(O,st.get(O.texture).__webglTexture,st.get(O.depthTexture).__webglTexture);const Et=O.texture;(Et.isData3DTexture||Et.isDataArrayTexture||Et.isCompressedArrayTexture)&&(Me=!0);const je=st.get(O).__webglFramebuffer;O.isWebGLCubeRenderTarget?(Array.isArray(je[Y])?re=je[Y][ee]:re=je[Y],xe=!0):We.isWebGL2&&O.samples>0&&W.useMultisampledRTT(O)===!1?re=st.get(O).__webglMultisampledFramebuffer:Array.isArray(je)?re=je[ee]:re=je,A.copy(O.viewport),L.copy(O.scissor),z=O.scissorTest}else A.copy(K).multiplyScalar(ye).floor(),L.copy(ce).multiplyScalar(ye).floor(),z=de;if(be.bindFramebuffer(ie.FRAMEBUFFER,re)&&We.drawBuffers&&se&&be.drawBuffers(O,re),be.viewport(A),be.scissor(L),be.setScissorTest(z),xe){const Ce=st.get(O.texture);ie.framebufferTexture2D(ie.FRAMEBUFFER,ie.COLOR_ATTACHMENT0,ie.TEXTURE_CUBE_MAP_POSITIVE_X+Y,Ce.__webglTexture,ee)}else if(Me){const Ce=st.get(O.texture),Et=Y||0;ie.framebufferTextureLayer(ie.FRAMEBUFFER,ie.COLOR_ATTACHMENT0,Ce.__webglTexture,ee||0,Et)}b=-1},this.readRenderTargetPixels=function(O,Y,ee,se,re,xe,Me){if(!(O&&O.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Re=st.get(O).__webglFramebuffer;if(O.isWebGLCubeRenderTarget&&Me!==void 0&&(Re=Re[Me]),Re){be.bindFramebuffer(ie.FRAMEBUFFER,Re);try{const Ce=O.texture,Et=Ce.format,je=Ce.type;if(Et!==kr&&ft.convert(Et)!==ie.getParameter(ie.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const $e=je===ei&&(Ae.has("EXT_color_buffer_half_float")||We.isWebGL2&&Ae.has("EXT_color_buffer_float"));if(je!==bs&&ft.convert(je)!==ie.getParameter(ie.IMPLEMENTATION_COLOR_READ_TYPE)&&!(je===Ur&&(We.isWebGL2||Ae.has("OES_texture_float")||Ae.has("WEBGL_color_buffer_float")))&&!$e){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Y>=0&&Y<=O.width-se&&ee>=0&&ee<=O.height-re&&ie.readPixels(Y,ee,se,re,ft.convert(Et),ft.convert(je),xe)}finally{const Ce=P!==null?st.get(P).__webglFramebuffer:null;be.bindFramebuffer(ie.FRAMEBUFFER,Ce)}}},this.copyFramebufferToTexture=function(O,Y,ee=0){const se=Math.pow(2,-ee),re=Math.floor(Y.image.width*se),xe=Math.floor(Y.image.height*se);W.setTexture2D(Y,0),ie.copyTexSubImage2D(ie.TEXTURE_2D,ee,0,0,O.x,O.y,re,xe),be.unbindTexture()},this.copyTextureToTexture=function(O,Y,ee,se=0){const re=Y.image.width,xe=Y.image.height,Me=ft.convert(ee.format),Re=ft.convert(ee.type);W.setTexture2D(ee,0),ie.pixelStorei(ie.UNPACK_FLIP_Y_WEBGL,ee.flipY),ie.pixelStorei(ie.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ee.premultiplyAlpha),ie.pixelStorei(ie.UNPACK_ALIGNMENT,ee.unpackAlignment),Y.isDataTexture?ie.texSubImage2D(ie.TEXTURE_2D,se,O.x,O.y,re,xe,Me,Re,Y.image.data):Y.isCompressedTexture?ie.compressedTexSubImage2D(ie.TEXTURE_2D,se,O.x,O.y,Y.mipmaps[0].width,Y.mipmaps[0].height,Me,Y.mipmaps[0].data):ie.texSubImage2D(ie.TEXTURE_2D,se,O.x,O.y,Me,Re,Y.image),se===0&&ee.generateMipmaps&&ie.generateMipmap(ie.TEXTURE_2D),be.unbindTexture()},this.copyTextureToTexture3D=function(O,Y,ee,se,re=0){if(T.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const xe=O.max.x-O.min.x+1,Me=O.max.y-O.min.y+1,Re=O.max.z-O.min.z+1,Ce=ft.convert(se.format),Et=ft.convert(se.type);let je;if(se.isData3DTexture)W.setTexture3D(se,0),je=ie.TEXTURE_3D;else if(se.isDataArrayTexture||se.isCompressedArrayTexture)W.setTexture2DArray(se,0),je=ie.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ie.pixelStorei(ie.UNPACK_FLIP_Y_WEBGL,se.flipY),ie.pixelStorei(ie.UNPACK_PREMULTIPLY_ALPHA_WEBGL,se.premultiplyAlpha),ie.pixelStorei(ie.UNPACK_ALIGNMENT,se.unpackAlignment);const $e=ie.getParameter(ie.UNPACK_ROW_LENGTH),mt=ie.getParameter(ie.UNPACK_IMAGE_HEIGHT),Pt=ie.getParameter(ie.UNPACK_SKIP_PIXELS),Ut=ie.getParameter(ie.UNPACK_SKIP_ROWS),Gt=ie.getParameter(ie.UNPACK_SKIP_IMAGES),pt=ee.isCompressedTexture?ee.mipmaps[re]:ee.image;ie.pixelStorei(ie.UNPACK_ROW_LENGTH,pt.width),ie.pixelStorei(ie.UNPACK_IMAGE_HEIGHT,pt.height),ie.pixelStorei(ie.UNPACK_SKIP_PIXELS,O.min.x),ie.pixelStorei(ie.UNPACK_SKIP_ROWS,O.min.y),ie.pixelStorei(ie.UNPACK_SKIP_IMAGES,O.min.z),ee.isDataTexture||ee.isData3DTexture?ie.texSubImage3D(je,re,Y.x,Y.y,Y.z,xe,Me,Re,Ce,Et,pt.data):ee.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ie.compressedTexSubImage3D(je,re,Y.x,Y.y,Y.z,xe,Me,Re,Ce,pt.data)):ie.texSubImage3D(je,re,Y.x,Y.y,Y.z,xe,Me,Re,Ce,Et,pt),ie.pixelStorei(ie.UNPACK_ROW_LENGTH,$e),ie.pixelStorei(ie.UNPACK_IMAGE_HEIGHT,mt),ie.pixelStorei(ie.UNPACK_SKIP_PIXELS,Pt),ie.pixelStorei(ie.UNPACK_SKIP_ROWS,Ut),ie.pixelStorei(ie.UNPACK_SKIP_IMAGES,Gt),re===0&&se.generateMipmaps&&ie.generateMipmap(je),be.unbindTexture()},this.initTexture=function(O){O.isCubeTexture?W.setTextureCube(O,0):O.isData3DTexture?W.setTexture3D(O,0):O.isDataArrayTexture||O.isCompressedArrayTexture?W.setTexture2DArray(O,0):W.setTexture2D(O,0),be.unbindTexture()},this.resetState=function(){U=0,N=0,P=null,be.reset(),ae.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return vo}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===_0?"display-p3":"srgb",t.unpackColorSpace=Fn.workingColorSpace===Dm?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Nr?Ol:VM}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Ol?Nr:Ls}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class UO extends w0{}UO.prototype.isWebGL1Renderer=!0;class S0{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Tt(e),this.density=t}clone(){return new S0(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class T0{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new Tt(e),this.near=t,this.far=r}clone(){return new T0(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Td extends Ln{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class M0{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Jp,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=Rs()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Rs()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Rs()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Ui=new Q;class yc{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)Ui.fromBufferAttribute(this,t),Ui.applyMatrix4(e),this.setXYZ(t,Ui.x,Ui.y,Ui.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Ui.fromBufferAttribute(this,t),Ui.applyNormalMatrix(e),this.setXYZ(t,Ui.x,Ui.y,Ui.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Ui.fromBufferAttribute(this,t),Ui.transformDirection(e),this.setXYZ(t,Ui.x,Ui.y,Ui.z);return this}setX(e,t){return this.normalized&&(t=cn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=cn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=cn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=cn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=is(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=is(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=is(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=is(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=cn(t,this.array),r=cn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=cn(t,this.array),r=cn(r,this.array),i=cn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=cn(t,this.array),r=cn(r,this.array),i=cn(i,this.array),s=cn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return new zn(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new yc(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class KM extends ui{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Tt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let ph;const Sf=new Q,mh=new Q,gh=new Q,vh=new Ue,Tf=new Ue,FO=new en,Sv=new Q,Mf=new Q,Tv=new Q,EP=new Ue,HE=new Ue,wP=new Ue;class VO extends Ln{constructor(e=new KM){if(super(),this.isSprite=!0,this.type="Sprite",ph===void 0){ph=new hn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new M0(t,5);ph.setIndex([0,1,2,0,2,3]),ph.setAttribute("position",new yc(r,3,0,!1)),ph.setAttribute("uv",new yc(r,2,3,!1))}this.geometry=ph,this.material=e,this.center=new Ue(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),mh.setFromMatrixScale(this.matrixWorld),FO.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),gh.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&mh.multiplyScalar(-gh.z);const r=this.material.rotation;let i,s;r!==0&&(s=Math.cos(r),i=Math.sin(r));const o=this.center;Mv(Sv.set(-.5,-.5,0),gh,o,mh,i,s),Mv(Mf.set(.5,-.5,0),gh,o,mh,i,s),Mv(Tv.set(.5,.5,0),gh,o,mh,i,s),EP.set(0,0),HE.set(1,0),wP.set(1,1);let a=e.ray.intersectTriangle(Sv,Mf,Tv,!1,Sf);if(a===null&&(Mv(Mf.set(-.5,.5,0),gh,o,mh,i,s),HE.set(0,1),a=e.ray.intersectTriangle(Sv,Tv,Mf,!1,Sf),a===null))return;const l=e.ray.origin.distanceTo(Sf);l<e.near||l>e.far||t.push({distance:l,point:Sf.clone(),uv:rs.getInterpolation(Sf,Sv,Mf,Tv,EP,HE,wP,new Ue),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Mv(n,e,t,r,i,s){vh.subVectors(n,t).addScalar(.5).multiply(r),i!==void 0?(Tf.x=s*vh.x-i*vh.y,Tf.y=i*vh.x+s*vh.y):Tf.copy(vh),n.copy(e),n.x+=Tf.x,n.y+=Tf.y,n.applyMatrix4(FO)}const Av=new Q,SP=new Q;class BO extends Ln{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let r=0,i=t.length;r<i;r++){const s=t[r];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,r=0){t=Math.abs(t);const i=this.levels;let s;for(s=0;s<i.length&&!(t<i[s].distance);s++);return i.splice(s,0,{distance:t,hysteresis:r,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let r,i;for(r=1,i=t.length;r<i;r++){let s=t[r].distance;if(t[r].object.visible&&(s-=s*t[r].hysteresis),e<s)break}return t[r-1].object}return null}raycast(e,t){if(this.levels.length>0){Av.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(Av);this.getObjectForDistance(i).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Av.setFromMatrixPosition(e.matrixWorld),SP.setFromMatrixPosition(this.matrixWorld);const r=Av.distanceTo(SP)/e.zoom;t[0].object.visible=!0;let i,s;for(i=1,s=t.length;i<s;i++){let o=t[i].distance;if(t[i].object.visible&&(o-=o*t[i].hysteresis),r>=o)t[i-1].object.visible=!1,t[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<s;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const r=this.levels;for(let i=0,s=r.length;i<s;i++){const o=r[i];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const TP=new Q,MP=new Vn,AP=new Vn,$$=new Q,CP=new en,Cv=new Q,GE=new bi,IP=new en,WE=new Ac;class zO extends sr{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=zS,this.bindMatrix=new en,this.bindMatrixInverse=new en,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Gi),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,Cv),this.boundingBox.expandByPoint(Cv)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new bi),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,Cv),this.boundingSphere.expandByPoint(Cv)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.material,i=this.matrixWorld;r!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),GE.copy(this.boundingSphere),GE.applyMatrix4(i),e.ray.intersectsSphere(GE)!==!1&&(IP.copy(i).invert(),WE.copy(e.ray).applyMatrix4(IP),!(this.boundingBox!==null&&WE.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,WE)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Vn,t=this.geometry.attributes.skinWeight;for(let r=0,i=t.count;r<i;r++){e.fromBufferAttribute(t,r);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===zS?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===nO?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const r=this.skeleton,i=this.geometry;MP.fromBufferAttribute(i.attributes.skinIndex,e),AP.fromBufferAttribute(i.attributes.skinWeight,e),TP.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=AP.getComponent(s);if(o!==0){const a=MP.getComponent(s);CP.multiplyMatrices(r.bones[a].matrixWorld,r.boneInverses[a]),t.addScaledVector($$.copy(TP).applyMatrix4(CP),o)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class QM extends Ln{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Ul extends Un{constructor(e=null,t=1,r=1,i,s,o,a,l,u=Er,d=Er,f,p){super(null,o,a,l,u,d,i,s,f,p),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const bP=new en,Y$=new en;class A0{constructor(e=[],t=[]){this.uuid=Rs(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new en)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const r=new en;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:Y$;bP.multiplyMatrices(a,t[s]),bP.toArray(r,s*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new A0(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const r=new Ul(t,e,e,kr,Ur);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){const s=e.bones[r];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new QM),this.bones.push(o),this.boneInverses.push(new en().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,r=this.boneInverses;for(let i=0,s=t.length;i<s;i++){const o=t[i];e.bones.push(o.uuid);const a=r[i];e.boneInverses.push(a.toArray())}return e}}class Md extends zn{constructor(e,t,r,i=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const _h=new en,RP=new en,Iv=[],PP=new Gi,K$=new en,Af=new sr,Cf=new bi;class HO extends sr{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Md(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<r;i++)this.setMatrixAt(i,K$)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Gi),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,_h),PP.copy(e.boundingBox).applyMatrix4(_h),this.boundingBox.union(PP)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new bi),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,_h),Cf.copy(e.boundingSphere).applyMatrix4(_h),this.boundingSphere.union(Cf)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const r=this.matrixWorld,i=this.count;if(Af.geometry=this.geometry,Af.material=this.material,Af.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Cf.copy(this.boundingSphere),Cf.applyMatrix4(r),e.ray.intersectsSphere(Cf)!==!1))for(let s=0;s<i;s++){this.getMatrixAt(s,_h),RP.multiplyMatrices(r,_h),Af.matrixWorld=RP,Af.raycast(e,Iv);for(let o=0,a=Iv.length;o<a;o++){const l=Iv[o];l.instanceId=s,l.object=this,t.push(l)}Iv.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Md(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}function Q$(n,e){return n.z-e.z}function Z$(n,e){return e.z-n.z}class J${constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t){const r=this.pool,i=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1});const s=r[this.index];i.push(s),this.index++,s.start=e.start,s.count=e.count,s.z=t}reset(){this.list.length=0,this.index=0}}const yh="batchId",rl=new en,NP=new en,eY=new en,LP=new en,jE=new Fm,bv=new Gi,Cu=new bi,If=new Q,qE=new J$,Si=new sr,Rv=[];function tY(n,e,t=0){const r=e.itemSize;if(n.isInterleavedBufferAttribute||n.array.constructor!==e.array.constructor){const i=n.count;for(let s=0;s<i;s++)for(let o=0;o<r;o++)e.setComponent(s+t,o,n.getComponent(s,o))}else e.array.set(n.array,t*r);e.needsUpdate=!0}class GO extends sr{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,t,r=t*2,i){super(new hn,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=t,this._maxIndexCount=r,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxGeometryCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),r=new Ul(t,e,e,kr,Ur);this._matricesTexture=r}_initializeGeometry(e){const t=this.geometry,r=this._maxVertexCount,i=this._maxGeometryCount,s=this._maxIndexCount;if(this._geometryInitialized===!1){for(const a in e.attributes){const l=e.getAttribute(a),{array:u,itemSize:d,normalized:f}=l,p=new u.constructor(r*d),g=new l.constructor(p,d,f);g.setUsage(l.usage),t.setAttribute(a,g)}if(e.getIndex()!==null){const a=r>65536?new Uint32Array(s):new Uint16Array(s);t.setIndex(new zn(a,1))}const o=i>65536?new Uint32Array(r):new Uint16Array(r);t.setAttribute(yh,new zn(o,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(yh))throw new Error(`BatchedMesh: Geometry cannot use attribute "${yh}"`);const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const r in t.attributes){if(r===yh)continue;if(!e.hasAttribute(r))throw new Error(`BatchedMesh: Added geometry missing "${r}". All geometries must have consistent attributes.`);const i=e.getAttribute(r),s=t.getAttribute(r);if(i.itemSize!==s.itemSize||i.normalized!==s.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Gi);const e=this._geometryCount,t=this.boundingBox,r=this._active;t.makeEmpty();for(let i=0;i<e;i++)r[i]!==!1&&(this.getMatrixAt(i,rl),this.getBoundingBoxAt(i,bv).applyMatrix4(rl),t.union(bv))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new bi);const e=this._geometryCount,t=this.boundingSphere,r=this._active;t.makeEmpty();for(let i=0;i<e;i++)r[i]!==!1&&(this.getMatrixAt(i,rl),this.getBoundingSphereAt(i,Cu).applyMatrix4(rl),t.union(Cu))}addGeometry(e,t=-1,r=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const i={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let s=null;const o=this._reservedRanges,a=this._drawRanges,l=this._bounds;this._geometryCount!==0&&(s=o[o.length-1]),t===-1?i.vertexCount=e.getAttribute("position").count:i.vertexCount=t,s===null?i.vertexStart=0:i.vertexStart=s.vertexStart+s.vertexCount;const u=e.getIndex(),d=u!==null;if(d&&(r===-1?i.indexCount=u.count:i.indexCount=r,s===null?i.indexStart=0:i.indexStart=s.indexStart+s.indexCount),i.indexStart!==-1&&i.indexStart+i.indexCount>this._maxIndexCount||i.vertexStart+i.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const f=this._visibility,p=this._active,g=this._matricesTexture,y=this._matricesTexture.image.data;f.push(!0),p.push(!0);const S=this._geometryCount;this._geometryCount++,eY.toArray(y,S*16),g.needsUpdate=!0,o.push(i),a.push({start:d?i.indexStart:i.vertexStart,count:-1}),l.push({boxInitialized:!1,box:new Gi,sphereInitialized:!1,sphere:new bi});const x=this.geometry.getAttribute(yh);for(let v=0;v<i.vertexCount;v++)x.setX(i.vertexStart+v,S);return x.needsUpdate=!0,this.setGeometryAt(S,e),S}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const r=this.geometry,i=r.getIndex()!==null,s=r.getIndex(),o=t.getIndex(),a=this._reservedRanges[e];if(i&&o.count>a.indexCount||t.attributes.position.count>a.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const l=a.vertexStart,u=a.vertexCount;for(const g in r.attributes){if(g===yh)continue;const y=t.getAttribute(g),S=r.getAttribute(g);tY(y,S,l);const x=y.itemSize;for(let v=y.count,w=u;v<w;v++){const T=l+v;for(let R=0;R<x;R++)S.setComponent(T,R,0)}S.needsUpdate=!0}if(i){const g=a.indexStart;for(let y=0;y<o.count;y++)s.setX(g+y,l+o.getX(y));for(let y=o.count,S=a.indexCount;y<S;y++)s.setX(g+y,l);s.needsUpdate=!0}const d=this._bounds[e];t.boundingBox!==null?(d.box.copy(t.boundingBox),d.boxInitialized=!0):d.boxInitialized=!1,t.boundingSphere!==null?(d.sphere.copy(t.boundingSphere),d.sphereInitialized=!0):d.sphereInitialized=!1;const f=this._drawRanges[e],p=t.getAttribute("position");return f.count=i?o.count:p.count,this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._active;return e>=t.length||t[e]===!1?this:(t[e]=!1,this._visibilityChanged=!0,this)}getBoundingBoxAt(e,t){if(this._active[e]===!1)return this;const i=this._bounds[e],s=i.box,o=this.geometry;if(i.boxInitialized===!1){s.makeEmpty();const a=o.index,l=o.attributes.position,u=this._drawRanges[e];for(let d=u.start,f=u.start+u.count;d<f;d++){let p=d;a&&(p=a.getX(p)),s.expandByPoint(If.fromBufferAttribute(l,p))}i.boxInitialized=!0}return t.copy(s),t}getBoundingSphereAt(e,t){if(this._active[e]===!1)return this;const i=this._bounds[e],s=i.sphere,o=this.geometry;if(i.sphereInitialized===!1){s.makeEmpty(),this.getBoundingBoxAt(e,bv),bv.getCenter(s.center);const a=o.index,l=o.attributes.position,u=this._drawRanges[e];let d=0;for(let f=u.start,p=u.start+u.count;f<p;f++){let g=f;a&&(g=a.getX(g)),If.fromBufferAttribute(l,g),d=Math.max(d,s.center.distanceToSquared(If))}s.radius=Math.sqrt(d),i.sphereInitialized=!0}return t.copy(s),t}setMatrixAt(e,t){const r=this._active,i=this._matricesTexture,s=this._matricesTexture.image.data,o=this._geometryCount;return e>=o||r[e]===!1?this:(t.toArray(s,e*16),i.needsUpdate=!0,this)}getMatrixAt(e,t){const r=this._active,i=this._matricesTexture.image.data,s=this._geometryCount;return e>=s||r[e]===!1?null:t.fromArray(i,e*16)}setVisibleAt(e,t){const r=this._visibility,i=this._active,s=this._geometryCount;return e>=s||i[e]===!1||r[e]===t?this:(r[e]=t,this._visibilityChanged=!0,this)}getVisibleAt(e){const t=this._visibility,r=this._active,i=this._geometryCount;return e>=i||r[e]===!1?!1:t[e]}raycast(e,t){const r=this._visibility,i=this._active,s=this._drawRanges,o=this._geometryCount,a=this.matrixWorld,l=this.geometry;Si.material=this.material,Si.geometry.index=l.index,Si.geometry.attributes=l.attributes,Si.geometry.boundingBox===null&&(Si.geometry.boundingBox=new Gi),Si.geometry.boundingSphere===null&&(Si.geometry.boundingSphere=new bi);for(let u=0;u<o;u++){if(!r[u]||!i[u])continue;const d=s[u];Si.geometry.setDrawRange(d.start,d.count),this.getMatrixAt(u,Si.matrixWorld).premultiply(a),this.getBoundingBoxAt(u,Si.geometry.boundingBox),this.getBoundingSphereAt(u,Si.geometry.boundingSphere),Si.raycast(e,Rv);for(let f=0,p=Rv.length;f<p;f++){const g=Rv[f];g.object=this,g.batchId=u,t.push(g)}Rv.length=0}Si.material=null,Si.geometry.index=null,Si.geometry.attributes={},Si.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,t,r,i,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=i.getIndex(),a=o===null?1:o.array.BYTES_PER_ELEMENT,l=this._visibility,u=this._multiDrawStarts,d=this._multiDrawCounts,f=this._drawRanges,p=this.perObjectFrustumCulled;p&&(LP.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse).multiply(this.matrixWorld),jE.setFromProjectionMatrix(LP,e.isWebGPURenderer?Ed:vo));let g=0;if(this.sortObjects){NP.copy(this.matrixWorld).invert(),If.setFromMatrixPosition(r.matrixWorld).applyMatrix4(NP);for(let x=0,v=l.length;x<v;x++)if(l[x]){this.getMatrixAt(x,rl),this.getBoundingSphereAt(x,Cu).applyMatrix4(rl);let w=!1;if(p&&(w=!jE.intersectsSphere(Cu)),!w){const T=If.distanceTo(Cu.center);qE.push(f[x],T)}}const y=qE.list,S=this.customSort;S===null?y.sort(s.transparent?Z$:Q$):S.call(this,y,r);for(let x=0,v=y.length;x<v;x++){const w=y[x];u[g]=w.start*a,d[g]=w.count,g++}qE.reset()}else for(let y=0,S=l.length;y<S;y++)if(l[y]){let x=!1;if(p&&(this.getMatrixAt(y,rl),this.getBoundingSphereAt(y,Cu).applyMatrix4(rl),x=!jE.intersectsSphere(Cu)),!x){const v=f[y];u[g]=v.start*a,d[g]=v.count,g++}}this._multiDrawCount=g,this._visibilityChanged=!1}onBeforeShadow(e,t,r,i,s,o){this.onBeforeRender(e,null,i,s,o)}}class $i extends ui{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Tt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const DP=new Q,kP=new Q,OP=new en,XE=new Ac,Pv=new bi;class Kl extends Ln{constructor(e=new hn,t=new $i){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[0];for(let i=1,s=t.count;i<s;i++)DP.fromBufferAttribute(t,i-1),kP.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=DP.distanceTo(kP);e.setAttribute("lineDistance",new Lt(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),Pv.copy(r.boundingSphere),Pv.applyMatrix4(i),Pv.radius+=s,e.ray.intersectsSphere(Pv)===!1)return;OP.copy(i).invert(),XE.copy(e.ray).applyMatrix4(OP);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=new Q,d=new Q,f=new Q,p=new Q,g=this.isLineSegments?2:1,y=r.index,x=r.attributes.position;if(y!==null){const v=Math.max(0,o.start),w=Math.min(y.count,o.start+o.count);for(let T=v,R=w-1;T<R;T+=g){const U=y.getX(T),N=y.getX(T+1);if(u.fromBufferAttribute(x,U),d.fromBufferAttribute(x,N),XE.distanceSqToSegment(u,d,p,f)>l)continue;p.applyMatrix4(this.matrixWorld);const b=e.ray.origin.distanceTo(p);b<e.near||b>e.far||t.push({distance:b,point:f.clone().applyMatrix4(this.matrixWorld),index:T,face:null,faceIndex:null,object:this})}}else{const v=Math.max(0,o.start),w=Math.min(x.count,o.start+o.count);for(let T=v,R=w-1;T<R;T+=g){if(u.fromBufferAttribute(x,T),d.fromBufferAttribute(x,T+1),XE.distanceSqToSegment(u,d,p,f)>l)continue;p.applyMatrix4(this.matrixWorld);const N=e.ray.origin.distanceTo(p);N<e.near||N>e.far||t.push({distance:N,point:f.clone().applyMatrix4(this.matrixWorld),index:T,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const UP=new Q,FP=new Q;class Ko extends Kl{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[];for(let i=0,s=t.count;i<s;i+=2)UP.fromBufferAttribute(t,i),FP.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+UP.distanceTo(FP);e.setAttribute("lineDistance",new Lt(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class WO extends Kl{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class ZM extends ui{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Tt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const VP=new en,yT=new Ac,Nv=new bi,Lv=new Q;class jO extends Ln{constructor(e=new hn,t=new ZM){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),Nv.copy(r.boundingSphere),Nv.applyMatrix4(i),Nv.radius+=s,e.ray.intersectsSphere(Nv)===!1)return;VP.copy(i).invert(),yT.copy(e.ray).applyMatrix4(VP);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=r.index,f=r.attributes.position;if(u!==null){const p=Math.max(0,o.start),g=Math.min(u.count,o.start+o.count);for(let y=p,S=g;y<S;y++){const x=u.getX(y);Lv.fromBufferAttribute(f,x),BP(Lv,x,l,i,e,t,this)}}else{const p=Math.max(0,o.start),g=Math.min(f.count,o.start+o.count);for(let y=p,S=g;y<S;y++)Lv.fromBufferAttribute(f,y),BP(Lv,y,l,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function BP(n,e,t,r,i,s,o){const a=yT.distanceSqToPoint(n);if(a<t){const l=new Q;yT.closestPointToPoint(n,l),l.applyMatrix4(r);const u=i.ray.origin.distanceTo(l);if(u<i.near||u>i.far)return;s.push({distance:u,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class nY extends Un{constructor(e,t,r,i,s,o,a,l,u){super(e,t,r,i,s,o,a,l,u),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:kn,this.magFilter=s!==void 0?s:kn,this.generateMipmaps=!1;const d=this;function f(){d.needsUpdate=!0,e.requestVideoFrameCallback(f)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(f)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class rY extends Un{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Er,this.minFilter=Er,this.generateMipmaps=!1,this.needsUpdate=!0}}class C0 extends Un{constructor(e,t,r,i,s,o,a,l,u,d,f,p){super(null,o,a,l,u,d,i,s,f,p),this.isCompressedTexture=!0,this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class iY extends C0{constructor(e,t,r,i,s,o){super(e,t,r,s,o),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=er}}class sY extends C0{constructor(e,t,r){super(void 0,e[0].width,e[0].height,t,r,Yo),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class oY extends Un{constructor(e,t,r,i,s,o,a,l,u){super(e,t,r,i,s,o,a,l,u),this.isCanvasTexture=!0,this.needsUpdate=!0}}class wo{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let r,i=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)r=this.getPoint(o/e),s+=r.distanceTo(i),t.push(s),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const r=this.getLengths();let i=0;const s=r.length;let o;t?o=t:o=e*r[s-1];let a=0,l=s-1,u;for(;a<=l;)if(i=Math.floor(a+(l-a)/2),u=r[i]-o,u<0)a=i+1;else if(u>0)l=i-1;else{l=i;break}if(i=l,r[i]===o)return i/(s-1);const d=r[i],p=r[i+1]-d,g=(o-d)/p;return(i+g)/(s-1)}getTangent(e,t){let i=e-1e-4,s=e+1e-4;i<0&&(i=0),s>1&&(s=1);const o=this.getPoint(i),a=this.getPoint(s),l=t||(o.isVector2?new Ue:new Q);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){const r=new Q,i=[],s=[],o=[],a=new Q,l=new en;for(let g=0;g<=e;g++){const y=g/e;i[g]=this.getTangentAt(y,new Q)}s[0]=new Q,o[0]=new Q;let u=Number.MAX_VALUE;const d=Math.abs(i[0].x),f=Math.abs(i[0].y),p=Math.abs(i[0].z);d<=u&&(u=d,r.set(1,0,0)),f<=u&&(u=f,r.set(0,1,0)),p<=u&&r.set(0,0,1),a.crossVectors(i[0],r).normalize(),s[0].crossVectors(i[0],a),o[0].crossVectors(i[0],s[0]);for(let g=1;g<=e;g++){if(s[g]=s[g-1].clone(),o[g]=o[g-1].clone(),a.crossVectors(i[g-1],i[g]),a.length()>Number.EPSILON){a.normalize();const y=Math.acos(mr(i[g-1].dot(i[g]),-1,1));s[g].applyMatrix4(l.makeRotationAxis(a,y))}o[g].crossVectors(i[g],s[g])}if(t===!0){let g=Math.acos(mr(s[0].dot(s[e]),-1,1));g/=e,i[0].dot(a.crossVectors(s[0],s[e]))>0&&(g=-g);for(let y=1;y<=e;y++)s[y].applyMatrix4(l.makeRotationAxis(i[y],g*y)),o[y].crossVectors(i[y],s[y])}return{tangents:i,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class I0 extends wo{constructor(e=0,t=0,r=1,i=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const r=t||new Ue,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(o?s=0:s=i),this.aClockwise===!0&&!o&&(s===i?s=-i:s=s-i);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const d=Math.cos(this.aRotation),f=Math.sin(this.aRotation),p=l-this.aX,g=u-this.aY;l=p*d-g*f+this.aX,u=p*f+g*d+this.aY}return r.set(l,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class qO extends I0{constructor(e,t,r,i,s,o){super(e,t,r,r,i,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function JM(){let n=0,e=0,t=0,r=0;function i(s,o,a,l){n=s,e=a,t=-3*s+3*o-2*a-l,r=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,u){i(o,a,u*(a-s),u*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,u,d,f){let p=(o-s)/u-(a-s)/(u+d)+(a-o)/d,g=(a-o)/d-(l-o)/(d+f)+(l-a)/f;p*=d,g*=d,i(o,a,p,g)},calc:function(s){const o=s*s,a=o*s;return n+e*s+t*o+r*a}}}const Dv=new Q,$E=new JM,YE=new JM,KE=new JM;class XO extends wo{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new Q){const r=t,i=this.points,s=i.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let u,d;this.closed||a>0?u=i[(a-1)%s]:(Dv.subVectors(i[0],i[1]).add(i[0]),u=Dv);const f=i[a%s],p=i[(a+1)%s];if(this.closed||a+2<s?d=i[(a+2)%s]:(Dv.subVectors(i[s-1],i[s-2]).add(i[s-1]),d=Dv),this.curveType==="centripetal"||this.curveType==="chordal"){const g=this.curveType==="chordal"?.5:.25;let y=Math.pow(u.distanceToSquared(f),g),S=Math.pow(f.distanceToSquared(p),g),x=Math.pow(p.distanceToSquared(d),g);S<1e-4&&(S=1),y<1e-4&&(y=S),x<1e-4&&(x=S),$E.initNonuniformCatmullRom(u.x,f.x,p.x,d.x,y,S,x),YE.initNonuniformCatmullRom(u.y,f.y,p.y,d.y,y,S,x),KE.initNonuniformCatmullRom(u.z,f.z,p.z,d.z,y,S,x)}else this.curveType==="catmullrom"&&($E.initCatmullRom(u.x,f.x,p.x,d.x,this.tension),YE.initCatmullRom(u.y,f.y,p.y,d.y,this.tension),KE.initCatmullRom(u.z,f.z,p.z,d.z,this.tension));return r.set($E.calc(l),YE.calc(l),KE.calc(l)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new Q().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function zP(n,e,t,r,i){const s=(r-e)*.5,o=(i-t)*.5,a=n*n,l=n*a;return(2*t-2*r+s+o)*l+(-3*t+3*r-2*s-o)*a+s*n+t}function aY(n,e){const t=1-n;return t*t*e}function lY(n,e){return 2*(1-n)*n*e}function uY(n,e){return n*n*e}function dp(n,e,t,r){return aY(n,e)+lY(n,t)+uY(n,r)}function cY(n,e){const t=1-n;return t*t*t*e}function hY(n,e){const t=1-n;return 3*t*t*n*e}function dY(n,e){return 3*(1-n)*n*n*e}function fY(n,e){return n*n*n*e}function fp(n,e,t,r,i){return cY(n,e)+hY(n,t)+dY(n,r)+fY(n,i)}class eA extends wo{constructor(e=new Ue,t=new Ue,r=new Ue,i=new Ue){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new Ue){const r=t,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return r.set(fp(e,i.x,s.x,o.x,a.x),fp(e,i.y,s.y,o.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class $O extends wo{constructor(e=new Q,t=new Q,r=new Q,i=new Q){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new Q){const r=t,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return r.set(fp(e,i.x,s.x,o.x,a.x),fp(e,i.y,s.y,o.y,a.y),fp(e,i.z,s.z,o.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class tA extends wo{constructor(e=new Ue,t=new Ue){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Ue){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Ue){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class YO extends wo{constructor(e=new Q,t=new Q){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new Q){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Q){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class nA extends wo{constructor(e=new Ue,t=new Ue,r=new Ue){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Ue){const r=t,i=this.v0,s=this.v1,o=this.v2;return r.set(dp(e,i.x,s.x,o.x),dp(e,i.y,s.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class rA extends wo{constructor(e=new Q,t=new Q,r=new Q){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Q){const r=t,i=this.v0,s=this.v1,o=this.v2;return r.set(dp(e,i.x,s.x,o.x),dp(e,i.y,s.y,o.y),dp(e,i.z,s.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class iA extends wo{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Ue){const r=t,i=this.points,s=(i.length-1)*e,o=Math.floor(s),a=s-o,l=i[o===0?o:o-1],u=i[o],d=i[o>i.length-2?i.length-1:o+1],f=i[o>i.length-3?i.length-1:o+2];return r.set(zP(a,l.x,u.x,d.x,f.x),zP(a,l.y,u.y,d.y,f.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new Ue().fromArray(i))}return this}}var Cy=Object.freeze({__proto__:null,ArcCurve:qO,CatmullRomCurve3:XO,CubicBezierCurve:eA,CubicBezierCurve3:$O,EllipseCurve:I0,LineCurve:tA,LineCurve3:YO,QuadraticBezierCurve:nA,QuadraticBezierCurve3:rA,SplineCurve:iA});class KO extends wo{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const r=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Cy[r](t,e))}return this}getPoint(e,t){const r=e*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=r){const o=i[s]-r,a=this.curves[s],l=a.getLength(),u=l===0?0:1-o/l;return a.getPointAt(u,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let r;for(let i=0,s=this.curves;i<s.length;i++){const o=s[i],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let u=0;u<l.length;u++){const d=l[u];r&&r.equals(d)||(t.push(d),r=d)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(new Cy[i.type]().fromJSON(i))}return this}}class tm extends KO{constructor(e){super(),this.type="Path",this.currentPoint=new Ue,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const r=new tA(this.currentPoint.clone(),new Ue(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){const s=new nA(this.currentPoint.clone(),new Ue(e,t),new Ue(r,i));return this.curves.push(s),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,s,o){const a=new eA(this.currentPoint.clone(),new Ue(e,t),new Ue(r,i),new Ue(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),r=new iA(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,r,i,s,o),this}absarc(e,t,r,i,s,o){return this.absellipse(e,t,r,r,i,s,o),this}ellipse(e,t,r,i,s,o,a,l){const u=this.currentPoint.x,d=this.currentPoint.y;return this.absellipse(e+u,t+d,r,i,s,o,a,l),this}absellipse(e,t,r,i,s,o,a,l){const u=new I0(e,t,r,i,s,o,a,l);if(this.curves.length>0){const f=u.getPoint(0);f.equals(this.currentPoint)||this.lineTo(f.x,f.y)}this.curves.push(u);const d=u.getPoint(1);return this.currentPoint.copy(d),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Vm extends hn{constructor(e=[new Ue(0,-.5),new Ue(.5,0),new Ue(0,.5)],t=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:i},t=Math.floor(t),i=mr(i,0,Math.PI*2);const s=[],o=[],a=[],l=[],u=[],d=1/t,f=new Q,p=new Ue,g=new Q,y=new Q,S=new Q;let x=0,v=0;for(let w=0;w<=e.length-1;w++)switch(w){case 0:x=e[w+1].x-e[w].x,v=e[w+1].y-e[w].y,g.x=v*1,g.y=-x,g.z=v*0,S.copy(g),g.normalize(),l.push(g.x,g.y,g.z);break;case e.length-1:l.push(S.x,S.y,S.z);break;default:x=e[w+1].x-e[w].x,v=e[w+1].y-e[w].y,g.x=v*1,g.y=-x,g.z=v*0,y.copy(g),g.x+=S.x,g.y+=S.y,g.z+=S.z,g.normalize(),l.push(g.x,g.y,g.z),S.copy(y)}for(let w=0;w<=t;w++){const T=r+w*d*i,R=Math.sin(T),U=Math.cos(T);for(let N=0;N<=e.length-1;N++){f.x=e[N].x*R,f.y=e[N].y,f.z=e[N].x*U,o.push(f.x,f.y,f.z),p.x=w/t,p.y=N/(e.length-1),a.push(p.x,p.y);const P=l[3*N+0]*R,b=l[3*N+1],M=l[3*N+0]*U;u.push(P,b,M)}}for(let w=0;w<t;w++)for(let T=0;T<e.length-1;T++){const R=T+w*e.length,U=R,N=R+e.length,P=R+e.length+1,b=R+1;s.push(U,N,b),s.push(P,b,N)}this.setIndex(s),this.setAttribute("position",new Lt(o,3)),this.setAttribute("uv",new Lt(a,2)),this.setAttribute("normal",new Lt(u,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Vm(e.points,e.segments,e.phiStart,e.phiLength)}}class b0 extends Vm{constructor(e=1,t=1,r=4,i=8){const s=new tm;s.absarc(0,-t/2,e,Math.PI*1.5,0),s.absarc(0,t/2,e,0,Math.PI*.5),super(s.getPoints(r),i),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:r,radialSegments:i}}static fromJSON(e){return new b0(e.radius,e.length,e.capSegments,e.radialSegments)}}class R0 extends hn{constructor(e=1,t=32,r=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:i},t=Math.max(3,t);const s=[],o=[],a=[],l=[],u=new Q,d=new Ue;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let f=0,p=3;f<=t;f++,p+=3){const g=r+f/t*i;u.x=e*Math.cos(g),u.y=e*Math.sin(g),o.push(u.x,u.y,u.z),a.push(0,0,1),d.x=(o[p]/e+1)/2,d.y=(o[p+1]/e+1)/2,l.push(d.x,d.y)}for(let f=1;f<=t;f++)s.push(f,f+1,0);this.setIndex(s),this.setAttribute("position",new Lt(o,3)),this.setAttribute("normal",new Lt(a,3)),this.setAttribute("uv",new Lt(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new R0(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Vd extends hn{constructor(e=1,t=1,r=1,i=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const u=this;i=Math.floor(i),s=Math.floor(s);const d=[],f=[],p=[],g=[];let y=0;const S=[],x=r/2;let v=0;w(),o===!1&&(e>0&&T(!0),t>0&&T(!1)),this.setIndex(d),this.setAttribute("position",new Lt(f,3)),this.setAttribute("normal",new Lt(p,3)),this.setAttribute("uv",new Lt(g,2));function w(){const R=new Q,U=new Q;let N=0;const P=(t-e)/r;for(let b=0;b<=s;b++){const M=[],A=b/s,L=A*(t-e)+e;for(let z=0;z<=i;z++){const B=z/i,$=B*l+a,he=Math.sin($),te=Math.cos($);U.x=L*he,U.y=-A*r+x,U.z=L*te,f.push(U.x,U.y,U.z),R.set(he,P,te).normalize(),p.push(R.x,R.y,R.z),g.push(B,1-A),M.push(y++)}S.push(M)}for(let b=0;b<i;b++)for(let M=0;M<s;M++){const A=S[M][b],L=S[M+1][b],z=S[M+1][b+1],B=S[M][b+1];d.push(A,L,B),d.push(L,z,B),N+=6}u.addGroup(v,N,0),v+=N}function T(R){const U=y,N=new Ue,P=new Q;let b=0;const M=R===!0?e:t,A=R===!0?1:-1;for(let z=1;z<=i;z++)f.push(0,x*A,0),p.push(0,A,0),g.push(.5,.5),y++;const L=y;for(let z=0;z<=i;z++){const $=z/i*l+a,he=Math.cos($),te=Math.sin($);P.x=M*te,P.y=x*A,P.z=M*he,f.push(P.x,P.y,P.z),p.push(0,A,0),N.x=he*.5+.5,N.y=te*.5*A+.5,g.push(N.x,N.y),y++}for(let z=0;z<i;z++){const B=U+z,$=L+z;R===!0?d.push($,$+1,B):d.push($+1,$,B),b+=3}u.addGroup(v,b,R===!0?1:2),v+=b}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Vd(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class P0 extends Vd{constructor(e=1,t=1,r=32,i=1,s=!1,o=0,a=Math.PI*2){super(0,e,t,r,i,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new P0(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class iu extends hn{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};const s=[],o=[];a(i),u(r),d(),this.setAttribute("position",new Lt(s,3)),this.setAttribute("normal",new Lt(s.slice(),3)),this.setAttribute("uv",new Lt(o,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function a(w){const T=new Q,R=new Q,U=new Q;for(let N=0;N<t.length;N+=3)g(t[N+0],T),g(t[N+1],R),g(t[N+2],U),l(T,R,U,w)}function l(w,T,R,U){const N=U+1,P=[];for(let b=0;b<=N;b++){P[b]=[];const M=w.clone().lerp(R,b/N),A=T.clone().lerp(R,b/N),L=N-b;for(let z=0;z<=L;z++)z===0&&b===N?P[b][z]=M:P[b][z]=M.clone().lerp(A,z/L)}for(let b=0;b<N;b++)for(let M=0;M<2*(N-b)-1;M++){const A=Math.floor(M/2);M%2===0?(p(P[b][A+1]),p(P[b+1][A]),p(P[b][A])):(p(P[b][A+1]),p(P[b+1][A+1]),p(P[b+1][A]))}}function u(w){const T=new Q;for(let R=0;R<s.length;R+=3)T.x=s[R+0],T.y=s[R+1],T.z=s[R+2],T.normalize().multiplyScalar(w),s[R+0]=T.x,s[R+1]=T.y,s[R+2]=T.z}function d(){const w=new Q;for(let T=0;T<s.length;T+=3){w.x=s[T+0],w.y=s[T+1],w.z=s[T+2];const R=x(w)/2/Math.PI+.5,U=v(w)/Math.PI+.5;o.push(R,1-U)}y(),f()}function f(){for(let w=0;w<o.length;w+=6){const T=o[w+0],R=o[w+2],U=o[w+4],N=Math.max(T,R,U),P=Math.min(T,R,U);N>.9&&P<.1&&(T<.2&&(o[w+0]+=1),R<.2&&(o[w+2]+=1),U<.2&&(o[w+4]+=1))}}function p(w){s.push(w.x,w.y,w.z)}function g(w,T){const R=w*3;T.x=e[R+0],T.y=e[R+1],T.z=e[R+2]}function y(){const w=new Q,T=new Q,R=new Q,U=new Q,N=new Ue,P=new Ue,b=new Ue;for(let M=0,A=0;M<s.length;M+=9,A+=6){w.set(s[M+0],s[M+1],s[M+2]),T.set(s[M+3],s[M+4],s[M+5]),R.set(s[M+6],s[M+7],s[M+8]),N.set(o[A+0],o[A+1]),P.set(o[A+2],o[A+3]),b.set(o[A+4],o[A+5]),U.copy(w).add(T).add(R).divideScalar(3);const L=x(U);S(N,A+0,w,L),S(P,A+2,T,L),S(b,A+4,R,L)}}function S(w,T,R,U){U<0&&w.x===1&&(o[T]=w.x-1),R.x===0&&R.z===0&&(o[T]=U/2/Math.PI+.5)}function x(w){return Math.atan2(w.z,-w.x)}function v(w){return Math.atan2(-w.y,Math.sqrt(w.x*w.x+w.z*w.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new iu(e.vertices,e.indices,e.radius,e.details)}}class N0 extends iu{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=1/r,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new N0(e.radius,e.detail)}}const kv=new Q,Ov=new Q,QE=new Q,Uv=new rs;class QO extends hn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),s=Math.cos(ic*t),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,u=[0,0,0],d=["a","b","c"],f=new Array(3),p={},g=[];for(let y=0;y<l;y+=3){o?(u[0]=o.getX(y),u[1]=o.getX(y+1),u[2]=o.getX(y+2)):(u[0]=y,u[1]=y+1,u[2]=y+2);const{a:S,b:x,c:v}=Uv;if(S.fromBufferAttribute(a,u[0]),x.fromBufferAttribute(a,u[1]),v.fromBufferAttribute(a,u[2]),Uv.getNormal(QE),f[0]=`${Math.round(S.x*i)},${Math.round(S.y*i)},${Math.round(S.z*i)}`,f[1]=`${Math.round(x.x*i)},${Math.round(x.y*i)},${Math.round(x.z*i)}`,f[2]=`${Math.round(v.x*i)},${Math.round(v.y*i)},${Math.round(v.z*i)}`,!(f[0]===f[1]||f[1]===f[2]||f[2]===f[0]))for(let w=0;w<3;w++){const T=(w+1)%3,R=f[w],U=f[T],N=Uv[d[w]],P=Uv[d[T]],b=`${R}_${U}`,M=`${U}_${R}`;M in p&&p[M]?(QE.dot(p[M].normal)<=s&&(g.push(N.x,N.y,N.z),g.push(P.x,P.y,P.z)),p[M]=null):b in p||(p[b]={index0:u[w],index1:u[T],normal:QE.clone()})}}for(const y in p)if(p[y]){const{index0:S,index1:x}=p[y];kv.fromBufferAttribute(a,S),Ov.fromBufferAttribute(a,x),g.push(kv.x,kv.y,kv.z),g.push(Ov.x,Ov.y,Ov.z)}this.setAttribute("position",new Lt(g,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class oc extends tm{constructor(e){super(e),this.uuid=Rs(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(new tm().fromJSON(i))}return this}}const pY={triangulate:function(n,e,t=2){const r=e&&e.length,i=r?e[0]*t:n.length;let s=ZO(n,0,i,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,u,d,f,p,g;if(r&&(s=yY(n,e,s,t)),n.length>80*t){a=u=n[0],l=d=n[1];for(let y=t;y<i;y+=t)f=n[y],p=n[y+1],f<a&&(a=f),p<l&&(l=p),f>u&&(u=f),p>d&&(d=p);g=Math.max(u-a,d-l),g=g!==0?32767/g:0}return nm(s,o,t,a,l,g,0),o}};function ZO(n,e,t,r,i){let s,o;if(i===RY(n,e,t,r)>0)for(s=e;s<t;s+=r)o=HP(s,n[s],n[s+1],o);else for(s=t-r;s>=e;s-=r)o=HP(s,n[s],n[s+1],o);return o&&L0(o,o.next)&&(im(o),o=o.next),o}function xc(n,e){if(!n)return n;e||(e=n);let t=n,r;do if(r=!1,!t.steiner&&(L0(t,t.next)||ir(t.prev,t,t.next)===0)){if(im(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function nm(n,e,t,r,i,s,o){if(!n)return;!o&&s&&TY(n,r,i,s);let a=n,l,u;for(;n.prev!==n.next;){if(l=n.prev,u=n.next,s?gY(n,r,i,s):mY(n)){e.push(l.i/t|0),e.push(n.i/t|0),e.push(u.i/t|0),im(n),n=u.next,a=u.next;continue}if(n=u,n===a){o?o===1?(n=vY(xc(n),e,t),nm(n,e,t,r,i,s,2)):o===2&&_Y(n,e,t,r,i,s):nm(xc(n),e,t,r,i,s,1);break}}}function mY(n){const e=n.prev,t=n,r=n.next;if(ir(e,t,r)>=0)return!1;const i=e.x,s=t.x,o=r.x,a=e.y,l=t.y,u=r.y,d=i<s?i<o?i:o:s<o?s:o,f=a<l?a<u?a:u:l<u?l:u,p=i>s?i>o?i:o:s>o?s:o,g=a>l?a>u?a:u:l>u?l:u;let y=r.next;for(;y!==e;){if(y.x>=d&&y.x<=p&&y.y>=f&&y.y<=g&&Xh(i,a,s,l,o,u,y.x,y.y)&&ir(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function gY(n,e,t,r){const i=n.prev,s=n,o=n.next;if(ir(i,s,o)>=0)return!1;const a=i.x,l=s.x,u=o.x,d=i.y,f=s.y,p=o.y,g=a<l?a<u?a:u:l<u?l:u,y=d<f?d<p?d:p:f<p?f:p,S=a>l?a>u?a:u:l>u?l:u,x=d>f?d>p?d:p:f>p?f:p,v=xT(g,y,e,t,r),w=xT(S,x,e,t,r);let T=n.prevZ,R=n.nextZ;for(;T&&T.z>=v&&R&&R.z<=w;){if(T.x>=g&&T.x<=S&&T.y>=y&&T.y<=x&&T!==i&&T!==o&&Xh(a,d,l,f,u,p,T.x,T.y)&&ir(T.prev,T,T.next)>=0||(T=T.prevZ,R.x>=g&&R.x<=S&&R.y>=y&&R.y<=x&&R!==i&&R!==o&&Xh(a,d,l,f,u,p,R.x,R.y)&&ir(R.prev,R,R.next)>=0))return!1;R=R.nextZ}for(;T&&T.z>=v;){if(T.x>=g&&T.x<=S&&T.y>=y&&T.y<=x&&T!==i&&T!==o&&Xh(a,d,l,f,u,p,T.x,T.y)&&ir(T.prev,T,T.next)>=0)return!1;T=T.prevZ}for(;R&&R.z<=w;){if(R.x>=g&&R.x<=S&&R.y>=y&&R.y<=x&&R!==i&&R!==o&&Xh(a,d,l,f,u,p,R.x,R.y)&&ir(R.prev,R,R.next)>=0)return!1;R=R.nextZ}return!0}function vY(n,e,t){let r=n;do{const i=r.prev,s=r.next.next;!L0(i,s)&&JO(i,r,r.next,s)&&rm(i,s)&&rm(s,i)&&(e.push(i.i/t|0),e.push(r.i/t|0),e.push(s.i/t|0),im(r),im(r.next),r=n=s),r=r.next}while(r!==n);return xc(r)}function _Y(n,e,t,r,i,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&CY(o,a)){let l=eU(o,a);o=xc(o,o.next),l=xc(l,l.next),nm(o,e,t,r,i,s,0),nm(l,e,t,r,i,s,0);return}a=a.next}o=o.next}while(o!==n)}function yY(n,e,t,r){const i=[];let s,o,a,l,u;for(s=0,o=e.length;s<o;s++)a=e[s]*r,l=s<o-1?e[s+1]*r:n.length,u=ZO(n,a,l,r,!1),u===u.next&&(u.steiner=!0),i.push(AY(u));for(i.sort(xY),s=0;s<i.length;s++)t=EY(i[s],t);return t}function xY(n,e){return n.x-e.x}function EY(n,e){const t=wY(n,e);if(!t)return e;const r=eU(t,n);return xc(r,r.next),xc(t,t.next)}function wY(n,e){let t=e,r=-1/0,i;const s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const p=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(p<=s&&p>r&&(r=p,i=t.x<t.next.x?t:t.next,p===s))return i}t=t.next}while(t!==e);if(!i)return null;const a=i,l=i.x,u=i.y;let d=1/0,f;t=i;do s>=t.x&&t.x>=l&&s!==t.x&&Xh(o<u?s:r,o,l,u,o<u?r:s,o,t.x,t.y)&&(f=Math.abs(o-t.y)/(s-t.x),rm(t,n)&&(f<d||f===d&&(t.x>i.x||t.x===i.x&&SY(i,t)))&&(i=t,d=f)),t=t.next;while(t!==a);return i}function SY(n,e){return ir(n.prev,n,e.prev)<0&&ir(e.next,n,n.next)<0}function TY(n,e,t,r){let i=n;do i.z===0&&(i.z=xT(i.x,i.y,e,t,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==n);i.prevZ.nextZ=null,i.prevZ=null,MY(i)}function MY(n){let e,t,r,i,s,o,a,l,u=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,r=t,a=0,e=0;e<u&&(a++,r=r.nextZ,!!r);e++);for(l=u;a>0||l>0&&r;)a!==0&&(l===0||!r||t.z<=r.z)?(i=t,t=t.nextZ,a--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:n=i,i.prevZ=s,s=i;t=r}s.nextZ=null,u*=2}while(o>1);return n}function xT(n,e,t,r,i){return n=(n-t)*i|0,e=(e-r)*i|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function AY(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function Xh(n,e,t,r,i,s,o,a){return(i-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(r-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(i-o)*(r-a)}function CY(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!IY(n,e)&&(rm(n,e)&&rm(e,n)&&bY(n,e)&&(ir(n.prev,n,e.prev)||ir(n,e.prev,e))||L0(n,e)&&ir(n.prev,n,n.next)>0&&ir(e.prev,e,e.next)>0)}function ir(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function L0(n,e){return n.x===e.x&&n.y===e.y}function JO(n,e,t,r){const i=Vv(ir(n,e,t)),s=Vv(ir(n,e,r)),o=Vv(ir(t,r,n)),a=Vv(ir(t,r,e));return!!(i!==s&&o!==a||i===0&&Fv(n,t,e)||s===0&&Fv(n,r,e)||o===0&&Fv(t,n,r)||a===0&&Fv(t,e,r))}function Fv(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Vv(n){return n>0?1:n<0?-1:0}function IY(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&JO(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function rm(n,e){return ir(n.prev,n,n.next)<0?ir(n,e,n.next)>=0&&ir(n,n.prev,e)>=0:ir(n,e,n.prev)<0||ir(n,n.next,e)<0}function bY(n,e){let t=n,r=!1;const i=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==n);return r}function eU(n,e){const t=new ET(n.i,n.x,n.y),r=new ET(e.i,e.x,e.y),i=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=i,i.prev=t,r.next=t,t.prev=r,s.next=r,r.prev=s,r}function HP(n,e,t,r){const i=new ET(n,e,t);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function im(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function ET(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function RY(n,e,t,r){let i=0;for(let s=e,o=t-r;s<t;s+=r)i+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return i}class Xo{static area(e){const t=e.length;let r=0;for(let i=t-1,s=0;s<t;i=s++)r+=e[i].x*e[s].y-e[s].x*e[i].y;return r*.5}static isClockWise(e){return Xo.area(e)<0}static triangulateShape(e,t){const r=[],i=[],s=[];GP(e),WP(r,e);let o=e.length;t.forEach(GP);for(let l=0;l<t.length;l++)i.push(o),o+=t[l].length,WP(r,t[l]);const a=pY.triangulate(r,i);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function GP(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function WP(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class D0 extends hn{constructor(e=new oc([new Ue(.5,.5),new Ue(-.5,.5),new Ue(-.5,-.5),new Ue(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const r=this,i=[],s=[];for(let a=0,l=e.length;a<l;a++){const u=e[a];o(u)}this.setAttribute("position",new Lt(i,3)),this.setAttribute("uv",new Lt(s,2)),this.computeVertexNormals();function o(a){const l=[],u=t.curveSegments!==void 0?t.curveSegments:12,d=t.steps!==void 0?t.steps:1,f=t.depth!==void 0?t.depth:1;let p=t.bevelEnabled!==void 0?t.bevelEnabled:!0,g=t.bevelThickness!==void 0?t.bevelThickness:.2,y=t.bevelSize!==void 0?t.bevelSize:g-.1,S=t.bevelOffset!==void 0?t.bevelOffset:0,x=t.bevelSegments!==void 0?t.bevelSegments:3;const v=t.extrudePath,w=t.UVGenerator!==void 0?t.UVGenerator:PY;let T,R=!1,U,N,P,b;v&&(T=v.getSpacedPoints(d),R=!0,p=!1,U=v.computeFrenetFrames(d,!1),N=new Q,P=new Q,b=new Q),p||(x=0,g=0,y=0,S=0);const M=a.extractPoints(u);let A=M.shape;const L=M.holes;if(!Xo.isClockWise(A)){A=A.reverse();for(let ie=0,Be=L.length;ie<Be;ie++){const Ae=L[ie];Xo.isClockWise(Ae)&&(L[ie]=Ae.reverse())}}const B=Xo.triangulateShape(A,L),$=A;for(let ie=0,Be=L.length;ie<Be;ie++){const Ae=L[ie];A=A.concat(Ae)}function he(ie,Be,Ae){return Be||console.error("THREE.ExtrudeGeometry: vec does not exist"),ie.clone().addScaledVector(Be,Ae)}const te=A.length,ye=B.length;function G(ie,Be,Ae){let We,be,At;const st=ie.x-Be.x,W=ie.y-Be.y,H=Ae.x-ie.x,_e=Ae.y-ie.y,Ve=st*st+W*W,ze=st*_e-W*H;if(Math.abs(ze)>Number.EPSILON){const De=Math.sqrt(Ve),yt=Math.sqrt(H*H+_e*_e),Xe=Be.x-W/De,Qe=Be.y+st/De,lt=Ae.x-_e/yt,Nt=Ae.y+H/yt,He=((lt-Xe)*_e-(Nt-Qe)*H)/(st*_e-W*H);We=Xe+st*He-ie.x,be=Qe+W*He-ie.y;const tn=We*We+be*be;if(tn<=2)return new Ue(We,be);At=Math.sqrt(tn/2)}else{let De=!1;st>Number.EPSILON?H>Number.EPSILON&&(De=!0):st<-Number.EPSILON?H<-Number.EPSILON&&(De=!0):Math.sign(W)===Math.sign(_e)&&(De=!0),De?(We=-W,be=st,At=Math.sqrt(Ve)):(We=st,be=W,At=Math.sqrt(Ve/2))}return new Ue(We/At,be/At)}const Z=[];for(let ie=0,Be=$.length,Ae=Be-1,We=ie+1;ie<Be;ie++,Ae++,We++)Ae===Be&&(Ae=0),We===Be&&(We=0),Z[ie]=G($[ie],$[Ae],$[We]);const K=[];let ce,de=Z.concat();for(let ie=0,Be=L.length;ie<Be;ie++){const Ae=L[ie];ce=[];for(let We=0,be=Ae.length,At=be-1,st=We+1;We<be;We++,At++,st++)At===be&&(At=0),st===be&&(st=0),ce[We]=G(Ae[We],Ae[At],Ae[st]);K.push(ce),de=de.concat(ce)}for(let ie=0;ie<x;ie++){const Be=ie/x,Ae=g*Math.cos(Be*Math.PI/2),We=y*Math.sin(Be*Math.PI/2)+S;for(let be=0,At=$.length;be<At;be++){const st=he($[be],Z[be],We);Ye(st.x,st.y,-Ae)}for(let be=0,At=L.length;be<At;be++){const st=L[be];ce=K[be];for(let W=0,H=st.length;W<H;W++){const _e=he(st[W],ce[W],We);Ye(_e.x,_e.y,-Ae)}}}const ue=y+S;for(let ie=0;ie<te;ie++){const Be=p?he(A[ie],de[ie],ue):A[ie];R?(P.copy(U.normals[0]).multiplyScalar(Be.x),N.copy(U.binormals[0]).multiplyScalar(Be.y),b.copy(T[0]).add(P).add(N),Ye(b.x,b.y,b.z)):Ye(Be.x,Be.y,0)}for(let ie=1;ie<=d;ie++)for(let Be=0;Be<te;Be++){const Ae=p?he(A[Be],de[Be],ue):A[Be];R?(P.copy(U.normals[ie]).multiplyScalar(Ae.x),N.copy(U.binormals[ie]).multiplyScalar(Ae.y),b.copy(T[ie]).add(P).add(N),Ye(b.x,b.y,b.z)):Ye(Ae.x,Ae.y,f/d*ie)}for(let ie=x-1;ie>=0;ie--){const Be=ie/x,Ae=g*Math.cos(Be*Math.PI/2),We=y*Math.sin(Be*Math.PI/2)+S;for(let be=0,At=$.length;be<At;be++){const st=he($[be],Z[be],We);Ye(st.x,st.y,f+Ae)}for(let be=0,At=L.length;be<At;be++){const st=L[be];ce=K[be];for(let W=0,H=st.length;W<H;W++){const _e=he(st[W],ce[W],We);R?Ye(_e.x,_e.y+T[d-1].y,T[d-1].x+Ae):Ye(_e.x,_e.y,f+Ae)}}}Ee(),Fe();function Ee(){const ie=i.length/3;if(p){let Be=0,Ae=te*Be;for(let We=0;We<ye;We++){const be=B[We];Ct(be[2]+Ae,be[1]+Ae,be[0]+Ae)}Be=d+x*2,Ae=te*Be;for(let We=0;We<ye;We++){const be=B[We];Ct(be[0]+Ae,be[1]+Ae,be[2]+Ae)}}else{for(let Be=0;Be<ye;Be++){const Ae=B[Be];Ct(Ae[2],Ae[1],Ae[0])}for(let Be=0;Be<ye;Be++){const Ae=B[Be];Ct(Ae[0]+te*d,Ae[1]+te*d,Ae[2]+te*d)}}r.addGroup(ie,i.length/3-ie,0)}function Fe(){const ie=i.length/3;let Be=0;ke($,Be),Be+=$.length;for(let Ae=0,We=L.length;Ae<We;Ae++){const be=L[Ae];ke(be,Be),Be+=be.length}r.addGroup(ie,i.length/3-ie,1)}function ke(ie,Be){let Ae=ie.length;for(;--Ae>=0;){const We=Ae;let be=Ae-1;be<0&&(be=ie.length-1);for(let At=0,st=d+x*2;At<st;At++){const W=te*At,H=te*(At+1),_e=Be+We+W,Ve=Be+be+W,ze=Be+be+H,De=Be+We+H;Dt(_e,Ve,ze,De)}}}function Ye(ie,Be,Ae){l.push(ie),l.push(Be),l.push(Ae)}function Ct(ie,Be,Ae){gt(ie),gt(Be),gt(Ae);const We=i.length/3,be=w.generateTopUV(r,i,We-3,We-2,We-1);vt(be[0]),vt(be[1]),vt(be[2])}function Dt(ie,Be,Ae,We){gt(ie),gt(Be),gt(We),gt(Be),gt(Ae),gt(We);const be=i.length/3,At=w.generateSideWallUV(r,i,be-6,be-3,be-2,be-1);vt(At[0]),vt(At[1]),vt(At[3]),vt(At[1]),vt(At[2]),vt(At[3])}function gt(ie){i.push(l[ie*3+0]),i.push(l[ie*3+1]),i.push(l[ie*3+2])}function vt(ie){s.push(ie.x),s.push(ie.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,r=this.parameters.options;return NY(t,r,e)}static fromJSON(e,t){const r=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=t[e.shapes[s]];r.push(a)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new Cy[i.type]().fromJSON(i)),new D0(r,e.options)}}const PY={generateTopUV:function(n,e,t,r,i){const s=e[t*3],o=e[t*3+1],a=e[r*3],l=e[r*3+1],u=e[i*3],d=e[i*3+1];return[new Ue(s,o),new Ue(a,l),new Ue(u,d)]},generateSideWallUV:function(n,e,t,r,i,s){const o=e[t*3],a=e[t*3+1],l=e[t*3+2],u=e[r*3],d=e[r*3+1],f=e[r*3+2],p=e[i*3],g=e[i*3+1],y=e[i*3+2],S=e[s*3],x=e[s*3+1],v=e[s*3+2];return Math.abs(a-d)<Math.abs(o-u)?[new Ue(o,1-l),new Ue(u,1-f),new Ue(p,1-y),new Ue(S,1-v)]:[new Ue(a,1-l),new Ue(d,1-f),new Ue(g,1-y),new Ue(x,1-v)]}};function NY(n,e,t){if(t.shapes=[],Array.isArray(n))for(let r=0,i=n.length;r<i;r++){const s=n[r];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class Bm extends iu{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Bm(e.radius,e.detail)}}class zm extends iu{constructor(e=1,t=0){const r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new zm(e.radius,e.detail)}}class k0 extends hn{constructor(e=.5,t=1,r=32,i=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:i,thetaStart:s,thetaLength:o},r=Math.max(3,r),i=Math.max(1,i);const a=[],l=[],u=[],d=[];let f=e;const p=(t-e)/i,g=new Q,y=new Ue;for(let S=0;S<=i;S++){for(let x=0;x<=r;x++){const v=s+x/r*o;g.x=f*Math.cos(v),g.y=f*Math.sin(v),l.push(g.x,g.y,g.z),u.push(0,0,1),y.x=(g.x/t+1)/2,y.y=(g.y/t+1)/2,d.push(y.x,y.y)}f+=p}for(let S=0;S<i;S++){const x=S*(r+1);for(let v=0;v<r;v++){const w=v+x,T=w,R=w+r+1,U=w+r+2,N=w+1;a.push(T,R,N),a.push(R,U,N)}}this.setIndex(a),this.setAttribute("position",new Lt(l,3)),this.setAttribute("normal",new Lt(u,3)),this.setAttribute("uv",new Lt(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new k0(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class O0 extends hn{constructor(e=new oc([new Ue(0,.5),new Ue(-.5,-.5),new Ue(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const r=[],i=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)u(e);else for(let d=0;d<e.length;d++)u(e[d]),this.addGroup(a,l,d),a+=l,l=0;this.setIndex(r),this.setAttribute("position",new Lt(i,3)),this.setAttribute("normal",new Lt(s,3)),this.setAttribute("uv",new Lt(o,2));function u(d){const f=i.length/3,p=d.extractPoints(t);let g=p.shape;const y=p.holes;Xo.isClockWise(g)===!1&&(g=g.reverse());for(let x=0,v=y.length;x<v;x++){const w=y[x];Xo.isClockWise(w)===!0&&(y[x]=w.reverse())}const S=Xo.triangulateShape(g,y);for(let x=0,v=y.length;x<v;x++){const w=y[x];g=g.concat(w)}for(let x=0,v=g.length;x<v;x++){const w=g[x];i.push(w.x,w.y,0),s.push(0,0,1),o.push(w.x,w.y)}for(let x=0,v=S.length;x<v;x++){const w=S[x],T=w[0]+f,R=w[1]+f,U=w[2]+f;r.push(T,R,U),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return LY(t,e)}static fromJSON(e,t){const r=[];for(let i=0,s=e.shapes.length;i<s;i++){const o=t[e.shapes[i]];r.push(o)}return new O0(r,e.curveSegments)}}function LY(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const i=n[t];e.shapes.push(i.uuid)}else e.shapes.push(n.uuid);return e}class Hm extends hn{constructor(e=1,t=32,r=16,i=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const l=Math.min(o+a,Math.PI);let u=0;const d=[],f=new Q,p=new Q,g=[],y=[],S=[],x=[];for(let v=0;v<=r;v++){const w=[],T=v/r;let R=0;v===0&&o===0?R=.5/t:v===r&&l===Math.PI&&(R=-.5/t);for(let U=0;U<=t;U++){const N=U/t;f.x=-e*Math.cos(i+N*s)*Math.sin(o+T*a),f.y=e*Math.cos(o+T*a),f.z=e*Math.sin(i+N*s)*Math.sin(o+T*a),y.push(f.x,f.y,f.z),p.copy(f).normalize(),S.push(p.x,p.y,p.z),x.push(N+R,1-T),w.push(u++)}d.push(w)}for(let v=0;v<r;v++)for(let w=0;w<t;w++){const T=d[v][w+1],R=d[v][w],U=d[v+1][w],N=d[v+1][w+1];(v!==0||o>0)&&g.push(T,R,N),(v!==r-1||l<Math.PI)&&g.push(R,U,N)}this.setIndex(g),this.setAttribute("position",new Lt(y,3)),this.setAttribute("normal",new Lt(S,3)),this.setAttribute("uv",new Lt(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Hm(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class U0 extends iu{constructor(e=1,t=0){const r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new U0(e.radius,e.detail)}}class F0 extends hn{constructor(e=1,t=.4,r=12,i=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:s},r=Math.floor(r),i=Math.floor(i);const o=[],a=[],l=[],u=[],d=new Q,f=new Q,p=new Q;for(let g=0;g<=r;g++)for(let y=0;y<=i;y++){const S=y/i*s,x=g/r*Math.PI*2;f.x=(e+t*Math.cos(x))*Math.cos(S),f.y=(e+t*Math.cos(x))*Math.sin(S),f.z=t*Math.sin(x),a.push(f.x,f.y,f.z),d.x=e*Math.cos(S),d.y=e*Math.sin(S),p.subVectors(f,d).normalize(),l.push(p.x,p.y,p.z),u.push(y/i),u.push(g/r)}for(let g=1;g<=r;g++)for(let y=1;y<=i;y++){const S=(i+1)*g+y-1,x=(i+1)*(g-1)+y-1,v=(i+1)*(g-1)+y,w=(i+1)*g+y;o.push(S,x,w),o.push(x,v,w)}this.setIndex(o),this.setAttribute("position",new Lt(a,3)),this.setAttribute("normal",new Lt(l,3)),this.setAttribute("uv",new Lt(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new F0(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class V0 extends hn{constructor(e=1,t=.4,r=64,i=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:s,q:o},r=Math.floor(r),i=Math.floor(i);const a=[],l=[],u=[],d=[],f=new Q,p=new Q,g=new Q,y=new Q,S=new Q,x=new Q,v=new Q;for(let T=0;T<=r;++T){const R=T/r*s*Math.PI*2;w(R,s,o,e,g),w(R+.01,s,o,e,y),x.subVectors(y,g),v.addVectors(y,g),S.crossVectors(x,v),v.crossVectors(S,x),S.normalize(),v.normalize();for(let U=0;U<=i;++U){const N=U/i*Math.PI*2,P=-t*Math.cos(N),b=t*Math.sin(N);f.x=g.x+(P*v.x+b*S.x),f.y=g.y+(P*v.y+b*S.y),f.z=g.z+(P*v.z+b*S.z),l.push(f.x,f.y,f.z),p.subVectors(f,g).normalize(),u.push(p.x,p.y,p.z),d.push(T/r),d.push(U/i)}}for(let T=1;T<=r;T++)for(let R=1;R<=i;R++){const U=(i+1)*(T-1)+(R-1),N=(i+1)*T+(R-1),P=(i+1)*T+R,b=(i+1)*(T-1)+R;a.push(U,N,b),a.push(N,P,b)}this.setIndex(a),this.setAttribute("position",new Lt(l,3)),this.setAttribute("normal",new Lt(u,3)),this.setAttribute("uv",new Lt(d,2));function w(T,R,U,N,P){const b=Math.cos(T),M=Math.sin(T),A=U/R*T,L=Math.cos(A);P.x=N*(2+L)*.5*b,P.y=N*(2+L)*M*.5,P.z=N*Math.sin(A)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new V0(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class B0 extends hn{constructor(e=new rA(new Q(-1,-1,0),new Q(-1,1,0),new Q(1,1,0)),t=64,r=1,i=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:i,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new Q,l=new Q,u=new Ue;let d=new Q;const f=[],p=[],g=[],y=[];S(),this.setIndex(y),this.setAttribute("position",new Lt(f,3)),this.setAttribute("normal",new Lt(p,3)),this.setAttribute("uv",new Lt(g,2));function S(){for(let T=0;T<t;T++)x(T);x(s===!1?t:0),w(),v()}function x(T){d=e.getPointAt(T/t,d);const R=o.normals[T],U=o.binormals[T];for(let N=0;N<=i;N++){const P=N/i*Math.PI*2,b=Math.sin(P),M=-Math.cos(P);l.x=M*R.x+b*U.x,l.y=M*R.y+b*U.y,l.z=M*R.z+b*U.z,l.normalize(),p.push(l.x,l.y,l.z),a.x=d.x+r*l.x,a.y=d.y+r*l.y,a.z=d.z+r*l.z,f.push(a.x,a.y,a.z)}}function v(){for(let T=1;T<=t;T++)for(let R=1;R<=i;R++){const U=(i+1)*(T-1)+(R-1),N=(i+1)*T+(R-1),P=(i+1)*T+R,b=(i+1)*(T-1)+R;y.push(U,N,b),y.push(N,P,b)}}function w(){for(let T=0;T<=t;T++)for(let R=0;R<=i;R++)u.x=T/t,u.y=R/i,g.push(u.x,u.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new B0(new Cy[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class tU extends hn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],r=new Set,i=new Q,s=new Q;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let u=0,d=l.length;u<d;++u){const f=l[u],p=f.start,g=f.count;for(let y=p,S=p+g;y<S;y+=3)for(let x=0;x<3;x++){const v=a.getX(y+x),w=a.getX(y+(x+1)%3);i.fromBufferAttribute(o,v),s.fromBufferAttribute(o,w),jP(i,s,r)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let u=0;u<3;u++){const d=3*a+u,f=3*a+(u+1)%3;i.fromBufferAttribute(o,d),s.fromBufferAttribute(o,f),jP(i,s,r)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new Lt(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function jP(n,e,t){const r=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(r)===!0||t.has(i)===!0?!1:(t.add(r),t.add(i),!0)}var qP=Object.freeze({__proto__:null,BoxGeometry:Cc,CapsuleGeometry:b0,CircleGeometry:R0,ConeGeometry:P0,CylinderGeometry:Vd,DodecahedronGeometry:N0,EdgesGeometry:QO,ExtrudeGeometry:D0,IcosahedronGeometry:Bm,LatheGeometry:Vm,OctahedronGeometry:zm,PlaneGeometry:ru,PolyhedronGeometry:iu,RingGeometry:k0,ShapeGeometry:O0,SphereGeometry:Hm,TetrahedronGeometry:U0,TorusGeometry:F0,TorusKnotGeometry:V0,TubeGeometry:B0,WireframeGeometry:tU});class nU extends ui{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Tt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class rU extends ji{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class sA extends ui{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Tt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Tt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=nu,this.normalScale=new Ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class iU extends sA{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ue(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return mr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Tt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Tt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Tt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class sU extends ui{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Tt(16777215),this.specular=new Tt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Tt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=nu,this.normalScale=new Ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Lm,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class oU extends ui{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Tt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Tt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=nu,this.normalScale=new Ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class aU extends ui{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=nu,this.normalScale=new Ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class lU extends ui{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Tt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Tt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=nu,this.normalScale=new Ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Lm,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class uU extends ui{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Tt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=nu,this.normalScale=new Ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class cU extends $i{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Zu(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function hU(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function dU(n){function e(i,s){return n[i]-n[s]}const t=n.length,r=new Array(t);for(let i=0;i!==t;++i)r[i]=i;return r.sort(e),r}function wT(n,e,t){const r=n.length,i=new n.constructor(r);for(let s=0,o=0;o!==r;++s){const a=t[s]*e;for(let l=0;l!==e;++l)i[o++]=n[a+l]}return i}function oA(n,e,t,r){let i=1,s=n[0];for(;s!==void 0&&s[r]===void 0;)s=n[i++];if(s===void 0)return;let o=s[r];if(o!==void 0)if(Array.isArray(o))do o=s[r],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=n[i++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[r],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=n[i++];while(s!==void 0);else do o=s[r],o!==void 0&&(e.push(s.time),t.push(o)),s=n[i++];while(s!==void 0)}function DY(n,e,t,r,i=30){const s=n.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const u=s.tracks[l],d=u.getValueSize(),f=[],p=[];for(let g=0;g<u.times.length;++g){const y=u.times[g]*i;if(!(y<t||y>=r)){f.push(u.times[g]);for(let S=0;S<d;++S)p.push(u.values[g*d+S])}}f.length!==0&&(u.times=Zu(f,u.times.constructor),u.values=Zu(p,u.values.constructor),o.push(u))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function kY(n,e=0,t=n,r=30){r<=0&&(r=30);const i=t.tracks.length,s=e/r;for(let o=0;o<i;++o){const a=t.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const u=n.tracks.find(function(v){return v.name===a.name&&v.ValueTypeName===l});if(u===void 0)continue;let d=0;const f=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=f/3);let p=0;const g=u.getValueSize();u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(p=g/3);const y=a.times.length-1;let S;if(s<=a.times[0]){const v=d,w=f-d;S=a.values.slice(v,w)}else if(s>=a.times[y]){const v=y*f+d,w=v+f-d;S=a.values.slice(v,w)}else{const v=a.createInterpolant(),w=d,T=f-d;v.evaluate(s),S=v.resultBuffer.slice(w,T)}l==="quaternion"&&new Ii().fromArray(S).normalize().conjugate().toArray(S);const x=u.times.length;for(let v=0;v<x;++v){const w=v*g+p;if(l==="quaternion")Ii.multiplyQuaternionsFlat(u.values,w,S,0,u.values,w);else{const T=g-p*2;for(let R=0;R<T;++R)u.values[w+R]-=S[R]}}}return n.blendMode=FM,n}const OY={convertArray:Zu,isTypedArray:hU,getKeyframeOrder:dU,sortedArray:wT,flattenJSON:oA,subclip:DY,makeClipAdditive:kY};class Gm{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,i=t[r],s=t[r-1];e:{t:{let o;n:{r:if(!(e<i)){for(let a=r+2;;){if(i===void 0){if(e<s)break r;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===a)break;if(s=i,i=t[++r],e<i)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(r=2,s=a);for(let l=r-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===l)break;if(i=s,s=t[--r-1],e>=s)break t}o=r,r=0;break n}break e}for(;r<o;){const a=r+o>>>1;e<t[a]?o=a:r=a+1}if(i=t[r],s=t[r-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,s,i)}return this.interpolate_(r,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i;for(let o=0;o!==i;++o)t[o]=r[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class fU extends Gm{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:$u,endingEnd:$u}}intervalChanged_(e,t,r){const i=this.parameterPositions;let s=e-2,o=e+1,a=i[s],l=i[o];if(a===void 0)switch(this.getSettings_().endingStart){case Yu:s=e,a=2*t-r;break;case Yp:s=i.length-2,a=t+i[s]-i[s+1];break;default:s=e,a=r}if(l===void 0)switch(this.getSettings_().endingEnd){case Yu:o=e,l=2*r-t;break;case Yp:o=1,l=r+i[1]-i[0];break;default:o=e-1,l=t}const u=(r-t)*.5,d=this.valueSize;this._weightPrev=u/(t-a),this._weightNext=u/(l-r),this._offsetPrev=s*d,this._offsetNext=o*d}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,d=this._offsetPrev,f=this._offsetNext,p=this._weightPrev,g=this._weightNext,y=(r-t)/(i-t),S=y*y,x=S*y,v=-p*x+2*p*S-p*y,w=(1+p)*x+(-1.5-2*p)*S+(-.5+p)*y+1,T=(-1-g)*x+(1.5+g)*S+.5*y,R=g*x-g*S;for(let U=0;U!==a;++U)s[U]=v*o[d+U]+w*o[u+U]+T*o[l+U]+R*o[f+U];return s}}class aA extends Gm{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,d=(r-t)/(i-t),f=1-d;for(let p=0;p!==a;++p)s[p]=o[u+p]*f+o[l+p]*d;return s}}class pU extends Gm{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class So{constructor(e,t,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Zu(t,this.TimeBufferType),this.values=Zu(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:Zu(e.times,Array),values:Zu(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new pU(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new aA(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new fU(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Xp:t=this.InterpolantFactoryMethodDiscrete;break;case $p:t=this.InterpolantFactoryMethodLinear;break;case A_:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Xp;case this.InterpolantFactoryMethodLinear:return $p;case this.InterpolantFactoryMethodSmooth:return A_}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){const r=this.times,i=r.length;let s=0,o=i-1;for(;s!==i&&r[s]<e;)++s;for(;o!==-1&&r[o]>t;)--o;if(++o,s!==0||o!==i){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=r.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,i=this.values,s=r.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=r[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(i!==void 0&&hU(i))for(let a=0,l=i.length;a!==l;++a){const u=i[a];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),r=this.getValueSize(),i=this.getInterpolation()===A_,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const u=e[a],d=e[a+1];if(u!==d&&(a!==1||u!==e[0]))if(i)l=!0;else{const f=a*r,p=f-r,g=f+r;for(let y=0;y!==r;++y){const S=t[f+y];if(S!==t[p+y]||S!==t[g+y]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const f=a*r,p=o*r;for(let g=0;g!==r;++g)t[p+g]=t[f+g]}++o}}if(s>0){e[o]=e[s];for(let a=s*r,l=o*r,u=0;u!==r;++u)t[l+u]=t[a+u];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*r)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=this.constructor,i=new r(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}So.prototype.TimeBufferType=Float32Array;So.prototype.ValueBufferType=Float32Array;So.prototype.DefaultInterpolation=$p;class Ic extends So{}Ic.prototype.ValueTypeName="bool";Ic.prototype.ValueBufferType=Array;Ic.prototype.DefaultInterpolation=Xp;Ic.prototype.InterpolantFactoryMethodLinear=void 0;Ic.prototype.InterpolantFactoryMethodSmooth=void 0;class lA extends So{}lA.prototype.ValueTypeName="color";class sm extends So{}sm.prototype.ValueTypeName="number";class mU extends Gm{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(r-t)/(i-t);let u=e*a;for(let d=u+a;u!==d;u+=4)Ii.slerpFlat(s,0,o,u-a,o,u,l);return s}}class Bd extends So{InterpolantFactoryMethodLinear(e){return new mU(this.times,this.values,this.getValueSize(),e)}}Bd.prototype.ValueTypeName="quaternion";Bd.prototype.DefaultInterpolation=$p;Bd.prototype.InterpolantFactoryMethodSmooth=void 0;class bc extends So{}bc.prototype.ValueTypeName="string";bc.prototype.ValueBufferType=Array;bc.prototype.DefaultInterpolation=Xp;bc.prototype.InterpolantFactoryMethodLinear=void 0;bc.prototype.InterpolantFactoryMethodSmooth=void 0;class om extends So{}om.prototype.ValueTypeName="vector";class am{constructor(e,t=-1,r,i=v0){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=Rs(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,i=1/(e.fps||1);for(let o=0,a=r.length;o!==a;++o)t.push(FY(r[o]).scale(i));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=r.length;s!==o;++s)t.push(So.toJSON(r[s]));return i}static CreateFromMorphTargetSequence(e,t,r,i){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],u=[];l.push((a+s-1)%s,a,(a+1)%s),u.push(0,1,0);const d=dU(l);l=wT(l,1,d),u=wT(u,1,d),!i&&l[0]===0&&(l.push(s),u.push(u[0])),o.push(new sm(".morphTargetInfluences["+t[a].name+"]",l,u).scale(1/r))}return new this(e,-1,o)}static findByName(e,t){let r=e;if(!Array.isArray(e)){const i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const i={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const u=e[a],d=u.name.match(s);if(d&&d.length>1){const f=d[1];let p=i[f];p||(i[f]=p=[]),p.push(u)}}const o=[];for(const a in i)o.push(this.CreateFromMorphTargetSequence(a,i[a],t,r));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(f,p,g,y,S){if(g.length!==0){const x=[],v=[];oA(g,x,v,y),x.length!==0&&S.push(new f(p,x,v))}},i=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const u=e.hierarchy||[];for(let f=0;f<u.length;f++){const p=u[f].keys;if(!(!p||p.length===0))if(p[0].morphTargets){const g={};let y;for(y=0;y<p.length;y++)if(p[y].morphTargets)for(let S=0;S<p[y].morphTargets.length;S++)g[p[y].morphTargets[S]]=-1;for(const S in g){const x=[],v=[];for(let w=0;w!==p[y].morphTargets.length;++w){const T=p[y];x.push(T.time),v.push(T.morphTarget===S?1:0)}i.push(new sm(".morphTargetInfluence["+S+"]",x,v))}l=g.length*o}else{const g=".bones["+t[f].name+"]";r(om,g+".position",p,"pos",i),r(Bd,g+".quaternion",p,"rot",i),r(om,g+".scale",p,"scl",i)}}return i.length===0?null:new this(s,l,i,a)}resetDuration(){const e=this.tracks;let t=0;for(let r=0,i=e.length;r!==i;++r){const s=this.tracks[r];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function UY(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return sm;case"vector":case"vector2":case"vector3":case"vector4":return om;case"color":return lA;case"quaternion":return Bd;case"bool":case"boolean":return Ic;case"string":return bc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function FY(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=UY(n.type);if(n.times===void 0){const t=[],r=[];oA(n.keys,t,r,"value"),n.times=t,n.values=r}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const xa={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class z0{constructor(e,t,r){const i=this;let s=!1,o=0,a=0,l;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(d){a++,s===!1&&i.onStart!==void 0&&i.onStart(d,o,a),s=!0},this.itemEnd=function(d){o++,i.onProgress!==void 0&&i.onProgress(d,o,a),o===a&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(d){i.onError!==void 0&&i.onError(d)},this.resolveURL=function(d){return l?l(d):d},this.setURLModifier=function(d){return l=d,this},this.addHandler=function(d,f){return u.push(d,f),this},this.removeHandler=function(d){const f=u.indexOf(d);return f!==-1&&u.splice(f,2),this},this.getHandler=function(d){for(let f=0,p=u.length;f<p;f+=2){const g=u[f],y=u[f+1];if(g.global&&(g.lastIndex=0),g.test(d))return y}return null}}}const gU=new z0;class Yi{constructor(e){this.manager=e!==void 0?e:gU,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const r=this;return new Promise(function(i,s){r.load(e,i,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Yi.DEFAULT_MATERIAL_NAME="__DEFAULT";const ca={};class VY extends Error{constructor(e,t){super(e),this.response=t}}class Ps extends Yi{constructor(e){super(e)}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=xa.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(ca[e]!==void 0){ca[e].push({onLoad:t,onProgress:r,onError:i});return}ca[e]=[],ca[e].push({onLoad:t,onProgress:r,onError:i});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;const d=ca[e],f=u.body.getReader(),p=u.headers.get("Content-Length")||u.headers.get("X-File-Size"),g=p?parseInt(p):0,y=g!==0;let S=0;const x=new ReadableStream({start(v){w();function w(){f.read().then(({done:T,value:R})=>{if(T)v.close();else{S+=R.byteLength;const U=new ProgressEvent("progress",{lengthComputable:y,loaded:S,total:g});for(let N=0,P=d.length;N<P;N++){const b=d[N];b.onProgress&&b.onProgress(U)}v.enqueue(R),w()}})}}});return new Response(x)}else throw new VY(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(l){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(d=>new DOMParser().parseFromString(d,a));case"json":return u.json();default:if(a===void 0)return u.text();{const f=/charset="?([^;"\s]*)"?/i.exec(a),p=f&&f[1]?f[1].toLowerCase():void 0,g=new TextDecoder(p);return u.arrayBuffer().then(y=>g.decode(y))}}}).then(u=>{xa.add(e,u);const d=ca[e];delete ca[e];for(let f=0,p=d.length;f<p;f++){const g=d[f];g.onLoad&&g.onLoad(u)}}).catch(u=>{const d=ca[e];if(d===void 0)throw this.manager.itemError(e),u;delete ca[e];for(let f=0,p=d.length;f<p;f++){const g=d[f];g.onError&&g.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class BY extends Yi{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new Ps(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t=[];for(let r=0;r<e.length;r++){const i=am.parse(e[r]);t.push(i)}return t}}class zY extends Yi{constructor(e){super(e)}load(e,t,r,i){const s=this,o=[],a=new C0,l=new Ps(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let u=0;function d(f){l.load(e[f],function(p){const g=s.parse(p,!0);o[f]={width:g.width,height:g.height,format:g.format,mipmaps:g.mipmaps},u+=1,u===6&&(g.mipmapCount===1&&(a.minFilter=kn),a.image=o,a.format=g.format,a.needsUpdate=!0,t&&t(a))},r,i)}if(Array.isArray(e))for(let f=0,p=e.length;f<p;++f)d(f);else l.load(e,function(f){const p=s.parse(f,!0);if(p.isCubemap){const g=p.mipmaps.length/p.mipmapCount;for(let y=0;y<g;y++){o[y]={mipmaps:[]};for(let S=0;S<p.mipmapCount;S++)o[y].mipmaps.push(p.mipmaps[y*p.mipmapCount+S]),o[y].format=p.format,o[y].width=p.width,o[y].height=p.height}a.image=o}else a.image.width=p.width,a.image.height=p.height,a.mipmaps=p.mipmaps;p.mipmapCount===1&&(a.minFilter=kn),a.format=p.format,a.needsUpdate=!0,t&&t(a)},r,i);return a}}class lm extends Yi{constructor(e){super(e)}load(e,t,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=xa.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=em("img");function l(){d(),xa.add(e,this),t&&t(this),s.manager.itemEnd(e)}function u(f){d(),i&&i(f),s.manager.itemError(e),s.manager.itemEnd(e)}function d(){a.removeEventListener("load",l,!1),a.removeEventListener("error",u,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class vU extends Yi{constructor(e){super(e)}load(e,t,r,i){const s=new Um;s.colorSpace=Nr;const o=new lm(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(u){o.load(e[u],function(d){s.images[u]=d,a++,a===6&&(s.needsUpdate=!0,t&&t(s))},void 0,i)}for(let u=0;u<e.length;++u)l(u);return s}}class uA extends Yi{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new Ul,a=new Ps(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){let u;try{u=s.parse(l)}catch(d){if(i!==void 0)i(d);else{console.error(d);return}}u.image!==void 0?o.image=u.image:u.data!==void 0&&(o.image.width=u.width,o.image.height=u.height,o.image.data=u.data),o.wrapS=u.wrapS!==void 0?u.wrapS:er,o.wrapT=u.wrapT!==void 0?u.wrapT:er,o.magFilter=u.magFilter!==void 0?u.magFilter:kn,o.minFilter=u.minFilter!==void 0?u.minFilter:kn,o.anisotropy=u.anisotropy!==void 0?u.anisotropy:1,u.colorSpace!==void 0?o.colorSpace=u.colorSpace:u.encoding!==void 0&&(o.encoding=u.encoding),u.flipY!==void 0&&(o.flipY=u.flipY),u.format!==void 0&&(o.format=u.format),u.type!==void 0&&(o.type=u.type),u.mipmaps!==void 0&&(o.mipmaps=u.mipmaps,o.minFilter=Yl),u.mipmapCount===1&&(o.minFilter=kn),u.generateMipmaps!==void 0&&(o.generateMipmaps=u.generateMipmaps),o.needsUpdate=!0,t&&t(o,u)},r,i),o}}class H0 extends Yi{constructor(e){super(e)}load(e,t,r,i){const s=new Un,o=new lm(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},r,i),s}}class su extends Ln{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Tt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class _U extends su{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Ln.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Tt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const ZE=new en,XP=new Q,$P=new Q;class cA{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ue(512,512),this.map=null,this.mapPass=null,this.matrix=new en,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Fm,this._frameExtents=new Ue(1,1),this._viewportCount=1,this._viewports=[new Vn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;XP.setFromMatrixPosition(e.matrixWorld),t.position.copy(XP),$P.setFromMatrixPosition(e.target.matrixWorld),t.lookAt($P),t.updateMatrixWorld(),ZE.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ZE),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(ZE)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class HY extends cA{constructor(){super(new Sr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,r=wd*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(r!==t.fov||i!==t.aspect||s!==t.far)&&(t.fov=r,t.aspect=i,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class yU extends su{constructor(e,t,r=0,i=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ln.DEFAULT_UP),this.updateMatrix(),this.target=new Ln,this.distance=r,this.angle=i,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new HY}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const YP=new en,bf=new Q,JE=new Q;class GY extends cA{constructor(){super(new Sr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ue(4,2),this._viewportCount=6,this._viewports=[new Vn(2,1,1,1),new Vn(0,1,1,1),new Vn(3,1,1,1),new Vn(1,1,1,1),new Vn(3,0,1,1),new Vn(1,0,1,1)],this._cubeDirections=[new Q(1,0,0),new Q(-1,0,0),new Q(0,0,1),new Q(0,0,-1),new Q(0,1,0),new Q(0,-1,0)],this._cubeUps=[new Q(0,1,0),new Q(0,1,0),new Q(0,1,0),new Q(0,1,0),new Q(0,0,1),new Q(0,0,-1)]}updateMatrices(e,t=0){const r=this.camera,i=this.matrix,s=e.distance||r.far;s!==r.far&&(r.far=s,r.updateProjectionMatrix()),bf.setFromMatrixPosition(e.matrixWorld),r.position.copy(bf),JE.copy(r.position),JE.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(JE),r.updateMatrixWorld(),i.makeTranslation(-bf.x,-bf.y,-bf.z),YP.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(YP)}}class xU extends su{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new GY}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class WY extends cA{constructor(){super(new wa(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class EU extends su{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ln.DEFAULT_UP),this.updateMatrix(),this.target=new Ln,this.shadow=new WY}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class wU extends su{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class SU extends su{constructor(e,t,r=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=r,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class TU{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Q)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const r=e.x,i=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*i),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*r),t.addScaledVector(o[4],1.092548*(r*i)),t.addScaledVector(o[5],1.092548*(i*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(r*s)),t.addScaledVector(o[8],.546274*(r*r-i*i)),t}getIrradianceAt(e,t){const r=e.x,i=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*i),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*r),t.addScaledVector(o[4],2*.429043*r*i),t.addScaledVector(o[5],2*.429043*i*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*r*s),t.addScaledVector(o[8],.429043*(r*r-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){const r=e.x,i=e.y,s=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*s,t[3]=.488603*r,t[4]=1.092548*r*i,t[5]=1.092548*i*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*r*s,t[8]=.546274*(r*r-i*i)}}class MU extends su{constructor(e=new TU,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class G0 extends Yi{constructor(e){super(e),this.textures={}}load(e,t,r,i){const s=this,o=new Ps(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t=this.textures;function r(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const i=G0.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new Tt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(i.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(i.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(i.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(i.depthFunc=e.depthFunc),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(i.blendSrc=e.blendSrc),e.blendDst!==void 0&&(i.blendDst=e.blendDst),e.blendEquation!==void 0&&(i.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(i.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(i.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(i.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&i.blendColor!==void 0&&i.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(i.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==void 0&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(i.uniforms[s]={},o.type){case"t":i.uniforms[s].value=r(o.value);break;case"c":i.uniforms[s].value=new Tt().setHex(o.value);break;case"v2":i.uniforms[s].value=new Ue().fromArray(o.value);break;case"v3":i.uniforms[s].value=new Q().fromArray(o.value);break;case"v4":i.uniforms[s].value=new Vn().fromArray(o.value);break;case"m3":i.uniforms[s].value=new fn().fromArray(o.value);break;case"m4":i.uniforms[s].value=new en().fromArray(o.value);break;default:i.uniforms[s].value=o.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)i.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(i.lights=e.lights),e.clipping!==void 0&&(i.clipping=e.clipping),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=r(e.map)),e.matcap!==void 0&&(i.matcap=r(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=r(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=r(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=r(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),i.normalScale=new Ue().fromArray(s)}return e.displacementMap!==void 0&&(i.displacementMap=r(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=r(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=r(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=r(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=r(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=r(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=r(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=r(e.envMap)),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=r(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=r(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=r(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=r(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=r(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new Ue().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=r(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=r(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=r(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=r(e.thicknessMap)),e.anisotropyMap!==void 0&&(i.anisotropyMap=r(e.anisotropyMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=r(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=r(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const t={ShadowMaterial:nU,SpriteMaterial:KM,RawShaderMaterial:rU,ShaderMaterial:ji,PointsMaterial:ZM,MeshPhysicalMaterial:iU,MeshStandardMaterial:sA,MeshPhongMaterial:sU,MeshToonMaterial:oU,MeshNormalMaterial:aU,MeshLambertMaterial:lU,MeshDepthMaterial:E0,MeshDistanceMaterial:YM,MeshBasicMaterial:Ba,MeshMatcapMaterial:uU,LineDashedMaterial:cU,LineBasicMaterial:$i,Material:ui};return new t[e]}}class ST{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let r=0,i=e.length;r<i;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class AU extends hn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class CU extends Yi{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new Ps(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t={},r={};function i(g,y){if(t[y]!==void 0)return t[y];const x=g.interleavedBuffers[y],v=s(g,x.buffer),w=Gh(x.type,v),T=new M0(w,x.stride);return T.uuid=x.uuid,t[y]=T,T}function s(g,y){if(r[y]!==void 0)return r[y];const x=g.arrayBuffers[y],v=new Uint32Array(x).buffer;return r[y]=v,v}const o=e.isInstancedBufferGeometry?new AU:new hn,a=e.data.index;if(a!==void 0){const g=Gh(a.type,a.array);o.setIndex(new zn(g,1))}const l=e.data.attributes;for(const g in l){const y=l[g];let S;if(y.isInterleavedBufferAttribute){const x=i(e.data,y.data);S=new yc(x,y.itemSize,y.offset,y.normalized)}else{const x=Gh(y.type,y.array),v=y.isInstancedBufferAttribute?Md:zn;S=new v(x,y.itemSize,y.normalized)}y.name!==void 0&&(S.name=y.name),y.usage!==void 0&&S.setUsage(y.usage),o.setAttribute(g,S)}const u=e.data.morphAttributes;if(u)for(const g in u){const y=u[g],S=[];for(let x=0,v=y.length;x<v;x++){const w=y[x];let T;if(w.isInterleavedBufferAttribute){const R=i(e.data,w.data);T=new yc(R,w.itemSize,w.offset,w.normalized)}else{const R=Gh(w.type,w.array);T=new zn(R,w.itemSize,w.normalized)}w.name!==void 0&&(T.name=w.name),S.push(T)}o.morphAttributes[g]=S}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const f=e.data.groups||e.data.drawcalls||e.data.offsets;if(f!==void 0)for(let g=0,y=f.length;g!==y;++g){const S=f[g];o.addGroup(S.start,S.count,S.materialIndex)}const p=e.data.boundingSphere;if(p!==void 0){const g=new Q;p.center!==void 0&&g.fromArray(p.center),o.boundingSphere=new bi(g,p.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class jY extends Yi{constructor(e){super(e)}load(e,t,r,i){const s=this,o=this.path===""?ST.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new Ps(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let u=null;try{u=JSON.parse(l)}catch(f){i!==void 0&&i(f),console.error("THREE:ObjectLoader: Can't parse "+e+".",f.message);return}const d=u.metadata;if(d===void 0||d.type===void 0||d.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(u,t)},r,i)}async loadAsync(e,t){const r=this,i=this.path===""?ST.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const s=new Ps(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,t),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await r.parseAsync(a)}parse(e,t){const r=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),o=this.parseImages(e.images,function(){t!==void 0&&t(u)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),u=this.parseObject(e.object,s,l,a,r),d=this.parseSkeletons(e.skeletons,u);if(this.bindSkeletons(u,d),t!==void 0){let f=!1;for(const p in o)if(o[p].data instanceof HTMLImageElement){f=!0;break}f===!1&&t(u)}return u}async parseAsync(e){const t=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,i,a,o,t),u=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,u),l}parseShapes(e){const t={};if(e!==void 0)for(let r=0,i=e.length;r<i;r++){const s=new oc().fromJSON(e[r]);t[s.uuid]=s}return t}parseSkeletons(e,t){const r={},i={};if(t.traverse(function(s){s.isBone&&(i[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new A0().fromJSON(e[s],i);r[a.uuid]=a}return r}parseGeometries(e,t){const r={};if(e!==void 0){const i=new CU;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=i.parse(l);break;default:l.type in qP?a=qP[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.userData!==void 0&&(a.userData=l.userData),r[l.uuid]=a}}return r}parseMaterials(e,t){const r={},i={};if(e!==void 0){const s=new G0;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){const l=e[o];r[l.uuid]===void 0&&(r[l.uuid]=s.parse(l)),i[l.uuid]=r[l.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let r=0;r<e.length;r++){const i=e[r],s=am.parse(i);t[s.uuid]=s}return t}parseImages(e,t){const r=this,i={};let s;function o(l){return r.manager.itemStart(l),s.load(l,function(){r.manager.itemEnd(l)},void 0,function(){r.manager.itemError(l),r.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const u=l,d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:r.resourcePath+u;return o(d)}else return l.data?{data:Gh(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new z0(t);s=new lm(l),s.setCrossOrigin(this.crossOrigin);for(let u=0,d=e.length;u<d;u++){const f=e[u],p=f.url;if(Array.isArray(p)){const g=[];for(let y=0,S=p.length;y<S;y++){const x=p[y],v=a(x);v!==null&&(v instanceof HTMLImageElement?g.push(v):g.push(new Ul(v.data,v.width,v.height)))}i[f.uuid]=new Ku(g)}else{const g=a(f.url);i[f.uuid]=new Ku(g)}}}return i}async parseImagesAsync(e){const t=this,r={};let i;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return await i.loadAsync(l)}else return o.data?{data:Gh(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){i=new lm(this.manager),i.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],u=l.url;if(Array.isArray(u)){const d=[];for(let f=0,p=u.length;f<p;f++){const g=u[f],y=await s(g);y!==null&&(y instanceof HTMLImageElement?d.push(y):d.push(new Ul(y.data,y.width,y.height)))}r[l.uuid]=new Ku(d)}else{const d=await s(l.url);r[l.uuid]=new Ku(d)}}}return r}parseTextures(e,t){function r(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const i={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=t[a.image],u=l.data;let d;Array.isArray(u)?(d=new Um,u.length===6&&(d.needsUpdate=!0)):(u&&u.data?d=new Ul:d=new Un,u&&(d.needsUpdate=!0)),d.source=l,d.uuid=a.uuid,a.name!==void 0&&(d.name=a.name),a.mapping!==void 0&&(d.mapping=r(a.mapping,qY)),a.channel!==void 0&&(d.channel=a.channel),a.offset!==void 0&&d.offset.fromArray(a.offset),a.repeat!==void 0&&d.repeat.fromArray(a.repeat),a.center!==void 0&&d.center.fromArray(a.center),a.rotation!==void 0&&(d.rotation=a.rotation),a.wrap!==void 0&&(d.wrapS=r(a.wrap[0],KP),d.wrapT=r(a.wrap[1],KP)),a.format!==void 0&&(d.format=a.format),a.internalFormat!==void 0&&(d.internalFormat=a.internalFormat),a.type!==void 0&&(d.type=a.type),a.colorSpace!==void 0&&(d.colorSpace=a.colorSpace),a.encoding!==void 0&&(d.encoding=a.encoding),a.minFilter!==void 0&&(d.minFilter=r(a.minFilter,QP)),a.magFilter!==void 0&&(d.magFilter=r(a.magFilter,QP)),a.anisotropy!==void 0&&(d.anisotropy=a.anisotropy),a.flipY!==void 0&&(d.flipY=a.flipY),a.generateMipmaps!==void 0&&(d.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(d.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(d.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(d.compareFunction=a.compareFunction),a.userData!==void 0&&(d.userData=a.userData),i[a.uuid]=d}return i}parseObject(e,t,r,i,s){let o;function a(p){return t[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",p),t[p]}function l(p){if(p!==void 0){if(Array.isArray(p)){const g=[];for(let y=0,S=p.length;y<S;y++){const x=p[y];r[x]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",x),g.push(r[x])}return g}return r[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",p),r[p]}}function u(p){return i[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",p),i[p]}let d,f;switch(e.type){case"Scene":o=new Td,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new Tt(e.background):o.background=u(e.background)),e.environment!==void 0&&(o.environment=u(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new T0(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new S0(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":o=new Sr(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new wa(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new wU(e.color,e.intensity);break;case"DirectionalLight":o=new EU(e.color,e.intensity);break;case"PointLight":o=new xU(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new SU(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new yU(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new _U(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new MU().fromJSON(e);break;case"SkinnedMesh":d=a(e.geometry),f=l(e.material),o=new zO(d,f),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":d=a(e.geometry),f=l(e.material),o=new sr(d,f);break;case"InstancedMesh":d=a(e.geometry),f=l(e.material);const p=e.count,g=e.instanceMatrix,y=e.instanceColor;o=new HO(d,f,p),o.instanceMatrix=new Md(new Float32Array(g.array),16),y!==void 0&&(o.instanceColor=new Md(new Float32Array(y.array),y.itemSize));break;case"BatchedMesh":d=a(e.geometry),f=l(e.material),o=new GO(e.maxGeometryCount,e.maxVertexCount,e.maxIndexCount,f),o.geometry=d,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(S=>{const x=new Gi;x.min.fromArray(S.boxMin),x.max.fromArray(S.boxMax);const v=new bi;return v.radius=S.sphereRadius,v.center.fromArray(S.sphereCenter),{boxInitialized:S.boxInitialized,box:x,sphereInitialized:S.sphereInitialized,sphere:v}}),o._maxGeometryCount=e.maxGeometryCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=u(e.matricesTexture.uuid);break;case"LOD":o=new BO;break;case"Line":o=new Kl(a(e.geometry),l(e.material));break;case"LineLoop":o=new WO(a(e.geometry),l(e.material));break;case"LineSegments":o=new Ko(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new jO(a(e.geometry),l(e.material));break;case"Sprite":o=new VO(l(e.material));break;case"Group":o=new qh;break;case"Bone":o=new QM;break;default:o=new Ln}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const p=e.children;for(let g=0;g<p.length;g++)o.add(this.parseObject(p[g],t,r,i,s))}if(e.animations!==void 0){const p=e.animations;for(let g=0;g<p.length;g++){const y=p[g];o.animations.push(s[y])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const p=e.levels;for(let g=0;g<p.length;g++){const y=p[g],S=o.getObjectByProperty("uuid",y.object);S!==void 0&&o.addLevel(S,y.distance,y.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(r){if(r.isSkinnedMesh===!0&&r.skeleton!==void 0){const i=t[r.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",r.skeleton):r.bind(i,r.bindMatrix)}})}}const qY={UVMapping:Xl,CubeReflectionMapping:Yo,CubeRefractionMapping:$l,EquirectangularReflectionMapping:xd,EquirectangularRefractionMapping:Wp,CubeUVReflectionMapping:Ud},KP={RepeatWrapping:jp,ClampToEdgeWrapping:er,MirroredRepeatWrapping:qp},QP={NearestFilter:Er,NearestMipmapNearestFilter:Ty,NearestMipmapLinearFilter:up,LinearFilter:kn,LinearMipmapNearestFilter:IM,LinearMipmapLinearFilter:Yl};class XY extends Yi{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=xa.get(e);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(u=>{t&&t(u),s.manager.itemEnd(e)}).catch(u=>{i&&i(u)});return}return setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o}const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader;const l=fetch(e,a).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(u){return xa.add(e,u),t&&t(u),s.manager.itemEnd(e),u}).catch(function(u){i&&i(u),xa.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});xa.add(e,l),s.manager.itemStart(e)}}let Bv;class hA{static getContext(){return Bv===void 0&&(Bv=new(window.AudioContext||window.webkitAudioContext)),Bv}static setContext(e){Bv=e}}class $Y extends Yi{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new Ps(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{const u=l.slice(0);hA.getContext().decodeAudioData(u,function(f){t(f)}).catch(a)}catch(u){a(u)}},r,i);function a(l){i?i(l):console.error(l),s.manager.itemError(e)}}}const ZP=new en,JP=new en,Iu=new en;class YY{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Sr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Sr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Iu.copy(e.projectionMatrix);const i=t.eyeSep/2,s=i*t.near/t.focus,o=t.near*Math.tan(ic*t.fov*.5)/t.zoom;let a,l;JP.elements[12]=-i,ZP.elements[12]=i,a=-o*t.aspect+s,l=o*t.aspect+s,Iu.elements[0]=2*t.near/(l-a),Iu.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(Iu),a=-o*t.aspect-s,l=o*t.aspect-s,Iu.elements[0]=2*t.near/(l-a),Iu.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(Iu)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(JP),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(ZP)}}class dA{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=e2(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=e2();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function e2(){return(typeof performance>"u"?Date:performance).now()}const bu=new Q,t2=new Ii,KY=new Q,Ru=new Q;class QY extends Ln{constructor(){super(),this.type="AudioListener",this.context=hA.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new dA}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(bu,t2,KY),Ru.set(0,0,-1).applyQuaternion(t2),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(bu.x,i),t.positionY.linearRampToValueAtTime(bu.y,i),t.positionZ.linearRampToValueAtTime(bu.z,i),t.forwardX.linearRampToValueAtTime(Ru.x,i),t.forwardY.linearRampToValueAtTime(Ru.y,i),t.forwardZ.linearRampToValueAtTime(Ru.z,i),t.upX.linearRampToValueAtTime(r.x,i),t.upY.linearRampToValueAtTime(r.y,i),t.upZ.linearRampToValueAtTime(r.z,i)}else t.setPosition(bu.x,bu.y,bu.z),t.setOrientation(Ru.x,Ru.y,Ru.z,r.x,r.y,r.z)}}class IU extends Ln{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Pu=new Q,n2=new Ii,ZY=new Q,Nu=new Q;class JY extends IU{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Pu,n2,ZY),Nu.set(0,0,1).applyQuaternion(n2);const t=this.panner;if(t.positionX){const r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Pu.x,r),t.positionY.linearRampToValueAtTime(Pu.y,r),t.positionZ.linearRampToValueAtTime(Pu.z,r),t.orientationX.linearRampToValueAtTime(Nu.x,r),t.orientationY.linearRampToValueAtTime(Nu.y,r),t.orientationZ.linearRampToValueAtTime(Nu.z,r)}else t.setPosition(Pu.x,Pu.y,Pu.z),t.setOrientation(Nu.x,Nu.y,Nu.z)}}class eK{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let r=0;r<t.length;r++)e+=t[r];return e/t.length}}class bU{constructor(e,t,r){this.binding=e,this.valueSize=r;let i,s,o;switch(t){case"quaternion":i=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const r=this.buffer,i=this.valueSize,s=e*i+i;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==i;++a)r[s+a]=r[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(r,s,0,a,i)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,r=this.buffer,i=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=t*this._origIndex;this._mixBufferRegion(r,i,l,1-s,t)}o>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*t,1,t);for(let l=t,u=t+t;l!==u;++l)if(r[l]!==r[l+t]){a.setValue(r,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(t,i);for(let s=r,o=i;s!==o;++s)t[s]=t[i+s%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,i,s){if(i>=.5)for(let o=0;o!==s;++o)e[t+o]=e[r+o]}_slerp(e,t,r,i){Ii.slerpFlat(e,t,e,t,e,r,i)}_slerpAdditive(e,t,r,i,s){const o=this._workIndex*s;Ii.multiplyQuaternionsFlat(e,o,e,t,e,r),Ii.slerpFlat(e,t,e,t,e,o,i)}_lerp(e,t,r,i,s){const o=1-i;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[r+a]*i}}_lerpAdditive(e,t,r,i,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[r+o]*i}}}const fA="\\[\\]\\.:\\/",tK=new RegExp("["+fA+"]","g"),pA="[^"+fA+"]",nK="[^"+fA.replace("\\.","")+"]",rK=/((?:WC+[\/:])*)/.source.replace("WC",pA),iK=/(WCOD+)?/.source.replace("WCOD",nK),sK=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",pA),oK=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",pA),aK=new RegExp("^"+rK+iK+sK+oK+"$"),lK=["material","materials","bones","map"];class uK{constructor(e,t,r){const i=r||In.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=r.length;i!==s;++i)r[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}class In{constructor(e,t,r){this.path=t,this.parsedPath=r||In.parseTrackName(t),this.node=In.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new In.Composite(e,t,r):new In(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(tK,"")}static parseTrackName(e){const t=aK.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=r.nodeName.substring(i+1);lK.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){const r=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const l=r(a.children);if(l)return l}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,r=t.objectName,i=t.propertyName;let s=t.propertyIndex;if(e||(e=In.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let u=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let d=0;d<e.length;d++)if(e[d].name===u){u=d;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(u!==void 0){if(e[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}const o=e[i];if(o===void 0){const u=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+i+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}In.Composite=uK;In.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};In.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};In.prototype.GetterByBindingType=[In.prototype._getValue_direct,In.prototype._getValue_array,In.prototype._getValue_arrayElement,In.prototype._getValue_toArray];In.prototype.SetterByBindingTypeAndVersioning=[[In.prototype._setValue_direct,In.prototype._setValue_direct_setNeedsUpdate,In.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[In.prototype._setValue_array,In.prototype._setValue_array_setNeedsUpdate,In.prototype._setValue_array_setMatrixWorldNeedsUpdate],[In.prototype._setValue_arrayElement,In.prototype._setValue_arrayElement_setNeedsUpdate,In.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[In.prototype._setValue_fromArray,In.prototype._setValue_fromArray_setNeedsUpdate,In.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class cK{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Rs(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let r=0,i=arguments.length;r!==i;++r)e[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,r=this._paths,i=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,u=this.nCachedObjects_;for(let d=0,f=arguments.length;d!==f;++d){const p=arguments[d],g=p.uuid;let y=t[g];if(y===void 0){y=l++,t[g]=y,e.push(p);for(let S=0,x=o;S!==x;++S)s[S].push(new In(p,r[S],i[S]))}else if(y<u){a=e[y];const S=--u,x=e[S];t[x.uuid]=y,e[y]=x,t[g]=S,e[S]=p;for(let v=0,w=o;v!==w;++v){const T=s[v],R=T[S];let U=T[y];T[y]=R,U===void 0&&(U=new In(p,r[v],i[v])),T[S]=U}}else e[y]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=u}remove(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],u=l.uuid,d=t[u];if(d!==void 0&&d>=s){const f=s++,p=e[f];t[p.uuid]=d,e[d]=p,t[u]=f,e[f]=l;for(let g=0,y=i;g!==y;++g){const S=r[g],x=S[f],v=S[d];S[d]=x,S[f]=v}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const u=arguments[a],d=u.uuid,f=t[d];if(f!==void 0)if(delete t[d],f<s){const p=--s,g=e[p],y=--o,S=e[y];t[g.uuid]=f,e[f]=g,t[S.uuid]=p,e[p]=S,e.pop();for(let x=0,v=i;x!==v;++x){const w=r[x],T=w[p],R=w[y];w[f]=T,w[p]=R,w.pop()}}else{const p=--o,g=e[p];p>0&&(t[g.uuid]=f),e[f]=g,e.pop();for(let y=0,S=i;y!==S;++y){const x=r[y];x[f]=x[p],x.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const r=this._bindingsIndicesByPath;let i=r[e];const s=this._bindings;if(i!==void 0)return s[i];const o=this._paths,a=this._parsedPaths,l=this._objects,u=l.length,d=this.nCachedObjects_,f=new Array(u);i=s.length,r[e]=i,o.push(e),a.push(t),s.push(f);for(let p=d,g=l.length;p!==g;++p){const y=l[p];f[p]=new In(y,e,t)}return f}unsubscribe_(e){const t=this._bindingsIndicesByPath,r=t[e];if(r!==void 0){const i=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],u=e[a];t[u]=r,o[r]=l,o.pop(),s[r]=s[a],s.pop(),i[r]=i[a],i.pop()}}}class RU{constructor(e,t,r=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=i;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:$u,endingEnd:$u};for(let u=0;u!==o;++u){const d=s[u].createInterpolant(null);a[u]=d,d.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=uO,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){const i=this._clip.duration,s=e._clip.duration,o=s/i,a=i/s;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){const i=this._mixer,s=i.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,u=a.sampleValues;return l[0]=s,l[1]=s+r,u[0]=e/o,u[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,i){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*r;l<0||r===0?t=0:(this._startTime=null,t=r*l)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case FM:for(let d=0,f=l.length;d!==f;++d)l[d].evaluate(o),u[d].accumulateAdditive(a);break;case v0:default:for(let d=0,f=l.length;d!==f;++d)l[d].evaluate(o),u[d].accumulate(i,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const r=this._weightInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const r=this._timeScaleInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,r=this.loop;let i=this.time+e,s=this._loopCount;const o=r===cO;if(e===0)return s===-1?i:o&&(s&1)===1?t-i:i;if(r===lO){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),i>=t||i<0){const a=Math.floor(i/t);i-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const u=e<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=i;if(o&&(s&1)===1)return t-i}return i}_setEndings(e,t,r){const i=this._interpolantSettings;r?(i.endingStart=Yu,i.endingEnd=Yu):(e?i.endingStart=this.zeroSlopeAtStart?Yu:$u:i.endingStart=Yp,t?i.endingEnd=this.zeroSlopeAtEnd?Yu:$u:i.endingEnd=Yp)}_scheduleFading(e,t,r){const i=this._mixer,s=i.time;let o=this._weightInterpolant;o===null&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=r,this}}const hK=new Float32Array(1);class dK extends Va{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const r=e._localRoot||this._root,i=e._clip.tracks,s=i.length,o=e._propertyBindings,a=e._interpolants,l=r.uuid,u=this._bindingsByRootAndName;let d=u[l];d===void 0&&(d={},u[l]=d);for(let f=0;f!==s;++f){const p=i[f],g=p.name;let y=d[g];if(y!==void 0)++y.referenceCount,o[f]=y;else{if(y=o[f],y!==void 0){y._cacheIndex===null&&(++y.referenceCount,this._addInactiveBinding(y,l,g));continue}const S=t&&t._propertyBindings[f].binding.parsedPath;y=new bU(In.create(r,g,S),p.ValueTypeName,p.getValueSize()),++y.referenceCount,this._addInactiveBinding(y,l,g),o[f]=y}a[f].resultBuffer=y.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const r=(e._localRoot||this._root).uuid,i=e._clip.uuid,s=this._actionsByClip[i];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,i,r)}const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){const i=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=i.length,i.push(e),o.actionByRoot[r]=e}_removeInactiveAction(e){const t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i,t[i]=r,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,u=l[l.length-1],d=e._byClipCacheIndex;u._byClipCacheIndex=d,l[d]=u,l.pop(),e._byClipCacheIndex=null;const f=a.actionByRoot,p=(e._localRoot||this._root).uuid;delete f[p],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackAction(e){const t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_addInactiveBinding(e,t,r){const i=this._bindingsByRootAndName,s=this._bindings;let o=i[t];o===void 0&&(o={},i[t]=o),o[r]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,r=e.binding,i=r.rootNode.uuid,s=r.path,o=this._bindingsByRootAndName,a=o[i],l=t[t.length-1],u=e._cacheIndex;l._cacheIndex=u,t[u]=l,t.pop(),delete a[s],Object.keys(a).length===0&&delete o[i]}_lendBinding(e){const t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackBinding(e){const t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let r=e[t];return r===void 0&&(r=new aA(new Float32Array(2),new Float32Array(2),1,hK),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){const t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=t[i];e.__cacheIndex=i,t[i]=e,s.__cacheIndex=r,t[r]=s}clipAction(e,t,r){const i=t||this._root,s=i.uuid;let o=typeof e=="string"?am.findByName(i,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let u=null;if(r===void 0&&(o!==null?r=o.blendMode:r=v0),l!==void 0){const f=l.actionByRoot[s];if(f!==void 0&&f.blendMode===r)return f;u=l.knownActions[0],o===null&&(o=u._clip)}if(o===null)return null;const d=new RU(this,o,t,r);return this._bindAction(d,u),this._addInactiveAction(d,a,s),d}existingAction(e,t){const r=t||this._root,i=r.uuid,s=typeof e=="string"?am.findByName(r,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;const t=this._actions,r=this._nActiveActions,i=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let u=0;u!==r;++u)t[u]._update(i,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let u=0;u!==l;++u)a[u].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,r=e.uuid,i=this._actionsByClip,s=i[r];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const u=o[a];this._deactivateAction(u);const d=u._cacheIndex,f=t[t.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,f._cacheIndex=d,t[d]=f,t.pop(),this._removeInactiveBindingsForAction(u)}delete i[r]}}uncacheRoot(e){const t=e.uuid,r=this._actionsByClip;for(const o in r){const a=r[o].actionByRoot,l=a[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const i=this._bindingsByRootAndName,s=i[t];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}}class mA{constructor(e){this.value=e}clone(){return new mA(this.value.clone===void 0?this.value:this.value.clone())}}let fK=0;class pK extends Va{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:fK++}),this.name="",this.usage=Jp,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let r=0,i=t.length;r<i;r++){const s=Array.isArray(t[r])?t[r]:[t[r]];for(let o=0;o<s.length;o++)this.uniforms.push(s[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class mK extends M0{constructor(e,t,r=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class gK{constructor(e,t,r,i,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=r,this.elementSize=i,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class gA{constructor(e,t,r=0,i=1/0){this.ray=new Ac(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new sc,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,r=[]){return TT(e,this,r,t),r.sort(r2),r}intersectObjects(e,t=!0,r=[]){for(let i=0,s=e.length;i<s;i++)TT(e[i],this,r,t);return r.sort(r2),r}}function r2(n,e){return n.distance-e.distance}function TT(n,e,t,r){if(n.layers.test(e.layers)&&n.raycast(e,t),r===!0){const i=n.children;for(let s=0,o=i.length;s<o;s++)TT(i[s],e,t,!0)}}class MT{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(mr(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class vK{constructor(e=1,t=0,r=0){return this.radius=e,this.theta=t,this.y=r,this}set(e,t,r){return this.radius=e,this.theta=t,this.y=r,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}clone(){return new this.constructor().copy(this)}}const i2=new Ue;class _K{constructor(e=new Ue(1/0,1/0),t=new Ue(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=i2.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,i2).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const s2=new Q,zv=new Q;class yK{constructor(e=new Q,t=new Q){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){s2.subVectors(e,this.start),zv.subVectors(this.end,this.start);const r=zv.dot(zv);let s=zv.dot(s2)/r;return t&&(s=mr(s,0,1)),s}closestPointToPoint(e,t,r){const i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const o2=new Q;class xK extends Ln{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const r=new hn,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const u=o/l*Math.PI*2,d=a/l*Math.PI*2;i.push(Math.cos(u),Math.sin(u),1,Math.cos(d),Math.sin(d),1)}r.setAttribute("position",new Lt(i,3));const s=new $i({fog:!1,toneMapped:!1});this.cone=new Ko(r,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),o2.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(o2),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const il=new Q,Hv=new en,ew=new en;class EK extends Ko{constructor(e){const t=PU(e),r=new hn,i=[],s=[],o=new Tt(0,0,1),a=new Tt(0,1,0);for(let u=0;u<t.length;u++){const d=t[u];d.parent&&d.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}r.setAttribute("position",new Lt(i,3)),r.setAttribute("color",new Lt(s,3));const l=new $i({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(r,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,r=this.geometry,i=r.getAttribute("position");ew.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(Hv.multiplyMatrices(ew,a.matrixWorld),il.setFromMatrixPosition(Hv),i.setXYZ(o,il.x,il.y,il.z),Hv.multiplyMatrices(ew,a.parent.matrixWorld),il.setFromMatrixPosition(Hv),i.setXYZ(o+1,il.x,il.y,il.z),o+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function PU(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,PU(n.children[t]));return e}class wK extends sr{constructor(e,t,r){const i=new Hm(t,4,2),s=new Ba({wireframe:!0,fog:!1,toneMapped:!1});super(i,s),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const SK=new Q,a2=new Tt,l2=new Tt;class TK extends Ln{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="HemisphereLightHelper";const i=new zm(t);i.rotateY(Math.PI*.5),this.material=new Ba({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=i.getAttribute("position"),o=new Float32Array(s.count*3);i.setAttribute("color",new zn(o,3)),this.add(new sr(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");a2.copy(this.light.color),l2.copy(this.light.groundColor);for(let r=0,i=t.count;r<i;r++){const s=r<i/2?a2:l2;t.setXYZ(r,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(SK.setFromMatrixPosition(this.light.matrixWorld).negate())}}class MK extends Ko{constructor(e=10,t=10,r=4473924,i=8947848){r=new Tt(r),i=new Tt(i);const s=t/2,o=e/t,a=e/2,l=[],u=[];for(let p=0,g=0,y=-a;p<=t;p++,y+=o){l.push(-a,0,y,a,0,y),l.push(y,0,-a,y,0,a);const S=p===s?r:i;S.toArray(u,g),g+=3,S.toArray(u,g),g+=3,S.toArray(u,g),g+=3,S.toArray(u,g),g+=3}const d=new hn;d.setAttribute("position",new Lt(l,3)),d.setAttribute("color",new Lt(u,3));const f=new $i({vertexColors:!0,toneMapped:!1});super(d,f),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class AK extends Ko{constructor(e=10,t=16,r=8,i=64,s=4473924,o=8947848){s=new Tt(s),o=new Tt(o);const a=[],l=[];if(t>1)for(let f=0;f<t;f++){const p=f/t*(Math.PI*2),g=Math.sin(p)*e,y=Math.cos(p)*e;a.push(0,0,0),a.push(g,0,y);const S=f&1?s:o;l.push(S.r,S.g,S.b),l.push(S.r,S.g,S.b)}for(let f=0;f<r;f++){const p=f&1?s:o,g=e-e/r*f;for(let y=0;y<i;y++){let S=y/i*(Math.PI*2),x=Math.sin(S)*g,v=Math.cos(S)*g;a.push(x,0,v),l.push(p.r,p.g,p.b),S=(y+1)/i*(Math.PI*2),x=Math.sin(S)*g,v=Math.cos(S)*g,a.push(x,0,v),l.push(p.r,p.g,p.b)}}const u=new hn;u.setAttribute("position",new Lt(a,3)),u.setAttribute("color",new Lt(l,3));const d=new $i({vertexColors:!0,toneMapped:!1});super(u,d),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const u2=new Q,Gv=new Q,c2=new Q;class CK extends Ln{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new hn;i.setAttribute("position",new Lt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new $i({fog:!1,toneMapped:!1});this.lightPlane=new Kl(i,s),this.add(this.lightPlane),i=new hn,i.setAttribute("position",new Lt([0,0,0,0,0,1],3)),this.targetLine=new Kl(i,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),u2.setFromMatrixPosition(this.light.matrixWorld),Gv.setFromMatrixPosition(this.light.target.matrixWorld),c2.subVectors(Gv,u2),this.lightPlane.lookAt(Gv),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Gv),this.targetLine.scale.z=c2.length()}}const Wv=new Q,dr=new Om;class IK extends Ko{constructor(e){const t=new hn,r=new $i({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(y,S){l(y),l(S)}function l(y){i.push(0,0,0),s.push(0,0,0),o[y]===void 0&&(o[y]=[]),o[y].push(i.length/3-1)}t.setAttribute("position",new Lt(i,3)),t.setAttribute("color",new Lt(s,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const u=new Tt(16755200),d=new Tt(16711680),f=new Tt(43775),p=new Tt(16777215),g=new Tt(3355443);this.setColors(u,d,f,p,g)}setColors(e,t,r,i,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,r.r,r.g,r.b),a.setXYZ(33,r.r,r.g,r.b),a.setXYZ(34,r.r,r.g,r.b),a.setXYZ(35,r.r,r.g,r.b),a.setXYZ(36,r.r,r.g,r.b),a.setXYZ(37,r.r,r.g,r.b),a.setXYZ(38,i.r,i.g,i.b),a.setXYZ(39,i.r,i.g,i.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,r=1,i=1;dr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),yr("c",t,e,dr,0,0,-1),yr("t",t,e,dr,0,0,1),yr("n1",t,e,dr,-r,-i,-1),yr("n2",t,e,dr,r,-i,-1),yr("n3",t,e,dr,-r,i,-1),yr("n4",t,e,dr,r,i,-1),yr("f1",t,e,dr,-r,-i,1),yr("f2",t,e,dr,r,-i,1),yr("f3",t,e,dr,-r,i,1),yr("f4",t,e,dr,r,i,1),yr("u1",t,e,dr,r*.7,i*1.1,-1),yr("u2",t,e,dr,-r*.7,i*1.1,-1),yr("u3",t,e,dr,0,i*2,-1),yr("cf1",t,e,dr,-r,0,1),yr("cf2",t,e,dr,r,0,1),yr("cf3",t,e,dr,0,-i,1),yr("cf4",t,e,dr,0,i,1),yr("cn1",t,e,dr,-r,0,-1),yr("cn2",t,e,dr,r,0,-1),yr("cn3",t,e,dr,0,-i,-1),yr("cn4",t,e,dr,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function yr(n,e,t,r,i,s,o){Wv.set(i,s,o).unproject(r);const a=e[n];if(a!==void 0){const l=t.getAttribute("position");for(let u=0,d=a.length;u<d;u++)l.setXYZ(a[u],Wv.x,Wv.y,Wv.z)}}const jv=new Gi;class bK extends Ko{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(8*3),s=new hn;s.setIndex(new zn(r,1)),s.setAttribute("position",new zn(i,3)),super(s,new $i({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&jv.setFromObject(this.object),jv.isEmpty())return;const t=jv.min,r=jv.max,i=this.geometry.attributes.position,s=i.array;s[0]=r.x,s[1]=r.y,s[2]=r.z,s[3]=t.x,s[4]=r.y,s[5]=r.z,s[6]=t.x,s[7]=t.y,s[8]=r.z,s[9]=r.x,s[10]=t.y,s[11]=r.z,s[12]=r.x,s[13]=r.y,s[14]=t.z,s[15]=t.x,s[16]=r.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=r.x,s[22]=t.y,s[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class RK extends Ko{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new hn;s.setIndex(new zn(r,1)),s.setAttribute("position",new Lt(i,3)),super(s,new $i({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class PK extends Kl{constructor(e,t=1,r=16776960){const i=r,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new hn;o.setAttribute("position",new Lt(s,3)),o.computeBoundingSphere(),super(o,new $i({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new hn;l.setAttribute("position",new Lt(a,3)),l.computeBoundingSphere(),this.add(new sr(l,new Ba({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const h2=new Q;let qv,tw;class NK extends Ln{constructor(e=new Q(0,0,1),t=new Q(0,0,0),r=1,i=16776960,s=r*.2,o=s*.2){super(),this.type="ArrowHelper",qv===void 0&&(qv=new hn,qv.setAttribute("position",new Lt([0,0,0,0,1,0],3)),tw=new Vd(0,.5,1,5,1),tw.translate(0,-.5,0)),this.position.copy(t),this.line=new Kl(qv,new $i({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new sr(tw,new Ba({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{h2.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(h2,t)}}setLength(e,t=e*.2,r=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class LK extends Ko{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new hn;i.setAttribute("position",new Lt(t,3)),i.setAttribute("color",new Lt(r,3));const s=new $i({vertexColors:!0,toneMapped:!1});super(i,s),this.type="AxesHelper"}setColors(e,t,r){const i=new Tt,s=this.geometry.attributes.color.array;return i.set(e),i.toArray(s,0),i.toArray(s,3),i.set(t),i.toArray(s,6),i.toArray(s,9),i.set(r),i.toArray(s,12),i.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class DK{constructor(){this.type="ShapePath",this.color=new Tt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new tm,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){return this.currentPath.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,s,o){return this.currentPath.bezierCurveTo(e,t,r,i,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(v){const w=[];for(let T=0,R=v.length;T<R;T++){const U=v[T],N=new oc;N.curves=U.curves,w.push(N)}return w}function r(v,w){const T=w.length;let R=!1;for(let U=T-1,N=0;N<T;U=N++){let P=w[U],b=w[N],M=b.x-P.x,A=b.y-P.y;if(Math.abs(A)>Number.EPSILON){if(A<0&&(P=w[N],M=-M,b=w[U],A=-A),v.y<P.y||v.y>b.y)continue;if(v.y===P.y){if(v.x===P.x)return!0}else{const L=A*(v.x-P.x)-M*(v.y-P.y);if(L===0)return!0;if(L<0)continue;R=!R}}else{if(v.y!==P.y)continue;if(b.x<=v.x&&v.x<=P.x||P.x<=v.x&&v.x<=b.x)return!0}}return R}const i=Xo.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const u=[];if(s.length===1)return a=s[0],l=new oc,l.curves=a.curves,u.push(l),u;let d=!i(s[0].getPoints());d=e?!d:d;const f=[],p=[];let g=[],y=0,S;p[y]=void 0,g[y]=[];for(let v=0,w=s.length;v<w;v++)a=s[v],S=a.getPoints(),o=i(S),o=e?!o:o,o?(!d&&p[y]&&y++,p[y]={s:new oc,p:S},p[y].s.curves=a.curves,d&&y++,g[y]=[]):g[y].push({h:a,p:S[0]});if(!p[0])return t(s);if(p.length>1){let v=!1,w=0;for(let T=0,R=p.length;T<R;T++)f[T]=[];for(let T=0,R=p.length;T<R;T++){const U=g[T];for(let N=0;N<U.length;N++){const P=U[N];let b=!0;for(let M=0;M<p.length;M++)r(P.p,p[M].p)&&(T!==M&&w++,b?(b=!1,f[M].push(P)):v=!0);b&&f[T].push(P)}}w>0&&v===!1&&(g=f)}let x;for(let v=0,w=p.length;v<w;v++){l=p[v].s,u.push(l),x=g[v];for(let T=0,R=x.length;T<R;T++)l.holes.push(x[T].h)}return u}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Nm}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Nm);const kK=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:CM,AddEquation:ml,AddOperation:Kk,AdditiveAnimationBlendMode:FM,AdditiveBlending:OS,AgXToneMapping:tO,AlphaFormat:rO,AlwaysCompare:xO,AlwaysDepth:Gk,AlwaysStencilFunc:pT,AmbientLight:wU,AnimationAction:RU,AnimationClip:am,AnimationLoader:BY,AnimationMixer:dK,AnimationObjectGroup:cK,AnimationUtils:OY,ArcCurve:qO,ArrayCamera:OO,ArrowHelper:NK,AttachedBindMode:zS,Audio:IU,AudioAnalyser:eK,AudioContext:hA,AudioListener:QY,AudioLoader:$Y,AxesHelper:LK,BackSide:Hi,BasicDepthPacking:hO,BasicShadowMap:Mk,BatchedMesh:GO,Bone:QM,BooleanKeyframeTrack:Ic,Box2:_K,Box3:Gi,Box3Helper:RK,BoxGeometry:Cc,BoxHelper:bK,BufferAttribute:zn,BufferGeometry:hn,BufferGeometryLoader:CU,ByteType:bM,Cache:xa,Camera:Om,CameraHelper:IK,CanvasTexture:oY,CapsuleGeometry:b0,CatmullRomCurve3:XO,CineonToneMapping:Jk,CircleGeometry:R0,ClampToEdgeWrapping:er,Clock:dA,Color:Tt,ColorKeyframeTrack:lA,ColorManagement:Fn,CompressedArrayTexture:iY,CompressedCubeTexture:sY,CompressedTexture:C0,CompressedTextureLoader:zY,ConeGeometry:P0,ConstantAlphaFactor:Bk,ConstantColorFactor:Fk,CubeCamera:IO,CubeReflectionMapping:Yo,CubeRefractionMapping:$l,CubeTexture:Um,CubeTextureLoader:vU,CubeUVReflectionMapping:Ud,CubicBezierCurve:eA,CubicBezierCurve3:$O,CubicInterpolant:fU,CullFaceBack:kS,CullFaceFront:Tk,CullFaceFrontBack:KW,CullFaceNone:Sk,Curve:wo,CurvePath:KO,CustomBlending:Ak,CustomToneMapping:eO,CylinderGeometry:Vd,Cylindrical:vK,Data3DTexture:GM,DataArrayTexture:y0,DataTexture:Ul,DataTextureLoader:uA,DataUtils:Qu,DecrementStencilOp:a9,DecrementWrapStencilOp:u9,DefaultLoadingManager:gU,DepthFormat:kl,DepthStencilFormat:_c,DepthTexture:$M,DetachedBindMode:nO,DirectionalLight:EU,DirectionalLightHelper:CK,DiscreteInterpolant:pU,DisplayP3ColorSpace:_0,DodecahedronGeometry:N0,DoubleSide:mo,DstAlphaFactor:Lk,DstColorFactor:kk,DynamicCopyUsage:T9,DynamicDrawUsage:_9,DynamicReadUsage:E9,EdgesGeometry:QO,EllipseCurve:I0,EqualCompare:gO,EqualDepth:jk,EqualStencilFunc:f9,EquirectangularReflectionMapping:xd,EquirectangularRefractionMapping:Wp,Euler:km,EventDispatcher:Va,ExtrudeGeometry:D0,FileLoader:Ps,Float16BufferAttribute:uj,Float32BufferAttribute:Lt,Float64BufferAttribute:cj,FloatType:Ur,Fog:T0,FogExp2:S0,FramebufferTexture:rY,FrontSide:Na,Frustum:Fm,GLBufferAttribute:gK,GLSL1:A9,GLSL3:mT,GreaterCompare:vO,GreaterDepth:Xk,GreaterEqualCompare:yO,GreaterEqualDepth:qk,GreaterEqualStencilFunc:v9,GreaterStencilFunc:m9,GridHelper:MK,Group:qh,HalfFloatType:ei,HemisphereLight:_U,HemisphereLightHelper:TK,IcosahedronGeometry:Bm,ImageBitmapLoader:XY,ImageLoader:lm,ImageUtils:HM,IncrementStencilOp:o9,IncrementWrapStencilOp:l9,InstancedBufferAttribute:Md,InstancedBufferGeometry:AU,InstancedInterleavedBuffer:mK,InstancedMesh:HO,Int16BufferAttribute:aj,Int32BufferAttribute:lj,Int8BufferAttribute:ij,IntType:g0,InterleavedBuffer:M0,InterleavedBufferAttribute:yc,Interpolant:Gm,InterpolateDiscrete:Xp,InterpolateLinear:$p,InterpolateSmooth:A_,InvertStencilOp:c9,KeepStencilOp:zu,KeyframeTrack:So,LOD:BO,LatheGeometry:Vm,Layers:sc,LessCompare:mO,LessDepth:Wk,LessEqualCompare:BM,LessEqualDepth:Gp,LessEqualStencilFunc:p9,LessStencilFunc:d9,Light:su,LightProbe:MU,Line:Kl,Line3:yK,LineBasicMaterial:$i,LineCurve:tA,LineCurve3:YO,LineDashedMaterial:cU,LineLoop:WO,LineSegments:Ko,LinearDisplayP3ColorSpace:Dm,LinearEncoding:VM,LinearFilter:kn,LinearInterpolant:aA,LinearMipMapLinearFilter:HS,LinearMipMapNearestFilter:e9,LinearMipmapLinearFilter:Yl,LinearMipmapNearestFilter:IM,LinearSRGBColorSpace:Ls,LinearToneMapping:Qk,LinearTransfer:Kp,Loader:Yi,LoaderUtils:ST,LoadingManager:z0,LoopOnce:lO,LoopPingPong:cO,LoopRepeat:uO,LuminanceAlphaFormat:sO,LuminanceFormat:iO,MOUSE:Vu,Material:ui,MaterialLoader:G0,MathUtils:EO,Matrix3:fn,Matrix4:en,MaxEquation:BS,Mesh:sr,MeshBasicMaterial:Ba,MeshDepthMaterial:E0,MeshDistanceMaterial:YM,MeshLambertMaterial:lU,MeshMatcapMaterial:uU,MeshNormalMaterial:aU,MeshPhongMaterial:sU,MeshPhysicalMaterial:iU,MeshStandardMaterial:sA,MeshToonMaterial:oU,MinEquation:VS,MirroredRepeatWrapping:qp,MixOperation:Yk,MultiplyBlending:FS,MultiplyOperation:Lm,NearestFilter:Er,NearestMipMapLinearFilter:JW,NearestMipMapNearestFilter:ZW,NearestMipmapLinearFilter:up,NearestMipmapNearestFilter:Ty,NeverCompare:pO,NeverDepth:Hk,NeverStencilFunc:h9,NoBlending:jo,NoColorSpace:Ss,NoToneMapping:qo,NormalAnimationBlendMode:v0,NormalBlending:rc,NotEqualCompare:_O,NotEqualDepth:$k,NotEqualStencilFunc:g9,NumberKeyframeTrack:sm,Object3D:Ln,ObjectLoader:jY,ObjectSpaceNormalMap:fO,OctahedronGeometry:zm,OneFactor:Rk,OneMinusConstantAlphaFactor:zk,OneMinusConstantColorFactor:Vk,OneMinusDstAlphaFactor:Dk,OneMinusDstColorFactor:Ok,OneMinusSrcAlphaFactor:Sy,OneMinusSrcColorFactor:Nk,OrthographicCamera:wa,P3Primaries:Zp,PCFShadowMap:p0,PCFSoftShadowMap:lp,PMREMGenerator:vT,Path:tm,PerspectiveCamera:Sr,Plane:fa,PlaneGeometry:ru,PlaneHelper:PK,PointLight:xU,PointLightHelper:wK,Points:jO,PointsMaterial:ZM,PolarGridHelper:AK,PolyhedronGeometry:iu,PositionalAudio:JY,PropertyBinding:In,PropertyMixer:bU,QuadraticBezierCurve:nA,QuadraticBezierCurve3:rA,Quaternion:Ii,QuaternionKeyframeTrack:Bd,QuaternionLinearInterpolant:mU,RED_GREEN_RGTC2_Format:dT,RED_RGTC1_Format:aO,REVISION:Nm,RGBADepthPacking:dO,RGBAFormat:kr,RGBAIntegerFormat:OM,RGBA_ASTC_10x10_Format:oT,RGBA_ASTC_10x5_Format:rT,RGBA_ASTC_10x6_Format:iT,RGBA_ASTC_10x8_Format:sT,RGBA_ASTC_12x10_Format:aT,RGBA_ASTC_12x12_Format:lT,RGBA_ASTC_4x4_Format:YS,RGBA_ASTC_5x4_Format:KS,RGBA_ASTC_5x5_Format:QS,RGBA_ASTC_6x5_Format:ZS,RGBA_ASTC_6x6_Format:JS,RGBA_ASTC_8x5_Format:eT,RGBA_ASTC_8x6_Format:tT,RGBA_ASTC_8x8_Format:nT,RGBA_BPTC_Format:M_,RGBA_ETC2_EAC_Format:$S,RGBA_PVRTC_2BPPV1_Format:qS,RGBA_PVRTC_4BPPV1_Format:jS,RGBA_S3TC_DXT1_Format:w_,RGBA_S3TC_DXT3_Format:S_,RGBA_S3TC_DXT5_Format:T_,RGB_BPTC_SIGNED_Format:uT,RGB_BPTC_UNSIGNED_Format:cT,RGB_ETC1_Format:UM,RGB_ETC2_Format:XS,RGB_PVRTC_2BPPV1_Format:WS,RGB_PVRTC_4BPPV1_Format:GS,RGB_S3TC_DXT1_Format:E_,RGFormat:oO,RGIntegerFormat:kM,RawShaderMaterial:rU,Ray:Ac,Raycaster:gA,Rec709Primaries:Qp,RectAreaLight:SU,RedFormat:LM,RedIntegerFormat:DM,ReinhardToneMapping:Zk,RenderTarget:TO,RepeatWrapping:jp,ReplaceStencilOp:s9,ReverseSubtractEquation:Ik,RingGeometry:k0,SIGNED_RED_GREEN_RGTC2_Format:fT,SIGNED_RED_RGTC1_Format:hT,SRGBColorSpace:Nr,SRGBTransfer:jn,Scene:Td,ShaderChunk:un,ShaderLib:po,ShaderMaterial:ji,ShadowMaterial:nU,Shape:oc,ShapeGeometry:O0,ShapePath:DK,ShapeUtils:Xo,ShortType:RM,Skeleton:A0,SkeletonHelper:EK,SkinnedMesh:zO,Source:Ku,Sphere:bi,SphereGeometry:Hm,Spherical:MT,SphericalHarmonics3:TU,SplineCurve:iA,SpotLight:yU,SpotLightHelper:xK,Sprite:VO,SpriteMaterial:KM,SrcAlphaFactor:wy,SrcAlphaSaturateFactor:Uk,SrcColorFactor:Pk,StaticCopyUsage:S9,StaticDrawUsage:Jp,StaticReadUsage:x9,StereoCamera:YY,StreamCopyUsage:M9,StreamDrawUsage:y9,StreamReadUsage:w9,StringKeyframeTrack:bc,SubtractEquation:Ck,SubtractiveBlending:US,TOUCH:Bu,TangentSpaceNormalMap:nu,TetrahedronGeometry:U0,Texture:Un,TextureLoader:H0,TorusGeometry:F0,TorusKnotGeometry:V0,Triangle:rs,TriangleFanDrawMode:r9,TriangleStripDrawMode:n9,TrianglesDrawMode:t9,TubeGeometry:B0,TwoPassDoubleSide:QW,UVMapping:Xl,Uint16BufferAttribute:WM,Uint32BufferAttribute:jM,Uint8BufferAttribute:sj,Uint8ClampedBufferAttribute:oj,Uniform:mA,UniformsGroup:pK,UniformsLib:dt,UniformsUtils:CO,UnsignedByteType:bs,UnsignedInt248Type:Dl,UnsignedIntType:ko,UnsignedShort4444Type:PM,UnsignedShort5551Type:NM,UnsignedShortType:m0,VSMShadowMap:co,Vector2:Ue,Vector3:Q,Vector4:Vn,VectorKeyframeTrack:om,VideoTexture:nY,WebGL1Renderer:UO,WebGL3DRenderTarget:q9,WebGLArrayRenderTarget:j9,WebGLCoordinateSystem:vo,WebGLCubeRenderTarget:qM,WebGLMultipleRenderTargets:X9,WebGLRenderTarget:Wi,WebGLRenderer:w0,WebGLUtils:kO,WebGPUCoordinateSystem:Ed,WireframeGeometry:tU,WrapAroundEnding:Yp,ZeroCurvatureEnding:$u,ZeroFactor:bk,ZeroSlopeEnding:Yu,ZeroStencilOp:i9,_SRGBAFormat:My,createCanvasElement:SO,sRGBEncoding:Ol},Symbol.toStringTag,{value:"Module"}));var NU={exports:{}},Rc={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Rc.ConcurrentRoot=1;Rc.ContinuousEventPriority=4;Rc.DefaultEventPriority=16;Rc.DiscreteEventPriority=1;Rc.IdleEventPriority=536870912;Rc.LegacyRoot=0;NU.exports=Rc;var $h=NU.exports;function OK(n){let e;const t=new Set,r=(u,d)=>{const f=typeof u=="function"?u(e):u;if(f!==e){const p=e;e=d?f:Object.assign({},e,f),t.forEach(g=>g(e,p))}},i=()=>e,s=(u,d=i,f=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let p=d(e);function g(){const y=d(e);if(!f(p,y)){const S=p;u(p=y,S)}}return t.add(g),()=>t.delete(g)},l={setState:r,getState:i,subscribe:(u,d,f)=>d||f?s(u,d,f):(t.add(u),()=>t.delete(u)),destroy:()=>t.clear()};return e=n(r,i,l),l}const UK=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),d2=UK?fe.useEffect:fe.useLayoutEffect;function LU(n){const e=typeof n=="function"?OK(n):n,t=(r=e.getState,i=Object.is)=>{const[,s]=fe.useReducer(x=>x+1,0),o=e.getState(),a=fe.useRef(o),l=fe.useRef(r),u=fe.useRef(i),d=fe.useRef(!1),f=fe.useRef();f.current===void 0&&(f.current=r(o));let p,g=!1;(a.current!==o||l.current!==r||u.current!==i||d.current)&&(p=r(o),g=!i(f.current,p)),d2(()=>{g&&(f.current=p),a.current=o,l.current=r,u.current=i,d.current=!1});const y=fe.useRef(o);d2(()=>{const x=()=>{try{const w=e.getState(),T=l.current(w);u.current(f.current,T)||(a.current=w,f.current=T,s())}catch{d.current=!0,s()}},v=e.subscribe(x);return e.getState()!==y.current&&x(),v},[]);const S=g?p:f.current;return fe.useDebugValue(S),S};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[t,e];return{next(){const i=r.length<=0;return{value:r.shift(),done:i}}}},t}const FK=n=>typeof n=="object"&&typeof n.then=="function",Ju=[];function DU(n,e,t=(r,i)=>r===i){if(n===e)return!0;if(!n||!e)return!1;const r=n.length;if(e.length!==r)return!1;for(let i=0;i<r;i++)if(!t(n[i],e[i]))return!1;return!0}function kU(n,e=null,t=!1,r={}){e===null&&(e=[n]);for(const s of Ju)if(DU(e,s.keys,s.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return r.lifespan&&r.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,r.lifespan)),s.response;if(!t)throw s.promise}const i={keys:e,equal:r.equal,remove:()=>{const s=Ju.indexOf(i);s!==-1&&Ju.splice(s,1)},promise:(FK(n)?n:n(...e)).then(s=>{i.response=s,r.lifespan&&r.lifespan>0&&(i.timeout=setTimeout(i.remove,r.lifespan))}).catch(s=>i.error=s)};if(Ju.push(i),!t)throw i.promise}const VK=(n,e,t)=>kU(n,e,!1,t),BK=(n,e,t)=>void kU(n,e,!0,t),zK=n=>{if(n===void 0||n.length===0)Ju.splice(0,Ju.length);else{const e=Ju.find(t=>DU(n,t.keys,t.equal));e&&e.remove()}};var OU={exports:{}},nw={exports:{}},rw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f2;function HK(){return f2||(f2=1,function(n){function e(G,Z){var K=G.length;G.push(Z);e:for(;0<K;){var ce=K-1>>>1,de=G[ce];if(0<i(de,Z))G[ce]=Z,G[K]=de,K=ce;else break e}}function t(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var Z=G[0],K=G.pop();if(K!==Z){G[0]=K;e:for(var ce=0,de=G.length,ue=de>>>1;ce<ue;){var Ee=2*(ce+1)-1,Fe=G[Ee],ke=Ee+1,Ye=G[ke];if(0>i(Fe,K))ke<de&&0>i(Ye,Fe)?(G[ce]=Ye,G[ke]=K,ce=ke):(G[ce]=Fe,G[Ee]=K,ce=Ee);else if(ke<de&&0>i(Ye,K))G[ce]=Ye,G[ke]=K,ce=ke;else break e}}return Z}function i(G,Z){var K=G.sortIndex-Z.sortIndex;return K!==0?K:G.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,f=null,p=3,g=!1,y=!1,S=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(G){for(var Z=t(u);Z!==null;){if(Z.callback===null)r(u);else if(Z.startTime<=G)r(u),Z.sortIndex=Z.expirationTime,e(l,Z);else break;Z=t(u)}}function R(G){if(S=!1,T(G),!y)if(t(l)!==null)y=!0,te(U);else{var Z=t(u);Z!==null&&ye(R,Z.startTime-G)}}function U(G,Z){y=!1,S&&(S=!1,v(b),b=-1),g=!0;var K=p;try{for(T(Z),f=t(l);f!==null&&(!(f.expirationTime>Z)||G&&!L());){var ce=f.callback;if(typeof ce=="function"){f.callback=null,p=f.priorityLevel;var de=ce(f.expirationTime<=Z);Z=n.unstable_now(),typeof de=="function"?f.callback=de:f===t(l)&&r(l),T(Z)}else r(l);f=t(l)}if(f!==null)var ue=!0;else{var Ee=t(u);Ee!==null&&ye(R,Ee.startTime-Z),ue=!1}return ue}finally{f=null,p=K,g=!1}}var N=!1,P=null,b=-1,M=5,A=-1;function L(){return!(n.unstable_now()-A<M)}function z(){if(P!==null){var G=n.unstable_now();A=G;var Z=!0;try{Z=P(!0,G)}finally{Z?B():(N=!1,P=null)}}else N=!1}var B;if(typeof w=="function")B=function(){w(z)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,he=$.port2;$.port1.onmessage=z,B=function(){he.postMessage(null)}}else B=function(){x(z,0)};function te(G){P=G,N||(N=!0,B())}function ye(G,Z){b=x(function(){G(n.unstable_now())},Z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(G){G.callback=null},n.unstable_continueExecution=function(){y||g||(y=!0,te(U))},n.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<G?Math.floor(1e3/G):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(G){switch(p){case 1:case 2:case 3:var Z=3;break;default:Z=p}var K=p;p=Z;try{return G()}finally{p=K}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(G,Z){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var K=p;p=G;try{return Z()}finally{p=K}},n.unstable_scheduleCallback=function(G,Z,K){var ce=n.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?ce+K:ce):K=ce,G){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=K+de,G={id:d++,callback:Z,priorityLevel:G,startTime:K,expirationTime:de,sortIndex:-1},K>ce?(G.sortIndex=K,e(u,G),t(l)===null&&G===t(u)&&(S?(v(b),b=-1):S=!0,ye(R,K-ce))):(G.sortIndex=de,e(l,G),y||g||(y=!0,te(U))),G},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(G){var Z=p;return function(){var K=p;p=Z;try{return G.apply(this,arguments)}finally{p=K}}}}(rw)),rw}var p2;function GK(){return p2||(p2=1,nw.exports=HK()),nw.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WK=function(e){var t={},r=fe,i=GK(),s=Object.assign;function o(c){for(var h="https://reactjs.org/docs/error-decoder.html?invariant="+c,_=1;_<arguments.length;_++)h+="&args[]="+encodeURIComponent(arguments[_]);return"Minified React error #"+c+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),u=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),g=Symbol.for("react.provider"),y=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),v=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),R=Symbol.for("react.offscreen"),U=Symbol.iterator;function N(c){return c===null||typeof c!="object"?null:(c=U&&c[U]||c["@@iterator"],typeof c=="function"?c:null)}function P(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case d:return"Fragment";case u:return"Portal";case p:return"Profiler";case f:return"StrictMode";case x:return"Suspense";case v:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case y:return(c.displayName||"Context")+".Consumer";case g:return(c._context.displayName||"Context")+".Provider";case S:var h=c.render;return c=c.displayName,c||(c=h.displayName||h.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case w:return h=c.displayName||null,h!==null?h:P(c.type)||"Memo";case T:h=c._payload,c=c._init;try{return P(c(h))}catch{}}return null}function b(c){var h=c.type;switch(c.tag){case 24:return"Cache";case 9:return(h.displayName||"Context")+".Consumer";case 10:return(h._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=h.render,c=c.displayName||c.name||"",h.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return P(h);case 8:return h===f?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h}return null}function M(c){var h=c,_=c;if(c.alternate)for(;h.return;)h=h.return;else{c=h;do h=c,h.flags&4098&&(_=h.return),c=h.return;while(c)}return h.tag===3?_:null}function A(c){if(M(c)!==c)throw Error(o(188))}function L(c){var h=c.alternate;if(!h){if(h=M(c),h===null)throw Error(o(188));return h!==c?null:c}for(var _=c,E=h;;){var C=_.return;if(C===null)break;var k=C.alternate;if(k===null){if(E=C.return,E!==null){_=E;continue}break}if(C.child===k.child){for(k=C.child;k;){if(k===_)return A(C),c;if(k===E)return A(C),h;k=k.sibling}throw Error(o(188))}if(_.return!==E.return)_=C,E=k;else{for(var ne=!1,pe=C.child;pe;){if(pe===_){ne=!0,_=C,E=k;break}if(pe===E){ne=!0,E=C,_=k;break}pe=pe.sibling}if(!ne){for(pe=k.child;pe;){if(pe===_){ne=!0,_=k,E=C;break}if(pe===E){ne=!0,E=k,_=C;break}pe=pe.sibling}if(!ne)throw Error(o(189))}}if(_.alternate!==E)throw Error(o(190))}if(_.tag!==3)throw Error(o(188));return _.stateNode.current===_?c:h}function z(c){return c=L(c),c!==null?B(c):null}function B(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var h=B(c);if(h!==null)return h;c=c.sibling}return null}function $(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){if(c.tag!==4){var h=$(c);if(h!==null)return h}c=c.sibling}return null}var he=Array.isArray,te=e.getPublicInstance,ye=e.getRootHostContext,G=e.getChildHostContext,Z=e.prepareForCommit,K=e.resetAfterCommit,ce=e.createInstance,de=e.appendInitialChild,ue=e.finalizeInitialChildren,Ee=e.prepareUpdate,Fe=e.shouldSetTextContent,ke=e.createTextInstance,Ye=e.scheduleTimeout,Ct=e.cancelTimeout,Dt=e.noTimeout,gt=e.isPrimaryRenderer,vt=e.supportsMutation,ie=e.supportsPersistence,Be=e.supportsHydration,Ae=e.getInstanceFromNode,We=e.preparePortalMount,be=e.getCurrentEventPriority,At=e.detachDeletedInstance,st=e.supportsMicrotasks,W=e.scheduleMicrotask,H=e.supportsTestSelectors,_e=e.findFiberRoot,Ve=e.getBoundingRect,ze=e.getTextContent,De=e.isHiddenSubtree,yt=e.matchAccessibilityRole,Xe=e.setFocusIfFocusable,Qe=e.setupIntersectionObserver,lt=e.appendChild,Nt=e.appendChildToContainer,He=e.commitTextUpdate,tn=e.commitMount,Ht=e.commitUpdate,xt=e.insertBefore,ct=e.insertInContainerBefore,ft=e.removeChild,ae=e.removeChildFromContainer,Se=e.resetTextContent,Je=e.hideInstance,ut=e.hideTextInstance,q=e.unhideInstance,J=e.unhideTextInstance,Ne=e.clearContainer,Ke=e.cloneInstance,Ze=e.createContainerChildSet,ot=e.appendChildToContainerChildSet,$t=e.finalizeContainerChildren,rn=e.replaceContainerChildren,sn=e.cloneHiddenInstance,gn=e.cloneHiddenTextInstance,Vt=e.canHydrateInstance,$n=e.canHydrateTextInstance,ur=e.canHydrateSuspenseInstance,qr=e.isSuspenseInstancePending,eo=e.isSuspenseInstanceFallback,ci=e.registerSuspenseInstanceRetry,tr=e.getNextHydratableSibling,Zt=e.getFirstHydratableChild,Os=e.getFirstHydratableChildWithinContainer,us=e.getFirstHydratableChildWithinSuspenseInstance,V=e.hydrateInstance,X=e.hydrateTextInstance,le=e.hydrateSuspenseInstance,O=e.getNextHydratableInstanceAfterSuspenseInstance,Y=e.commitHydratedContainer,ee=e.commitHydratedSuspenseInstance,se=e.clearSuspenseBoundary,re=e.clearSuspenseBoundaryFromContainer,xe=e.shouldDeleteUnhydratedTailInstances,Me=e.didNotMatchHydratedContainerTextInstance,Re=e.didNotMatchHydratedTextInstance,Ce;function Et(c){if(Ce===void 0)try{throw Error()}catch(_){var h=_.stack.trim().match(/\n( *(at )?)/);Ce=h&&h[1]||""}return`
`+Ce+c}var je=!1;function $e(c,h){if(!c||je)return"";je=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(h)if(h=function(){throw Error()},Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(it){var E=it}Reflect.construct(c,[],h)}else{try{h.call()}catch(it){E=it}c.call(h.prototype)}else{try{throw Error()}catch(it){E=it}c()}}catch(it){if(it&&E&&typeof it.stack=="string"){for(var C=it.stack.split(`
`),k=E.stack.split(`
`),ne=C.length-1,pe=k.length-1;1<=ne&&0<=pe&&C[ne]!==k[pe];)pe--;for(;1<=ne&&0<=pe;ne--,pe--)if(C[ne]!==k[pe]){if(ne!==1||pe!==1)do if(ne--,pe--,0>pe||C[ne]!==k[pe]){var Pe=`
`+C[ne].replace(" at new "," at ");return c.displayName&&Pe.includes("<anonymous>")&&(Pe=Pe.replace("<anonymous>",c.displayName)),Pe}while(1<=ne&&0<=pe);break}}}finally{je=!1,Error.prepareStackTrace=_}return(c=c?c.displayName||c.name:"")?Et(c):""}var mt=Object.prototype.hasOwnProperty,Pt=[],Ut=-1;function Gt(c){return{current:c}}function pt(c){0>Ut||(c.current=Pt[Ut],Pt[Ut]=null,Ut--)}function at(c,h){Ut++,Pt[Ut]=c.current,c.current=h}var Jt={},kt=Gt(Jt),Wt=Gt(!1),Mn=Jt;function oe(c,h){var _=c.type.contextTypes;if(!_)return Jt;var E=c.stateNode;if(E&&E.__reactInternalMemoizedUnmaskedChildContext===h)return E.__reactInternalMemoizedMaskedChildContext;var C={},k;for(k in _)C[k]=h[k];return E&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=h,c.__reactInternalMemoizedMaskedChildContext=C),C}function ge(c){return c=c.childContextTypes,c!=null}function Le(){pt(Wt),pt(kt)}function qe(c,h,_){if(kt.current!==Jt)throw Error(o(168));at(kt,h),at(Wt,_)}function ht(c,h,_){var E=c.stateNode;if(h=h.childContextTypes,typeof E.getChildContext!="function")return _;E=E.getChildContext();for(var C in E)if(!(C in h))throw Error(o(108,b(c)||"Unknown",C));return s({},_,E)}function rt(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||Jt,Mn=kt.current,at(kt,c),at(Wt,Wt.current),!0}function et(c,h,_){var E=c.stateNode;if(!E)throw Error(o(169));_?(c=ht(c,h,Mn),E.__reactInternalMemoizedMergedChildContext=c,pt(Wt),pt(kt),at(kt,c)):pt(Wt),at(Wt,_)}var It=Math.clz32?Math.clz32:ln,Yt=Math.log,Dn=Math.LN2;function ln(c){return c>>>=0,c===0?32:31-(Yt(c)/Dn|0)|0}var Us=64,Ki=4194304;function Xr(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return c&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function ou(c,h){var _=c.pendingLanes;if(_===0)return 0;var E=0,C=c.suspendedLanes,k=c.pingedLanes,ne=_&268435455;if(ne!==0){var pe=ne&~C;pe!==0?E=Xr(pe):(k&=ne,k!==0&&(E=Xr(k)))}else ne=_&~C,ne!==0?E=Xr(ne):k!==0&&(E=Xr(k));if(E===0)return 0;if(h!==0&&h!==E&&!(h&C)&&(C=E&-E,k=h&-h,C>=k||C===16&&(k&4194240)!==0))return h;if(E&4&&(E|=_&16),h=c.entangledLanes,h!==0)for(c=c.entanglements,h&=E;0<h;)_=31-It(h),C=1<<_,E|=c[_],h&=~C;return E}function Pc(c,h){switch(c){case 1:case 2:case 4:return h+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nc(c,h){for(var _=c.suspendedLanes,E=c.pingedLanes,C=c.expirationTimes,k=c.pendingLanes;0<k;){var ne=31-It(k),pe=1<<ne,Pe=C[ne];Pe===-1?(!(pe&_)||pe&E)&&(C[ne]=Pc(pe,h)):Pe<=h&&(c.expiredLanes|=pe),k&=~pe}}function yn(c){return c=c.pendingLanes&-1073741825,c!==0?c:c&1073741824?1073741824:0}function Vr(c){for(var h=[],_=0;31>_;_++)h.push(c);return h}function Qo(c,h,_){c.pendingLanes|=h,h!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),c=c.eventTimes,h=31-It(h),c[h]=_}function za(c,h){var _=c.pendingLanes&~h;c.pendingLanes=h,c.suspendedLanes=0,c.pingedLanes=0,c.expiredLanes&=h,c.mutableReadLanes&=h,c.entangledLanes&=h,h=c.entanglements;var E=c.eventTimes;for(c=c.expirationTimes;0<_;){var C=31-It(_),k=1<<C;h[C]=0,E[C]=-1,c[C]=-1,_&=~k}}function Ni(c,h){var _=c.entangledLanes|=h;for(c=c.entanglements;_;){var E=31-It(_),C=1<<E;C&h|c[E]&h&&(c[E]|=h),_&=~C}}var vn=0;function zd(c){return c&=-c,1<c?4<c?c&268435455?16:536870912:4:1}var Lc=i.unstable_scheduleCallback,Zo=i.unstable_cancelCallback,j0=i.unstable_shouldYield,q0=i.unstable_requestPaint,Tr=i.unstable_now,Fs=i.unstable_ImmediatePriority,X0=i.unstable_UserBlockingPriority,Hd=i.unstable_NormalPriority,Dc=i.unstable_IdlePriority,Jo=null,cs=null;function au(c){if(cs&&typeof cs.onCommitFiberRoot=="function")try{cs.onCommitFiberRoot(Jo,c,void 0,(c.current.flags&128)===128)}catch{}}function lu(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var hs=typeof Object.is=="function"?Object.is:lu,ds=null,Gn=!1,Gd=!1;function Xm(c){ds===null?ds=[c]:ds.push(c)}function $m(c){Gn=!0,Xm(c)}function fs(){if(!Gd&&ds!==null){Gd=!0;var c=0,h=vn;try{var _=ds;for(vn=1;c<_.length;c++){var E=_[c];do E=E(!0);while(E!==null)}ds=null,Gn=!1}catch(C){throw ds!==null&&(ds=ds.slice(c+1)),Lc(Fs,fs),C}finally{vn=h,Gd=!1}}return null}var Ym=a.ReactCurrentBatchConfig;function ea(c,h){if(hs(c,h))return!0;if(typeof c!="object"||c===null||typeof h!="object"||h===null)return!1;var _=Object.keys(c),E=Object.keys(h);if(_.length!==E.length)return!1;for(E=0;E<_.length;E++){var C=_[E];if(!mt.call(h,C)||!hs(c[C],h[C]))return!1}return!0}function Km(c){switch(c.tag){case 5:return Et(c.type);case 16:return Et("Lazy");case 13:return Et("Suspense");case 19:return Et("SuspenseList");case 0:case 2:case 15:return c=$e(c.type,!1),c;case 11:return c=$e(c.type.render,!1),c;case 1:return c=$e(c.type,!0),c;default:return""}}function vr(c,h){if(c&&c.defaultProps){h=s({},h),c=c.defaultProps;for(var _ in c)h[_]===void 0&&(h[_]=c[_]);return h}return h}var uu=Gt(null),kc=null,Vs=null,Oc=null;function cu(){Oc=Vs=kc=null}function hu(c,h,_){gt?(at(uu,h._currentValue),h._currentValue=_):(at(uu,h._currentValue2),h._currentValue2=_)}function Uc(c){var h=uu.current;pt(uu),gt?c._currentValue=h:c._currentValue2=h}function Ha(c,h,_){for(;c!==null;){var E=c.alternate;if((c.childLanes&h)!==h?(c.childLanes|=h,E!==null&&(E.childLanes|=h)):E!==null&&(E.childLanes&h)!==h&&(E.childLanes|=h),c===_)break;c=c.return}}function Ga(c,h){kc=c,Oc=Vs=null,c=c.dependencies,c!==null&&c.firstContext!==null&&(c.lanes&h&&(gs=!0),c.firstContext=null)}function Li(c){var h=gt?c._currentValue:c._currentValue2;if(Oc!==c)if(c={context:c,memoizedValue:h,next:null},Vs===null){if(kc===null)throw Error(o(308));Vs=c,kc.dependencies={lanes:0,firstContext:c}}else Vs=Vs.next=c;return h}var hi=null,to=!1;function Fc(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vc(c,h){c=c.updateQueue,h.updateQueue===c&&(h.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function ps(c,h){return{eventTime:c,lane:h,tag:0,payload:null,callback:null,next:null}}function no(c,h){var _=c.updateQueue;_!==null&&(_=_.shared,Ir!==null&&c.mode&1&&!(pn&2)?(c=_.interleaved,c===null?(h.next=h,hi===null?hi=[_]:hi.push(_)):(h.next=c.next,c.next=h),_.interleaved=h):(c=_.pending,c===null?h.next=h:(h.next=c.next,c.next=h),_.pending=h))}function ta(c,h,_){if(h=h.updateQueue,h!==null&&(h=h.shared,(_&4194240)!==0)){var E=h.lanes;E&=c.pendingLanes,_|=E,h.lanes=_,Ni(c,_)}}function Wd(c,h){var _=c.updateQueue,E=c.alternate;if(E!==null&&(E=E.updateQueue,_===E)){var C=null,k=null;if(_=_.firstBaseUpdate,_!==null){do{var ne={eventTime:_.eventTime,lane:_.lane,tag:_.tag,payload:_.payload,callback:_.callback,next:null};k===null?C=k=ne:k=k.next=ne,_=_.next}while(_!==null);k===null?C=k=h:k=k.next=h}else C=k=h;_={baseState:E.baseState,firstBaseUpdate:C,lastBaseUpdate:k,shared:E.shared,effects:E.effects},c.updateQueue=_;return}c=_.lastBaseUpdate,c===null?_.firstBaseUpdate=h:c.next=h,_.lastBaseUpdate=h}function du(c,h,_,E){var C=c.updateQueue;to=!1;var k=C.firstBaseUpdate,ne=C.lastBaseUpdate,pe=C.shared.pending;if(pe!==null){C.shared.pending=null;var Pe=pe,it=Pe.next;Pe.next=null,ne===null?k=it:ne.next=it,ne=Pe;var Rt=c.alternate;Rt!==null&&(Rt=Rt.updateQueue,pe=Rt.lastBaseUpdate,pe!==ne&&(pe===null?Rt.firstBaseUpdate=it:pe.next=it,Rt.lastBaseUpdate=Pe))}if(k!==null){var on=C.baseState;ne=0,Rt=it=Pe=null,pe=k;do{var qt=pe.lane,Wn=pe.eventTime;if((E&qt)===qt){Rt!==null&&(Rt=Rt.next={eventTime:Wn,lane:0,tag:pe.tag,payload:pe.payload,callback:pe.callback,next:null});e:{var Ft=c,gi=pe;switch(qt=h,Wn=_,gi.tag){case 1:if(Ft=gi.payload,typeof Ft=="function"){on=Ft.call(Wn,on,qt);break e}on=Ft;break e;case 3:Ft.flags=Ft.flags&-65537|128;case 0:if(Ft=gi.payload,qt=typeof Ft=="function"?Ft.call(Wn,on,qt):Ft,qt==null)break e;on=s({},on,qt);break e;case 2:to=!0}}pe.callback!==null&&pe.lane!==0&&(c.flags|=64,qt=C.effects,qt===null?C.effects=[pe]:qt.push(pe))}else Wn={eventTime:Wn,lane:qt,tag:pe.tag,payload:pe.payload,callback:pe.callback,next:null},Rt===null?(it=Rt=Wn,Pe=on):Rt=Rt.next=Wn,ne|=qt;if(pe=pe.next,pe===null){if(pe=C.shared.pending,pe===null)break;qt=pe,pe=qt.next,qt.next=null,C.lastBaseUpdate=qt,C.shared.pending=null}}while(!0);if(Rt===null&&(Pe=on),C.baseState=Pe,C.firstBaseUpdate=it,C.lastBaseUpdate=Rt,h=C.shared.interleaved,h!==null){C=h;do ne|=C.lane,C=C.next;while(C!==h)}else k===null&&(C.shared.lanes=0);$c|=ne,c.lanes=ne,c.memoizedState=on}}function To(c,h,_){if(c=h.effects,h.effects=null,c!==null)for(h=0;h<c.length;h++){var E=c[h],C=E.callback;if(C!==null){if(E.callback=null,E=_,typeof C!="function")throw Error(o(191,C));C.call(E)}}}var jd=new r.Component().refs;function Bc(c,h,_,E){h=c.memoizedState,_=_(E,h),_=_==null?h:s({},h,_),c.memoizedState=_,c.lanes===0&&(c.updateQueue.baseState=_)}var fu={isMounted:function(c){return(c=c._reactInternals)?M(c)===c:!1},enqueueSetState:function(c,h,_){c=c._reactInternals;var E=Oi(),C=qa(c),k=ps(E,C);k.payload=h,_!=null&&(k.callback=_),no(c,k),h=Hs(c,C,E),h!==null&&ta(h,c,C)},enqueueReplaceState:function(c,h,_){c=c._reactInternals;var E=Oi(),C=qa(c),k=ps(E,C);k.tag=1,k.payload=h,_!=null&&(k.callback=_),no(c,k),h=Hs(c,C,E),h!==null&&ta(h,c,C)},enqueueForceUpdate:function(c,h){c=c._reactInternals;var _=Oi(),E=qa(c),C=ps(_,E);C.tag=2,h!=null&&(C.callback=h),no(c,C),h=Hs(c,E,_),h!==null&&ta(h,c,E)}};function qd(c,h,_,E,C,k,ne){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(E,k,ne):h.prototype&&h.prototype.isPureReactComponent?!ea(_,E)||!ea(C,k):!0}function pu(c,h,_){var E=!1,C=Jt,k=h.contextType;return typeof k=="object"&&k!==null?k=Li(k):(C=ge(h)?Mn:kt.current,E=h.contextTypes,k=(E=E!=null)?oe(c,C):Jt),h=new h(_,k),c.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=fu,c.stateNode=h,h._reactInternals=c,E&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=C,c.__reactInternalMemoizedMaskedChildContext=k),h}function di(c,h,_,E){c=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(_,E),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(_,E),h.state!==c&&fu.enqueueReplaceState(h,h.state,null)}function zc(c,h,_,E){var C=c.stateNode;C.props=_,C.state=c.memoizedState,C.refs=jd,Fc(c);var k=h.contextType;typeof k=="object"&&k!==null?C.context=Li(k):(k=ge(h)?Mn:kt.current,C.context=oe(c,k)),C.state=c.memoizedState,k=h.getDerivedStateFromProps,typeof k=="function"&&(Bc(c,h,k,_),C.state=c.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(h=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),h!==C.state&&fu.enqueueReplaceState(C,C.state,null),du(c,_,C,E),C.state=c.memoizedState),typeof C.componentDidMount=="function"&&(c.flags|=4194308)}var na=[],ms=0,m=null,I=0,D=[],j=0,ve=null,Te=1,nt="";function Tn(c,h){na[ms++]=I,na[ms++]=m,m=c,I=h}function Mr(c,h,_){D[j++]=Te,D[j++]=nt,D[j++]=ve,ve=c;var E=Te;c=nt;var C=32-It(E)-1;E&=~(1<<C),_+=1;var k=32-It(h)+C;if(30<k){var ne=C-C%5;k=(E&(1<<ne)-1).toString(32),E>>=ne,C-=ne,Te=1<<32-It(h)+C|_<<C|E,nt=k+c}else Te=1<<k|_<<C|E,nt=c}function xn(c){c.return!==null&&(Tn(c,1),Mr(c,1,0))}function Ar(c){for(;c===m;)m=na[--ms],na[ms]=null,I=na[--ms],na[ms]=null;for(;c===ve;)ve=D[--j],D[j]=null,nt=D[--j],D[j]=null,Te=D[--j],D[j]=null}var On=null,Cr=null,En=!1,Mo=!1,Di=null;function bA(c,h){var _=Gs(5,null,null,0);_.elementType="DELETED",_.stateNode=h,_.return=c,h=c.deletions,h===null?(c.deletions=[_],c.flags|=16):h.push(_)}function RA(c,h){switch(c.tag){case 5:return h=Vt(h,c.type,c.pendingProps),h!==null?(c.stateNode=h,On=c,Cr=Zt(h),!0):!1;case 6:return h=$n(h,c.pendingProps),h!==null?(c.stateNode=h,On=c,Cr=null,!0):!1;case 13:if(h=ur(h),h!==null){var _=ve!==null?{id:Te,overflow:nt}:null;return c.memoizedState={dehydrated:h,treeContext:_,retryLane:1073741824},_=Gs(18,null,null,0),_.stateNode=h,_.return=c,c.child=_,On=c,Cr=null,!0}return!1;default:return!1}}function $0(c){return(c.mode&1)!==0&&(c.flags&128)===0}function Y0(c){if(En){var h=Cr;if(h){var _=h;if(!RA(c,h)){if($0(c))throw Error(o(418));h=tr(_);var E=On;h&&RA(c,h)?bA(E,_):(c.flags=c.flags&-4097|2,En=!1,On=c)}}else{if($0(c))throw Error(o(418));c.flags=c.flags&-4097|2,En=!1,On=c}}}function PA(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;On=c}function Xd(c){if(!Be||c!==On)return!1;if(!En)return PA(c),En=!0,!1;if(c.tag!==3&&(c.tag!==5||xe(c.type)&&!Fe(c.type,c.memoizedProps))){var h=Cr;if(h){if($0(c)){for(c=Cr;c;)c=tr(c);throw Error(o(418))}for(;h;)bA(c,h),h=tr(h)}}if(PA(c),c.tag===13){if(!Be)throw Error(o(316));if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(o(317));Cr=O(c)}else Cr=On?tr(c.stateNode):null;return!0}function Hc(){Be&&(Cr=On=null,Mo=En=!1)}function K0(c){Di===null?Di=[c]:Di.push(c)}function $d(c,h,_){if(c=_.ref,c!==null&&typeof c!="function"&&typeof c!="object"){if(_._owner){if(_=_._owner,_){if(_.tag!==1)throw Error(o(309));var E=_.stateNode}if(!E)throw Error(o(147,c));var C=E,k=""+c;return h!==null&&h.ref!==null&&typeof h.ref=="function"&&h.ref._stringRef===k?h.ref:(h=function(ne){var pe=C.refs;pe===jd&&(pe=C.refs={}),ne===null?delete pe[k]:pe[k]=ne},h._stringRef=k,h)}if(typeof c!="string")throw Error(o(284));if(!_._owner)throw Error(o(290,c))}return c}function Qm(c,h){throw c=Object.prototype.toString.call(h),Error(o(31,c==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":c))}function NA(c){var h=c._init;return h(c._payload)}function LA(c){function h(we,me){if(c){var Ie=we.deletions;Ie===null?(we.deletions=[me],we.flags|=16):Ie.push(me)}}function _(we,me){if(!c)return null;for(;me!==null;)h(we,me),me=me.sibling;return null}function E(we,me){for(we=new Map;me!==null;)me.key!==null?we.set(me.key,me):we.set(me.index,me),me=me.sibling;return we}function C(we,me){return we=$a(we,me),we.index=0,we.sibling=null,we}function k(we,me,Ie){return we.index=Ie,c?(Ie=we.alternate,Ie!==null?(Ie=Ie.index,Ie<me?(we.flags|=2,me):Ie):(we.flags|=2,me)):(we.flags|=1048576,me)}function ne(we){return c&&we.alternate===null&&(we.flags|=2),we}function pe(we,me,Ie,St){return me===null||me.tag!==6?(me=Lx(Ie,we.mode,St),me.return=we,me):(me=C(me,Ie),me.return=we,me)}function Pe(we,me,Ie,St){var Ot=Ie.type;return Ot===d?Rt(we,me,Ie.props.children,St,Ie.key):me!==null&&(me.elementType===Ot||typeof Ot=="object"&&Ot!==null&&Ot.$$typeof===T&&NA(Ot)===me.type)?(St=C(me,Ie.props),St.ref=$d(we,me,Ie),St.return=we,St):(St=Ig(Ie.type,Ie.key,Ie.props,null,we.mode,St),St.ref=$d(we,me,Ie),St.return=we,St)}function it(we,me,Ie,St){return me===null||me.tag!==4||me.stateNode.containerInfo!==Ie.containerInfo||me.stateNode.implementation!==Ie.implementation?(me=Dx(Ie,we.mode,St),me.return=we,me):(me=C(me,Ie.children||[]),me.return=we,me)}function Rt(we,me,Ie,St,Ot){return me===null||me.tag!==7?(me=Eu(Ie,we.mode,St,Ot),me.return=we,me):(me=C(me,Ie),me.return=we,me)}function on(we,me,Ie){if(typeof me=="string"&&me!==""||typeof me=="number")return me=Lx(""+me,we.mode,Ie),me.return=we,me;if(typeof me=="object"&&me!==null){switch(me.$$typeof){case l:return Ie=Ig(me.type,me.key,me.props,null,we.mode,Ie),Ie.ref=$d(we,null,me),Ie.return=we,Ie;case u:return me=Dx(me,we.mode,Ie),me.return=we,me;case T:var St=me._init;return on(we,St(me._payload),Ie)}if(he(me)||N(me))return me=Eu(me,we.mode,Ie,null),me.return=we,me;Qm(we,me)}return null}function qt(we,me,Ie,St){var Ot=me!==null?me.key:null;if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number")return Ot!==null?null:pe(we,me,""+Ie,St);if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case l:return Ie.key===Ot?Pe(we,me,Ie,St):null;case u:return Ie.key===Ot?it(we,me,Ie,St):null;case T:return Ot=Ie._init,qt(we,me,Ot(Ie._payload),St)}if(he(Ie)||N(Ie))return Ot!==null?null:Rt(we,me,Ie,St,null);Qm(we,Ie)}return null}function Wn(we,me,Ie,St,Ot){if(typeof St=="string"&&St!==""||typeof St=="number")return we=we.get(Ie)||null,pe(me,we,""+St,Ot);if(typeof St=="object"&&St!==null){switch(St.$$typeof){case l:return we=we.get(St.key===null?Ie:St.key)||null,Pe(me,we,St,Ot);case u:return we=we.get(St.key===null?Ie:St.key)||null,it(me,we,St,Ot);case T:var dn=St._init;return Wn(we,me,Ie,dn(St._payload),Ot)}if(he(St)||N(St))return we=we.get(Ie)||null,Rt(me,we,St,Ot,null);Qm(me,St)}return null}function Ft(we,me,Ie,St){for(var Ot=null,dn=null,an=me,Rn=me=0,Yr=null;an!==null&&Rn<Ie.length;Rn++){an.index>Rn?(Yr=an,an=null):Yr=an.sibling;var Pn=qt(we,an,Ie[Rn],St);if(Pn===null){an===null&&(an=Yr);break}c&&an&&Pn.alternate===null&&h(we,an),me=k(Pn,me,Rn),dn===null?Ot=Pn:dn.sibling=Pn,dn=Pn,an=Yr}if(Rn===Ie.length)return _(we,an),En&&Tn(we,Rn),Ot;if(an===null){for(;Rn<Ie.length;Rn++)an=on(we,Ie[Rn],St),an!==null&&(me=k(an,me,Rn),dn===null?Ot=an:dn.sibling=an,dn=an);return En&&Tn(we,Rn),Ot}for(an=E(we,an);Rn<Ie.length;Rn++)Yr=Wn(an,we,Rn,Ie[Rn],St),Yr!==null&&(c&&Yr.alternate!==null&&an.delete(Yr.key===null?Rn:Yr.key),me=k(Yr,me,Rn),dn===null?Ot=Yr:dn.sibling=Yr,dn=Yr);return c&&an.forEach(function(Ya){return h(we,Ya)}),En&&Tn(we,Rn),Ot}function gi(we,me,Ie,St){var Ot=N(Ie);if(typeof Ot!="function")throw Error(o(150));if(Ie=Ot.call(Ie),Ie==null)throw Error(o(151));for(var dn=Ot=null,an=me,Rn=me=0,Yr=null,Pn=Ie.next();an!==null&&!Pn.done;Rn++,Pn=Ie.next()){an.index>Rn?(Yr=an,an=null):Yr=an.sibling;var Ya=qt(we,an,Pn.value,St);if(Ya===null){an===null&&(an=Yr);break}c&&an&&Ya.alternate===null&&h(we,an),me=k(Ya,me,Rn),dn===null?Ot=Ya:dn.sibling=Ya,dn=Ya,an=Yr}if(Pn.done)return _(we,an),En&&Tn(we,Rn),Ot;if(an===null){for(;!Pn.done;Rn++,Pn=Ie.next())Pn=on(we,Pn.value,St),Pn!==null&&(me=k(Pn,me,Rn),dn===null?Ot=Pn:dn.sibling=Pn,dn=Pn);return En&&Tn(we,Rn),Ot}for(an=E(we,an);!Pn.done;Rn++,Pn=Ie.next())Pn=Wn(an,we,Rn,Pn.value,St),Pn!==null&&(c&&Pn.alternate!==null&&an.delete(Pn.key===null?Rn:Pn.key),me=k(Pn,me,Rn),dn===null?Ot=Pn:dn.sibling=Pn,dn=Pn);return c&&an.forEach(function(jF){return h(we,jF)}),En&&Tn(we,Rn),Ot}function Ws(we,me,Ie,St){if(typeof Ie=="object"&&Ie!==null&&Ie.type===d&&Ie.key===null&&(Ie=Ie.props.children),typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case l:e:{for(var Ot=Ie.key,dn=me;dn!==null;){if(dn.key===Ot){if(Ot=Ie.type,Ot===d){if(dn.tag===7){_(we,dn.sibling),me=C(dn,Ie.props.children),me.return=we,we=me;break e}}else if(dn.elementType===Ot||typeof Ot=="object"&&Ot!==null&&Ot.$$typeof===T&&NA(Ot)===dn.type){_(we,dn.sibling),me=C(dn,Ie.props),me.ref=$d(we,dn,Ie),me.return=we,we=me;break e}_(we,dn);break}else h(we,dn);dn=dn.sibling}Ie.type===d?(me=Eu(Ie.props.children,we.mode,St,Ie.key),me.return=we,we=me):(St=Ig(Ie.type,Ie.key,Ie.props,null,we.mode,St),St.ref=$d(we,me,Ie),St.return=we,we=St)}return ne(we);case u:e:{for(dn=Ie.key;me!==null;){if(me.key===dn)if(me.tag===4&&me.stateNode.containerInfo===Ie.containerInfo&&me.stateNode.implementation===Ie.implementation){_(we,me.sibling),me=C(me,Ie.children||[]),me.return=we,we=me;break e}else{_(we,me);break}else h(we,me);me=me.sibling}me=Dx(Ie,we.mode,St),me.return=we,we=me}return ne(we);case T:return dn=Ie._init,Ws(we,me,dn(Ie._payload),St)}if(he(Ie))return Ft(we,me,Ie,St);if(N(Ie))return gi(we,me,Ie,St);Qm(we,Ie)}return typeof Ie=="string"&&Ie!==""||typeof Ie=="number"?(Ie=""+Ie,me!==null&&me.tag===6?(_(we,me.sibling),me=C(me,Ie),me.return=we,we=me):(_(we,me),me=Lx(Ie,we.mode,St),me.return=we,we=me),ne(we)):_(we,me)}return Ws}var Gc=LA(!0),DA=LA(!1),Yd={},Bs=Gt(Yd),Kd=Gt(Yd),Wc=Gt(Yd);function Ao(c){if(c===Yd)throw Error(o(174));return c}function Q0(c,h){at(Wc,h),at(Kd,c),at(Bs,Yd),c=ye(h),pt(Bs),at(Bs,c)}function jc(){pt(Bs),pt(Kd),pt(Wc)}function kA(c){var h=Ao(Wc.current),_=Ao(Bs.current);h=G(_,c.type,h),_!==h&&(at(Kd,c),at(Bs,h))}function Z0(c){Kd.current===c&&(pt(Bs),pt(Kd))}var nr=Gt(0);function Zm(c){for(var h=c;h!==null;){if(h.tag===13){var _=h.memoizedState;if(_!==null&&(_=_.dehydrated,_===null||qr(_)||eo(_)))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if(h.flags&128)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var J0=[];function ex(){for(var c=0;c<J0.length;c++){var h=J0[c];gt?h._workInProgressVersionPrimary=null:h._workInProgressVersionSecondary=null}J0.length=0}var Jm=a.ReactCurrentDispatcher,zs=a.ReactCurrentBatchConfig,qc=0,cr=null,fi=null,$r=null,eg=!1,Qd=!1,Zd=0,gF=0;function pi(){throw Error(o(321))}function tx(c,h){if(h===null)return!1;for(var _=0;_<h.length&&_<c.length;_++)if(!hs(c[_],h[_]))return!1;return!0}function nx(c,h,_,E,C,k){if(qc=k,cr=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,Jm.current=c===null||c.memoizedState===null?xF:EF,c=_(E,C),Qd){k=0;do{if(Qd=!1,Zd=0,25<=k)throw Error(o(301));k+=1,$r=fi=null,h.updateQueue=null,Jm.current=wF,c=_(E,C)}while(Qd)}if(Jm.current=sg,h=fi!==null&&fi.next!==null,qc=0,$r=fi=cr=null,eg=!1,h)throw Error(o(300));return c}function rx(){var c=Zd!==0;return Zd=0,c}function ra(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $r===null?cr.memoizedState=$r=c:$r=$r.next=c,$r}function Co(){if(fi===null){var c=cr.alternate;c=c!==null?c.memoizedState:null}else c=fi.next;var h=$r===null?cr.memoizedState:$r.next;if(h!==null)$r=h,fi=c;else{if(c===null)throw Error(o(310));fi=c,c={memoizedState:fi.memoizedState,baseState:fi.baseState,baseQueue:fi.baseQueue,queue:fi.queue,next:null},$r===null?cr.memoizedState=$r=c:$r=$r.next=c}return $r}function mu(c,h){return typeof h=="function"?h(c):h}function tg(c){var h=Co(),_=h.queue;if(_===null)throw Error(o(311));_.lastRenderedReducer=c;var E=fi,C=E.baseQueue,k=_.pending;if(k!==null){if(C!==null){var ne=C.next;C.next=k.next,k.next=ne}E.baseQueue=C=k,_.pending=null}if(C!==null){k=C.next,E=E.baseState;var pe=ne=null,Pe=null,it=k;do{var Rt=it.lane;if((qc&Rt)===Rt)Pe!==null&&(Pe=Pe.next={lane:0,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null}),E=it.hasEagerState?it.eagerState:c(E,it.action);else{var on={lane:Rt,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null};Pe===null?(pe=Pe=on,ne=E):Pe=Pe.next=on,cr.lanes|=Rt,$c|=Rt}it=it.next}while(it!==null&&it!==k);Pe===null?ne=E:Pe.next=pe,hs(E,h.memoizedState)||(gs=!0),h.memoizedState=E,h.baseState=ne,h.baseQueue=Pe,_.lastRenderedState=E}if(c=_.interleaved,c!==null){C=c;do k=C.lane,cr.lanes|=k,$c|=k,C=C.next;while(C!==c)}else C===null&&(_.lanes=0);return[h.memoizedState,_.dispatch]}function ng(c){var h=Co(),_=h.queue;if(_===null)throw Error(o(311));_.lastRenderedReducer=c;var E=_.dispatch,C=_.pending,k=h.memoizedState;if(C!==null){_.pending=null;var ne=C=C.next;do k=c(k,ne.action),ne=ne.next;while(ne!==C);hs(k,h.memoizedState)||(gs=!0),h.memoizedState=k,h.baseQueue===null&&(h.baseState=k),_.lastRenderedState=k}return[k,E]}function OA(){}function UA(c,h){var _=cr,E=Co(),C=h(),k=!hs(E.memoizedState,C);if(k&&(E.memoizedState=C,gs=!0),E=E.queue,ef(BA.bind(null,_,E,c),[c]),E.getSnapshot!==h||k||$r!==null&&$r.memoizedState.tag&1){if(_.flags|=2048,Jd(9,VA.bind(null,_,E,C,h),void 0,null),Ir===null)throw Error(o(349));qc&30||FA(_,h,C)}return C}function FA(c,h,_){c.flags|=16384,c={getSnapshot:h,value:_},h=cr.updateQueue,h===null?(h={lastEffect:null,stores:null},cr.updateQueue=h,h.stores=[c]):(_=h.stores,_===null?h.stores=[c]:_.push(c))}function VA(c,h,_,E){h.value=_,h.getSnapshot=E,zA(h)&&Hs(c,1,-1)}function BA(c,h,_){return _(function(){zA(h)&&Hs(c,1,-1)})}function zA(c){var h=c.getSnapshot;c=c.value;try{var _=h();return!hs(c,_)}catch{return!0}}function ix(c){var h=ra();return typeof c=="function"&&(c=c()),h.memoizedState=h.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mu,lastRenderedState:c},h.queue=c,c=c.dispatch=yF.bind(null,cr,c),[h.memoizedState,c]}function Jd(c,h,_,E){return c={tag:c,create:h,destroy:_,deps:E,next:null},h=cr.updateQueue,h===null?(h={lastEffect:null,stores:null},cr.updateQueue=h,h.lastEffect=c.next=c):(_=h.lastEffect,_===null?h.lastEffect=c.next=c:(E=_.next,_.next=c,c.next=E,h.lastEffect=c)),c}function HA(){return Co().memoizedState}function rg(c,h,_,E){var C=ra();cr.flags|=c,C.memoizedState=Jd(1|h,_,void 0,E===void 0?null:E)}function ig(c,h,_,E){var C=Co();E=E===void 0?null:E;var k=void 0;if(fi!==null){var ne=fi.memoizedState;if(k=ne.destroy,E!==null&&tx(E,ne.deps)){C.memoizedState=Jd(h,_,k,E);return}}cr.flags|=c,C.memoizedState=Jd(1|h,_,k,E)}function sx(c,h){return rg(8390656,8,c,h)}function ef(c,h){return ig(2048,8,c,h)}function GA(c,h){return ig(4,2,c,h)}function WA(c,h){return ig(4,4,c,h)}function jA(c,h){if(typeof h=="function")return c=c(),h(c),function(){h(null)};if(h!=null)return c=c(),h.current=c,function(){h.current=null}}function qA(c,h,_){return _=_!=null?_.concat([c]):null,ig(4,4,jA.bind(null,h,c),_)}function ox(){}function XA(c,h){var _=Co();h=h===void 0?null:h;var E=_.memoizedState;return E!==null&&h!==null&&tx(h,E[1])?E[0]:(_.memoizedState=[c,h],c)}function $A(c,h){var _=Co();h=h===void 0?null:h;var E=_.memoizedState;return E!==null&&h!==null&&tx(h,E[1])?E[0]:(c=c(),_.memoizedState=[c,h],c)}function vF(c,h){var _=vn;vn=_!==0&&4>_?_:4,c(!0);var E=zs.transition;zs.transition={};try{c(!1),h()}finally{vn=_,zs.transition=E}}function YA(){return Co().memoizedState}function _F(c,h,_){var E=qa(c);_={lane:E,action:_,hasEagerState:!1,eagerState:null,next:null},KA(c)?QA(h,_):(ZA(c,h,_),_=Oi(),c=Hs(c,E,_),c!==null&&JA(c,h,E))}function yF(c,h,_){var E=qa(c),C={lane:E,action:_,hasEagerState:!1,eagerState:null,next:null};if(KA(c))QA(h,C);else{ZA(c,h,C);var k=c.alternate;if(c.lanes===0&&(k===null||k.lanes===0)&&(k=h.lastRenderedReducer,k!==null))try{var ne=h.lastRenderedState,pe=k(ne,_);if(C.hasEagerState=!0,C.eagerState=pe,hs(pe,ne))return}catch{}finally{}_=Oi(),c=Hs(c,E,_),c!==null&&JA(c,h,E)}}function KA(c){var h=c.alternate;return c===cr||h!==null&&h===cr}function QA(c,h){Qd=eg=!0;var _=c.pending;_===null?h.next=h:(h.next=_.next,_.next=h),c.pending=h}function ZA(c,h,_){Ir!==null&&c.mode&1&&!(pn&2)?(c=h.interleaved,c===null?(_.next=_,hi===null?hi=[h]:hi.push(h)):(_.next=c.next,c.next=_),h.interleaved=_):(c=h.pending,c===null?_.next=_:(_.next=c.next,c.next=_),h.pending=_)}function JA(c,h,_){if(_&4194240){var E=h.lanes;E&=c.pendingLanes,_|=E,h.lanes=_,Ni(c,_)}}var sg={readContext:Li,useCallback:pi,useContext:pi,useEffect:pi,useImperativeHandle:pi,useInsertionEffect:pi,useLayoutEffect:pi,useMemo:pi,useReducer:pi,useRef:pi,useState:pi,useDebugValue:pi,useDeferredValue:pi,useTransition:pi,useMutableSource:pi,useSyncExternalStore:pi,useId:pi,unstable_isNewReconciler:!1},xF={readContext:Li,useCallback:function(c,h){return ra().memoizedState=[c,h===void 0?null:h],c},useContext:Li,useEffect:sx,useImperativeHandle:function(c,h,_){return _=_!=null?_.concat([c]):null,rg(4194308,4,jA.bind(null,h,c),_)},useLayoutEffect:function(c,h){return rg(4194308,4,c,h)},useInsertionEffect:function(c,h){return rg(4,2,c,h)},useMemo:function(c,h){var _=ra();return h=h===void 0?null:h,c=c(),_.memoizedState=[c,h],c},useReducer:function(c,h,_){var E=ra();return h=_!==void 0?_(h):h,E.memoizedState=E.baseState=h,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:h},E.queue=c,c=c.dispatch=_F.bind(null,cr,c),[E.memoizedState,c]},useRef:function(c){var h=ra();return c={current:c},h.memoizedState=c},useState:ix,useDebugValue:ox,useDeferredValue:function(c){var h=ix(c),_=h[0],E=h[1];return sx(function(){var C=zs.transition;zs.transition={};try{E(c)}finally{zs.transition=C}},[c]),_},useTransition:function(){var c=ix(!1),h=c[0];return c=vF.bind(null,c[1]),ra().memoizedState=c,[h,c]},useMutableSource:function(){},useSyncExternalStore:function(c,h,_){var E=cr,C=ra();if(En){if(_===void 0)throw Error(o(407));_=_()}else{if(_=h(),Ir===null)throw Error(o(349));qc&30||FA(E,h,_)}C.memoizedState=_;var k={value:_,getSnapshot:h};return C.queue=k,sx(BA.bind(null,E,k,c),[c]),E.flags|=2048,Jd(9,VA.bind(null,E,k,_,h),void 0,null),_},useId:function(){var c=ra(),h=Ir.identifierPrefix;if(En){var _=nt,E=Te;_=(E&~(1<<32-It(E)-1)).toString(32)+_,h=":"+h+"R"+_,_=Zd++,0<_&&(h+="H"+_.toString(32)),h+=":"}else _=gF++,h=":"+h+"r"+_.toString(32)+":";return c.memoizedState=h},unstable_isNewReconciler:!1},EF={readContext:Li,useCallback:XA,useContext:Li,useEffect:ef,useImperativeHandle:qA,useInsertionEffect:GA,useLayoutEffect:WA,useMemo:$A,useReducer:tg,useRef:HA,useState:function(){return tg(mu)},useDebugValue:ox,useDeferredValue:function(c){var h=tg(mu),_=h[0],E=h[1];return ef(function(){var C=zs.transition;zs.transition={};try{E(c)}finally{zs.transition=C}},[c]),_},useTransition:function(){var c=tg(mu)[0],h=Co().memoizedState;return[c,h]},useMutableSource:OA,useSyncExternalStore:UA,useId:YA,unstable_isNewReconciler:!1},wF={readContext:Li,useCallback:XA,useContext:Li,useEffect:ef,useImperativeHandle:qA,useInsertionEffect:GA,useLayoutEffect:WA,useMemo:$A,useReducer:ng,useRef:HA,useState:function(){return ng(mu)},useDebugValue:ox,useDeferredValue:function(c){var h=ng(mu),_=h[0],E=h[1];return ef(function(){var C=zs.transition;zs.transition={};try{E(c)}finally{zs.transition=C}},[c]),_},useTransition:function(){var c=ng(mu)[0],h=Co().memoizedState;return[c,h]},useMutableSource:OA,useSyncExternalStore:UA,useId:YA,unstable_isNewReconciler:!1};function ax(c,h){try{var _="",E=h;do _+=Km(E),E=E.return;while(E);var C=_}catch(k){C=`
Error generating stack: `+k.message+`
`+k.stack}return{value:c,source:h,stack:C}}function lx(c,h){try{console.error(h.value)}catch(_){setTimeout(function(){throw _})}}var SF=typeof WeakMap=="function"?WeakMap:Map;function eC(c,h,_){_=ps(-1,_),_.tag=3,_.payload={element:null};var E=h.value;return _.callback=function(){Eg||(Eg=!0,Ax=E),lx(c,h)},_}function tC(c,h,_){_=ps(-1,_),_.tag=3;var E=c.type.getDerivedStateFromError;if(typeof E=="function"){var C=h.value;_.payload=function(){return E(C)},_.callback=function(){lx(c,h)}}var k=c.stateNode;return k!==null&&typeof k.componentDidCatch=="function"&&(_.callback=function(){lx(c,h),typeof E!="function"&&(Wa===null?Wa=new Set([this]):Wa.add(this));var ne=h.stack;this.componentDidCatch(h.value,{componentStack:ne!==null?ne:""})}),_}function nC(c,h,_){var E=c.pingCache;if(E===null){E=c.pingCache=new SF;var C=new Set;E.set(h,C)}else C=E.get(h),C===void 0&&(C=new Set,E.set(h,C));C.has(_)||(C.add(_),c=UF.bind(null,c,h,_),h.then(c,c))}function rC(c){do{var h;if((h=c.tag===13)&&(h=c.memoizedState,h=h!==null?h.dehydrated!==null:!0),h)return c;c=c.return}while(c!==null);return null}function iC(c,h,_,E,C){return c.mode&1?(c.flags|=65536,c.lanes=C,c):(c===h?c.flags|=65536:(c.flags|=128,_.flags|=131072,_.flags&=-52805,_.tag===1&&(_.alternate===null?_.tag=17:(h=ps(-1,1),h.tag=2,no(_,h))),_.lanes|=1),c)}function Io(c){c.flags|=4}function sC(c,h){if(c!==null&&c.child===h.child)return!0;if(h.flags&16)return!1;for(c=h.child;c!==null;){if(c.flags&12854||c.subtreeFlags&12854)return!1;c=c.sibling}return!0}var tf,nf,og,ag;if(vt)tf=function(c,h){for(var _=h.child;_!==null;){if(_.tag===5||_.tag===6)de(c,_.stateNode);else if(_.tag!==4&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===h)break;for(;_.sibling===null;){if(_.return===null||_.return===h)return;_=_.return}_.sibling.return=_.return,_=_.sibling}},nf=function(){},og=function(c,h,_,E,C){if(c=c.memoizedProps,c!==E){var k=h.stateNode,ne=Ao(Bs.current);_=Ee(k,_,c,E,C,ne),(h.updateQueue=_)&&Io(h)}},ag=function(c,h,_,E){_!==E&&Io(h)};else if(ie){tf=function(c,h,_,E){for(var C=h.child;C!==null;){if(C.tag===5){var k=C.stateNode;_&&E&&(k=sn(k,C.type,C.memoizedProps,C)),de(c,k)}else if(C.tag===6)k=C.stateNode,_&&E&&(k=gn(k,C.memoizedProps,C)),de(c,k);else if(C.tag!==4){if(C.tag===22&&C.memoizedState!==null)k=C.child,k!==null&&(k.return=C),tf(c,C,!0,!0);else if(C.child!==null){C.child.return=C,C=C.child;continue}}if(C===h)break;for(;C.sibling===null;){if(C.return===null||C.return===h)return;C=C.return}C.sibling.return=C.return,C=C.sibling}};var oC=function(c,h,_,E){for(var C=h.child;C!==null;){if(C.tag===5){var k=C.stateNode;_&&E&&(k=sn(k,C.type,C.memoizedProps,C)),ot(c,k)}else if(C.tag===6)k=C.stateNode,_&&E&&(k=gn(k,C.memoizedProps,C)),ot(c,k);else if(C.tag!==4){if(C.tag===22&&C.memoizedState!==null)k=C.child,k!==null&&(k.return=C),oC(c,C,!0,!0);else if(C.child!==null){C.child.return=C,C=C.child;continue}}if(C===h)break;for(;C.sibling===null;){if(C.return===null||C.return===h)return;C=C.return}C.sibling.return=C.return,C=C.sibling}};nf=function(c,h){var _=h.stateNode;if(!sC(c,h)){c=_.containerInfo;var E=Ze(c);oC(E,h,!1,!1),_.pendingChildren=E,Io(h),$t(c,E)}},og=function(c,h,_,E,C){var k=c.stateNode,ne=c.memoizedProps;if((c=sC(c,h))&&ne===E)h.stateNode=k;else{var pe=h.stateNode,Pe=Ao(Bs.current),it=null;ne!==E&&(it=Ee(pe,_,ne,E,C,Pe)),c&&it===null?h.stateNode=k:(k=Ke(k,it,_,ne,E,h,c,pe),ue(k,_,E,C,Pe)&&Io(h),h.stateNode=k,c?Io(h):tf(k,h,!1,!1))}},ag=function(c,h,_,E){_!==E?(c=Ao(Wc.current),_=Ao(Bs.current),h.stateNode=ke(E,c,_,h),Io(h)):h.stateNode=c.stateNode}}else nf=function(){},og=function(){},ag=function(){};function rf(c,h){if(!En)switch(c.tailMode){case"hidden":h=c.tail;for(var _=null;h!==null;)h.alternate!==null&&(_=h),h=h.sibling;_===null?c.tail=null:_.sibling=null;break;case"collapsed":_=c.tail;for(var E=null;_!==null;)_.alternate!==null&&(E=_),_=_.sibling;E===null?h||c.tail===null?c.tail=null:c.tail.sibling=null:E.sibling=null}}function mi(c){var h=c.alternate!==null&&c.alternate.child===c.child,_=0,E=0;if(h)for(var C=c.child;C!==null;)_|=C.lanes|C.childLanes,E|=C.subtreeFlags&14680064,E|=C.flags&14680064,C.return=c,C=C.sibling;else for(C=c.child;C!==null;)_|=C.lanes|C.childLanes,E|=C.subtreeFlags,E|=C.flags,C.return=c,C=C.sibling;return c.subtreeFlags|=E,c.childLanes=_,h}function TF(c,h,_){var E=h.pendingProps;switch(Ar(h),h.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mi(h),null;case 1:return ge(h.type)&&Le(),mi(h),null;case 3:return E=h.stateNode,jc(),pt(Wt),pt(kt),ex(),E.pendingContext&&(E.context=E.pendingContext,E.pendingContext=null),(c===null||c.child===null)&&(Xd(h)?Io(h):c===null||c.memoizedState.isDehydrated&&!(h.flags&256)||(h.flags|=1024,Di!==null&&(bx(Di),Di=null))),nf(c,h),mi(h),null;case 5:Z0(h),_=Ao(Wc.current);var C=h.type;if(c!==null&&h.stateNode!=null)og(c,h,C,E,_),c.ref!==h.ref&&(h.flags|=512,h.flags|=2097152);else{if(!E){if(h.stateNode===null)throw Error(o(166));return mi(h),null}if(c=Ao(Bs.current),Xd(h)){if(!Be)throw Error(o(175));c=V(h.stateNode,h.type,h.memoizedProps,_,c,h,!Mo),h.updateQueue=c,c!==null&&Io(h)}else{var k=ce(C,E,_,c,h);tf(k,h,!1,!1),h.stateNode=k,ue(k,C,E,_,c)&&Io(h)}h.ref!==null&&(h.flags|=512,h.flags|=2097152)}return mi(h),null;case 6:if(c&&h.stateNode!=null)ag(c,h,c.memoizedProps,E);else{if(typeof E!="string"&&h.stateNode===null)throw Error(o(166));if(c=Ao(Wc.current),_=Ao(Bs.current),Xd(h)){if(!Be)throw Error(o(176));if(c=h.stateNode,E=h.memoizedProps,(_=X(c,E,h,!Mo))&&(C=On,C!==null))switch(k=(C.mode&1)!==0,C.tag){case 3:Me(C.stateNode.containerInfo,c,E,k);break;case 5:Re(C.type,C.memoizedProps,C.stateNode,c,E,k)}_&&Io(h)}else h.stateNode=ke(E,c,_,h)}return mi(h),null;case 13:if(pt(nr),E=h.memoizedState,En&&Cr!==null&&h.mode&1&&!(h.flags&128)){for(c=Cr;c;)c=tr(c);return Hc(),h.flags|=98560,h}if(E!==null&&E.dehydrated!==null){if(E=Xd(h),c===null){if(!E)throw Error(o(318));if(!Be)throw Error(o(344));if(c=h.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(o(317));le(c,h)}else Hc(),!(h.flags&128)&&(h.memoizedState=null),h.flags|=4;return mi(h),null}return Di!==null&&(bx(Di),Di=null),h.flags&128?(h.lanes=_,h):(E=E!==null,_=!1,c===null?Xd(h):_=c.memoizedState!==null,E&&!_&&(h.child.flags|=8192,h.mode&1&&(c===null||nr.current&1?Br===0&&(Br=3):Px())),h.updateQueue!==null&&(h.flags|=4),mi(h),null);case 4:return jc(),nf(c,h),c===null&&We(h.stateNode.containerInfo),mi(h),null;case 10:return Uc(h.type._context),mi(h),null;case 17:return ge(h.type)&&Le(),mi(h),null;case 19:if(pt(nr),C=h.memoizedState,C===null)return mi(h),null;if(E=(h.flags&128)!==0,k=C.rendering,k===null)if(E)rf(C,!1);else{if(Br!==0||c!==null&&c.flags&128)for(c=h.child;c!==null;){if(k=Zm(c),k!==null){for(h.flags|=128,rf(C,!1),c=k.updateQueue,c!==null&&(h.updateQueue=c,h.flags|=4),h.subtreeFlags=0,c=_,E=h.child;E!==null;)_=E,C=c,_.flags&=14680066,k=_.alternate,k===null?(_.childLanes=0,_.lanes=C,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=k.childLanes,_.lanes=k.lanes,_.child=k.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=k.memoizedProps,_.memoizedState=k.memoizedState,_.updateQueue=k.updateQueue,_.type=k.type,C=k.dependencies,_.dependencies=C===null?null:{lanes:C.lanes,firstContext:C.firstContext}),E=E.sibling;return at(nr,nr.current&1|2),h.child}c=c.sibling}C.tail!==null&&Tr()>Mx&&(h.flags|=128,E=!0,rf(C,!1),h.lanes=4194304)}else{if(!E)if(c=Zm(k),c!==null){if(h.flags|=128,E=!0,c=c.updateQueue,c!==null&&(h.updateQueue=c,h.flags|=4),rf(C,!0),C.tail===null&&C.tailMode==="hidden"&&!k.alternate&&!En)return mi(h),null}else 2*Tr()-C.renderingStartTime>Mx&&_!==1073741824&&(h.flags|=128,E=!0,rf(C,!1),h.lanes=4194304);C.isBackwards?(k.sibling=h.child,h.child=k):(c=C.last,c!==null?c.sibling=k:h.child=k,C.last=k)}return C.tail!==null?(h=C.tail,C.rendering=h,C.tail=h.sibling,C.renderingStartTime=Tr(),h.sibling=null,c=nr.current,at(nr,E?c&1|2:c&1),h):(mi(h),null);case 22:case 23:return Rx(),E=h.memoizedState!==null,c!==null&&c.memoizedState!==null!==E&&(h.flags|=8192),E&&h.mode&1?vs&1073741824&&(mi(h),vt&&h.subtreeFlags&6&&(h.flags|=8192)):mi(h),null;case 24:return null;case 25:return null}throw Error(o(156,h.tag))}var MF=a.ReactCurrentOwner,gs=!1;function ki(c,h,_,E){h.child=c===null?DA(h,null,_,E):Gc(h,c.child,_,E)}function aC(c,h,_,E,C){_=_.render;var k=h.ref;return Ga(h,C),E=nx(c,h,_,E,k,C),_=rx(),c!==null&&!gs?(h.updateQueue=c.updateQueue,h.flags&=-2053,c.lanes&=~C,ia(c,h,C)):(En&&_&&xn(h),h.flags|=1,ki(c,h,E,C),h.child)}function lC(c,h,_,E,C){if(c===null){var k=_.type;return typeof k=="function"&&!Nx(k)&&k.defaultProps===void 0&&_.compare===null&&_.defaultProps===void 0?(h.tag=15,h.type=k,uC(c,h,k,E,C)):(c=Ig(_.type,null,E,h,h.mode,C),c.ref=h.ref,c.return=h,h.child=c)}if(k=c.child,!(c.lanes&C)){var ne=k.memoizedProps;if(_=_.compare,_=_!==null?_:ea,_(ne,E)&&c.ref===h.ref)return ia(c,h,C)}return h.flags|=1,c=$a(k,E),c.ref=h.ref,c.return=h,h.child=c}function uC(c,h,_,E,C){if(c!==null&&ea(c.memoizedProps,E)&&c.ref===h.ref)if(gs=!1,(c.lanes&C)!==0)c.flags&131072&&(gs=!0);else return h.lanes=c.lanes,ia(c,h,C);return ux(c,h,_,E,C)}function cC(c,h,_){var E=h.pendingProps,C=E.children,k=c!==null?c.memoizedState:null;if(E.mode==="hidden")if(!(h.mode&1))h.memoizedState={baseLanes:0,cachePool:null},at(Xc,vs),vs|=_;else if(_&1073741824)h.memoizedState={baseLanes:0,cachePool:null},E=k!==null?k.baseLanes:_,at(Xc,vs),vs|=E;else return c=k!==null?k.baseLanes|_:_,h.lanes=h.childLanes=1073741824,h.memoizedState={baseLanes:c,cachePool:null},h.updateQueue=null,at(Xc,vs),vs|=c,null;else k!==null?(E=k.baseLanes|_,h.memoizedState=null):E=_,at(Xc,vs),vs|=E;return ki(c,h,C,_),h.child}function hC(c,h){var _=h.ref;(c===null&&_!==null||c!==null&&c.ref!==_)&&(h.flags|=512,h.flags|=2097152)}function ux(c,h,_,E,C){var k=ge(_)?Mn:kt.current;return k=oe(h,k),Ga(h,C),_=nx(c,h,_,E,k,C),E=rx(),c!==null&&!gs?(h.updateQueue=c.updateQueue,h.flags&=-2053,c.lanes&=~C,ia(c,h,C)):(En&&E&&xn(h),h.flags|=1,ki(c,h,_,C),h.child)}function dC(c,h,_,E,C){if(ge(_)){var k=!0;rt(h)}else k=!1;if(Ga(h,C),h.stateNode===null)c!==null&&(c.alternate=null,h.alternate=null,h.flags|=2),pu(h,_,E),zc(h,_,E,C),E=!0;else if(c===null){var ne=h.stateNode,pe=h.memoizedProps;ne.props=pe;var Pe=ne.context,it=_.contextType;typeof it=="object"&&it!==null?it=Li(it):(it=ge(_)?Mn:kt.current,it=oe(h,it));var Rt=_.getDerivedStateFromProps,on=typeof Rt=="function"||typeof ne.getSnapshotBeforeUpdate=="function";on||typeof ne.UNSAFE_componentWillReceiveProps!="function"&&typeof ne.componentWillReceiveProps!="function"||(pe!==E||Pe!==it)&&di(h,ne,E,it),to=!1;var qt=h.memoizedState;ne.state=qt,du(h,E,ne,C),Pe=h.memoizedState,pe!==E||qt!==Pe||Wt.current||to?(typeof Rt=="function"&&(Bc(h,_,Rt,E),Pe=h.memoizedState),(pe=to||qd(h,_,pe,E,qt,Pe,it))?(on||typeof ne.UNSAFE_componentWillMount!="function"&&typeof ne.componentWillMount!="function"||(typeof ne.componentWillMount=="function"&&ne.componentWillMount(),typeof ne.UNSAFE_componentWillMount=="function"&&ne.UNSAFE_componentWillMount()),typeof ne.componentDidMount=="function"&&(h.flags|=4194308)):(typeof ne.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=E,h.memoizedState=Pe),ne.props=E,ne.state=Pe,ne.context=it,E=pe):(typeof ne.componentDidMount=="function"&&(h.flags|=4194308),E=!1)}else{ne=h.stateNode,Vc(c,h),pe=h.memoizedProps,it=h.type===h.elementType?pe:vr(h.type,pe),ne.props=it,on=h.pendingProps,qt=ne.context,Pe=_.contextType,typeof Pe=="object"&&Pe!==null?Pe=Li(Pe):(Pe=ge(_)?Mn:kt.current,Pe=oe(h,Pe));var Wn=_.getDerivedStateFromProps;(Rt=typeof Wn=="function"||typeof ne.getSnapshotBeforeUpdate=="function")||typeof ne.UNSAFE_componentWillReceiveProps!="function"&&typeof ne.componentWillReceiveProps!="function"||(pe!==on||qt!==Pe)&&di(h,ne,E,Pe),to=!1,qt=h.memoizedState,ne.state=qt,du(h,E,ne,C);var Ft=h.memoizedState;pe!==on||qt!==Ft||Wt.current||to?(typeof Wn=="function"&&(Bc(h,_,Wn,E),Ft=h.memoizedState),(it=to||qd(h,_,it,E,qt,Ft,Pe)||!1)?(Rt||typeof ne.UNSAFE_componentWillUpdate!="function"&&typeof ne.componentWillUpdate!="function"||(typeof ne.componentWillUpdate=="function"&&ne.componentWillUpdate(E,Ft,Pe),typeof ne.UNSAFE_componentWillUpdate=="function"&&ne.UNSAFE_componentWillUpdate(E,Ft,Pe)),typeof ne.componentDidUpdate=="function"&&(h.flags|=4),typeof ne.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof ne.componentDidUpdate!="function"||pe===c.memoizedProps&&qt===c.memoizedState||(h.flags|=4),typeof ne.getSnapshotBeforeUpdate!="function"||pe===c.memoizedProps&&qt===c.memoizedState||(h.flags|=1024),h.memoizedProps=E,h.memoizedState=Ft),ne.props=E,ne.state=Ft,ne.context=Pe,E=it):(typeof ne.componentDidUpdate!="function"||pe===c.memoizedProps&&qt===c.memoizedState||(h.flags|=4),typeof ne.getSnapshotBeforeUpdate!="function"||pe===c.memoizedProps&&qt===c.memoizedState||(h.flags|=1024),E=!1)}return cx(c,h,_,E,k,C)}function cx(c,h,_,E,C,k){hC(c,h);var ne=(h.flags&128)!==0;if(!E&&!ne)return C&&et(h,_,!1),ia(c,h,k);E=h.stateNode,MF.current=h;var pe=ne&&typeof _.getDerivedStateFromError!="function"?null:E.render();return h.flags|=1,c!==null&&ne?(h.child=Gc(h,c.child,null,k),h.child=Gc(h,null,pe,k)):ki(c,h,pe,k),h.memoizedState=E.state,C&&et(h,_,!0),h.child}function fC(c){var h=c.stateNode;h.pendingContext?qe(c,h.pendingContext,h.pendingContext!==h.context):h.context&&qe(c,h.context,!1),Q0(c,h.containerInfo)}function pC(c,h,_,E,C){return Hc(),K0(C),h.flags|=256,ki(c,h,_,E),h.child}var lg={dehydrated:null,treeContext:null,retryLane:0};function ug(c){return{baseLanes:c,cachePool:null}}function mC(c,h,_){var E=h.pendingProps,C=nr.current,k=!1,ne=(h.flags&128)!==0,pe;if((pe=ne)||(pe=c!==null&&c.memoizedState===null?!1:(C&2)!==0),pe?(k=!0,h.flags&=-129):(c===null||c.memoizedState!==null)&&(C|=1),at(nr,C&1),c===null)return Y0(h),c=h.memoizedState,c!==null&&(c=c.dehydrated,c!==null)?(h.mode&1?eo(c)?h.lanes=8:h.lanes=1073741824:h.lanes=1,null):(C=E.children,c=E.fallback,k?(E=h.mode,k=h.child,C={mode:"hidden",children:C},!(E&1)&&k!==null?(k.childLanes=0,k.pendingProps=C):k=bg(C,E,0,null),c=Eu(c,E,_,null),k.return=h,c.return=h,k.sibling=c,h.child=k,h.child.memoizedState=ug(_),h.memoizedState=lg,c):hx(h,C));if(C=c.memoizedState,C!==null){if(pe=C.dehydrated,pe!==null){if(ne)return h.flags&256?(h.flags&=-257,cg(c,h,_,Error(o(422)))):h.memoizedState!==null?(h.child=c.child,h.flags|=128,null):(k=E.fallback,C=h.mode,E=bg({mode:"visible",children:E.children},C,0,null),k=Eu(k,C,_,null),k.flags|=2,E.return=h,k.return=h,E.sibling=k,h.child=E,h.mode&1&&Gc(h,c.child,null,_),h.child.memoizedState=ug(_),h.memoizedState=lg,k);if(!(h.mode&1))h=cg(c,h,_,null);else if(eo(pe))h=cg(c,h,_,Error(o(419)));else if(E=(_&c.childLanes)!==0,gs||E){if(E=Ir,E!==null){switch(_&-_){case 4:k=2;break;case 16:k=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:k=32;break;case 536870912:k=268435456;break;default:k=0}E=k&(E.suspendedLanes|_)?0:k,E!==0&&E!==C.retryLane&&(C.retryLane=E,Hs(c,E,-1))}Px(),h=cg(c,h,_,Error(o(421)))}else qr(pe)?(h.flags|=128,h.child=c.child,h=FF.bind(null,c),ci(pe,h),h=null):(_=C.treeContext,Be&&(Cr=us(pe),On=h,En=!0,Di=null,Mo=!1,_!==null&&(D[j++]=Te,D[j++]=nt,D[j++]=ve,Te=_.id,nt=_.overflow,ve=h)),h=hx(h,h.pendingProps.children),h.flags|=4096);return h}return k?(E=vC(c,h,E.children,E.fallback,_),k=h.child,C=c.child.memoizedState,k.memoizedState=C===null?ug(_):{baseLanes:C.baseLanes|_,cachePool:null},k.childLanes=c.childLanes&~_,h.memoizedState=lg,E):(_=gC(c,h,E.children,_),h.memoizedState=null,_)}return k?(E=vC(c,h,E.children,E.fallback,_),k=h.child,C=c.child.memoizedState,k.memoizedState=C===null?ug(_):{baseLanes:C.baseLanes|_,cachePool:null},k.childLanes=c.childLanes&~_,h.memoizedState=lg,E):(_=gC(c,h,E.children,_),h.memoizedState=null,_)}function hx(c,h){return h=bg({mode:"visible",children:h},c.mode,0,null),h.return=c,c.child=h}function gC(c,h,_,E){var C=c.child;return c=C.sibling,_=$a(C,{mode:"visible",children:_}),!(h.mode&1)&&(_.lanes=E),_.return=h,_.sibling=null,c!==null&&(E=h.deletions,E===null?(h.deletions=[c],h.flags|=16):E.push(c)),h.child=_}function vC(c,h,_,E,C){var k=h.mode;c=c.child;var ne=c.sibling,pe={mode:"hidden",children:_};return!(k&1)&&h.child!==c?(_=h.child,_.childLanes=0,_.pendingProps=pe,h.deletions=null):(_=$a(c,pe),_.subtreeFlags=c.subtreeFlags&14680064),ne!==null?E=$a(ne,E):(E=Eu(E,k,C,null),E.flags|=2),E.return=h,_.return=h,_.sibling=E,h.child=_,E}function cg(c,h,_,E){return E!==null&&K0(E),Gc(h,c.child,null,_),c=hx(h,h.pendingProps.children),c.flags|=2,h.memoizedState=null,c}function _C(c,h,_){c.lanes|=h;var E=c.alternate;E!==null&&(E.lanes|=h),Ha(c.return,h,_)}function dx(c,h,_,E,C){var k=c.memoizedState;k===null?c.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:E,tail:_,tailMode:C}:(k.isBackwards=h,k.rendering=null,k.renderingStartTime=0,k.last=E,k.tail=_,k.tailMode=C)}function yC(c,h,_){var E=h.pendingProps,C=E.revealOrder,k=E.tail;if(ki(c,h,E.children,_),E=nr.current,E&2)E=E&1|2,h.flags|=128;else{if(c!==null&&c.flags&128)e:for(c=h.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&_C(c,_,h);else if(c.tag===19)_C(c,_,h);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===h)break e;for(;c.sibling===null;){if(c.return===null||c.return===h)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}E&=1}if(at(nr,E),!(h.mode&1))h.memoizedState=null;else switch(C){case"forwards":for(_=h.child,C=null;_!==null;)c=_.alternate,c!==null&&Zm(c)===null&&(C=_),_=_.sibling;_=C,_===null?(C=h.child,h.child=null):(C=_.sibling,_.sibling=null),dx(h,!1,C,_,k);break;case"backwards":for(_=null,C=h.child,h.child=null;C!==null;){if(c=C.alternate,c!==null&&Zm(c)===null){h.child=C;break}c=C.sibling,C.sibling=_,_=C,C=c}dx(h,!0,_,null,k);break;case"together":dx(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function ia(c,h,_){if(c!==null&&(h.dependencies=c.dependencies),$c|=h.lanes,!(_&h.childLanes))return null;if(c!==null&&h.child!==c.child)throw Error(o(153));if(h.child!==null){for(c=h.child,_=$a(c,c.pendingProps),h.child=_,_.return=h;c.sibling!==null;)c=c.sibling,_=_.sibling=$a(c,c.pendingProps),_.return=h;_.sibling=null}return h.child}function AF(c,h,_){switch(h.tag){case 3:fC(h),Hc();break;case 5:kA(h);break;case 1:ge(h.type)&&rt(h);break;case 4:Q0(h,h.stateNode.containerInfo);break;case 10:hu(h,h.type._context,h.memoizedProps.value);break;case 13:var E=h.memoizedState;if(E!==null)return E.dehydrated!==null?(at(nr,nr.current&1),h.flags|=128,null):_&h.child.childLanes?mC(c,h,_):(at(nr,nr.current&1),c=ia(c,h,_),c!==null?c.sibling:null);at(nr,nr.current&1);break;case 19:if(E=(_&h.childLanes)!==0,c.flags&128){if(E)return yC(c,h,_);h.flags|=128}var C=h.memoizedState;if(C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),at(nr,nr.current),E)break;return null;case 22:case 23:return h.lanes=0,cC(c,h,_)}return ia(c,h,_)}function CF(c,h){switch(Ar(h),h.tag){case 1:return ge(h.type)&&Le(),c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 3:return jc(),pt(Wt),pt(kt),ex(),c=h.flags,c&65536&&!(c&128)?(h.flags=c&-65537|128,h):null;case 5:return Z0(h),null;case 13:if(pt(nr),c=h.memoizedState,c!==null&&c.dehydrated!==null){if(h.alternate===null)throw Error(o(340));Hc()}return c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 19:return pt(nr),null;case 4:return jc(),null;case 10:return Uc(h.type._context),null;case 22:case 23:return Rx(),null;case 24:return null;default:return null}}var hg=!1,gu=!1,IF=typeof WeakSet=="function"?WeakSet:Set,wt=null;function dg(c,h){var _=c.ref;if(_!==null)if(typeof _=="function")try{_(null)}catch(E){Ji(c,h,E)}else _.current=null}function fx(c,h,_){try{_()}catch(E){Ji(c,h,E)}}var xC=!1;function bF(c,h){for(Z(c.containerInfo),wt=h;wt!==null;)if(c=wt,h=c.child,(c.subtreeFlags&1028)!==0&&h!==null)h.return=c,wt=h;else for(;wt!==null;){c=wt;try{var _=c.alternate;if(c.flags&1024)switch(c.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var E=_.memoizedProps,C=_.memoizedState,k=c.stateNode,ne=k.getSnapshotBeforeUpdate(c.elementType===c.type?E:vr(c.type,E),C);k.__reactInternalSnapshotBeforeUpdate=ne}break;case 3:vt&&Ne(c.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(pe){Ji(c,c.return,pe)}if(h=c.sibling,h!==null){h.return=c.return,wt=h;break}wt=c.return}return _=xC,xC=!1,_}function vu(c,h,_){var E=h.updateQueue;if(E=E!==null?E.lastEffect:null,E!==null){var C=E=E.next;do{if((C.tag&c)===c){var k=C.destroy;C.destroy=void 0,k!==void 0&&fx(h,_,k)}C=C.next}while(C!==E)}}function sf(c,h){if(h=h.updateQueue,h=h!==null?h.lastEffect:null,h!==null){var _=h=h.next;do{if((_.tag&c)===c){var E=_.create;_.destroy=E()}_=_.next}while(_!==h)}}function px(c){var h=c.ref;if(h!==null){var _=c.stateNode;switch(c.tag){case 5:c=te(_);break;default:c=_}typeof h=="function"?h(c):h.current=c}}function EC(c,h,_){if(cs&&typeof cs.onCommitFiberUnmount=="function")try{cs.onCommitFiberUnmount(Jo,h)}catch{}switch(h.tag){case 0:case 11:case 14:case 15:if(c=h.updateQueue,c!==null&&(c=c.lastEffect,c!==null)){var E=c=c.next;do{var C=E,k=C.destroy;C=C.tag,k!==void 0&&(C&2||C&4)&&fx(h,_,k),E=E.next}while(E!==c)}break;case 1:if(dg(h,_),c=h.stateNode,typeof c.componentWillUnmount=="function")try{c.props=h.memoizedProps,c.state=h.memoizedState,c.componentWillUnmount()}catch(ne){Ji(h,_,ne)}break;case 5:dg(h,_);break;case 4:vt?CC(c,h,_):ie&&ie&&(h=h.stateNode.containerInfo,_=Ze(h),rn(h,_))}}function wC(c,h,_){for(var E=h;;)if(EC(c,E,_),E.child===null||vt&&E.tag===4){if(E===h)break;for(;E.sibling===null;){if(E.return===null||E.return===h)return;E=E.return}E.sibling.return=E.return,E=E.sibling}else E.child.return=E,E=E.child}function SC(c){var h=c.alternate;h!==null&&(c.alternate=null,SC(h)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(h=c.stateNode,h!==null&&At(h)),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function TC(c){return c.tag===5||c.tag===3||c.tag===4}function MC(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||TC(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function AC(c){if(vt){e:{for(var h=c.return;h!==null;){if(TC(h))break e;h=h.return}throw Error(o(160))}var _=h;switch(_.tag){case 5:h=_.stateNode,_.flags&32&&(Se(h),_.flags&=-33),_=MC(c),gx(c,_,h);break;case 3:case 4:h=_.stateNode.containerInfo,_=MC(c),mx(c,_,h);break;default:throw Error(o(161))}}}function mx(c,h,_){var E=c.tag;if(E===5||E===6)c=c.stateNode,h?ct(_,c,h):Nt(_,c);else if(E!==4&&(c=c.child,c!==null))for(mx(c,h,_),c=c.sibling;c!==null;)mx(c,h,_),c=c.sibling}function gx(c,h,_){var E=c.tag;if(E===5||E===6)c=c.stateNode,h?xt(_,c,h):lt(_,c);else if(E!==4&&(c=c.child,c!==null))for(gx(c,h,_),c=c.sibling;c!==null;)gx(c,h,_),c=c.sibling}function CC(c,h,_){for(var E=h,C=!1,k,ne;;){if(!C){C=E.return;e:for(;;){if(C===null)throw Error(o(160));switch(k=C.stateNode,C.tag){case 5:ne=!1;break e;case 3:k=k.containerInfo,ne=!0;break e;case 4:k=k.containerInfo,ne=!0;break e}C=C.return}C=!0}if(E.tag===5||E.tag===6)wC(c,E,_),ne?ae(k,E.stateNode):ft(k,E.stateNode);else if(E.tag===18)ne?re(k,E.stateNode):se(k,E.stateNode);else if(E.tag===4){if(E.child!==null){k=E.stateNode.containerInfo,ne=!0,E.child.return=E,E=E.child;continue}}else if(EC(c,E,_),E.child!==null){E.child.return=E,E=E.child;continue}if(E===h)break;for(;E.sibling===null;){if(E.return===null||E.return===h)return;E=E.return,E.tag===4&&(C=!1)}E.sibling.return=E.return,E=E.sibling}}function vx(c,h){if(vt){switch(h.tag){case 0:case 11:case 14:case 15:vu(3,h,h.return),sf(3,h),vu(5,h,h.return);return;case 1:return;case 5:var _=h.stateNode;if(_!=null){var E=h.memoizedProps;c=c!==null?c.memoizedProps:E;var C=h.type,k=h.updateQueue;h.updateQueue=null,k!==null&&Ht(_,k,C,c,E,h)}return;case 6:if(h.stateNode===null)throw Error(o(162));_=h.memoizedProps,He(h.stateNode,c!==null?c.memoizedProps:_,_);return;case 3:Be&&c!==null&&c.memoizedState.isDehydrated&&Y(h.stateNode.containerInfo);return;case 12:return;case 13:fg(h);return;case 19:fg(h);return;case 17:return}throw Error(o(163))}switch(h.tag){case 0:case 11:case 14:case 15:vu(3,h,h.return),sf(3,h),vu(5,h,h.return);return;case 12:return;case 13:fg(h);return;case 19:fg(h);return;case 3:Be&&c!==null&&c.memoizedState.isDehydrated&&Y(h.stateNode.containerInfo);break;case 22:case 23:return}e:if(ie){switch(h.tag){case 1:case 5:case 6:break e;case 3:case 4:h=h.stateNode,rn(h.containerInfo,h.pendingChildren);break e}throw Error(o(163))}}function fg(c){var h=c.updateQueue;if(h!==null){c.updateQueue=null;var _=c.stateNode;_===null&&(_=c.stateNode=new IF),h.forEach(function(E){var C=VF.bind(null,c,E);_.has(E)||(_.add(E),E.then(C,C))})}}function RF(c,h){for(wt=h;wt!==null;){h=wt;var _=h.deletions;if(_!==null)for(var E=0;E<_.length;E++){var C=_[E];try{var k=c;vt?CC(k,C,h):wC(k,C,h);var ne=C.alternate;ne!==null&&(ne.return=null),C.return=null}catch(Ot){Ji(C,h,Ot)}}if(_=h.child,h.subtreeFlags&12854&&_!==null)_.return=h,wt=_;else for(;wt!==null;){h=wt;try{var pe=h.flags;if(pe&32&&vt&&Se(h.stateNode),pe&512){var Pe=h.alternate;if(Pe!==null){var it=Pe.ref;it!==null&&(typeof it=="function"?it(null):it.current=null)}}if(pe&8192)switch(h.tag){case 13:if(h.memoizedState!==null){var Rt=h.alternate;(Rt===null||Rt.memoizedState===null)&&(Tx=Tr())}break;case 22:var on=h.memoizedState!==null,qt=h.alternate,Wn=qt!==null&&qt.memoizedState!==null;if(_=h,vt){e:if(E=_,C=on,k=null,vt)for(var Ft=E;;){if(Ft.tag===5){if(k===null){k=Ft;var gi=Ft.stateNode;C?Je(gi):q(Ft.stateNode,Ft.memoizedProps)}}else if(Ft.tag===6){if(k===null){var Ws=Ft.stateNode;C?ut(Ws):J(Ws,Ft.memoizedProps)}}else if((Ft.tag!==22&&Ft.tag!==23||Ft.memoizedState===null||Ft===E)&&Ft.child!==null){Ft.child.return=Ft,Ft=Ft.child;continue}if(Ft===E)break;for(;Ft.sibling===null;){if(Ft.return===null||Ft.return===E)break e;k===Ft&&(k=null),Ft=Ft.return}k===Ft&&(k=null),Ft.sibling.return=Ft.return,Ft=Ft.sibling}}if(on&&!Wn&&_.mode&1){wt=_;for(var we=_.child;we!==null;){for(_=wt=we;wt!==null;){E=wt;var me=E.child;switch(E.tag){case 0:case 11:case 14:case 15:vu(4,E,E.return);break;case 1:dg(E,E.return);var Ie=E.stateNode;if(typeof Ie.componentWillUnmount=="function"){var St=E.return;try{Ie.props=E.memoizedProps,Ie.state=E.memoizedState,Ie.componentWillUnmount()}catch(Ot){Ji(E,St,Ot)}}break;case 5:dg(E,E.return);break;case 22:if(E.memoizedState!==null){RC(_);continue}}me!==null?(me.return=E,wt=me):RC(_)}we=we.sibling}}}switch(pe&4102){case 2:AC(h),h.flags&=-3;break;case 6:AC(h),h.flags&=-3,vx(h.alternate,h);break;case 4096:h.flags&=-4097;break;case 4100:h.flags&=-4097,vx(h.alternate,h);break;case 4:vx(h.alternate,h)}}catch(Ot){Ji(h,h.return,Ot)}if(_=h.sibling,_!==null){_.return=h.return,wt=_;break}wt=h.return}}}function PF(c,h,_){wt=c,IC(c)}function IC(c,h,_){for(var E=(c.mode&1)!==0;wt!==null;){var C=wt,k=C.child;if(C.tag===22&&E){var ne=C.memoizedState!==null||hg;if(!ne){var pe=C.alternate,Pe=pe!==null&&pe.memoizedState!==null||gu;pe=hg;var it=gu;if(hg=ne,(gu=Pe)&&!it)for(wt=C;wt!==null;)ne=wt,Pe=ne.child,ne.tag===22&&ne.memoizedState!==null?PC(C):Pe!==null?(Pe.return=ne,wt=Pe):PC(C);for(;k!==null;)wt=k,IC(k),k=k.sibling;wt=C,hg=pe,gu=it}bC(c)}else C.subtreeFlags&8772&&k!==null?(k.return=C,wt=k):bC(c)}}function bC(c){for(;wt!==null;){var h=wt;if(h.flags&8772){var _=h.alternate;try{if(h.flags&8772)switch(h.tag){case 0:case 11:case 15:gu||sf(5,h);break;case 1:var E=h.stateNode;if(h.flags&4&&!gu)if(_===null)E.componentDidMount();else{var C=h.elementType===h.type?_.memoizedProps:vr(h.type,_.memoizedProps);E.componentDidUpdate(C,_.memoizedState,E.__reactInternalSnapshotBeforeUpdate)}var k=h.updateQueue;k!==null&&To(h,k,E);break;case 3:var ne=h.updateQueue;if(ne!==null){if(_=null,h.child!==null)switch(h.child.tag){case 5:_=te(h.child.stateNode);break;case 1:_=h.child.stateNode}To(h,ne,_)}break;case 5:var pe=h.stateNode;_===null&&h.flags&4&&tn(pe,h.type,h.memoizedProps,h);break;case 6:break;case 4:break;case 12:break;case 13:if(Be&&h.memoizedState===null){var Pe=h.alternate;if(Pe!==null){var it=Pe.memoizedState;if(it!==null){var Rt=it.dehydrated;Rt!==null&&ee(Rt)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}gu||h.flags&512&&px(h)}catch(on){Ji(h,h.return,on)}}if(h===c){wt=null;break}if(_=h.sibling,_!==null){_.return=h.return,wt=_;break}wt=h.return}}function RC(c){for(;wt!==null;){var h=wt;if(h===c){wt=null;break}var _=h.sibling;if(_!==null){_.return=h.return,wt=_;break}wt=h.return}}function PC(c){for(;wt!==null;){var h=wt;try{switch(h.tag){case 0:case 11:case 15:var _=h.return;try{sf(4,h)}catch(Pe){Ji(h,_,Pe)}break;case 1:var E=h.stateNode;if(typeof E.componentDidMount=="function"){var C=h.return;try{E.componentDidMount()}catch(Pe){Ji(h,C,Pe)}}var k=h.return;try{px(h)}catch(Pe){Ji(h,k,Pe)}break;case 5:var ne=h.return;try{px(h)}catch(Pe){Ji(h,ne,Pe)}}}catch(Pe){Ji(h,h.return,Pe)}if(h===c){wt=null;break}var pe=h.sibling;if(pe!==null){pe.return=h.return,wt=pe;break}wt=h.return}}var pg=0,mg=1,gg=2,vg=3,_g=4;if(typeof Symbol=="function"&&Symbol.for){var of=Symbol.for;pg=of("selector.component"),mg=of("selector.has_pseudo_class"),gg=of("selector.role"),vg=of("selector.test_id"),_g=of("selector.text")}function _x(c){var h=Ae(c);if(h!=null){if(typeof h.memoizedProps["data-testname"]!="string")throw Error(o(364));return h}if(c=_e(c),c===null)throw Error(o(362));return c.stateNode.current}function yx(c,h){switch(h.$$typeof){case pg:if(c.type===h.value)return!0;break;case mg:e:{h=h.value,c=[c,0];for(var _=0;_<c.length;){var E=c[_++],C=c[_++],k=h[C];if(E.tag!==5||!De(E)){for(;k!=null&&yx(E,k);)C++,k=h[C];if(C===h.length){h=!0;break e}else for(E=E.child;E!==null;)c.push(E,C),E=E.sibling}}h=!1}return h;case gg:if(c.tag===5&&yt(c.stateNode,h.value))return!0;break;case _g:if((c.tag===5||c.tag===6)&&(c=ze(c),c!==null&&0<=c.indexOf(h.value)))return!0;break;case vg:if(c.tag===5&&(c=c.memoizedProps["data-testname"],typeof c=="string"&&c.toLowerCase()===h.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function xx(c){switch(c.$$typeof){case pg:return"<"+(P(c.value)||"Unknown")+">";case mg:return":has("+(xx(c)||"")+")";case gg:return'[role="'+c.value+'"]';case _g:return'"'+c.value+'"';case vg:return'[data-testname="'+c.value+'"]';default:throw Error(o(365))}}function NC(c,h){var _=[];c=[c,0];for(var E=0;E<c.length;){var C=c[E++],k=c[E++],ne=h[k];if(C.tag!==5||!De(C)){for(;ne!=null&&yx(C,ne);)k++,ne=h[k];if(k===h.length)_.push(C);else for(C=C.child;C!==null;)c.push(C,k),C=C.sibling}}return _}function Ex(c,h){if(!H)throw Error(o(363));c=_x(c),c=NC(c,h),h=[],c=Array.from(c);for(var _=0;_<c.length;){var E=c[_++];if(E.tag===5)De(E)||h.push(E.stateNode);else for(E=E.child;E!==null;)c.push(E),E=E.sibling}return h}var NF=Math.ceil,yg=a.ReactCurrentDispatcher,wx=a.ReactCurrentOwner,_r=a.ReactCurrentBatchConfig,pn=0,Ir=null,br=null,ni=0,vs=0,Xc=Gt(0),Br=0,af=null,$c=0,xg=0,Sx=0,lf=null,Qi=null,Tx=0,Mx=1/0;function Yc(){Mx=Tr()+500}var Eg=!1,Ax=null,Wa=null,wg=!1,ja=null,Sg=0,uf=0,Cx=null,Tg=-1,Mg=0;function Oi(){return pn&6?Tr():Tg!==-1?Tg:Tg=Tr()}function qa(c){return c.mode&1?pn&2&&ni!==0?ni&-ni:Ym.transition!==null?(Mg===0&&(c=Us,Us<<=1,!(Us&4194240)&&(Us=64),Mg=c),Mg):(c=vn,c!==0?c:be()):1}function Hs(c,h,_){if(50<uf)throw uf=0,Cx=null,Error(o(185));var E=Ag(c,h);return E===null?null:(Qo(E,h,_),(!(pn&2)||E!==Ir)&&(E===Ir&&(!(pn&2)&&(xg|=h),Br===4&&Xa(E,ni)),Zi(E,_),h===1&&pn===0&&!(c.mode&1)&&(Yc(),Gn&&fs())),E)}function Ag(c,h){c.lanes|=h;var _=c.alternate;for(_!==null&&(_.lanes|=h),_=c,c=c.return;c!==null;)c.childLanes|=h,_=c.alternate,_!==null&&(_.childLanes|=h),_=c,c=c.return;return _.tag===3?_.stateNode:null}function Zi(c,h){var _=c.callbackNode;Nc(c,h);var E=ou(c,c===Ir?ni:0);if(E===0)_!==null&&Zo(_),c.callbackNode=null,c.callbackPriority=0;else if(h=E&-E,c.callbackPriority!==h){if(_!=null&&Zo(_),h===1)c.tag===0?$m(DC.bind(null,c)):Xm(DC.bind(null,c)),st?W(function(){pn===0&&fs()}):Lc(Fs,fs),_=null;else{switch(zd(E)){case 1:_=Fs;break;case 4:_=X0;break;case 16:_=Hd;break;case 536870912:_=Dc;break;default:_=Hd}_=GC(_,LC.bind(null,c))}c.callbackPriority=h,c.callbackNode=_}}function LC(c,h){if(Tg=-1,Mg=0,pn&6)throw Error(o(327));var _=c.callbackNode;if(xu()&&c.callbackNode!==_)return null;var E=ou(c,c===Ir?ni:0);if(E===0)return null;if(E&30||E&c.expiredLanes||h)h=Cg(c,E);else{h=E;var C=pn;pn|=2;var k=UC();(Ir!==c||ni!==h)&&(Yc(),_u(c,h));do try{kF();break}catch(pe){OC(c,pe)}while(!0);cu(),yg.current=k,pn=C,br!==null?h=0:(Ir=null,ni=0,h=Br)}if(h!==0){if(h===2&&(C=yn(c),C!==0&&(E=C,h=Ix(c,C))),h===1)throw _=af,_u(c,0),Xa(c,E),Zi(c,Tr()),_;if(h===6)Xa(c,E);else{if(C=c.current.alternate,!(E&30)&&!LF(C)&&(h=Cg(c,E),h===2&&(k=yn(c),k!==0&&(E=k,h=Ix(c,k))),h===1))throw _=af,_u(c,0),Xa(c,E),Zi(c,Tr()),_;switch(c.finishedWork=C,c.finishedLanes=E,h){case 0:case 1:throw Error(o(345));case 2:yu(c,Qi);break;case 3:if(Xa(c,E),(E&130023424)===E&&(h=Tx+500-Tr(),10<h)){if(ou(c,0)!==0)break;if(C=c.suspendedLanes,(C&E)!==E){Oi(),c.pingedLanes|=c.suspendedLanes&C;break}c.timeoutHandle=Ye(yu.bind(null,c,Qi),h);break}yu(c,Qi);break;case 4:if(Xa(c,E),(E&4194240)===E)break;for(h=c.eventTimes,C=-1;0<E;){var ne=31-It(E);k=1<<ne,ne=h[ne],ne>C&&(C=ne),E&=~k}if(E=C,E=Tr()-E,E=(120>E?120:480>E?480:1080>E?1080:1920>E?1920:3e3>E?3e3:4320>E?4320:1960*NF(E/1960))-E,10<E){c.timeoutHandle=Ye(yu.bind(null,c,Qi),E);break}yu(c,Qi);break;case 5:yu(c,Qi);break;default:throw Error(o(329))}}}return Zi(c,Tr()),c.callbackNode===_?LC.bind(null,c):null}function Ix(c,h){var _=lf;return c.current.memoizedState.isDehydrated&&(_u(c,h).flags|=256),c=Cg(c,h),c!==2&&(h=Qi,Qi=_,h!==null&&bx(h)),c}function bx(c){Qi===null?Qi=c:Qi.push.apply(Qi,c)}function LF(c){for(var h=c;;){if(h.flags&16384){var _=h.updateQueue;if(_!==null&&(_=_.stores,_!==null))for(var E=0;E<_.length;E++){var C=_[E],k=C.getSnapshot;C=C.value;try{if(!hs(k(),C))return!1}catch{return!1}}}if(_=h.child,h.subtreeFlags&16384&&_!==null)_.return=h,h=_;else{if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function Xa(c,h){for(h&=~Sx,h&=~xg,c.suspendedLanes|=h,c.pingedLanes&=~h,c=c.expirationTimes;0<h;){var _=31-It(h),E=1<<_;c[_]=-1,h&=~E}}function DC(c){if(pn&6)throw Error(o(327));xu();var h=ou(c,0);if(!(h&1))return Zi(c,Tr()),null;var _=Cg(c,h);if(c.tag!==0&&_===2){var E=yn(c);E!==0&&(h=E,_=Ix(c,E))}if(_===1)throw _=af,_u(c,0),Xa(c,h),Zi(c,Tr()),_;if(_===6)throw Error(o(345));return c.finishedWork=c.current.alternate,c.finishedLanes=h,yu(c,Qi),Zi(c,Tr()),null}function kC(c){ja!==null&&ja.tag===0&&!(pn&6)&&xu();var h=pn;pn|=1;var _=_r.transition,E=vn;try{if(_r.transition=null,vn=1,c)return c()}finally{vn=E,_r.transition=_,pn=h,!(pn&6)&&fs()}}function Rx(){vs=Xc.current,pt(Xc)}function _u(c,h){c.finishedWork=null,c.finishedLanes=0;var _=c.timeoutHandle;if(_!==Dt&&(c.timeoutHandle=Dt,Ct(_)),br!==null)for(_=br.return;_!==null;){var E=_;switch(Ar(E),E.tag){case 1:E=E.type.childContextTypes,E!=null&&Le();break;case 3:jc(),pt(Wt),pt(kt),ex();break;case 5:Z0(E);break;case 4:jc();break;case 13:pt(nr);break;case 19:pt(nr);break;case 10:Uc(E.type._context);break;case 22:case 23:Rx()}_=_.return}if(Ir=c,br=c=$a(c.current,null),ni=vs=h,Br=0,af=null,Sx=xg=$c=0,Qi=lf=null,hi!==null){for(h=0;h<hi.length;h++)if(_=hi[h],E=_.interleaved,E!==null){_.interleaved=null;var C=E.next,k=_.pending;if(k!==null){var ne=k.next;k.next=C,E.next=ne}_.pending=E}hi=null}return c}function OC(c,h){do{var _=br;try{if(cu(),Jm.current=sg,eg){for(var E=cr.memoizedState;E!==null;){var C=E.queue;C!==null&&(C.pending=null),E=E.next}eg=!1}if(qc=0,$r=fi=cr=null,Qd=!1,Zd=0,wx.current=null,_===null||_.return===null){Br=1,af=h,br=null;break}e:{var k=c,ne=_.return,pe=_,Pe=h;if(h=ni,pe.flags|=32768,Pe!==null&&typeof Pe=="object"&&typeof Pe.then=="function"){var it=Pe,Rt=pe,on=Rt.tag;if(!(Rt.mode&1)&&(on===0||on===11||on===15)){var qt=Rt.alternate;qt?(Rt.updateQueue=qt.updateQueue,Rt.memoizedState=qt.memoizedState,Rt.lanes=qt.lanes):(Rt.updateQueue=null,Rt.memoizedState=null)}var Wn=rC(ne);if(Wn!==null){Wn.flags&=-257,iC(Wn,ne,pe,k,h),Wn.mode&1&&nC(k,it,h),h=Wn,Pe=it;var Ft=h.updateQueue;if(Ft===null){var gi=new Set;gi.add(Pe),h.updateQueue=gi}else Ft.add(Pe);break e}else{if(!(h&1)){nC(k,it,h),Px();break e}Pe=Error(o(426))}}else if(En&&pe.mode&1){var Ws=rC(ne);if(Ws!==null){!(Ws.flags&65536)&&(Ws.flags|=256),iC(Ws,ne,pe,k,h),K0(Pe);break e}}k=Pe,Br!==4&&(Br=2),lf===null?lf=[k]:lf.push(k),Pe=ax(Pe,pe),pe=ne;do{switch(pe.tag){case 3:pe.flags|=65536,h&=-h,pe.lanes|=h;var we=eC(pe,Pe,h);Wd(pe,we);break e;case 1:k=Pe;var me=pe.type,Ie=pe.stateNode;if(!(pe.flags&128)&&(typeof me.getDerivedStateFromError=="function"||Ie!==null&&typeof Ie.componentDidCatch=="function"&&(Wa===null||!Wa.has(Ie)))){pe.flags|=65536,h&=-h,pe.lanes|=h;var St=tC(pe,k,h);Wd(pe,St);break e}}pe=pe.return}while(pe!==null)}VC(_)}catch(Ot){h=Ot,br===_&&_!==null&&(br=_=_.return);continue}break}while(!0)}function UC(){var c=yg.current;return yg.current=sg,c===null?sg:c}function Px(){(Br===0||Br===3||Br===2)&&(Br=4),Ir===null||!($c&268435455)&&!(xg&268435455)||Xa(Ir,ni)}function Cg(c,h){var _=pn;pn|=2;var E=UC();Ir===c&&ni===h||_u(c,h);do try{DF();break}catch(C){OC(c,C)}while(!0);if(cu(),pn=_,yg.current=E,br!==null)throw Error(o(261));return Ir=null,ni=0,Br}function DF(){for(;br!==null;)FC(br)}function kF(){for(;br!==null&&!j0();)FC(br)}function FC(c){var h=HC(c.alternate,c,vs);c.memoizedProps=c.pendingProps,h===null?VC(c):br=h,wx.current=null}function VC(c){var h=c;do{var _=h.alternate;if(c=h.return,h.flags&32768){if(_=CF(_,h),_!==null){_.flags&=32767,br=_;return}if(c!==null)c.flags|=32768,c.subtreeFlags=0,c.deletions=null;else{Br=6,br=null;return}}else if(_=TF(_,h,vs),_!==null){br=_;return}if(h=h.sibling,h!==null){br=h;return}br=h=c}while(h!==null);Br===0&&(Br=5)}function yu(c,h){var _=vn,E=_r.transition;try{_r.transition=null,vn=1,OF(c,h,_)}finally{_r.transition=E,vn=_}return null}function OF(c,h,_){do xu();while(ja!==null);if(pn&6)throw Error(o(327));var E=c.finishedWork,C=c.finishedLanes;if(E===null)return null;if(c.finishedWork=null,c.finishedLanes=0,E===c.current)throw Error(o(177));c.callbackNode=null,c.callbackPriority=0;var k=E.lanes|E.childLanes;if(za(c,k),c===Ir&&(br=Ir=null,ni=0),!(E.subtreeFlags&2064)&&!(E.flags&2064)||wg||(wg=!0,GC(Hd,function(){return xu(),null})),k=(E.flags&15990)!==0,E.subtreeFlags&15990||k){k=_r.transition,_r.transition=null;var ne=vn;vn=1;var pe=pn;pn|=4,wx.current=null,bF(c,E),RF(c,E),K(c.containerInfo),c.current=E,PF(E),q0(),pn=pe,vn=ne,_r.transition=k}else c.current=E;if(wg&&(wg=!1,ja=c,Sg=C),k=c.pendingLanes,k===0&&(Wa=null),au(E.stateNode),Zi(c,Tr()),h!==null)for(_=c.onRecoverableError,E=0;E<h.length;E++)_(h[E]);if(Eg)throw Eg=!1,c=Ax,Ax=null,c;return Sg&1&&c.tag!==0&&xu(),k=c.pendingLanes,k&1?c===Cx?uf++:(uf=0,Cx=c):uf=0,fs(),null}function xu(){if(ja!==null){var c=zd(Sg),h=_r.transition,_=vn;try{if(_r.transition=null,vn=16>c?16:c,ja===null)var E=!1;else{if(c=ja,ja=null,Sg=0,pn&6)throw Error(o(331));var C=pn;for(pn|=4,wt=c.current;wt!==null;){var k=wt,ne=k.child;if(wt.flags&16){var pe=k.deletions;if(pe!==null){for(var Pe=0;Pe<pe.length;Pe++){var it=pe[Pe];for(wt=it;wt!==null;){var Rt=wt;switch(Rt.tag){case 0:case 11:case 15:vu(8,Rt,k)}var on=Rt.child;if(on!==null)on.return=Rt,wt=on;else for(;wt!==null;){Rt=wt;var qt=Rt.sibling,Wn=Rt.return;if(SC(Rt),Rt===it){wt=null;break}if(qt!==null){qt.return=Wn,wt=qt;break}wt=Wn}}}var Ft=k.alternate;if(Ft!==null){var gi=Ft.child;if(gi!==null){Ft.child=null;do{var Ws=gi.sibling;gi.sibling=null,gi=Ws}while(gi!==null)}}wt=k}}if(k.subtreeFlags&2064&&ne!==null)ne.return=k,wt=ne;else e:for(;wt!==null;){if(k=wt,k.flags&2048)switch(k.tag){case 0:case 11:case 15:vu(9,k,k.return)}var we=k.sibling;if(we!==null){we.return=k.return,wt=we;break e}wt=k.return}}var me=c.current;for(wt=me;wt!==null;){ne=wt;var Ie=ne.child;if(ne.subtreeFlags&2064&&Ie!==null)Ie.return=ne,wt=Ie;else e:for(ne=me;wt!==null;){if(pe=wt,pe.flags&2048)try{switch(pe.tag){case 0:case 11:case 15:sf(9,pe)}}catch(Ot){Ji(pe,pe.return,Ot)}if(pe===ne){wt=null;break e}var St=pe.sibling;if(St!==null){St.return=pe.return,wt=St;break e}wt=pe.return}}if(pn=C,fs(),cs&&typeof cs.onPostCommitFiberRoot=="function")try{cs.onPostCommitFiberRoot(Jo,c)}catch{}E=!0}return E}finally{vn=_,_r.transition=h}}return!1}function BC(c,h,_){h=ax(_,h),h=eC(c,h,1),no(c,h),h=Oi(),c=Ag(c,1),c!==null&&(Qo(c,1,h),Zi(c,h))}function Ji(c,h,_){if(c.tag===3)BC(c,c,_);else for(;h!==null;){if(h.tag===3){BC(h,c,_);break}else if(h.tag===1){var E=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(Wa===null||!Wa.has(E))){c=ax(_,c),c=tC(h,c,1),no(h,c),c=Oi(),h=Ag(h,1),h!==null&&(Qo(h,1,c),Zi(h,c));break}}h=h.return}}function UF(c,h,_){var E=c.pingCache;E!==null&&E.delete(h),h=Oi(),c.pingedLanes|=c.suspendedLanes&_,Ir===c&&(ni&_)===_&&(Br===4||Br===3&&(ni&130023424)===ni&&500>Tr()-Tx?_u(c,0):Sx|=_),Zi(c,h)}function zC(c,h){h===0&&(c.mode&1?(h=Ki,Ki<<=1,!(Ki&130023424)&&(Ki=4194304)):h=1);var _=Oi();c=Ag(c,h),c!==null&&(Qo(c,h,_),Zi(c,_))}function FF(c){var h=c.memoizedState,_=0;h!==null&&(_=h.retryLane),zC(c,_)}function VF(c,h){var _=0;switch(c.tag){case 13:var E=c.stateNode,C=c.memoizedState;C!==null&&(_=C.retryLane);break;case 19:E=c.stateNode;break;default:throw Error(o(314))}E!==null&&E.delete(h),zC(c,_)}var HC;HC=function(c,h,_){if(c!==null)if(c.memoizedProps!==h.pendingProps||Wt.current)gs=!0;else{if(!(c.lanes&_)&&!(h.flags&128))return gs=!1,AF(c,h,_);gs=!!(c.flags&131072)}else gs=!1,En&&h.flags&1048576&&Mr(h,I,h.index);switch(h.lanes=0,h.tag){case 2:var E=h.type;c!==null&&(c.alternate=null,h.alternate=null,h.flags|=2),c=h.pendingProps;var C=oe(h,kt.current);Ga(h,_),C=nx(null,h,E,c,C,_);var k=rx();return h.flags|=1,typeof C=="object"&&C!==null&&typeof C.render=="function"&&C.$$typeof===void 0?(h.tag=1,h.memoizedState=null,h.updateQueue=null,ge(E)?(k=!0,rt(h)):k=!1,h.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,Fc(h),C.updater=fu,h.stateNode=C,C._reactInternals=h,zc(h,E,c,_),h=cx(null,h,E,!0,k,_)):(h.tag=0,En&&k&&xn(h),ki(null,h,C,_),h=h.child),h;case 16:E=h.elementType;e:{switch(c!==null&&(c.alternate=null,h.alternate=null,h.flags|=2),c=h.pendingProps,C=E._init,E=C(E._payload),h.type=E,C=h.tag=zF(E),c=vr(E,c),C){case 0:h=ux(null,h,E,c,_);break e;case 1:h=dC(null,h,E,c,_);break e;case 11:h=aC(null,h,E,c,_);break e;case 14:h=lC(null,h,E,vr(E.type,c),_);break e}throw Error(o(306,E,""))}return h;case 0:return E=h.type,C=h.pendingProps,C=h.elementType===E?C:vr(E,C),ux(c,h,E,C,_);case 1:return E=h.type,C=h.pendingProps,C=h.elementType===E?C:vr(E,C),dC(c,h,E,C,_);case 3:e:{if(fC(h),c===null)throw Error(o(387));E=h.pendingProps,k=h.memoizedState,C=k.element,Vc(c,h),du(h,E,null,_);var ne=h.memoizedState;if(E=ne.element,Be&&k.isDehydrated)if(k={element:E,isDehydrated:!1,cache:ne.cache,transitions:ne.transitions},h.updateQueue.baseState=k,h.memoizedState=k,h.flags&256){C=Error(o(423)),h=pC(c,h,E,_,C);break e}else if(E!==C){C=Error(o(424)),h=pC(c,h,E,_,C);break e}else for(Be&&(Cr=Os(h.stateNode.containerInfo),On=h,En=!0,Di=null,Mo=!1),_=DA(h,null,E,_),h.child=_;_;)_.flags=_.flags&-3|4096,_=_.sibling;else{if(Hc(),E===C){h=ia(c,h,_);break e}ki(c,h,E,_)}h=h.child}return h;case 5:return kA(h),c===null&&Y0(h),E=h.type,C=h.pendingProps,k=c!==null?c.memoizedProps:null,ne=C.children,Fe(E,C)?ne=null:k!==null&&Fe(E,k)&&(h.flags|=32),hC(c,h),ki(c,h,ne,_),h.child;case 6:return c===null&&Y0(h),null;case 13:return mC(c,h,_);case 4:return Q0(h,h.stateNode.containerInfo),E=h.pendingProps,c===null?h.child=Gc(h,null,E,_):ki(c,h,E,_),h.child;case 11:return E=h.type,C=h.pendingProps,C=h.elementType===E?C:vr(E,C),aC(c,h,E,C,_);case 7:return ki(c,h,h.pendingProps,_),h.child;case 8:return ki(c,h,h.pendingProps.children,_),h.child;case 12:return ki(c,h,h.pendingProps.children,_),h.child;case 10:e:{if(E=h.type._context,C=h.pendingProps,k=h.memoizedProps,ne=C.value,hu(h,E,ne),k!==null)if(hs(k.value,ne)){if(k.children===C.children&&!Wt.current){h=ia(c,h,_);break e}}else for(k=h.child,k!==null&&(k.return=h);k!==null;){var pe=k.dependencies;if(pe!==null){ne=k.child;for(var Pe=pe.firstContext;Pe!==null;){if(Pe.context===E){if(k.tag===1){Pe=ps(-1,_&-_),Pe.tag=2;var it=k.updateQueue;if(it!==null){it=it.shared;var Rt=it.pending;Rt===null?Pe.next=Pe:(Pe.next=Rt.next,Rt.next=Pe),it.pending=Pe}}k.lanes|=_,Pe=k.alternate,Pe!==null&&(Pe.lanes|=_),Ha(k.return,_,h),pe.lanes|=_;break}Pe=Pe.next}}else if(k.tag===10)ne=k.type===h.type?null:k.child;else if(k.tag===18){if(ne=k.return,ne===null)throw Error(o(341));ne.lanes|=_,pe=ne.alternate,pe!==null&&(pe.lanes|=_),Ha(ne,_,h),ne=k.sibling}else ne=k.child;if(ne!==null)ne.return=k;else for(ne=k;ne!==null;){if(ne===h){ne=null;break}if(k=ne.sibling,k!==null){k.return=ne.return,ne=k;break}ne=ne.return}k=ne}ki(c,h,C.children,_),h=h.child}return h;case 9:return C=h.type,E=h.pendingProps.children,Ga(h,_),C=Li(C),E=E(C),h.flags|=1,ki(c,h,E,_),h.child;case 14:return E=h.type,C=vr(E,h.pendingProps),C=vr(E.type,C),lC(c,h,E,C,_);case 15:return uC(c,h,h.type,h.pendingProps,_);case 17:return E=h.type,C=h.pendingProps,C=h.elementType===E?C:vr(E,C),c!==null&&(c.alternate=null,h.alternate=null,h.flags|=2),h.tag=1,ge(E)?(c=!0,rt(h)):c=!1,Ga(h,_),pu(h,E,C),zc(h,E,C,_),cx(null,h,E,!0,c,_);case 19:return yC(c,h,_);case 22:return cC(c,h,_)}throw Error(o(156,h.tag))};function GC(c,h){return Lc(c,h)}function BF(c,h,_,E){this.tag=c,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gs(c,h,_,E){return new BF(c,h,_,E)}function Nx(c){return c=c.prototype,!(!c||!c.isReactComponent)}function zF(c){if(typeof c=="function")return Nx(c)?1:0;if(c!=null){if(c=c.$$typeof,c===S)return 11;if(c===w)return 14}return 2}function $a(c,h){var _=c.alternate;return _===null?(_=Gs(c.tag,h,c.key,c.mode),_.elementType=c.elementType,_.type=c.type,_.stateNode=c.stateNode,_.alternate=c,c.alternate=_):(_.pendingProps=h,_.type=c.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=c.flags&14680064,_.childLanes=c.childLanes,_.lanes=c.lanes,_.child=c.child,_.memoizedProps=c.memoizedProps,_.memoizedState=c.memoizedState,_.updateQueue=c.updateQueue,h=c.dependencies,_.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},_.sibling=c.sibling,_.index=c.index,_.ref=c.ref,_}function Ig(c,h,_,E,C,k){var ne=2;if(E=c,typeof c=="function")Nx(c)&&(ne=1);else if(typeof c=="string")ne=5;else e:switch(c){case d:return Eu(_.children,C,k,h);case f:ne=8,C|=8;break;case p:return c=Gs(12,_,h,C|2),c.elementType=p,c.lanes=k,c;case x:return c=Gs(13,_,h,C),c.elementType=x,c.lanes=k,c;case v:return c=Gs(19,_,h,C),c.elementType=v,c.lanes=k,c;case R:return bg(_,C,k,h);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case g:ne=10;break e;case y:ne=9;break e;case S:ne=11;break e;case w:ne=14;break e;case T:ne=16,E=null;break e}throw Error(o(130,c==null?c:typeof c,""))}return h=Gs(ne,_,h,C),h.elementType=c,h.type=E,h.lanes=k,h}function Eu(c,h,_,E){return c=Gs(7,c,E,h),c.lanes=_,c}function bg(c,h,_,E){return c=Gs(22,c,E,h),c.elementType=R,c.lanes=_,c.stateNode={},c}function Lx(c,h,_){return c=Gs(6,c,null,h),c.lanes=_,c}function Dx(c,h,_){return h=Gs(4,c.children!==null?c.children:[],c.key,h),h.lanes=_,h.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},h}function HF(c,h,_,E,C){this.tag=h,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Dt,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Vr(0),this.expirationTimes=Vr(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vr(0),this.identifierPrefix=E,this.onRecoverableError=C,Be&&(this.mutableSourceEagerHydrationData=null)}function WC(c,h,_,E,C,k,ne,pe,Pe){return c=new HF(c,h,_,pe,Pe),h===1?(h=1,k===!0&&(h|=8)):h=0,k=Gs(3,null,null,h),c.current=k,k.stateNode=c,k.memoizedState={element:E,isDehydrated:_,cache:null,transitions:null},Fc(k),c}function jC(c){if(!c)return Jt;c=c._reactInternals;e:{if(M(c)!==c||c.tag!==1)throw Error(o(170));var h=c;do{switch(h.tag){case 3:h=h.stateNode.context;break e;case 1:if(ge(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break e}}h=h.return}while(h!==null);throw Error(o(171))}if(c.tag===1){var _=c.type;if(ge(_))return ht(c,_,h)}return h}function qC(c){var h=c._reactInternals;if(h===void 0)throw typeof c.render=="function"?Error(o(188)):(c=Object.keys(c).join(","),Error(o(268,c)));return c=z(h),c===null?null:c.stateNode}function XC(c,h){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var _=c.retryLane;c.retryLane=_!==0&&_<h?_:h}}function kx(c,h){XC(c,h),(c=c.alternate)&&XC(c,h)}function GF(c){return c=z(c),c===null?null:c.stateNode}function WF(){return null}return t.attemptContinuousHydration=function(c){if(c.tag===13){var h=Oi();Hs(c,134217728,h),kx(c,134217728)}},t.attemptHydrationAtCurrentPriority=function(c){if(c.tag===13){var h=Oi(),_=qa(c);Hs(c,_,h),kx(c,_)}},t.attemptSynchronousHydration=function(c){switch(c.tag){case 3:var h=c.stateNode;if(h.current.memoizedState.isDehydrated){var _=Xr(h.pendingLanes);_!==0&&(Ni(h,_|1),Zi(h,Tr()),!(pn&6)&&(Yc(),fs()))}break;case 13:var E=Oi();kC(function(){return Hs(c,1,E)}),kx(c,1)}},t.batchedUpdates=function(c,h){var _=pn;pn|=1;try{return c(h)}finally{pn=_,pn===0&&(Yc(),Gn&&fs())}},t.createComponentSelector=function(c){return{$$typeof:pg,value:c}},t.createContainer=function(c,h,_,E,C,k,ne){return WC(c,h,!1,null,_,E,C,k,ne)},t.createHasPseudoClassSelector=function(c){return{$$typeof:mg,value:c}},t.createHydrationContainer=function(c,h,_,E,C,k,ne,pe,Pe){return c=WC(_,E,!0,c,C,k,ne,pe,Pe),c.context=jC(null),_=c.current,E=Oi(),C=qa(_),k=ps(E,C),k.callback=h??null,no(_,k),c.current.lanes=C,Qo(c,C,E),Zi(c,E),c},t.createPortal=function(c,h,_){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:E==null?null:""+E,children:c,containerInfo:h,implementation:_}},t.createRoleSelector=function(c){return{$$typeof:gg,value:c}},t.createTestNameSelector=function(c){return{$$typeof:vg,value:c}},t.createTextSelector=function(c){return{$$typeof:_g,value:c}},t.deferredUpdates=function(c){var h=vn,_=_r.transition;try{return _r.transition=null,vn=16,c()}finally{vn=h,_r.transition=_}},t.discreteUpdates=function(c,h,_,E,C){var k=vn,ne=_r.transition;try{return _r.transition=null,vn=1,c(h,_,E,C)}finally{vn=k,_r.transition=ne,pn===0&&Yc()}},t.findAllNodes=Ex,t.findBoundingRects=function(c,h){if(!H)throw Error(o(363));h=Ex(c,h),c=[];for(var _=0;_<h.length;_++)c.push(Ve(h[_]));for(h=c.length-1;0<h;h--){_=c[h];for(var E=_.x,C=E+_.width,k=_.y,ne=k+_.height,pe=h-1;0<=pe;pe--)if(h!==pe){var Pe=c[pe],it=Pe.x,Rt=it+Pe.width,on=Pe.y,qt=on+Pe.height;if(E>=it&&k>=on&&C<=Rt&&ne<=qt){c.splice(h,1);break}else if(E!==it||_.width!==Pe.width||qt<k||on>ne){if(!(k!==on||_.height!==Pe.height||Rt<E||it>C)){it>E&&(Pe.width+=it-E,Pe.x=E),Rt<C&&(Pe.width=C-it),c.splice(h,1);break}}else{on>k&&(Pe.height+=on-k,Pe.y=k),qt<ne&&(Pe.height=ne-on),c.splice(h,1);break}}}return c},t.findHostInstance=qC,t.findHostInstanceWithNoPortals=function(c){return c=L(c),c=c!==null?$(c):null,c===null?null:c.stateNode},t.findHostInstanceWithWarning=function(c){return qC(c)},t.flushControlled=function(c){var h=pn;pn|=1;var _=_r.transition,E=vn;try{_r.transition=null,vn=1,c()}finally{vn=E,_r.transition=_,pn=h,pn===0&&(Yc(),fs())}},t.flushPassiveEffects=xu,t.flushSync=kC,t.focusWithin=function(c,h){if(!H)throw Error(o(363));for(c=_x(c),h=NC(c,h),h=Array.from(h),c=0;c<h.length;){var _=h[c++];if(!De(_)){if(_.tag===5&&Xe(_.stateNode))return!0;for(_=_.child;_!==null;)h.push(_),_=_.sibling}}return!1},t.getCurrentUpdatePriority=function(){return vn},t.getFindAllNodesFailureDescription=function(c,h){if(!H)throw Error(o(363));var _=0,E=[];c=[_x(c),0];for(var C=0;C<c.length;){var k=c[C++],ne=c[C++],pe=h[ne];if((k.tag!==5||!De(k))&&(yx(k,pe)&&(E.push(xx(pe)),ne++,ne>_&&(_=ne)),ne<h.length))for(k=k.child;k!==null;)c.push(k,ne),k=k.sibling}if(_<h.length){for(c=[];_<h.length;_++)c.push(xx(h[_]));return`findAllNodes was able to match part of the selector:
  `+(E.join(" > ")+`

No matching component was found for:
  `)+c.join(" > ")}return null},t.getPublicRootInstance=function(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 5:return te(c.child.stateNode);default:return c.child.stateNode}},t.injectIntoDevTools=function(c){if(c={bundleType:c.bundleType,version:c.version,rendererPackageName:c.rendererPackageName,rendererConfig:c.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:GF,findFiberByHostInstance:c.findFiberByHostInstance||WF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")c=!1;else{var h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(h.isDisabled||!h.supportsFiber)c=!0;else{try{Jo=h.inject(c),cs=h}catch{}c=!!h.checkDCE}}return c},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(c,h,_,E){if(!H)throw Error(o(363));c=Ex(c,h);var C=Qe(c,_,E).disconnect;return{disconnect:function(){C()}}},t.registerMutableSourceForHydration=function(c,h){var _=h._getVersion;_=_(h._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[h,_]:c.mutableSourceEagerHydrationData.push(h,_)},t.runWithPriority=function(c,h){var _=vn;try{return vn=c,h()}finally{vn=_}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(c,h,_,E){var C=h.current,k=Oi(),ne=qa(C);return _=jC(_),h.context===null?h.context=_:h.pendingContext=_,h=ps(k,ne),h.payload={element:c},E=E===void 0?null:E,E!==null&&(h.callback=E),no(C,h),c=Hs(C,ne,k),c!==null&&ta(c,C,ne),ne},t};OU.exports=WK;var jK=OU.exports;const qK=PT(jK);var UU={exports:{}},FU={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(G,Z){var K=G.length;G.push(Z);e:for(;0<K;){var ce=K-1>>>1,de=G[ce];if(0<i(de,Z))G[ce]=Z,G[K]=de,K=ce;else break e}}function t(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var Z=G[0],K=G.pop();if(K!==Z){G[0]=K;e:for(var ce=0,de=G.length,ue=de>>>1;ce<ue;){var Ee=2*(ce+1)-1,Fe=G[Ee],ke=Ee+1,Ye=G[ke];if(0>i(Fe,K))ke<de&&0>i(Ye,Fe)?(G[ce]=Ye,G[ke]=K,ce=ke):(G[ce]=Fe,G[Ee]=K,ce=Ee);else if(ke<de&&0>i(Ye,K))G[ce]=Ye,G[ke]=K,ce=ke;else break e}}return Z}function i(G,Z){var K=G.sortIndex-Z.sortIndex;return K!==0?K:G.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,f=null,p=3,g=!1,y=!1,S=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(G){for(var Z=t(u);Z!==null;){if(Z.callback===null)r(u);else if(Z.startTime<=G)r(u),Z.sortIndex=Z.expirationTime,e(l,Z);else break;Z=t(u)}}function R(G){if(S=!1,T(G),!y)if(t(l)!==null)y=!0,te(U);else{var Z=t(u);Z!==null&&ye(R,Z.startTime-G)}}function U(G,Z){y=!1,S&&(S=!1,v(b),b=-1),g=!0;var K=p;try{for(T(Z),f=t(l);f!==null&&(!(f.expirationTime>Z)||G&&!L());){var ce=f.callback;if(typeof ce=="function"){f.callback=null,p=f.priorityLevel;var de=ce(f.expirationTime<=Z);Z=n.unstable_now(),typeof de=="function"?f.callback=de:f===t(l)&&r(l),T(Z)}else r(l);f=t(l)}if(f!==null)var ue=!0;else{var Ee=t(u);Ee!==null&&ye(R,Ee.startTime-Z),ue=!1}return ue}finally{f=null,p=K,g=!1}}var N=!1,P=null,b=-1,M=5,A=-1;function L(){return!(n.unstable_now()-A<M)}function z(){if(P!==null){var G=n.unstable_now();A=G;var Z=!0;try{Z=P(!0,G)}finally{Z?B():(N=!1,P=null)}}else N=!1}var B;if(typeof w=="function")B=function(){w(z)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,he=$.port2;$.port1.onmessage=z,B=function(){he.postMessage(null)}}else B=function(){x(z,0)};function te(G){P=G,N||(N=!0,B())}function ye(G,Z){b=x(function(){G(n.unstable_now())},Z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(G){G.callback=null},n.unstable_continueExecution=function(){y||g||(y=!0,te(U))},n.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<G?Math.floor(1e3/G):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(G){switch(p){case 1:case 2:case 3:var Z=3;break;default:Z=p}var K=p;p=Z;try{return G()}finally{p=K}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(G,Z){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var K=p;p=G;try{return Z()}finally{p=K}},n.unstable_scheduleCallback=function(G,Z,K){var ce=n.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?ce+K:ce):K=ce,G){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=K+de,G={id:d++,callback:Z,priorityLevel:G,startTime:K,expirationTime:de,sortIndex:-1},K>ce?(G.sortIndex=K,e(u,G),t(l)===null&&G===t(u)&&(S?(v(b),b=-1):S=!0,ye(R,K-ce))):(G.sortIndex=de,e(l,G),y||g||(y=!0,te(U))),G},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(G){var Z=p;return function(){var K=p;p=Z;try{return G.apply(this,arguments)}finally{p=K}}}})(FU);UU.exports=FU;var m2=UU.exports;const vA={},VU=n=>void Object.assign(vA,n);function XK(n,e){function t(d,{args:f=[],attach:p,...g},y){let S=`${d[0].toUpperCase()}${d.slice(1)}`,x;if(d==="primitive"){if(g.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const v=g.object;x=Ah(v,{type:d,root:y,attach:p,primitive:!0})}else{const v=vA[S];if(!v)throw new Error(`R3F: ${S} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(f))throw new Error("R3F: The args prop must be an array!");x=Ah(new v(...f),{type:d,root:y,attach:p,memoizedProps:{args:f}})}return x.__r3f.attach===void 0&&(x instanceof hn?x.__r3f.attach="geometry":x instanceof ui&&(x.__r3f.attach="material")),S!=="inject"&&ow(x,g),x}function r(d,f){let p=!1;if(f){var g,y;(g=f.__r3f)!=null&&g.attach?sw(d,f,f.__r3f.attach):f.isObject3D&&d.isObject3D&&(d.add(f),p=!0),p||(y=d.__r3f)==null||y.objects.push(f),f.__r3f||Ah(f,{}),f.__r3f.parent=d,CT(f),Ch(f)}}function i(d,f,p){let g=!1;if(f){var y,S;if((y=f.__r3f)!=null&&y.attach)sw(d,f,f.__r3f.attach);else if(f.isObject3D&&d.isObject3D){f.parent=d,f.dispatchEvent({type:"added"}),d.dispatchEvent({type:"childadded",child:f});const x=d.children.filter(w=>w!==f),v=x.indexOf(p);d.children=[...x.slice(0,v),f,...x.slice(v)],g=!0}g||(S=d.__r3f)==null||S.objects.push(f),f.__r3f||Ah(f,{}),f.__r3f.parent=d,CT(f),Ch(f)}}function s(d,f,p=!1){d&&[...d].forEach(g=>o(f,g,p))}function o(d,f,p){if(f){var g,y,S;if(f.__r3f&&(f.__r3f.parent=null),(g=d.__r3f)!=null&&g.objects&&(d.__r3f.objects=d.__r3f.objects.filter(R=>R!==f)),(y=f.__r3f)!=null&&y.attach)x2(d,f,f.__r3f.attach);else if(f.isObject3D&&d.isObject3D){var x;d.remove(f),(x=f.__r3f)!=null&&x.root&&eQ(I_(f),f)}const w=(S=f.__r3f)==null?void 0:S.primitive,T=!w&&(p===void 0?f.dispose!==null:p);if(!w){var v;s((v=f.__r3f)==null?void 0:v.objects,f,T),s(f.children,f,T)}if(delete f.__r3f,T&&f.dispose&&f.type!=="Scene"){const R=()=>{try{f.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?m2.unstable_scheduleCallback(m2.unstable_IdlePriority,R):R()}Ch(d)}}function a(d,f,p,g){var y;const S=(y=d.__r3f)==null?void 0:y.parent;if(!S)return;const x=t(f,p,d.__r3f.root);if(d.children){for(const v of d.children)v.__r3f&&r(x,v);d.children=d.children.filter(v=>!v.__r3f)}d.__r3f.objects.forEach(v=>r(x,v)),d.__r3f.objects=[],d.__r3f.autoRemovedBeforeAppend||o(S,d),x.parent&&(x.__r3f.autoRemovedBeforeAppend=!0),r(S,x),x.raycast&&x.__r3f.eventCount&&I_(x).getState().internal.interaction.push(x),[g,g.alternate].forEach(v=>{v!==null&&(v.stateNode=x,v.ref&&(typeof v.ref=="function"?v.ref(x):v.ref.current=x))})}const l=()=>{};return{reconciler:qK({createInstance:t,removeChild:o,appendChild:r,appendInitialChild:r,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(d,f)=>{if(!f)return;const p=d.getState().scene;p.__r3f&&(p.__r3f.root=d,r(p,f))},removeChildFromContainer:(d,f)=>{f&&o(d.getState().scene,f)},insertInContainerBefore:(d,f,p)=>{if(!f||!p)return;const g=d.getState().scene;g.__r3f&&i(g,f,p)},getRootHostContext:()=>null,getChildHostContext:d=>d,finalizeInitialChildren(d){var f;return!!((f=d==null?void 0:d.__r3f)!=null?f:{}).handlers},prepareUpdate(d,f,p,g){var y;if(((y=d==null?void 0:d.__r3f)!=null?y:{}).primitive&&g.object&&g.object!==d)return[!0];{const{args:x=[],children:v,...w}=g,{args:T=[],children:R,...U}=p;if(!Array.isArray(x))throw new Error("R3F: the args prop must be an array!");if(x.some((P,b)=>P!==T[b]))return[!0];const N=qU(d,w,U,!0);return N.changes.length?[!1,N]:null}},commitUpdate(d,[f,p],g,y,S,x){f?a(d,g,S,x):ow(d,p)},commitMount(d,f,p,g){var y;const S=(y=d.__r3f)!=null?y:{};d.raycast&&S.handlers&&S.eventCount&&I_(d).getState().internal.interaction.push(d)},getPublicInstance:d=>d,prepareForCommit:()=>null,preparePortalMount:d=>Ah(d.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(d){var f;const{attach:p,parent:g}=(f=d.__r3f)!=null?f:{};p&&g&&x2(g,d,p),d.isObject3D&&(d.visible=!1),Ch(d)},unhideInstance(d,f){var p;const{attach:g,parent:y}=(p=d.__r3f)!=null?p:{};g&&y&&sw(y,d,g),(d.isObject3D&&f.visible==null||f.visible)&&(d.visible=!0),Ch(d)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():$h.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&qn.fun(performance.now)?performance.now:qn.fun(Date.now)?Date.now:()=>0,scheduleTimeout:qn.fun(setTimeout)?setTimeout:void 0,cancelTimeout:qn.fun(clearTimeout)?clearTimeout:void 0}),applyProps:ow}}var g2,v2;const iw=n=>"colorSpace"in n||"outputColorSpace"in n,BU=()=>{var n;return(n=vA.ColorManagement)!=null?n:null},zU=n=>n&&n.isOrthographicCamera,$K=n=>n&&n.hasOwnProperty("current"),Wm=typeof window<"u"&&((g2=window.document)!=null&&g2.createElement||((v2=window.navigator)==null?void 0:v2.product)==="ReactNative")?fe.useLayoutEffect:fe.useEffect;function HU(n){const e=fe.useRef(n);return Wm(()=>void(e.current=n),[n]),e}function YK({set:n}){return Wm(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}class GU extends fe.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}GU.getDerivedStateFromError=()=>({error:!0});const WU="__default",_2=new Map,KK=n=>n&&!!n.memoized&&!!n.changes;function jU(n){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],t),n[1]):n}const Rf=n=>{var e;return(e=n.__r3f)==null?void 0:e.root.getState()};function I_(n){let e=n.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const qn={obj:n=>n===Object(n)&&!qn.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,arr:n=>Array.isArray(n),equ(n,e,{arrays:t="shallow",objects:r="reference",strict:i=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(qn.str(n)||qn.num(n)||qn.boo(n))return n===e;const s=qn.obj(n);if(s&&r==="reference")return n===e;const o=qn.arr(n);if(o&&t==="reference")return n===e;if((o||s)&&n===e)return!0;let a;for(a in n)if(!(a in e))return!1;if(s&&t==="shallow"&&r==="shallow"){for(a in i?e:n)if(!qn.equ(n[a],e[a],{strict:i,objects:"reference"}))return!1}else for(a in i?e:n)if(n[a]!==e[a])return!1;if(qn.und(a)){if(o&&n.length===0&&e.length===0||s&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function QK(n){const e={nodes:{},materials:{}};return n&&n.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material)}),e}function ZK(n){n.dispose&&n.type!=="Scene"&&n.dispose();for(const e in n)e.dispose==null||e.dispose(),delete n[e]}function Ah(n,e){const t=n;return t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},n}function AT(n,e){let t=n;if(e.includes("-")){const r=e.split("-"),i=r.pop();return t=r.reduce((s,o)=>s[o],n),{target:t,key:i}}else return{target:t,key:e}}const y2=/-\d+$/;function sw(n,e,t){if(qn.str(t)){if(y2.test(t)){const s=t.replace(y2,""),{target:o,key:a}=AT(n,s);Array.isArray(o[a])||(o[a]=[])}const{target:r,key:i}=AT(n,t);e.__r3f.previousAttach=r[i],r[i]=e}else e.__r3f.previousAttach=t(n,e)}function x2(n,e,t){var r,i;if(qn.str(t)){const{target:s,key:o}=AT(n,t),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(r=e.__r3f)==null||r.previousAttach==null||r.previousAttach(n,e);(i=e.__r3f)==null||delete i.previousAttach}function qU(n,{children:e,key:t,ref:r,...i},{children:s,key:o,ref:a,...l}={},u=!1){const d=n.__r3f,f=Object.entries(i),p=[];if(u){const y=Object.keys(l);for(let S=0;S<y.length;S++)i.hasOwnProperty(y[S])||f.unshift([y[S],WU+"remove"])}f.forEach(([y,S])=>{var x;if((x=n.__r3f)!=null&&x.primitive&&y==="object"||qn.equ(S,l[y]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(y))return p.push([y,S,!0,[]]);let v=[];y.includes("-")&&(v=y.split("-")),p.push([y,S,!1,v]);for(const w in i){const T=i[w];w.startsWith(`${y}-`)&&p.push([w,T,!1,w.split("-")])}});const g={...i};return d!=null&&d.memoizedProps&&d!=null&&d.memoizedProps.args&&(g.args=d.memoizedProps.args),d!=null&&d.memoizedProps&&d!=null&&d.memoizedProps.attach&&(g.attach=d.memoizedProps.attach),{memoized:g,changes:p}}function ow(n,e){var t;const r=n.__r3f,i=r==null?void 0:r.root,s=i==null||i.getState==null?void 0:i.getState(),{memoized:o,changes:a}=KK(e)?e:qU(n,e),l=r==null?void 0:r.eventCount;n.__r3f&&(n.__r3f.memoizedProps=o);for(let d=0;d<a.length;d++){let[f,p,g,y]=a[d];if(iw(n)){const w="srgb",T="srgb-linear";f==="encoding"?(f="colorSpace",p=p===3001?w:T):f==="outputEncoding"&&(f="outputColorSpace",p=p===3001?w:T)}let S=n,x=S[f];if(y.length&&(x=y.reduce((v,w)=>v[w],n),!(x&&x.set))){const[v,...w]=y.reverse();S=w.reverse().reduce((T,R)=>T[R],n),f=v}if(p===WU+"remove")if(S.constructor){let v=_2.get(S.constructor);v||(v=new S.constructor,_2.set(S.constructor,v)),p=v[f]}else p=0;if(g&&r)p?r.handlers[f]=p:delete r.handlers[f],r.eventCount=Object.keys(r.handlers).length;else if(x&&x.set&&(x.copy||x instanceof sc)){if(Array.isArray(p))x.fromArray?x.fromArray(p):x.set(...p);else if(x.copy&&p&&p.constructor&&x.constructor===p.constructor)x.copy(p);else if(p!==void 0){const v=x instanceof Tt;!v&&x.setScalar?x.setScalar(p):x instanceof sc&&p instanceof sc?x.mask=p.mask:x.set(p),!BU()&&s&&!s.linear&&v&&x.convertSRGBToLinear()}}else if(S[f]=p,S[f]instanceof Un&&S[f].format===kr&&S[f].type===bs&&s){const v=S[f];iw(v)&&iw(s.gl)?v.colorSpace=s.gl.outputColorSpace:v.encoding=s.gl.outputEncoding}Ch(n)}if(r&&r.parent&&n.raycast&&l!==r.eventCount){const d=I_(n).getState().internal,f=d.interaction.indexOf(n);f>-1&&d.interaction.splice(f,1),r.eventCount&&d.interaction.push(n)}return!(a.length===1&&a[0][0]==="onUpdate")&&a.length&&(t=n.__r3f)!=null&&t.parent&&CT(n),n}function Ch(n){var e,t;const r=(e=n.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();r&&r.internal.frames===0&&r.invalidate()}function CT(n){n.onUpdate==null||n.onUpdate(n)}function XU(n,e){n.manual||(zU(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix(),n.updateMatrixWorld())}function Xv(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function JK(){var n;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return $h.DefaultEventPriority;switch((n=e.event)==null?void 0:n.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return $h.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return $h.ContinuousEventPriority;default:return $h.DefaultEventPriority}}function $U(n,e,t,r){const i=t.get(e);i&&(t.delete(e),t.size===0&&(n.delete(r),i.target.releasePointerCapture(r)))}function eQ(n,e){const{internal:t}=n.getState();t.interaction=t.interaction.filter(r=>r!==e),t.initialHits=t.initialHits.filter(r=>r!==e),t.hovered.forEach((r,i)=>{(r.eventObject===e||r.object===e)&&t.hovered.delete(i)}),t.capturedMap.forEach((r,i)=>{$U(t.capturedMap,e,r,i)})}function tQ(n){function e(l){const{internal:u}=n.getState(),d=l.offsetX-u.initialClick[0],f=l.offsetY-u.initialClick[1];return Math.round(Math.sqrt(d*d+f*f))}function t(l){return l.filter(u=>["Move","Over","Enter","Out","Leave"].some(d=>{var f;return(f=u.__r3f)==null?void 0:f.handlers["onPointer"+d]}))}function r(l,u){const d=n.getState(),f=new Set,p=[],g=u?u(d.internal.interaction):d.internal.interaction;for(let v=0;v<g.length;v++){const w=Rf(g[v]);w&&(w.raycaster.camera=void 0)}d.previousRoot||d.events.compute==null||d.events.compute(l,d);function y(v){const w=Rf(v);if(!w||!w.events.enabled||w.raycaster.camera===null)return[];if(w.raycaster.camera===void 0){var T;w.events.compute==null||w.events.compute(l,w,(T=w.previousRoot)==null?void 0:T.getState()),w.raycaster.camera===void 0&&(w.raycaster.camera=null)}return w.raycaster.camera?w.raycaster.intersectObject(v,!0):[]}let S=g.flatMap(y).sort((v,w)=>{const T=Rf(v.object),R=Rf(w.object);return!T||!R?v.distance-w.distance:R.events.priority-T.events.priority||v.distance-w.distance}).filter(v=>{const w=Xv(v);return f.has(w)?!1:(f.add(w),!0)});d.events.filter&&(S=d.events.filter(S,d));for(const v of S){let w=v.object;for(;w;){var x;(x=w.__r3f)!=null&&x.eventCount&&p.push({...v,eventObject:w}),w=w.parent}}if("pointerId"in l&&d.internal.capturedMap.has(l.pointerId))for(let v of d.internal.capturedMap.get(l.pointerId).values())f.has(Xv(v.intersection))||p.push(v.intersection);return p}function i(l,u,d,f){const p=n.getState();if(l.length){const g={stopped:!1};for(const y of l){const S=Rf(y.object)||p,{raycaster:x,pointer:v,camera:w,internal:T}=S,R=new Q(v.x,v.y,0).unproject(w),U=A=>{var L,z;return(L=(z=T.capturedMap.get(A))==null?void 0:z.has(y.eventObject))!=null?L:!1},N=A=>{const L={intersection:y,target:u.target};T.capturedMap.has(A)?T.capturedMap.get(A).set(y.eventObject,L):T.capturedMap.set(A,new Map([[y.eventObject,L]])),u.target.setPointerCapture(A)},P=A=>{const L=T.capturedMap.get(A);L&&$U(T.capturedMap,y.eventObject,L,A)};let b={};for(let A in u){let L=u[A];typeof L!="function"&&(b[A]=L)}let M={...y,...b,pointer:v,intersections:l,stopped:g.stopped,delta:d,unprojectedPoint:R,ray:x.ray,camera:w,stopPropagation(){const A="pointerId"in u&&T.capturedMap.get(u.pointerId);if((!A||A.has(y.eventObject))&&(M.stopped=g.stopped=!0,T.hovered.size&&Array.from(T.hovered.values()).find(L=>L.eventObject===y.eventObject))){const L=l.slice(0,l.indexOf(y));s([...L,y])}},target:{hasPointerCapture:U,setPointerCapture:N,releasePointerCapture:P},currentTarget:{hasPointerCapture:U,setPointerCapture:N,releasePointerCapture:P},nativeEvent:u};if(f(M),g.stopped===!0)break}}return l}function s(l){const{internal:u}=n.getState();for(const d of u.hovered.values())if(!l.length||!l.find(f=>f.object===d.object&&f.index===d.index&&f.instanceId===d.instanceId)){const p=d.eventObject.__r3f,g=p==null?void 0:p.handlers;if(u.hovered.delete(Xv(d)),p!=null&&p.eventCount){const y={...d,intersections:l};g.onPointerOut==null||g.onPointerOut(y),g.onPointerLeave==null||g.onPointerLeave(y)}}}function o(l,u){for(let d=0;d<u.length;d++){const f=u[d].__r3f;f==null||f.handlers.onPointerMissed==null||f.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return u=>{const{internal:d}=n.getState();"pointerId"in u&&d.capturedMap.has(u.pointerId)&&requestAnimationFrame(()=>{d.capturedMap.has(u.pointerId)&&(d.capturedMap.delete(u.pointerId),s([]))})}}return function(d){const{onPointerMissed:f,internal:p}=n.getState();p.lastEvent.current=d;const g=l==="onPointerMove",y=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",x=r(d,g?t:void 0),v=y?e(d):0;l==="onPointerDown"&&(p.initialClick=[d.offsetX,d.offsetY],p.initialHits=x.map(T=>T.eventObject)),y&&!x.length&&v<=2&&(o(d,p.interaction),f&&f(d)),g&&s(x);function w(T){const R=T.eventObject,U=R.__r3f,N=U==null?void 0:U.handlers;if(U!=null&&U.eventCount)if(g){if(N.onPointerOver||N.onPointerEnter||N.onPointerOut||N.onPointerLeave){const P=Xv(T),b=p.hovered.get(P);b?b.stopped&&T.stopPropagation():(p.hovered.set(P,T),N.onPointerOver==null||N.onPointerOver(T),N.onPointerEnter==null||N.onPointerEnter(T))}N.onPointerMove==null||N.onPointerMove(T)}else{const P=N[l];P?(!y||p.initialHits.includes(R))&&(o(d,p.interaction.filter(b=>!p.initialHits.includes(b))),P(T)):y&&p.initialHits.includes(R)&&o(d,p.interaction.filter(b=>!p.initialHits.includes(b)))}}i(x,d,v,w)}}return{handlePointer:a}}const nQ=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],YU=n=>!!(n!=null&&n.render),_A=fe.createContext(null),rQ=(n,e)=>{const t=LU((a,l)=>{const u=new Q,d=new Q,f=new Q;function p(v=l().camera,w=d,T=l().size){const{width:R,height:U,top:N,left:P}=T,b=R/U;w instanceof Q?f.copy(w):f.set(...w);const M=v.getWorldPosition(u).distanceTo(f);if(zU(v))return{width:R/v.zoom,height:U/v.zoom,top:N,left:P,factor:1,distance:M,aspect:b};{const A=v.fov*Math.PI/180,L=2*Math.tan(A/2)*M,z=L*(R/U);return{width:z,height:L,top:N,left:P,factor:R/z,distance:M,aspect:b}}}let g;const y=v=>a(w=>({performance:{...w.performance,current:v}})),S=new Ue;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(v=1)=>n(l(),v),advance:(v,w)=>e(v,w,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new dA,pointer:S,mouse:S,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const v=l();g&&clearTimeout(g),v.performance.current!==v.performance.min&&y(v.performance.min),g=setTimeout(()=>y(l().performance.max),v.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:p},setEvents:v=>a(w=>({...w,events:{...w.events,...v}})),setSize:(v,w,T,R,U)=>{const N=l().camera,P={width:v,height:w,top:R||0,left:U||0,updateStyle:T};a(b=>({size:P,viewport:{...b.viewport,...p(N,d,P)}}))},setDpr:v=>a(w=>{const T=jU(v);return{viewport:{...w.viewport,dpr:T,initialDpr:w.viewport.initialDpr||T}}}),setFrameloop:(v="always")=>{const w=l().clock;w.stop(),w.elapsedTime=0,v!=="never"&&(w.start(),w.elapsedTime=0),a(()=>({frameloop:v}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:fe.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(v,w,T)=>{const R=l().internal;return R.priority=R.priority+(w>0?1:0),R.subscribers.push({ref:v,priority:w,store:T}),R.subscribers=R.subscribers.sort((U,N)=>U.priority-N.priority),()=>{const U=l().internal;U!=null&&U.subscribers&&(U.priority=U.priority-(w>0?1:0),U.subscribers=U.subscribers.filter(N=>N.ref!==v))}}}}}),r=t.getState();let i=r.size,s=r.viewport.dpr,o=r.camera;return t.subscribe(()=>{const{camera:a,size:l,viewport:u,gl:d,set:f}=t.getState();if(l.width!==i.width||l.height!==i.height||u.dpr!==s){var p;i=l,s=u.dpr,XU(a,l),d.setPixelRatio(u.dpr);const g=(p=l.updateStyle)!=null?p:typeof HTMLCanvasElement<"u"&&d.domElement instanceof HTMLCanvasElement;d.setSize(l.width,l.height,g)}a!==o&&(o=a,f(g=>({viewport:{...g.viewport,...g.viewport.getCurrentViewport(a)}})))}),t.subscribe(a=>n(a)),t};let $v,iQ=new Set,sQ=new Set,oQ=new Set;function aw(n,e){if(n.size)for(const{callback:t}of n.values())t(e)}function Pf(n,e){switch(n){case"before":return aw(iQ,e);case"after":return aw(sQ,e);case"tail":return aw(oQ,e)}}let lw,uw;function cw(n,e,t){let r=e.clock.getDelta();for(e.frameloop==="never"&&typeof n=="number"&&(r=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),lw=e.internal.subscribers,$v=0;$v<lw.length;$v++)uw=lw[$v],uw.ref.current(uw.store.getState(),r,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function aQ(n){let e=!1,t=!1,r,i,s;function o(u){i=requestAnimationFrame(o),e=!0,r=0,Pf("before",u),t=!0;for(const f of n.values()){var d;s=f.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((d=s.gl.xr)!=null&&d.isPresenting)&&(r+=cw(u,s))}if(t=!1,Pf("after",u),r===0)return Pf("tail",u),e=!1,cancelAnimationFrame(i)}function a(u,d=1){var f;if(!u)return n.forEach(p=>a(p.store.getState(),d));(f=u.gl.xr)!=null&&f.isPresenting||!u.internal.active||u.frameloop==="never"||(d>1?u.internal.frames=Math.min(60,u.internal.frames+d):t?u.internal.frames=2:u.internal.frames=1,e||(e=!0,requestAnimationFrame(o)))}function l(u,d=!0,f,p){if(d&&Pf("before",u),f)cw(u,f,p);else for(const g of n.values())cw(u,g.store.getState());d&&Pf("after",u)}return{loop:o,invalidate:a,advance:l}}function yA(){const n=fe.useContext(_A);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function Mi(n=t=>t,e){return yA()(n,e)}function jm(n,e=0){const t=yA(),r=t.getState().internal.subscribe,i=HU(n);return Wm(()=>r(i,e,t),[e,r,t]),null}const E2=new WeakMap;function KU(n,e){return function(t,...r){let i=E2.get(t);return i||(i=new t,E2.set(t,i)),n&&n(i),Promise.all(r.map(s=>new Promise((o,a)=>i.load(s,l=>{l.scene&&Object.assign(l,QK(l.scene)),o(l)},e,l=>a(new Error(`Could not load ${s}: ${l==null?void 0:l.message}`))))))}}function La(n,e,t,r){const i=Array.isArray(e)?e:[e],s=VK(KU(t,r),[n,...i],{equal:qn.equ});return Array.isArray(e)?s:s[0]}La.preload=function(n,e,t){const r=Array.isArray(e)?e:[e];return BK(KU(t),[n,...r])};La.clear=function(n,e){const t=Array.isArray(e)?e:[e];return zK([n,...t])};const Ad=new Map,{invalidate:w2,advance:S2}=aQ(Ad),{reconciler:um,applyProps:ul}=XK(Ad,JK),xh={objects:"shallow",strict:!1},lQ=(n,e)=>{const t=typeof n=="function"?n(e):n;return YU(t)?t:new w0({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...n})};function uQ(n,e){const t=typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement;if(e){const{width:r,height:i,top:s,left:o,updateStyle:a=t}=e;return{width:r,height:i,top:s,left:o,updateStyle:a}}else if(typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:r,height:i,top:s,left:o}=n.parentElement.getBoundingClientRect();return{width:r,height:i,top:s,left:o,updateStyle:t}}else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0,updateStyle:t};return{width:0,height:0,top:0,left:0}}function cQ(n){const e=Ad.get(n),t=e==null?void 0:e.fiber,r=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const i=typeof reportError=="function"?reportError:console.error,s=r||rQ(w2,S2),o=t||um.createContainer(s,$h.ConcurrentRoot,null,!1,null,"",i,null);e||Ad.set(n,{fiber:o,store:s});let a,l=!1,u;return{configure(d={}){let{gl:f,size:p,scene:g,events:y,onCreated:S,shadows:x=!1,linear:v=!1,flat:w=!1,legacy:T=!1,orthographic:R=!1,frameloop:U="always",dpr:N=[1,2],performance:P,raycaster:b,camera:M,onPointerMissed:A}=d,L=s.getState(),z=L.gl;L.gl||L.set({gl:z=lQ(f,n)});let B=L.raycaster;B||L.set({raycaster:B=new gA});const{params:$,...he}=b||{};if(qn.equ(he,B,xh)||ul(B,{...he}),qn.equ($,B.params,xh)||ul(B,{params:{...B.params,...$}}),!L.camera||L.camera===u&&!qn.equ(u,M,xh)){u=M;const K=M instanceof Om,ce=K?M:R?new wa(0,0,0,0,.1,1e3):new Sr(75,0,.1,1e3);K||(ce.position.z=5,M&&(ul(ce,M),("aspect"in M||"left"in M||"right"in M||"bottom"in M||"top"in M)&&(ce.manual=!0,ce.updateProjectionMatrix())),!L.camera&&!(M!=null&&M.rotation)&&ce.lookAt(0,0,0)),L.set({camera:ce}),B.camera=ce}if(!L.scene){let K;g instanceof Td?K=g:(K=new Td,g&&ul(K,g)),L.set({scene:Ah(K)})}if(!L.xr){var te;const K=(ue,Ee)=>{const Fe=s.getState();Fe.frameloop!=="never"&&S2(ue,!0,Fe,Ee)},ce=()=>{const ue=s.getState();ue.gl.xr.enabled=ue.gl.xr.isPresenting,ue.gl.xr.setAnimationLoop(ue.gl.xr.isPresenting?K:null),ue.gl.xr.isPresenting||w2(ue)},de={connect(){const ue=s.getState().gl;ue.xr.addEventListener("sessionstart",ce),ue.xr.addEventListener("sessionend",ce)},disconnect(){const ue=s.getState().gl;ue.xr.removeEventListener("sessionstart",ce),ue.xr.removeEventListener("sessionend",ce)}};typeof((te=z.xr)==null?void 0:te.addEventListener)=="function"&&de.connect(),L.set({xr:de})}if(z.shadowMap){const K=z.shadowMap.enabled,ce=z.shadowMap.type;if(z.shadowMap.enabled=!!x,qn.boo(x))z.shadowMap.type=lp;else if(qn.str(x)){var ye;const de={basic:Mk,percentage:p0,soft:lp,variance:co};z.shadowMap.type=(ye=de[x])!=null?ye:lp}else qn.obj(x)&&Object.assign(z.shadowMap,x);(K!==z.shadowMap.enabled||ce!==z.shadowMap.type)&&(z.shadowMap.needsUpdate=!0)}const G=BU();G&&("enabled"in G?G.enabled=!T:"legacyMode"in G&&(G.legacyMode=T)),l||ul(z,{outputEncoding:v?3e3:3001,toneMapping:w?qo:CM}),L.legacy!==T&&L.set(()=>({legacy:T})),L.linear!==v&&L.set(()=>({linear:v})),L.flat!==w&&L.set(()=>({flat:w})),f&&!qn.fun(f)&&!YU(f)&&!qn.equ(f,z,xh)&&ul(z,f),y&&!L.events.handlers&&L.set({events:y(s)});const Z=uQ(n,p);return qn.equ(Z,L.size,xh)||L.setSize(Z.width,Z.height,Z.updateStyle,Z.top,Z.left),N&&L.viewport.dpr!==jU(N)&&L.setDpr(N),L.frameloop!==U&&L.setFrameloop(U),L.onPointerMissed||L.set({onPointerMissed:A}),P&&!qn.equ(P,L.performance,xh)&&L.set(K=>({performance:{...K.performance,...P}})),a=S,l=!0,this},render(d){return l||this.configure(),um.updateContainer(F.jsx(hQ,{store:s,children:d,onCreated:a,rootElement:n}),o,null,()=>{}),s},unmount(){QU(n)}}}function hQ({store:n,children:e,onCreated:t,rootElement:r}){return Wm(()=>{const i=n.getState();i.set(s=>({internal:{...s.internal,active:!0}})),t&&t(i),n.getState().events.connected||i.events.connect==null||i.events.connect(r)},[]),F.jsx(_A.Provider,{value:n,children:e})}function QU(n,e){const t=Ad.get(n),r=t==null?void 0:t.fiber;if(r){const i=t==null?void 0:t.store.getState();i&&(i.internal.active=!1),um.updateContainer(null,r,null,()=>{i&&setTimeout(()=>{try{var s,o,a,l;i.events.disconnect==null||i.events.disconnect(),(s=i.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=i.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=i.gl)!=null&&l.xr&&i.xr.disconnect(),ZK(i),Ad.delete(n)}catch{}},500)})}}function dQ(n,e,t){return F.jsx(fQ,{children:n,container:e,state:t},e.uuid)}function fQ({state:n={},children:e,container:t}){const{events:r,size:i,...s}=n,o=yA(),[a]=fe.useState(()=>new gA),[l]=fe.useState(()=>new Ue),u=fe.useCallback((f,p)=>{const g={...f};Object.keys(f).forEach(S=>{(nQ.includes(S)||f[S]!==p[S]&&p[S])&&delete g[S]});let y;if(p&&i){const S=p.camera;y=f.viewport.getCurrentViewport(S,new Q,i),S!==f.camera&&XU(S,i)}return{...g,scene:t,raycaster:a,pointer:l,mouse:l,previousRoot:o,events:{...f.events,...p==null?void 0:p.events,...r},size:{...f.size,...i},viewport:{...f.viewport,...y},...s}},[n]),[d]=fe.useState(()=>{const f=o.getState();return LU((g,y)=>({...f,scene:t,raycaster:a,pointer:l,mouse:l,previousRoot:o,events:{...f.events,...r},size:{...f.size,...i},...s,set:g,get:y,setEvents:S=>g(x=>({...x,events:{...x.events,...S}}))}))});return fe.useEffect(()=>{const f=o.subscribe(p=>d.setState(g=>u(p,g)));return()=>{f()}},[u]),fe.useEffect(()=>{d.setState(f=>u(o.getState(),f))},[u]),fe.useEffect(()=>()=>{d.destroy()},[]),F.jsx(F.Fragment,{children:um.createPortal(F.jsx(_A.Provider,{value:d,children:e}),d,null)})}um.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:fe.version});const hw={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function pQ(n){const{handlePointer:e}=tQ(n);return{priority:1,enabled:!0,compute(t,r,i){r.pointer.set(t.offsetX/r.size.width*2-1,-(t.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(hw).reduce((t,r)=>({...t,[r]:e(r)}),{}),update:()=>{var t;const{events:r,internal:i}=n.getState();(t=i.lastEvent)!=null&&t.current&&r.handlers&&r.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{var r;const{set:i,events:s}=n.getState();s.disconnect==null||s.disconnect(),i(o=>({events:{...o.events,connected:t}})),Object.entries((r=s.handlers)!=null?r:[]).forEach(([o,a])=>{const[l,u]=hw[o];t.addEventListener(l,a,{passive:u})})},disconnect:()=>{const{set:t,events:r}=n.getState();if(r.connected){var i;Object.entries((i=r.handlers)!=null?i:[]).forEach(([s,o])=>{if(r&&r.connected instanceof HTMLElement){const[a]=hw[s];r.connected.removeEventListener(a,o)}}),t(s=>({events:{...s.events,connected:void 0}}))}}}}function IT(n,e,t){var r,i,s,o,a;e==null&&(e=100);function l(){var d=Date.now()-o;d<e&&d>=0?r=setTimeout(l,e-d):(r=null,t||(a=n.apply(s,i),s=i=null))}var u=function(){s=this,i=arguments,o=Date.now();var d=t&&!r;return r||(r=setTimeout(l,e)),d&&(a=n.apply(s,i),s=i=null),a};return u.clear=function(){r&&(clearTimeout(r),r=null)},u.flush=function(){r&&(a=n.apply(s,i),s=i=null,clearTimeout(r),r=null)},u}IT.debounce=IT;var mQ=IT;const T2=PT(mQ);var gQ=Object.defineProperty,vQ=Object.defineProperties,_Q=Object.getOwnPropertyDescriptors,M2=Object.getOwnPropertySymbols,yQ=Object.prototype.hasOwnProperty,xQ=Object.prototype.propertyIsEnumerable,A2=(n,e,t)=>e in n?gQ(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,C2=(n,e)=>{for(var t in e||(e={}))yQ.call(e,t)&&A2(n,t,e[t]);if(M2)for(var t of M2(e))xQ.call(e,t)&&A2(n,t,e[t]);return n},EQ=(n,e)=>vQ(n,_Q(e)),I2,b2;typeof window<"u"&&((I2=window.document)!=null&&I2.createElement||((b2=window.navigator)==null?void 0:b2.product)==="ReactNative")?fe.useLayoutEffect:fe.useEffect;function ZU(n,e,t){if(!n)return;if(t(n)===!0)return n;let r=n.child;for(;r;){const i=ZU(r,e,t);if(i)return i;r=r.sibling}}function JU(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const R2=console.error;console.error=function(){const n=[...arguments].join("");if(n!=null&&n.startsWith("Warning:")&&n.includes("useContext")){console.error=R2;return}return R2.apply(this,arguments)};const xA=JU(fe.createContext(null));class eF extends fe.Component{render(){return fe.createElement(xA.Provider,{value:this._reactInternals},this.props.children)}}function wQ(){const n=fe.useContext(xA);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=fe.useId();return fe.useMemo(()=>{for(const r of[n,n==null?void 0:n.alternate]){if(!r)continue;const i=ZU(r,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(i)return i}},[n,e])}function SQ(){const n=wQ(),[e]=fe.useState(()=>new Map);e.clear();let t=n;for(;t;){if(t.type&&typeof t.type=="object"){const i=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;i&&i!==xA&&!e.has(i)&&e.set(i,fe.useContext(JU(i)))}t=t.return}return e}function TQ(){const n=SQ();return fe.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>r=>fe.createElement(e,null,fe.createElement(t.Provider,EQ(C2({},r),{value:n.get(t)}))),e=>fe.createElement(eF,C2({},e))),[n])}function MQ({debounce:n,scroll:e,polyfill:t,offsetSize:r}={debounce:0,scroll:!1,offsetSize:!1}){const i=t||typeof window<"u"&&window.ResizeObserver,[s,o]=fe.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0});if(!i)return s.width=1280,s.height=800,[()=>{},s,()=>{}];const a=fe.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),l=n?typeof n=="number"?n:n.scroll:null,u=n?typeof n=="number"?n:n.resize:null,d=fe.useRef(!1);fe.useEffect(()=>(d.current=!0,()=>void(d.current=!1)));const[f,p,g]=fe.useMemo(()=>{const v=()=>{if(!a.current.element)return;const{left:w,top:T,width:R,height:U,bottom:N,right:P,x:b,y:M}=a.current.element.getBoundingClientRect(),A={left:w,top:T,width:R,height:U,bottom:N,right:P,x:b,y:M};a.current.element instanceof HTMLElement&&r&&(A.height=a.current.element.offsetHeight,A.width=a.current.element.offsetWidth),Object.freeze(A),d.current&&!bQ(a.current.lastBounds,A)&&o(a.current.lastBounds=A)};return[v,u?T2(v,u):v,l?T2(v,l):v]},[o,r,l,u]);function y(){a.current.scrollContainers&&(a.current.scrollContainers.forEach(v=>v.removeEventListener("scroll",g,!0)),a.current.scrollContainers=null),a.current.resizeObserver&&(a.current.resizeObserver.disconnect(),a.current.resizeObserver=null),a.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",a.current.orientationHandler))}function S(){var v;a.current.element&&(a.current.resizeObserver=new i(p),(v=a.current.resizeObserver)==null||v.observe(a.current.element),e&&a.current.scrollContainers&&a.current.scrollContainers.forEach(w=>w.addEventListener("scroll",g,{capture:!0,passive:!0})),a.current.orientationHandler=()=>{g()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",a.current.orientationHandler))}const x=v=>{!v||v===a.current.element||(y(),a.current.element=v,a.current.scrollContainers=tF(v),S())};return CQ(g,!!e),AQ(p),fe.useEffect(()=>{y(),S()},[e,g,p]),fe.useEffect(()=>y,[]),[x,s,f]}function AQ(n){fe.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function CQ(n,e){fe.useEffect(()=>{if(e){const t=n;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[n,e])}function tF(n){const e=[];if(!n||n===document.body)return e;const{overflow:t,overflowX:r,overflowY:i}=window.getComputedStyle(n);return[t,r,i].some(s=>s==="auto"||s==="scroll")&&e.push(n),[...e,...tF(n.parentElement)]}const IQ=["x","y","top","bottom","left","right","width","height"],bQ=(n,e)=>IQ.every(t=>n[t]===e[t]),RQ=fe.forwardRef(function({children:e,fallback:t,resize:r,style:i,gl:s,events:o=pQ,eventSource:a,eventPrefix:l,shadows:u,linear:d,flat:f,legacy:p,orthographic:g,frameloop:y,dpr:S,performance:x,raycaster:v,camera:w,scene:T,onPointerMissed:R,onCreated:U,...N},P){fe.useMemo(()=>VU(kK),[]);const b=TQ(),[M,A]=MQ({scroll:!0,debounce:{scroll:50,resize:0},...r}),L=fe.useRef(null),z=fe.useRef(null);fe.useImperativeHandle(P,()=>L.current);const B=HU(R),[$,he]=fe.useState(!1),[te,ye]=fe.useState(!1);if($)throw $;if(te)throw te;const G=fe.useRef(null);Wm(()=>{const K=L.current;A.width>0&&A.height>0&&K&&(G.current||(G.current=cQ(K)),G.current.configure({gl:s,events:o,shadows:u,linear:d,flat:f,legacy:p,orthographic:g,frameloop:y,dpr:S,performance:x,raycaster:v,camera:w,scene:T,size:A,onPointerMissed:(...ce)=>B.current==null?void 0:B.current(...ce),onCreated:ce=>{ce.events.connect==null||ce.events.connect(a?$K(a)?a.current:a:z.current),l&&ce.setEvents({compute:(de,ue)=>{const Ee=de[l+"X"],Fe=de[l+"Y"];ue.pointer.set(Ee/ue.size.width*2-1,-(Fe/ue.size.height)*2+1),ue.raycaster.setFromCamera(ue.pointer,ue.camera)}}),U==null||U(ce)}}),G.current.render(F.jsx(b,{children:F.jsx(GU,{set:ye,children:F.jsx(fe.Suspense,{fallback:F.jsx(YK,{set:he}),children:e})})})))}),fe.useEffect(()=>{const K=L.current;if(K)return()=>QU(K)},[]);const Z=a?"none":"auto";return F.jsx("div",{ref:z,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:Z,...i},...N,children:F.jsx("div",{ref:M,style:{width:"100%",height:"100%"},children:F.jsx("canvas",{ref:L,style:{display:"block"},children:t})})})}),PQ=fe.forwardRef(function(e,t){return F.jsx(eF,{children:F.jsx(RQ,{...e,ref:t})})});function cm(){return cm=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},cm.apply(null,arguments)}const nF=parseInt(Nm.replace(/\D+/g,""));var $s=Uint8Array,yl=Uint16Array,bT=Uint32Array,rF=new $s([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),iF=new $s([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),NQ=new $s([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),sF=function(n,e){for(var t=new yl(31),r=0;r<31;++r)t[r]=e+=1<<n[r-1];for(var i=new bT(t[30]),r=1;r<30;++r)for(var s=t[r];s<t[r+1];++s)i[s]=s-t[r]<<5|r;return[t,i]},oF=sF(rF,2),aF=oF[0],LQ=oF[1];aF[28]=258,LQ[258]=28;var DQ=sF(iF,0),kQ=DQ[0],RT=new yl(32768);for(var Qn=0;Qn<32768;++Qn){var sl=(Qn&43690)>>>1|(Qn&21845)<<1;sl=(sl&52428)>>>2|(sl&13107)<<2,sl=(sl&61680)>>>4|(sl&3855)<<4,RT[Qn]=((sl&65280)>>>8|(sl&255)<<8)>>>1}var pp=function(n,e,t){for(var r=n.length,i=0,s=new yl(e);i<r;++i)++s[n[i]-1];var o=new yl(e);for(i=0;i<e;++i)o[i]=o[i-1]+s[i-1]<<1;var a;if(t){a=new yl(1<<e);var l=15-e;for(i=0;i<r;++i)if(n[i])for(var u=i<<4|n[i],d=e-n[i],f=o[n[i]-1]++<<d,p=f|(1<<d)-1;f<=p;++f)a[RT[f]>>>l]=u}else for(a=new yl(r),i=0;i<r;++i)n[i]&&(a[i]=RT[o[n[i]-1]++]>>>15-n[i]);return a},qm=new $s(288);for(var Qn=0;Qn<144;++Qn)qm[Qn]=8;for(var Qn=144;Qn<256;++Qn)qm[Qn]=9;for(var Qn=256;Qn<280;++Qn)qm[Qn]=7;for(var Qn=280;Qn<288;++Qn)qm[Qn]=8;var lF=new $s(32);for(var Qn=0;Qn<32;++Qn)lF[Qn]=5;var OQ=pp(qm,9,1),UQ=pp(lF,5,1),dw=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},lo=function(n,e,t){var r=e/8|0;return(n[r]|n[r+1]<<8)>>(e&7)&t},fw=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(e&7)},FQ=function(n){return(n/8|0)+(n&7&&1)},VQ=function(n,e,t){(t==null||t>n.length)&&(t=n.length);var r=new(n instanceof yl?yl:n instanceof bT?bT:$s)(t-e);return r.set(n.subarray(e,t)),r},BQ=function(n,e,t){var r=n.length;if(!r||t&&!t.l&&r<5)return e||new $s(0);var i=!e||t,s=!t||t.i;t||(t={}),e||(e=new $s(r*3));var o=function(ke){var Ye=e.length;if(ke>Ye){var Ct=new $s(Math.max(Ye*2,ke));Ct.set(e),e=Ct}},a=t.f||0,l=t.p||0,u=t.b||0,d=t.l,f=t.d,p=t.m,g=t.n,y=r*8;do{if(!d){t.f=a=lo(n,l,1);var S=lo(n,l+1,3);if(l+=3,S)if(S==1)d=OQ,f=UQ,p=9,g=5;else if(S==2){var T=lo(n,l,31)+257,R=lo(n,l+10,15)+4,U=T+lo(n,l+5,31)+1;l+=14;for(var N=new $s(U),P=new $s(19),b=0;b<R;++b)P[NQ[b]]=lo(n,l+b*3,7);l+=R*3;for(var M=dw(P),A=(1<<M)-1,L=pp(P,M,1),b=0;b<U;){var z=L[lo(n,l,A)];l+=z&15;var x=z>>>4;if(x<16)N[b++]=x;else{var B=0,$=0;for(x==16?($=3+lo(n,l,3),l+=2,B=N[b-1]):x==17?($=3+lo(n,l,7),l+=3):x==18&&($=11+lo(n,l,127),l+=7);$--;)N[b++]=B}}var he=N.subarray(0,T),te=N.subarray(T);p=dw(he),g=dw(te),d=pp(he,p,1),f=pp(te,g,1)}else throw"invalid block type";else{var x=FQ(l)+4,v=n[x-4]|n[x-3]<<8,w=x+v;if(w>r){if(s)throw"unexpected EOF";break}i&&o(u+v),e.set(n.subarray(x,w),u),t.b=u+=v,t.p=l=w*8;continue}if(l>y){if(s)throw"unexpected EOF";break}}i&&o(u+131072);for(var ye=(1<<p)-1,G=(1<<g)-1,Z=l;;Z=l){var B=d[fw(n,l)&ye],K=B>>>4;if(l+=B&15,l>y){if(s)throw"unexpected EOF";break}if(!B)throw"invalid length/literal";if(K<256)e[u++]=K;else if(K==256){Z=l,d=null;break}else{var ce=K-254;if(K>264){var b=K-257,de=rF[b];ce=lo(n,l,(1<<de)-1)+aF[b],l+=de}var ue=f[fw(n,l)&G],Ee=ue>>>4;if(!ue)throw"invalid distance";l+=ue&15;var te=kQ[Ee];if(Ee>3){var de=iF[Ee];te+=fw(n,l)&(1<<de)-1,l+=de}if(l>y){if(s)throw"unexpected EOF";break}i&&o(u+131072);for(var Fe=u+ce;u<Fe;u+=4)e[u]=e[u-te],e[u+1]=e[u+1-te],e[u+2]=e[u+2-te],e[u+3]=e[u+3-te];u=Fe}}t.l=d,t.p=Z,t.b=u,d&&(a=1,t.m=p,t.d=f,t.n=g)}while(!a);return u==e.length?e:VQ(e,0,u)},zQ=new $s(0),HQ=function(n){if((n[0]&15)!=8||n[0]>>>4>7||(n[0]<<8|n[1])%31)throw"invalid zlib data";if(n[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function Yv(n,e){return BQ((HQ(n),n.subarray(2,-4)),e)}var GQ=typeof TextDecoder<"u"&&new TextDecoder,WQ=0;try{GQ.decode(zQ,{stream:!0}),WQ=1}catch{}const jQ=n=>n&&n.isCubeTexture;class qQ extends sr{constructor(e,t){var r,i;const s=jQ(e),a=((i=s?(r=e.image[0])==null?void 0:r.width:e.image.width)!=null?i:1024)/4,l=Math.floor(Math.log2(a)),u=Math.pow(2,l),d=3*Math.max(u,16*7),f=4*u,p=[s?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/d}`,`#define CUBEUV_TEXEL_HEIGHT ${1/f}`,`#define CUBEUV_MAX_MIP ${l}.0`],g=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,y=p.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${nF>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,S={map:{value:e},height:{value:(t==null?void 0:t.height)||15},radius:{value:(t==null?void 0:t.radius)||100}},x=new Bm(1,16),v=new ji({uniforms:S,fragmentShader:y,vertexShader:g,side:mo});super(x,v)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var XQ=Object.defineProperty,$Q=(n,e,t)=>e in n?XQ(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,YQ=(n,e,t)=>($Q(n,e+"",t),t);class KQ{constructor(){YQ(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,e);e.target=null}}}var QQ=Object.defineProperty,ZQ=(n,e,t)=>e in n?QQ(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Xt=(n,e,t)=>(ZQ(n,typeof e!="symbol"?e+"":e,t),t);const Kv=new Ac,P2=new fa,JQ=Math.cos(70*(Math.PI/180)),N2=(n,e)=>(n%e+e)%e;let eZ=class extends KQ{constructor(e,t){super(),Xt(this,"object"),Xt(this,"domElement"),Xt(this,"enabled",!0),Xt(this,"target",new Q),Xt(this,"minDistance",0),Xt(this,"maxDistance",1/0),Xt(this,"minZoom",0),Xt(this,"maxZoom",1/0),Xt(this,"minPolarAngle",0),Xt(this,"maxPolarAngle",Math.PI),Xt(this,"minAzimuthAngle",-1/0),Xt(this,"maxAzimuthAngle",1/0),Xt(this,"enableDamping",!1),Xt(this,"dampingFactor",.05),Xt(this,"enableZoom",!0),Xt(this,"zoomSpeed",1),Xt(this,"enableRotate",!0),Xt(this,"rotateSpeed",1),Xt(this,"enablePan",!0),Xt(this,"panSpeed",1),Xt(this,"screenSpacePanning",!0),Xt(this,"keyPanSpeed",7),Xt(this,"zoomToCursor",!1),Xt(this,"autoRotate",!1),Xt(this,"autoRotateSpeed",2),Xt(this,"reverseOrbit",!1),Xt(this,"reverseHorizontalOrbit",!1),Xt(this,"reverseVerticalOrbit",!1),Xt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Xt(this,"mouseButtons",{LEFT:Vu.ROTATE,MIDDLE:Vu.DOLLY,RIGHT:Vu.PAN}),Xt(this,"touches",{ONE:Bu.ROTATE,TWO:Bu.DOLLY_PAN}),Xt(this,"target0"),Xt(this,"position0"),Xt(this,"zoom0"),Xt(this,"_domElementKeyEvents",null),Xt(this,"getPolarAngle"),Xt(this,"getAzimuthalAngle"),Xt(this,"setPolarAngle"),Xt(this,"setAzimuthalAngle"),Xt(this,"getDistance"),Xt(this,"getZoomScale"),Xt(this,"listenToKeyEvents"),Xt(this,"stopListenToKeyEvents"),Xt(this,"saveState"),Xt(this,"reset"),Xt(this,"update"),Xt(this,"connect"),Xt(this,"dispose"),Xt(this,"dollyIn"),Xt(this,"dollyOut"),Xt(this,"getScale"),Xt(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>d.phi,this.getAzimuthalAngle=()=>d.theta,this.setPolarAngle=ae=>{let Se=N2(ae,2*Math.PI),Je=d.phi;Je<0&&(Je+=2*Math.PI),Se<0&&(Se+=2*Math.PI);let ut=Math.abs(Se-Je);2*Math.PI-ut<ut&&(Se<Je?Se+=2*Math.PI:Je+=2*Math.PI),f.phi=Se-Je,r.update()},this.setAzimuthalAngle=ae=>{let Se=N2(ae,2*Math.PI),Je=d.theta;Je<0&&(Je+=2*Math.PI),Se<0&&(Se+=2*Math.PI);let ut=Math.abs(Se-Je);2*Math.PI-ut<ut&&(Se<Je?Se+=2*Math.PI:Je+=2*Math.PI),f.theta=Se-Je,r.update()},this.getDistance=()=>r.object.position.distanceTo(r.target),this.listenToKeyEvents=ae=>{ae.addEventListener("keydown",lt),this._domElementKeyEvents=ae},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",lt),this._domElementKeyEvents=null},this.saveState=()=>{r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=()=>{r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(i),r.update(),l=a.NONE},this.update=(()=>{const ae=new Q,Se=new Q(0,1,0),Je=new Ii().setFromUnitVectors(e.up,Se),ut=Je.clone().invert(),q=new Q,J=new Ii,Ne=2*Math.PI;return function(){const Ze=r.object.position;Je.setFromUnitVectors(e.up,Se),ut.copy(Je).invert(),ae.copy(Ze).sub(r.target),ae.applyQuaternion(Je),d.setFromVector3(ae),r.autoRotate&&l===a.NONE&&$(z()),r.enableDamping?(d.theta+=f.theta*r.dampingFactor,d.phi+=f.phi*r.dampingFactor):(d.theta+=f.theta,d.phi+=f.phi);let ot=r.minAzimuthAngle,$t=r.maxAzimuthAngle;isFinite(ot)&&isFinite($t)&&(ot<-Math.PI?ot+=Ne:ot>Math.PI&&(ot-=Ne),$t<-Math.PI?$t+=Ne:$t>Math.PI&&($t-=Ne),ot<=$t?d.theta=Math.max(ot,Math.min($t,d.theta)):d.theta=d.theta>(ot+$t)/2?Math.max(ot,d.theta):Math.min($t,d.theta)),d.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,d.phi)),d.makeSafe(),r.enableDamping===!0?r.target.addScaledVector(g,r.dampingFactor):r.target.add(g),r.zoomToCursor&&M||r.object.isOrthographicCamera?d.radius=ue(d.radius):d.radius=ue(d.radius*p),ae.setFromSpherical(d),ae.applyQuaternion(ut),Ze.copy(r.target).add(ae),r.object.matrixAutoUpdate||r.object.updateMatrix(),r.object.lookAt(r.target),r.enableDamping===!0?(f.theta*=1-r.dampingFactor,f.phi*=1-r.dampingFactor,g.multiplyScalar(1-r.dampingFactor)):(f.set(0,0,0),g.set(0,0,0));let rn=!1;if(r.zoomToCursor&&M){let sn=null;if(r.object instanceof Sr&&r.object.isPerspectiveCamera){const gn=ae.length();sn=ue(gn*p);const Vt=gn-sn;r.object.position.addScaledVector(P,Vt),r.object.updateMatrixWorld()}else if(r.object.isOrthographicCamera){const gn=new Q(b.x,b.y,0);gn.unproject(r.object),r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/p)),r.object.updateProjectionMatrix(),rn=!0;const Vt=new Q(b.x,b.y,0);Vt.unproject(r.object),r.object.position.sub(Vt).add(gn),r.object.updateMatrixWorld(),sn=ae.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;sn!==null&&(r.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar(sn).add(r.object.position):(Kv.origin.copy(r.object.position),Kv.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(Kv.direction))<JQ?e.lookAt(r.target):(P2.setFromNormalAndCoplanarPoint(r.object.up,r.target),Kv.intersectPlane(P2,r.target))))}else r.object instanceof wa&&r.object.isOrthographicCamera&&(rn=p!==1,rn&&(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/p)),r.object.updateProjectionMatrix()));return p=1,M=!1,rn||q.distanceToSquared(r.object.position)>u||8*(1-J.dot(r.object.quaternion))>u?(r.dispatchEvent(i),q.copy(r.object.position),J.copy(r.object.quaternion),rn=!1,!0):!1}})(),this.connect=ae=>{r.domElement=ae,r.domElement.style.touchAction="none",r.domElement.addEventListener("contextmenu",tn),r.domElement.addEventListener("pointerdown",Ve),r.domElement.addEventListener("pointercancel",De),r.domElement.addEventListener("wheel",Qe)},this.dispose=()=>{var ae,Se,Je,ut,q,J;r.domElement&&(r.domElement.style.touchAction="auto"),(ae=r.domElement)==null||ae.removeEventListener("contextmenu",tn),(Se=r.domElement)==null||Se.removeEventListener("pointerdown",Ve),(Je=r.domElement)==null||Je.removeEventListener("pointercancel",De),(ut=r.domElement)==null||ut.removeEventListener("wheel",Qe),(q=r.domElement)==null||q.ownerDocument.removeEventListener("pointermove",ze),(J=r.domElement)==null||J.ownerDocument.removeEventListener("pointerup",De),r._domElementKeyEvents!==null&&r._domElementKeyEvents.removeEventListener("keydown",lt)};const r=this,i={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const u=1e-6,d=new MT,f=new MT;let p=1;const g=new Q,y=new Ue,S=new Ue,x=new Ue,v=new Ue,w=new Ue,T=new Ue,R=new Ue,U=new Ue,N=new Ue,P=new Q,b=new Ue;let M=!1;const A=[],L={};function z(){return 2*Math.PI/60/60*r.autoRotateSpeed}function B(){return Math.pow(.95,r.zoomSpeed)}function $(ae){r.reverseOrbit||r.reverseHorizontalOrbit?f.theta+=ae:f.theta-=ae}function he(ae){r.reverseOrbit||r.reverseVerticalOrbit?f.phi+=ae:f.phi-=ae}const te=(()=>{const ae=new Q;return function(Je,ut){ae.setFromMatrixColumn(ut,0),ae.multiplyScalar(-Je),g.add(ae)}})(),ye=(()=>{const ae=new Q;return function(Je,ut){r.screenSpacePanning===!0?ae.setFromMatrixColumn(ut,1):(ae.setFromMatrixColumn(ut,0),ae.crossVectors(r.object.up,ae)),ae.multiplyScalar(Je),g.add(ae)}})(),G=(()=>{const ae=new Q;return function(Je,ut){const q=r.domElement;if(q&&r.object instanceof Sr&&r.object.isPerspectiveCamera){const J=r.object.position;ae.copy(J).sub(r.target);let Ne=ae.length();Ne*=Math.tan(r.object.fov/2*Math.PI/180),te(2*Je*Ne/q.clientHeight,r.object.matrix),ye(2*ut*Ne/q.clientHeight,r.object.matrix)}else q&&r.object instanceof wa&&r.object.isOrthographicCamera?(te(Je*(r.object.right-r.object.left)/r.object.zoom/q.clientWidth,r.object.matrix),ye(ut*(r.object.top-r.object.bottom)/r.object.zoom/q.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}})();function Z(ae){r.object instanceof Sr&&r.object.isPerspectiveCamera||r.object instanceof wa&&r.object.isOrthographicCamera?p=ae:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function K(ae){Z(p/ae)}function ce(ae){Z(p*ae)}function de(ae){if(!r.zoomToCursor||!r.domElement)return;M=!0;const Se=r.domElement.getBoundingClientRect(),Je=ae.clientX-Se.left,ut=ae.clientY-Se.top,q=Se.width,J=Se.height;b.x=Je/q*2-1,b.y=-(ut/J)*2+1,P.set(b.x,b.y,1).unproject(r.object).sub(r.object.position).normalize()}function ue(ae){return Math.max(r.minDistance,Math.min(r.maxDistance,ae))}function Ee(ae){y.set(ae.clientX,ae.clientY)}function Fe(ae){de(ae),R.set(ae.clientX,ae.clientY)}function ke(ae){v.set(ae.clientX,ae.clientY)}function Ye(ae){S.set(ae.clientX,ae.clientY),x.subVectors(S,y).multiplyScalar(r.rotateSpeed);const Se=r.domElement;Se&&($(2*Math.PI*x.x/Se.clientHeight),he(2*Math.PI*x.y/Se.clientHeight)),y.copy(S),r.update()}function Ct(ae){U.set(ae.clientX,ae.clientY),N.subVectors(U,R),N.y>0?K(B()):N.y<0&&ce(B()),R.copy(U),r.update()}function Dt(ae){w.set(ae.clientX,ae.clientY),T.subVectors(w,v).multiplyScalar(r.panSpeed),G(T.x,T.y),v.copy(w),r.update()}function gt(ae){de(ae),ae.deltaY<0?ce(B()):ae.deltaY>0&&K(B()),r.update()}function vt(ae){let Se=!1;switch(ae.code){case r.keys.UP:G(0,r.keyPanSpeed),Se=!0;break;case r.keys.BOTTOM:G(0,-r.keyPanSpeed),Se=!0;break;case r.keys.LEFT:G(r.keyPanSpeed,0),Se=!0;break;case r.keys.RIGHT:G(-r.keyPanSpeed,0),Se=!0;break}Se&&(ae.preventDefault(),r.update())}function ie(){if(A.length==1)y.set(A[0].pageX,A[0].pageY);else{const ae=.5*(A[0].pageX+A[1].pageX),Se=.5*(A[0].pageY+A[1].pageY);y.set(ae,Se)}}function Be(){if(A.length==1)v.set(A[0].pageX,A[0].pageY);else{const ae=.5*(A[0].pageX+A[1].pageX),Se=.5*(A[0].pageY+A[1].pageY);v.set(ae,Se)}}function Ae(){const ae=A[0].pageX-A[1].pageX,Se=A[0].pageY-A[1].pageY,Je=Math.sqrt(ae*ae+Se*Se);R.set(0,Je)}function We(){r.enableZoom&&Ae(),r.enablePan&&Be()}function be(){r.enableZoom&&Ae(),r.enableRotate&&ie()}function At(ae){if(A.length==1)S.set(ae.pageX,ae.pageY);else{const Je=ft(ae),ut=.5*(ae.pageX+Je.x),q=.5*(ae.pageY+Je.y);S.set(ut,q)}x.subVectors(S,y).multiplyScalar(r.rotateSpeed);const Se=r.domElement;Se&&($(2*Math.PI*x.x/Se.clientHeight),he(2*Math.PI*x.y/Se.clientHeight)),y.copy(S)}function st(ae){if(A.length==1)w.set(ae.pageX,ae.pageY);else{const Se=ft(ae),Je=.5*(ae.pageX+Se.x),ut=.5*(ae.pageY+Se.y);w.set(Je,ut)}T.subVectors(w,v).multiplyScalar(r.panSpeed),G(T.x,T.y),v.copy(w)}function W(ae){const Se=ft(ae),Je=ae.pageX-Se.x,ut=ae.pageY-Se.y,q=Math.sqrt(Je*Je+ut*ut);U.set(0,q),N.set(0,Math.pow(U.y/R.y,r.zoomSpeed)),K(N.y),R.copy(U)}function H(ae){r.enableZoom&&W(ae),r.enablePan&&st(ae)}function _e(ae){r.enableZoom&&W(ae),r.enableRotate&&At(ae)}function Ve(ae){var Se,Je;r.enabled!==!1&&(A.length===0&&((Se=r.domElement)==null||Se.ownerDocument.addEventListener("pointermove",ze),(Je=r.domElement)==null||Je.ownerDocument.addEventListener("pointerup",De)),Ht(ae),ae.pointerType==="touch"?Nt(ae):yt(ae))}function ze(ae){r.enabled!==!1&&(ae.pointerType==="touch"?He(ae):Xe(ae))}function De(ae){var Se,Je,ut;xt(ae),A.length===0&&((Se=r.domElement)==null||Se.releasePointerCapture(ae.pointerId),(Je=r.domElement)==null||Je.ownerDocument.removeEventListener("pointermove",ze),(ut=r.domElement)==null||ut.ownerDocument.removeEventListener("pointerup",De)),r.dispatchEvent(o),l=a.NONE}function yt(ae){let Se;switch(ae.button){case 0:Se=r.mouseButtons.LEFT;break;case 1:Se=r.mouseButtons.MIDDLE;break;case 2:Se=r.mouseButtons.RIGHT;break;default:Se=-1}switch(Se){case Vu.DOLLY:if(r.enableZoom===!1)return;Fe(ae),l=a.DOLLY;break;case Vu.ROTATE:if(ae.ctrlKey||ae.metaKey||ae.shiftKey){if(r.enablePan===!1)return;ke(ae),l=a.PAN}else{if(r.enableRotate===!1)return;Ee(ae),l=a.ROTATE}break;case Vu.PAN:if(ae.ctrlKey||ae.metaKey||ae.shiftKey){if(r.enableRotate===!1)return;Ee(ae),l=a.ROTATE}else{if(r.enablePan===!1)return;ke(ae),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&r.dispatchEvent(s)}function Xe(ae){if(r.enabled!==!1)switch(l){case a.ROTATE:if(r.enableRotate===!1)return;Ye(ae);break;case a.DOLLY:if(r.enableZoom===!1)return;Ct(ae);break;case a.PAN:if(r.enablePan===!1)return;Dt(ae);break}}function Qe(ae){r.enabled===!1||r.enableZoom===!1||l!==a.NONE&&l!==a.ROTATE||(ae.preventDefault(),r.dispatchEvent(s),gt(ae),r.dispatchEvent(o))}function lt(ae){r.enabled===!1||r.enablePan===!1||vt(ae)}function Nt(ae){switch(ct(ae),A.length){case 1:switch(r.touches.ONE){case Bu.ROTATE:if(r.enableRotate===!1)return;ie(),l=a.TOUCH_ROTATE;break;case Bu.PAN:if(r.enablePan===!1)return;Be(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(r.touches.TWO){case Bu.DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;We(),l=a.TOUCH_DOLLY_PAN;break;case Bu.DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;be(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&r.dispatchEvent(s)}function He(ae){switch(ct(ae),l){case a.TOUCH_ROTATE:if(r.enableRotate===!1)return;At(ae),r.update();break;case a.TOUCH_PAN:if(r.enablePan===!1)return;st(ae),r.update();break;case a.TOUCH_DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;H(ae),r.update();break;case a.TOUCH_DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;_e(ae),r.update();break;default:l=a.NONE}}function tn(ae){r.enabled!==!1&&ae.preventDefault()}function Ht(ae){A.push(ae)}function xt(ae){delete L[ae.pointerId];for(let Se=0;Se<A.length;Se++)if(A[Se].pointerId==ae.pointerId){A.splice(Se,1);return}}function ct(ae){let Se=L[ae.pointerId];Se===void 0&&(Se=new Ue,L[ae.pointerId]=Se),Se.set(ae.pageX,ae.pageY)}function ft(ae){const Se=ae.pointerId===A[0].pointerId?A[1]:A[0];return L[Se.pointerId]}this.dollyIn=(ae=B())=>{ce(ae),r.update()},this.dollyOut=(ae=B())=>{K(ae),r.update()},this.getScale=()=>p,this.setScale=ae=>{Z(ae),r.update()},this.getZoomScale=()=>B(),t!==void 0&&this.connect(t),this.update()}};const tZ={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:`
      varying vec2 vUv;

      void main() {

        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

      }
  `,fragmentShader:`
    uniform sampler2D tDiffuse;
    uniform float h;

    varying vec2 vUv;

    void main() {

    	vec4 sum = vec4( 0.0 );

    	sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;

    	gl_FragColor = sum;

    }
  `},nZ={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:`
    varying vec2 vUv;

    void main() {

      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }
  `,fragmentShader:`

  uniform sampler2D tDiffuse;
  uniform float v;

  varying vec2 vUv;

  void main() {

    vec4 sum = vec4( 0.0 );

    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;

    gl_FragColor = sum;

  }
  `};class rZ extends uA{constructor(e){super(e),this.type=ei}parse(e){const o=function(b,M){switch(b){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(M||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(M||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(M||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(M||""))}},d=`
`,f=function(b,M,A){M=M||1024;let z=b.pos,B=-1,$=0,he="",te=String.fromCharCode.apply(null,new Uint16Array(b.subarray(z,z+128)));for(;0>(B=te.indexOf(d))&&$<M&&z<b.byteLength;)he+=te,$+=te.length,z+=128,te+=String.fromCharCode.apply(null,new Uint16Array(b.subarray(z,z+128)));return-1<B?(b.pos+=$+B+1,he+te.slice(0,B)):!1},p=function(b){const M=/^#\?(\S+)/,A=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,L=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,z=/^\s*FORMAT=(\S+)\s*$/,B=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,$={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let he,te;for((b.pos>=b.byteLength||!(he=f(b)))&&o(1,"no header found"),(te=he.match(M))||o(3,"bad initial token"),$.valid|=1,$.programtype=te[1],$.string+=he+`
`;he=f(b),he!==!1;){if($.string+=he+`
`,he.charAt(0)==="#"){$.comments+=he+`
`;continue}if((te=he.match(A))&&($.gamma=parseFloat(te[1])),(te=he.match(L))&&($.exposure=parseFloat(te[1])),(te=he.match(z))&&($.valid|=2,$.format=te[1]),(te=he.match(B))&&($.valid|=4,$.height=parseInt(te[1],10),$.width=parseInt(te[2],10)),$.valid&2&&$.valid&4)break}return $.valid&2||o(3,"missing format specifier"),$.valid&4||o(3,"missing image size specifier"),$},g=function(b,M,A){const L=M;if(L<8||L>32767||b[0]!==2||b[1]!==2||b[2]&128)return new Uint8Array(b);L!==(b[2]<<8|b[3])&&o(3,"wrong scanline width");const z=new Uint8Array(4*M*A);z.length||o(4,"unable to allocate buffer space");let B=0,$=0;const he=4*L,te=new Uint8Array(4),ye=new Uint8Array(he);let G=A;for(;G>0&&$<b.byteLength;){$+4>b.byteLength&&o(1),te[0]=b[$++],te[1]=b[$++],te[2]=b[$++],te[3]=b[$++],(te[0]!=2||te[1]!=2||(te[2]<<8|te[3])!=L)&&o(3,"bad rgbe scanline format");let Z=0,K;for(;Z<he&&$<b.byteLength;){K=b[$++];const de=K>128;if(de&&(K-=128),(K===0||Z+K>he)&&o(3,"bad scanline data"),de){const ue=b[$++];for(let Ee=0;Ee<K;Ee++)ye[Z++]=ue}else ye.set(b.subarray($,$+K),Z),Z+=K,$+=K}const ce=L;for(let de=0;de<ce;de++){let ue=0;z[B]=ye[de+ue],ue+=L,z[B+1]=ye[de+ue],ue+=L,z[B+2]=ye[de+ue],ue+=L,z[B+3]=ye[de+ue],B+=4}G--}return z},y=function(b,M,A,L){const z=b[M+3],B=Math.pow(2,z-128)/255;A[L+0]=b[M+0]*B,A[L+1]=b[M+1]*B,A[L+2]=b[M+2]*B,A[L+3]=1},S=function(b,M,A,L){const z=b[M+3],B=Math.pow(2,z-128)/255;A[L+0]=Qu.toHalfFloat(Math.min(b[M+0]*B,65504)),A[L+1]=Qu.toHalfFloat(Math.min(b[M+1]*B,65504)),A[L+2]=Qu.toHalfFloat(Math.min(b[M+2]*B,65504)),A[L+3]=Qu.toHalfFloat(1)},x=new Uint8Array(e);x.pos=0;const v=p(x),w=v.width,T=v.height,R=g(x.subarray(x.pos),w,T);let U,N,P;switch(this.type){case Ur:P=R.length/4;const b=new Float32Array(P*4);for(let A=0;A<P;A++)y(R,A*4,b,A*4);U=b,N=Ur;break;case ei:P=R.length/4;const M=new Uint16Array(P*4);for(let A=0;A<P;A++)S(R,A*4,M,A*4);U=M,N=ei;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:w,height:T,data:U,header:v.string,gamma:v.gamma,exposure:v.exposure,type:N}}setDataType(e){return this.type=e,this}load(e,t,r,i){function s(o,a){switch(o.type){case Ur:case ei:"colorSpace"in o?o.colorSpace="srgb-linear":o.encoding=3e3,o.minFilter=kn,o.magFilter=kn,o.generateMipmaps=!1,o.flipY=!0;break}t&&t(o,a)}return super.load(e,s,r,i)}}const Nf=nF>=152;class iZ extends uA{constructor(e){super(e),this.type=ei}parse(e){const M=Math.pow(2.7182818,2.2);function A(V,X){for(var le=0,O=0;O<65536;++O)(O==0||V[O>>3]&1<<(O&7))&&(X[le++]=O);for(var Y=le-1;le<65536;)X[le++]=0;return Y}function L(V){for(var X=0;X<16384;X++)V[X]={},V[X].len=0,V[X].lit=0,V[X].p=null}const z={l:0,c:0,lc:0};function B(V,X,le,O,Y){for(;le<V;)X=X<<8|ft(O,Y),le+=8;le-=V,z.l=X>>le&(1<<V)-1,z.c=X,z.lc=le}const $=new Array(59);function he(V){for(var X=0;X<=58;++X)$[X]=0;for(var X=0;X<65537;++X)$[V[X]]+=1;for(var le=0,X=58;X>0;--X){var O=le+$[X]>>1;$[X]=le,le=O}for(var X=0;X<65537;++X){var Y=V[X];Y>0&&(V[X]=Y|$[Y]++<<6)}}function te(V,X,le,O,Y,ee,se){for(var re=le,xe=0,Me=0;Y<=ee;Y++){if(re.value-le.value>O)return!1;B(6,xe,Me,V,re);var Re=z.l;if(xe=z.c,Me=z.lc,se[Y]=Re,Re==63){if(re.value-le.value>O)throw"Something wrong with hufUnpackEncTable";B(8,xe,Me,V,re);var Ce=z.l+6;if(xe=z.c,Me=z.lc,Y+Ce>ee+1)throw"Something wrong with hufUnpackEncTable";for(;Ce--;)se[Y++]=0;Y--}else if(Re>=59){var Ce=Re-59+2;if(Y+Ce>ee+1)throw"Something wrong with hufUnpackEncTable";for(;Ce--;)se[Y++]=0;Y--}}he(se)}function ye(V){return V&63}function G(V){return V>>6}function Z(V,X,le,O){for(;X<=le;X++){var Y=G(V[X]),ee=ye(V[X]);if(Y>>ee)throw"Invalid table entry";if(ee>14){var se=O[Y>>ee-14];if(se.len)throw"Invalid table entry";if(se.lit++,se.p){var re=se.p;se.p=new Array(se.lit);for(var xe=0;xe<se.lit-1;++xe)se.p[xe]=re[xe]}else se.p=new Array(1);se.p[se.lit-1]=X}else if(ee)for(var Me=0,xe=1<<14-ee;xe>0;xe--){var se=O[(Y<<14-ee)+Me];if(se.len||se.p)throw"Invalid table entry";se.len=ee,se.lit=X,Me++}}return!0}const K={c:0,lc:0};function ce(V,X,le,O){V=V<<8|ft(le,O),X+=8,K.c=V,K.lc=X}const de={c:0,lc:0};function ue(V,X,le,O,Y,ee,se,re,xe,Me){if(V==X){O<8&&(ce(le,O,Y,se),le=K.c,O=K.lc),O-=8;var Re=le>>O,Re=new Uint8Array([Re])[0];if(xe.value+Re>Me)return!1;for(var Ce=re[xe.value-1];Re-- >0;)re[xe.value++]=Ce}else if(xe.value<Me)re[xe.value++]=V;else return!1;de.c=le,de.lc=O}function Ee(V){return V&65535}function Fe(V){var X=Ee(V);return X>32767?X-65536:X}const ke={a:0,b:0};function Ye(V,X){var le=Fe(V),O=Fe(X),Y=O,ee=le+(Y&1)+(Y>>1),se=ee,re=ee-Y;ke.a=se,ke.b=re}function Ct(V,X){var le=Ee(V),O=Ee(X),Y=le-(O>>1)&65535,ee=O+Y-32768&65535;ke.a=ee,ke.b=Y}function Dt(V,X,le,O,Y,ee,se){for(var re=se<16384,xe=le>Y?Y:le,Me=1,Re;Me<=xe;)Me<<=1;for(Me>>=1,Re=Me,Me>>=1;Me>=1;){for(var Ce=0,Et=Ce+ee*(Y-Re),je=ee*Me,$e=ee*Re,mt=O*Me,Pt=O*Re,Ut,Gt,pt,at;Ce<=Et;Ce+=$e){for(var Jt=Ce,kt=Ce+O*(le-Re);Jt<=kt;Jt+=Pt){var Wt=Jt+mt,Mn=Jt+je,oe=Mn+mt;re?(Ye(V[Jt+X],V[Mn+X]),Ut=ke.a,pt=ke.b,Ye(V[Wt+X],V[oe+X]),Gt=ke.a,at=ke.b,Ye(Ut,Gt),V[Jt+X]=ke.a,V[Wt+X]=ke.b,Ye(pt,at),V[Mn+X]=ke.a,V[oe+X]=ke.b):(Ct(V[Jt+X],V[Mn+X]),Ut=ke.a,pt=ke.b,Ct(V[Wt+X],V[oe+X]),Gt=ke.a,at=ke.b,Ct(Ut,Gt),V[Jt+X]=ke.a,V[Wt+X]=ke.b,Ct(pt,at),V[Mn+X]=ke.a,V[oe+X]=ke.b)}if(le&Me){var Mn=Jt+je;re?Ye(V[Jt+X],V[Mn+X]):Ct(V[Jt+X],V[Mn+X]),Ut=ke.a,V[Mn+X]=ke.b,V[Jt+X]=Ut}}if(Y&Me)for(var Jt=Ce,kt=Ce+O*(le-Re);Jt<=kt;Jt+=Pt){var Wt=Jt+mt;re?Ye(V[Jt+X],V[Wt+X]):Ct(V[Jt+X],V[Wt+X]),Ut=ke.a,V[Wt+X]=ke.b,V[Jt+X]=Ut}Re=Me,Me>>=1}return Ce}function gt(V,X,le,O,Y,ee,se,re,xe,Me){for(var Re=0,Ce=0,Et=re,je=Math.trunc(Y.value+(ee+7)/8);Y.value<je;)for(ce(Re,Ce,le,Y),Re=K.c,Ce=K.lc;Ce>=14;){var $e=Re>>Ce-14&16383,mt=X[$e];if(mt.len)Ce-=mt.len,ue(mt.lit,se,Re,Ce,le,O,Y,xe,Me,Et),Re=de.c,Ce=de.lc;else{if(!mt.p)throw"hufDecode issues";var Pt;for(Pt=0;Pt<mt.lit;Pt++){for(var Ut=ye(V[mt.p[Pt]]);Ce<Ut&&Y.value<je;)ce(Re,Ce,le,Y),Re=K.c,Ce=K.lc;if(Ce>=Ut&&G(V[mt.p[Pt]])==(Re>>Ce-Ut&(1<<Ut)-1)){Ce-=Ut,ue(mt.p[Pt],se,Re,Ce,le,O,Y,xe,Me,Et),Re=de.c,Ce=de.lc;break}}if(Pt==mt.lit)throw"hufDecode issues"}}var Gt=8-ee&7;for(Re>>=Gt,Ce-=Gt;Ce>0;){var mt=X[Re<<14-Ce&16383];if(mt.len)Ce-=mt.len,ue(mt.lit,se,Re,Ce,le,O,Y,xe,Me,Et),Re=de.c,Ce=de.lc;else throw"hufDecode issues"}return!0}function vt(V,X,le,O,Y,ee){var se={value:0},re=le.value,xe=ct(X,le),Me=ct(X,le);le.value+=4;var Re=ct(X,le);if(le.value+=4,xe<0||xe>=65537||Me<0||Me>=65537)throw"Something wrong with HUF_ENCSIZE";var Ce=new Array(65537),Et=new Array(16384);L(Et);var je=O-(le.value-re);if(te(V,X,le,je,xe,Me,Ce),Re>8*(O-(le.value-re)))throw"Something wrong with hufUncompress";Z(Ce,xe,Me,Et),gt(Ce,Et,V,X,le,Re,Me,ee,Y,se)}function ie(V,X,le){for(var O=0;O<le;++O)X[O]=V[X[O]]}function Be(V){for(var X=1;X<V.length;X++){var le=V[X-1]+V[X]-128;V[X]=le}}function Ae(V,X){for(var le=0,O=Math.floor((V.length+1)/2),Y=0,ee=V.length-1;!(Y>ee||(X[Y++]=V[le++],Y>ee));)X[Y++]=V[O++]}function We(V){for(var X=V.byteLength,le=new Array,O=0,Y=new DataView(V);X>0;){var ee=Y.getInt8(O++);if(ee<0){var se=-ee;X-=se+1;for(var re=0;re<se;re++)le.push(Y.getUint8(O++))}else{var se=ee;X-=2;for(var xe=Y.getUint8(O++),re=0;re<se+1;re++)le.push(xe)}}return le}function be(V,X,le,O,Y,ee){var Wt=new DataView(ee.buffer),se=le[V.idx[0]].width,re=le[V.idx[0]].height,xe=3,Me=Math.floor(se/8),Re=Math.ceil(se/8),Ce=Math.ceil(re/8),Et=se-(Re-1)*8,je=re-(Ce-1)*8,$e={value:0},mt=new Array(xe),Pt=new Array(xe),Ut=new Array(xe),Gt=new Array(xe),pt=new Array(xe);for(let qe=0;qe<xe;++qe)pt[qe]=X[V.idx[qe]],mt[qe]=qe<1?0:mt[qe-1]+Re*Ce,Pt[qe]=new Float32Array(64),Ut[qe]=new Uint16Array(64),Gt[qe]=new Uint16Array(Re*64);for(let qe=0;qe<Ce;++qe){var at=8;qe==Ce-1&&(at=je);var Jt=8;for(let rt=0;rt<Re;++rt){rt==Re-1&&(Jt=Et);for(let et=0;et<xe;++et)Ut[et].fill(0),Ut[et][0]=Y[mt[et]++],At($e,O,Ut[et]),st(Ut[et],Pt[et]),W(Pt[et]);H(Pt);for(let et=0;et<xe;++et)_e(Pt[et],Gt[et],rt*64)}let ht=0;for(let rt=0;rt<xe;++rt){const et=le[V.idx[rt]].type;for(let It=8*qe;It<8*qe+at;++It){ht=pt[rt][It];for(let Yt=0;Yt<Me;++Yt){const Dn=Yt*64+(It&7)*8;Wt.setUint16(ht+0*2*et,Gt[rt][Dn+0],!0),Wt.setUint16(ht+1*2*et,Gt[rt][Dn+1],!0),Wt.setUint16(ht+2*2*et,Gt[rt][Dn+2],!0),Wt.setUint16(ht+3*2*et,Gt[rt][Dn+3],!0),Wt.setUint16(ht+4*2*et,Gt[rt][Dn+4],!0),Wt.setUint16(ht+5*2*et,Gt[rt][Dn+5],!0),Wt.setUint16(ht+6*2*et,Gt[rt][Dn+6],!0),Wt.setUint16(ht+7*2*et,Gt[rt][Dn+7],!0),ht+=8*2*et}}if(Me!=Re)for(let It=8*qe;It<8*qe+at;++It){const Yt=pt[rt][It]+8*Me*2*et,Dn=Me*64+(It&7)*8;for(let ln=0;ln<Jt;++ln)Wt.setUint16(Yt+ln*2*et,Gt[rt][Dn+ln],!0)}}}for(var kt=new Uint16Array(se),Wt=new DataView(ee.buffer),Mn=0;Mn<xe;++Mn){le[V.idx[Mn]].decoded=!0;var oe=le[V.idx[Mn]].type;if(le[Mn].type==2)for(var ge=0;ge<re;++ge){const qe=pt[Mn][ge];for(var Le=0;Le<se;++Le)kt[Le]=Wt.getUint16(qe+Le*2*oe,!0);for(var Le=0;Le<se;++Le)Wt.setFloat32(qe+Le*2*oe,q(kt[Le]),!0)}}}function At(V,X,le){for(var O,Y=1;Y<64;)O=X[V.value],O==65280?Y=64:O>>8==255?Y+=O&255:(le[Y]=O,Y++),V.value++}function st(V,X){X[0]=q(V[0]),X[1]=q(V[1]),X[2]=q(V[5]),X[3]=q(V[6]),X[4]=q(V[14]),X[5]=q(V[15]),X[6]=q(V[27]),X[7]=q(V[28]),X[8]=q(V[2]),X[9]=q(V[4]),X[10]=q(V[7]),X[11]=q(V[13]),X[12]=q(V[16]),X[13]=q(V[26]),X[14]=q(V[29]),X[15]=q(V[42]),X[16]=q(V[3]),X[17]=q(V[8]),X[18]=q(V[12]),X[19]=q(V[17]),X[20]=q(V[25]),X[21]=q(V[30]),X[22]=q(V[41]),X[23]=q(V[43]),X[24]=q(V[9]),X[25]=q(V[11]),X[26]=q(V[18]),X[27]=q(V[24]),X[28]=q(V[31]),X[29]=q(V[40]),X[30]=q(V[44]),X[31]=q(V[53]),X[32]=q(V[10]),X[33]=q(V[19]),X[34]=q(V[23]),X[35]=q(V[32]),X[36]=q(V[39]),X[37]=q(V[45]),X[38]=q(V[52]),X[39]=q(V[54]),X[40]=q(V[20]),X[41]=q(V[22]),X[42]=q(V[33]),X[43]=q(V[38]),X[44]=q(V[46]),X[45]=q(V[51]),X[46]=q(V[55]),X[47]=q(V[60]),X[48]=q(V[21]),X[49]=q(V[34]),X[50]=q(V[37]),X[51]=q(V[47]),X[52]=q(V[50]),X[53]=q(V[56]),X[54]=q(V[59]),X[55]=q(V[61]),X[56]=q(V[35]),X[57]=q(V[36]),X[58]=q(V[48]),X[59]=q(V[49]),X[60]=q(V[57]),X[61]=q(V[58]),X[62]=q(V[62]),X[63]=q(V[63])}function W(V){const X=.5*Math.cos(.7853975),le=.5*Math.cos(3.14159/16),O=.5*Math.cos(3.14159/8),Y=.5*Math.cos(3*3.14159/16),ee=.5*Math.cos(5*3.14159/16),se=.5*Math.cos(3*3.14159/8),re=.5*Math.cos(7*3.14159/16);for(var xe=new Array(4),Me=new Array(4),Re=new Array(4),Ce=new Array(4),Et=0;Et<8;++Et){var je=Et*8;xe[0]=O*V[je+2],xe[1]=se*V[je+2],xe[2]=O*V[je+6],xe[3]=se*V[je+6],Me[0]=le*V[je+1]+Y*V[je+3]+ee*V[je+5]+re*V[je+7],Me[1]=Y*V[je+1]-re*V[je+3]-le*V[je+5]-ee*V[je+7],Me[2]=ee*V[je+1]-le*V[je+3]+re*V[je+5]+Y*V[je+7],Me[3]=re*V[je+1]-ee*V[je+3]+Y*V[je+5]-le*V[je+7],Re[0]=X*(V[je+0]+V[je+4]),Re[3]=X*(V[je+0]-V[je+4]),Re[1]=xe[0]+xe[3],Re[2]=xe[1]-xe[2],Ce[0]=Re[0]+Re[1],Ce[1]=Re[3]+Re[2],Ce[2]=Re[3]-Re[2],Ce[3]=Re[0]-Re[1],V[je+0]=Ce[0]+Me[0],V[je+1]=Ce[1]+Me[1],V[je+2]=Ce[2]+Me[2],V[je+3]=Ce[3]+Me[3],V[je+4]=Ce[3]-Me[3],V[je+5]=Ce[2]-Me[2],V[je+6]=Ce[1]-Me[1],V[je+7]=Ce[0]-Me[0]}for(var $e=0;$e<8;++$e)xe[0]=O*V[16+$e],xe[1]=se*V[16+$e],xe[2]=O*V[48+$e],xe[3]=se*V[48+$e],Me[0]=le*V[8+$e]+Y*V[24+$e]+ee*V[40+$e]+re*V[56+$e],Me[1]=Y*V[8+$e]-re*V[24+$e]-le*V[40+$e]-ee*V[56+$e],Me[2]=ee*V[8+$e]-le*V[24+$e]+re*V[40+$e]+Y*V[56+$e],Me[3]=re*V[8+$e]-ee*V[24+$e]+Y*V[40+$e]-le*V[56+$e],Re[0]=X*(V[$e]+V[32+$e]),Re[3]=X*(V[$e]-V[32+$e]),Re[1]=xe[0]+xe[3],Re[2]=xe[1]-xe[2],Ce[0]=Re[0]+Re[1],Ce[1]=Re[3]+Re[2],Ce[2]=Re[3]-Re[2],Ce[3]=Re[0]-Re[1],V[0+$e]=Ce[0]+Me[0],V[8+$e]=Ce[1]+Me[1],V[16+$e]=Ce[2]+Me[2],V[24+$e]=Ce[3]+Me[3],V[32+$e]=Ce[3]-Me[3],V[40+$e]=Ce[2]-Me[2],V[48+$e]=Ce[1]-Me[1],V[56+$e]=Ce[0]-Me[0]}function H(V){for(var X=0;X<64;++X){var le=V[0][X],O=V[1][X],Y=V[2][X];V[0][X]=le+1.5747*Y,V[1][X]=le-.1873*O-.4682*Y,V[2][X]=le+1.8556*O}}function _e(V,X,le){for(var O=0;O<64;++O)X[le+O]=Qu.toHalfFloat(Ve(V[O]))}function Ve(V){return V<=1?Math.sign(V)*Math.pow(Math.abs(V),2.2):Math.sign(V)*Math.pow(M,Math.abs(V)-1)}function ze(V){return new DataView(V.array.buffer,V.offset.value,V.size)}function De(V){var X=V.viewer.buffer.slice(V.offset.value,V.offset.value+V.size),le=new Uint8Array(We(X)),O=new Uint8Array(le.length);return Be(le),Ae(le,O),new DataView(O.buffer)}function yt(V){var X=V.array.slice(V.offset.value,V.offset.value+V.size),le=Yv(X),O=new Uint8Array(le.length);return Be(le),Ae(le,O),new DataView(O.buffer)}function Xe(V){for(var X=V.viewer,le={value:V.offset.value},O=new Uint16Array(V.width*V.scanlineBlockSize*(V.channels*V.type)),Y=new Uint8Array(8192),ee=0,se=new Array(V.channels),re=0;re<V.channels;re++)se[re]={},se[re].start=ee,se[re].end=se[re].start,se[re].nx=V.width,se[re].ny=V.lines,se[re].size=V.type,ee+=se[re].nx*se[re].ny*se[re].size;var xe=J(X,le),Me=J(X,le);if(Me>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(xe<=Me)for(var re=0;re<Me-xe+1;re++)Y[re+xe]=ae(X,le);var Re=new Uint16Array(65536),Ce=A(Y,Re),Et=ct(X,le);vt(V.array,X,le,Et,O,ee);for(var re=0;re<V.channels;++re)for(var je=se[re],$e=0;$e<se[re].size;++$e)Dt(O,je.start+$e,je.nx,je.size,je.ny,je.nx*je.size,Ce);ie(Re,O,ee);for(var mt=0,Pt=new Uint8Array(O.buffer.byteLength),Ut=0;Ut<V.lines;Ut++)for(var Gt=0;Gt<V.channels;Gt++){var je=se[Gt],pt=je.nx*je.size,at=new Uint8Array(O.buffer,je.end*2,pt*2);Pt.set(at,mt),mt+=pt*2,je.end+=pt}return new DataView(Pt.buffer)}function Qe(V){var X=V.array.slice(V.offset.value,V.offset.value+V.size),le=Yv(X);const O=V.lines*V.channels*V.width,Y=V.type==1?new Uint16Array(O):new Uint32Array(O);let ee=0,se=0;const re=new Array(4);for(let xe=0;xe<V.lines;xe++)for(let Me=0;Me<V.channels;Me++){let Re=0;switch(V.type){case 1:re[0]=ee,re[1]=re[0]+V.width,ee=re[1]+V.width;for(let Ce=0;Ce<V.width;++Ce){const Et=le[re[0]++]<<8|le[re[1]++];Re+=Et,Y[se]=Re,se++}break;case 2:re[0]=ee,re[1]=re[0]+V.width,re[2]=re[1]+V.width,ee=re[2]+V.width;for(let Ce=0;Ce<V.width;++Ce){const Et=le[re[0]++]<<24|le[re[1]++]<<16|le[re[2]++]<<8;Re+=Et,Y[se]=Re,se++}break}}return new DataView(Y.buffer)}function lt(V){var X=V.viewer,le={value:V.offset.value},O=new Uint8Array(V.width*V.lines*(V.channels*V.type*2)),Y={version:Se(X,le),unknownUncompressedSize:Se(X,le),unknownCompressedSize:Se(X,le),acCompressedSize:Se(X,le),dcCompressedSize:Se(X,le),rleCompressedSize:Se(X,le),rleUncompressedSize:Se(X,le),rleRawSize:Se(X,le),totalAcUncompressedCount:Se(X,le),totalDcUncompressedCount:Se(X,le),acCompression:Se(X,le)};if(Y.version<2)throw"EXRLoader.parse: "+tr.compression+" version "+Y.version+" is unsupported";for(var ee=new Array,se=J(X,le)-2;se>0;){var re=Nt(X.buffer,le),xe=ae(X,le),Me=xe>>2&3,Re=(xe>>4)-1,Ce=new Int8Array([Re])[0],Et=ae(X,le);ee.push({name:re,index:Ce,type:Et,compression:Me}),se-=re.length+3}for(var je=tr.channels,$e=new Array(V.channels),mt=0;mt<V.channels;++mt){var Pt=$e[mt]={},Ut=je[mt];Pt.name=Ut.name,Pt.compression=0,Pt.decoded=!1,Pt.type=Ut.pixelType,Pt.pLinear=Ut.pLinear,Pt.width=V.width,Pt.height=V.lines}for(var Gt={idx:new Array(3)},pt=0;pt<V.channels;++pt)for(var Pt=$e[pt],mt=0;mt<ee.length;++mt){var at=ee[mt];Pt.name==at.name&&(Pt.compression=at.compression,at.index>=0&&(Gt.idx[at.index]=pt),Pt.offset=pt)}if(Y.acCompressedSize>0)switch(Y.acCompression){case 0:var Wt=new Uint16Array(Y.totalAcUncompressedCount);vt(V.array,X,le,Y.acCompressedSize,Wt,Y.totalAcUncompressedCount);break;case 1:var Jt=V.array.slice(le.value,le.value+Y.totalAcUncompressedCount),kt=Yv(Jt),Wt=new Uint16Array(kt.buffer);le.value+=Y.totalAcUncompressedCount;break}if(Y.dcCompressedSize>0){var Mn={array:V.array,offset:le,size:Y.dcCompressedSize},oe=new Uint16Array(yt(Mn).buffer);le.value+=Y.dcCompressedSize}if(Y.rleRawSize>0){var Jt=V.array.slice(le.value,le.value+Y.rleCompressedSize),kt=Yv(Jt),ge=We(kt.buffer);le.value+=Y.rleCompressedSize}for(var Le=0,qe=new Array($e.length),mt=0;mt<qe.length;++mt)qe[mt]=new Array;for(var ht=0;ht<V.lines;++ht)for(var rt=0;rt<$e.length;++rt)qe[rt].push(Le),Le+=$e[rt].width*V.type*2;be(Gt,qe,$e,Wt,oe,O);for(var mt=0;mt<$e.length;++mt){var Pt=$e[mt];if(!Pt.decoded)switch(Pt.compression){case 2:for(var et=0,It=0,ht=0;ht<V.lines;++ht){for(var Yt=qe[mt][et],Dn=0;Dn<Pt.width;++Dn){for(var ln=0;ln<2*Pt.type;++ln)O[Yt++]=ge[It+ln*Pt.width*Pt.height];It++}et++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(O.buffer)}function Nt(V,X){for(var le=new Uint8Array(V),O=0;le[X.value+O]!=0;)O+=1;var Y=new TextDecoder().decode(le.slice(X.value,X.value+O));return X.value=X.value+O+1,Y}function He(V,X,le){var O=new TextDecoder().decode(new Uint8Array(V).slice(X.value,X.value+le));return X.value=X.value+le,O}function tn(V,X){var le=xt(V,X),O=ct(V,X);return[le,O]}function Ht(V,X){var le=ct(V,X),O=ct(V,X);return[le,O]}function xt(V,X){var le=V.getInt32(X.value,!0);return X.value=X.value+4,le}function ct(V,X){var le=V.getUint32(X.value,!0);return X.value=X.value+4,le}function ft(V,X){var le=V[X.value];return X.value=X.value+1,le}function ae(V,X){var le=V.getUint8(X.value);return X.value=X.value+1,le}const Se=function(V,X){let le;return"getBigInt64"in DataView.prototype?le=Number(V.getBigInt64(X.value,!0)):le=V.getUint32(X.value+4,!0)+Number(V.getUint32(X.value,!0)<<32),X.value+=8,le};function Je(V,X){var le=V.getFloat32(X.value,!0);return X.value+=4,le}function ut(V,X){return Qu.toHalfFloat(Je(V,X))}function q(V){var X=(V&31744)>>10,le=V&1023;return(V>>15?-1:1)*(X?X===31?le?NaN:1/0:Math.pow(2,X-15)*(1+le/1024):6103515625e-14*(le/1024))}function J(V,X){var le=V.getUint16(X.value,!0);return X.value+=2,le}function Ne(V,X){return q(J(V,X))}function Ke(V,X,le,O){for(var Y=le.value,ee=[];le.value<Y+O-1;){var se=Nt(X,le),re=xt(V,le),xe=ae(V,le);le.value+=3;var Me=xt(V,le),Re=xt(V,le);ee.push({name:se,pixelType:re,pLinear:xe,xSampling:Me,ySampling:Re})}return le.value+=1,ee}function Ze(V,X){var le=Je(V,X),O=Je(V,X),Y=Je(V,X),ee=Je(V,X),se=Je(V,X),re=Je(V,X),xe=Je(V,X),Me=Je(V,X);return{redX:le,redY:O,greenX:Y,greenY:ee,blueX:se,blueY:re,whiteX:xe,whiteY:Me}}function ot(V,X){var le=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],O=ae(V,X);return le[O]}function $t(V,X){var le=ct(V,X),O=ct(V,X),Y=ct(V,X),ee=ct(V,X);return{xMin:le,yMin:O,xMax:Y,yMax:ee}}function rn(V,X){var le=["INCREASING_Y"],O=ae(V,X);return le[O]}function sn(V,X){var le=Je(V,X),O=Je(V,X);return[le,O]}function gn(V,X){var le=Je(V,X),O=Je(V,X),Y=Je(V,X);return[le,O,Y]}function Vt(V,X,le,O,Y){if(O==="string"||O==="stringvector"||O==="iccProfile")return He(X,le,Y);if(O==="chlist")return Ke(V,X,le,Y);if(O==="chromaticities")return Ze(V,le);if(O==="compression")return ot(V,le);if(O==="box2i")return $t(V,le);if(O==="lineOrder")return rn(V,le);if(O==="float")return Je(V,le);if(O==="v2f")return sn(V,le);if(O==="v3f")return gn(V,le);if(O==="int")return xt(V,le);if(O==="rational")return tn(V,le);if(O==="timecode")return Ht(V,le);if(O==="preview")return le.value+=Y,"skipped";le.value+=Y}function $n(V,X,le){const O={};if(V.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";O.version=V.getUint8(4);const Y=V.getUint8(5);O.spec={singleTile:!!(Y&2),longName:!!(Y&4),deepFormat:!!(Y&8),multiPart:!!(Y&16)},le.value=8;for(var ee=!0;ee;){var se=Nt(X,le);if(se==0)ee=!1;else{var re=Nt(X,le),xe=ct(V,le),Me=Vt(V,X,le,re,xe);Me===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${re}'.`):O[se]=Me}}if(Y&-5)throw console.error("EXRHeader:",O),"THREE.EXRLoader: provided file is currently unsupported.";return O}function ur(V,X,le,O,Y){const ee={size:0,viewer:X,array:le,offset:O,width:V.dataWindow.xMax-V.dataWindow.xMin+1,height:V.dataWindow.yMax-V.dataWindow.yMin+1,channels:V.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:V.channels[0].pixelType,uncompress:null,getter:null,format:null,[Nf?"colorSpace":"encoding"]:null};switch(V.compression){case"NO_COMPRESSION":ee.lines=1,ee.uncompress=ze;break;case"RLE_COMPRESSION":ee.lines=1,ee.uncompress=De;break;case"ZIPS_COMPRESSION":ee.lines=1,ee.uncompress=yt;break;case"ZIP_COMPRESSION":ee.lines=16,ee.uncompress=yt;break;case"PIZ_COMPRESSION":ee.lines=32,ee.uncompress=Xe;break;case"PXR24_COMPRESSION":ee.lines=16,ee.uncompress=Qe;break;case"DWAA_COMPRESSION":ee.lines=32,ee.uncompress=lt;break;case"DWAB_COMPRESSION":ee.lines=256,ee.uncompress=lt;break;default:throw"EXRLoader.parse: "+V.compression+" is unsupported"}if(ee.scanlineBlockSize=ee.lines,ee.type==1)switch(Y){case Ur:ee.getter=Ne,ee.inputSize=2;break;case ei:ee.getter=J,ee.inputSize=2;break}else if(ee.type==2)switch(Y){case Ur:ee.getter=Je,ee.inputSize=4;break;case ei:ee.getter=ut,ee.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+ee.type+" for "+V.compression+".";ee.blockCount=(V.dataWindow.yMax+1)/ee.scanlineBlockSize;for(var se=0;se<ee.blockCount;se++)Se(X,O);ee.outputChannels=ee.channels==3?4:ee.channels;const re=ee.width*ee.height*ee.outputChannels;switch(Y){case Ur:ee.byteArray=new Float32Array(re),ee.channels<ee.outputChannels&&ee.byteArray.fill(1,0,re);break;case ei:ee.byteArray=new Uint16Array(re),ee.channels<ee.outputChannels&&ee.byteArray.fill(15360,0,re);break;default:console.error("THREE.EXRLoader: unsupported type: ",Y);break}return ee.bytesPerLine=ee.width*ee.inputSize*ee.channels,ee.outputChannels==4?ee.format=kr:ee.format=LM,Nf?ee.colorSpace="srgb-linear":ee.encoding=3e3,ee}const qr=new DataView(e),eo=new Uint8Array(e),ci={value:0},tr=$n(qr,e,ci),Zt=ur(tr,qr,eo,ci,this.type),Os={value:0},us={R:0,G:1,B:2,A:3,Y:0};for(let V=0;V<Zt.height/Zt.scanlineBlockSize;V++){const X=ct(qr,ci);Zt.size=ct(qr,ci),Zt.lines=X+Zt.scanlineBlockSize>Zt.height?Zt.height-X:Zt.scanlineBlockSize;const O=Zt.size<Zt.lines*Zt.bytesPerLine?Zt.uncompress(Zt):ze(Zt);ci.value+=Zt.size;for(let Y=0;Y<Zt.scanlineBlockSize;Y++){const ee=Y+V*Zt.scanlineBlockSize;if(ee>=Zt.height)break;for(let se=0;se<Zt.channels;se++){const re=us[tr.channels[se].name];for(let xe=0;xe<Zt.width;xe++){Os.value=(Y*(Zt.channels*Zt.width)+se*Zt.width+xe)*Zt.inputSize;const Me=(Zt.height-1-ee)*(Zt.width*Zt.outputChannels)+xe*Zt.outputChannels+re;Zt.byteArray[Me]=Zt.getter(O,Os)}}}}return{header:tr,width:Zt.width,height:Zt.height,data:Zt.byteArray,format:Zt.format,[Nf?"colorSpace":"encoding"]:Zt[Nf?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,r,i){function s(o,a){Nf?o.colorSpace=a.colorSpace:o.encoding=a.encoding,o.minFilter=kn,o.magFilter=kn,o.generateMipmaps=!1,o.flipY=!1,t&&t(o,a)}return super.load(e,s,r,i)}}const pw=n=>n===Object(n)&&!Array.isArray(n)&&typeof n!="function";function EA(n,e){const t=Mi(s=>s.gl),r=La(H0,pw(n)?Object.values(n):n);return fe.useLayoutEffect(()=>{e==null||e(r)},[e]),fe.useEffect(()=>{if("initTexture"in t){let s=[];Array.isArray(r)?s=r:r instanceof Un?s=[r]:pw(r)&&(s=Object.values(r)),s.forEach(o=>{o instanceof Un&&t.initTexture(o)})}},[t,r]),fe.useMemo(()=>{if(pw(n)){const s={};let o=0;for(const a in n)s[a]=r[o++];return s}else return r},[n,r])}EA.preload=n=>La.preload(H0,n);EA.clear=n=>La.clear(H0,n);const sZ=fe.forwardRef(({makeDefault:n,camera:e,regress:t,domElement:r,enableDamping:i=!0,keyEvents:s=!1,onChange:o,onStart:a,onEnd:l,...u},d)=>{const f=Mi(N=>N.invalidate),p=Mi(N=>N.camera),g=Mi(N=>N.gl),y=Mi(N=>N.events),S=Mi(N=>N.setEvents),x=Mi(N=>N.set),v=Mi(N=>N.get),w=Mi(N=>N.performance),T=e||p,R=r||y.connected||g.domElement,U=fe.useMemo(()=>new eZ(T),[T]);return jm(()=>{U.enabled&&U.update()},-1),fe.useEffect(()=>(s&&U.connect(s===!0?R:s),U.connect(R),()=>void U.dispose()),[s,R,t,U,f]),fe.useEffect(()=>{const N=M=>{f(),t&&w.regress(),o&&o(M)},P=M=>{a&&a(M)},b=M=>{l&&l(M)};return U.addEventListener("change",N),U.addEventListener("start",P),U.addEventListener("end",b),()=>{U.removeEventListener("start",P),U.removeEventListener("end",b),U.removeEventListener("change",N)}},[o,a,l,U,f,S]),fe.useEffect(()=>{if(n){const N=v().controls;return x({controls:U}),()=>x({controls:N})}},[n,U]),fe.createElement("primitive",cm({ref:d,object:U,enableDamping:i},u))}),oZ=3e3,aZ=3001,lZ=fe.forwardRef(({children:n,enabled:e=!0,speed:t=1,rotationIntensity:r=1,floatIntensity:i=1,floatingRange:s=[-.1,.1],autoInvalidate:o=!1,...a},l)=>{const u=fe.useRef(null);fe.useImperativeHandle(l,()=>u.current,[]);const d=fe.useRef(Math.random()*1e4);return jm(f=>{var p,g;if(!e||t===0)return;o&&f.invalidate();const y=d.current+f.clock.elapsedTime;u.current.rotation.x=Math.cos(y/4*t)/8*r,u.current.rotation.y=Math.sin(y/4*t)/8*r,u.current.rotation.z=Math.sin(y/4*t)/20*r;let S=Math.sin(y/4*t)/10;S=EO.mapLinear(S,-.1,.1,(p=s==null?void 0:s[0])!==null&&p!==void 0?p:-.1,(g=s==null?void 0:s[1])!==null&&g!==void 0?g:.1),u.current.position.y=S*i,u.current.updateMatrix()}),fe.createElement("group",a,fe.createElement("group",{ref:u,matrixAutoUpdate:!1},n))}),uF=(n,e,t)=>{let r;switch(n){case bs:r=new Uint8ClampedArray(e*t*4);break;case ei:r=new Uint16Array(e*t*4);break;case ko:r=new Uint32Array(e*t*4);break;case bM:r=new Int8Array(e*t*4);break;case RM:r=new Int16Array(e*t*4);break;case g0:r=new Int32Array(e*t*4);break;case Ur:r=new Float32Array(e*t*4);break;default:throw new Error("Unsupported data type")}return r};let Qv;const uZ=(n,e,t,r)=>{if(Qv!==void 0)return Qv;const i=new Wi(1,1,r);e.setRenderTarget(i);const s=new sr(new ru,new Ba({color:16777215}));e.render(s,t),e.setRenderTarget(null);const o=uF(n,i.width,i.height);return e.readRenderTargetPixels(i,0,0,i.width,i.height,o),i.dispose(),s.geometry.dispose(),s.material.dispose(),Qv=o[0]!==0,Qv};class wA{constructor(e){hr(this,"_renderer");hr(this,"_rendererIsDisposable",!1);hr(this,"_material");hr(this,"_scene");hr(this,"_camera");hr(this,"_quad");hr(this,"_renderTarget");hr(this,"_width");hr(this,"_height");hr(this,"_type");hr(this,"_colorSpace");hr(this,"_supportsReadPixels",!0);hr(this,"render",()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)});var r,i,s,o,a,l,u,d,f,p,g,y,S,x,v,w;this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const t={format:kr,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((r=e.renderTargetOptions)==null?void 0:r.anisotropy)!==void 0?(i=e.renderTargetOptions)==null?void 0:i.anisotropy:1,generateMipmaps:((s=e.renderTargetOptions)==null?void 0:s.generateMipmaps)!==void 0?(o=e.renderTargetOptions)==null?void 0:o.generateMipmaps:!1,magFilter:((a=e.renderTargetOptions)==null?void 0:a.magFilter)!==void 0?(l=e.renderTargetOptions)==null?void 0:l.magFilter:kn,minFilter:((u=e.renderTargetOptions)==null?void 0:u.minFilter)!==void 0?(d=e.renderTargetOptions)==null?void 0:d.minFilter:kn,samples:((f=e.renderTargetOptions)==null?void 0:f.samples)!==void 0?(p=e.renderTargetOptions)==null?void 0:p.samples:void 0,wrapS:((g=e.renderTargetOptions)==null?void 0:g.wrapS)!==void 0?(y=e.renderTargetOptions)==null?void 0:y.wrapS:er,wrapT:((S=e.renderTargetOptions)==null?void 0:S.wrapT)!==void 0?(x=e.renderTargetOptions)==null?void 0:x.wrapT:er};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=wA.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new Td,this._camera=new wa,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!uZ(this._type,this._renderer,this._camera,t)){let T;switch(this._type){case ei:T=this._renderer.extensions.has("EXT_color_buffer_float")?Ur:void 0;break}T!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${Ur}`),this._type=T):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new sr(new ru,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new Wi(this.width,this.height,t),this._renderTarget.texture.mapping=((v=e.renderTargetOptions)==null?void 0:v.mapping)!==void 0?(w=e.renderTargetOptions)==null?void 0:w.mapping:Xl}static instantiateRenderer(){const e=new w0;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=uF(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new Ul(this.toArray(),this.width,this.height,kr,this._type,(e==null?void 0:e.mapping)||Xl,(e==null?void 0:e.wrapS)||er,(e==null?void 0:e.wrapT)||er,(e==null?void 0:e.magFilter)||kn,(e==null?void 0:e.minFilter)||kn,(e==null?void 0:e.anisotropy)||1,Ls);return t.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof ji&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof Un&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof Un&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class cF extends Error{}class hF extends Error{}const Lf=(n,e,t)=>{const r=new RegExp(`${e}="([^"]*)"`,"i").exec(n);if(r)return r[1];const i=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(n);if(i){const s=i[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return s&&s.length===3?s.map(o=>o.replace(/<\/?rdf:li>/g,"")):i[1].trim()}if(t!==void 0)return t;throw new Error(`Can't find ${e} in gainmap metadata`)},cZ=n=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(n):e=n.toString();let t=e.indexOf("<x:xmpmeta");for(;t!==-1;){const r=e.indexOf("x:xmpmeta>",t),i=e.slice(t,r+10);try{const s=Lf(i,"hdrgm:GainMapMin","0"),o=Lf(i,"hdrgm:GainMapMax"),a=Lf(i,"hdrgm:Gamma","1"),l=Lf(i,"hdrgm:OffsetSDR","0.015625"),u=Lf(i,"hdrgm:OffsetHDR","0.015625"),d=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(i),f=d?d[1]:"0",p=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(i);if(!p)throw new Error("Incomplete gainmap metadata");const g=p[1];return{gainMapMin:Array.isArray(s)?s.map(y=>parseFloat(y)):[parseFloat(s),parseFloat(s),parseFloat(s)],gainMapMax:Array.isArray(o)?o.map(y=>parseFloat(y)):[parseFloat(o),parseFloat(o),parseFloat(o)],gamma:Array.isArray(a)?a.map(y=>parseFloat(y)):[parseFloat(a),parseFloat(a),parseFloat(a)],offsetSdr:Array.isArray(l)?l.map(y=>parseFloat(y)):[parseFloat(l),parseFloat(l),parseFloat(l)],offsetHdr:Array.isArray(u)?u.map(y=>parseFloat(y)):[parseFloat(u),parseFloat(u),parseFloat(u)],hdrCapacityMin:parseFloat(f),hdrCapacityMax:parseFloat(g)}}catch{}t=e.indexOf("<x:xmpmeta",r)}};class hZ{constructor(e){hr(this,"options");this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((t,r)=>{const i=this.options.debug,s=new DataView(e.buffer);if(s.getUint16(0)!==65496){r(new Error("Not a valid jpeg"));return}const o=s.byteLength;let a=2,l=0,u;for(;a<o;){if(++l>250){r(new Error(`Found no marker after ${l} loops `));return}if(s.getUint8(a)!==255){r(new Error(`Not a valid marker at offset 0x${a.toString(16)}, found: 0x${s.getUint8(a).toString(16)}`));return}if(u=s.getUint8(a+1),i&&console.log(`Marker: ${u.toString(16)}`),u===226){i&&console.log("Found APP2 marker (0xffe2)");const d=a+4;if(s.getUint32(d)===1297106432){const f=d+4;let p;if(s.getUint16(f)===18761)p=!1;else if(s.getUint16(f)===19789)p=!0;else{r(new Error("No valid endianness marker found in TIFF header"));return}if(s.getUint16(f+2,!p)!==42){r(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const g=s.getUint32(f+4,!p);if(g<8){r(new Error("Not valid TIFF data! (First offset less than 8)"));return}const y=f+g,S=s.getUint16(y,!p),x=y+2;let v=0;for(let U=x;U<x+12*S;U+=12)s.getUint16(U,!p)===45057&&(v=s.getUint32(U+8,!p));const T=y+2+S*12+4,R=[];for(let U=T;U<T+v*16;U+=16){const N={MPType:s.getUint32(U,!p),size:s.getUint32(U+4,!p),dataOffset:s.getUint32(U+8,!p),dependantImages:s.getUint32(U+12,!p),start:-1,end:-1,isFII:!1};N.dataOffset?(N.start=f+N.dataOffset,N.isFII=!1):(N.start=0,N.isFII=!0),N.end=N.start+N.size,R.push(N)}if(this.options.extractNonFII&&R.length){const U=new Blob([s]),N=[];for(const P of R){if(P.isFII&&!this.options.extractFII)continue;const b=U.slice(P.start,P.end+1,"image/jpeg");N.push(b)}t(N)}}}a+=2+s.getUint16(a+2)}})}}const dZ=async n=>{const e=cZ(n);if(!e)throw new hF("Gain map XMP metadata not found");const r=await new hZ({extractFII:!0,extractNonFII:!0}).extract(n);if(r.length!==2)throw new cF("Gain map recovery image not found");return{sdr:new Uint8Array(await r[0].arrayBuffer()),gainMap:new Uint8Array(await r[1].arrayBuffer()),metadata:e}},L2=n=>new Promise((e,t)=>{const r=document.createElement("img");r.onload=()=>{e(r)},r.onerror=i=>{t(i)},r.src=URL.createObjectURL(n)});class fZ extends Yi{constructor(t,r){super(r);hr(this,"_renderer");hr(this,"_renderTargetOptions");hr(this,"_internalLoadingManager");hr(this,"_config");this._config=t,t.renderer&&(this._renderer=t.renderer),this._internalLoadingManager=new z0}setRenderer(t){return this._renderer=t,this}setRenderTargetOptions(t){return this._renderTargetOptions=t,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: A Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const t=this._config.createMaterial({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new Un,sdr:new Un});return this._config.createQuadRenderer({width:16,height:16,type:ei,colorSpace:Ls,material:t,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async processImages(t,r,i){const s=r?new Blob([r],{type:"image/jpeg"}):void 0,o=new Blob([t],{type:"image/jpeg"});let a,l,u=!1;if(typeof createImageBitmap>"u"){const d=await Promise.all([s?L2(s):Promise.resolve(void 0),L2(o)]);l=d[0],a=d[1],u=i==="flipY"}else{const d=await Promise.all([s?createImageBitmap(s,{imageOrientation:i||"flipY"}):Promise.resolve(void 0),createImageBitmap(o,{imageOrientation:i||"flipY"})]);l=d[0],a=d[1]}return{sdrImage:a,gainMapImage:l,needsFlip:u}}createTextures(t,r,i){const s=new Un(r||new ImageData(2,2),Xl,er,er,kn,HS,kr,bs,1,Ls);s.flipY=i,s.needsUpdate=!0;const o=new Un(t,Xl,er,er,kn,HS,kr,bs,1,Nr);return o.flipY=i,o.needsUpdate=!0,{gainMap:s,sdr:o}}updateQuadRenderer(t,r,i,s,o){t.width=r.width,t.height=r.height,t.material.gainMap=i,t.material.sdr=s,t.material.gainMapMin=o.gainMapMin,t.material.gainMapMax=o.gainMapMax,t.material.offsetHdr=o.offsetHdr,t.material.offsetSdr=o.offsetSdr,t.material.gamma=o.gamma,t.material.hdrCapacityMin=o.hdrCapacityMin,t.material.hdrCapacityMax=o.hdrCapacityMax,t.material.maxDisplayBoost=Math.pow(2,o.hdrCapacityMax),t.material.needsUpdate=!0}}const pZ=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,mZ=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class gZ extends ji{constructor({gamma:t,offsetHdr:r,offsetSdr:i,gainMapMin:s,gainMapMax:o,maxDisplayBoost:a,hdrCapacityMin:l,hdrCapacityMax:u,sdr:d,gainMap:f}){super({name:"GainMapDecoderMaterial",vertexShader:pZ,fragmentShader:mZ,uniforms:{sdr:{value:d},gainMap:{value:f},gamma:{value:new Q(1/t[0],1/t[1],1/t[2])},offsetHdr:{value:new Q().fromArray(r)},offsetSdr:{value:new Q().fromArray(i)},gainMapMin:{value:new Q().fromArray(s)},gainMapMax:{value:new Q().fromArray(o)},weightFactor:{value:(Math.log2(a)-l)/(u-l)}},blending:jo,depthTest:!1,depthWrite:!1});hr(this,"_maxDisplayBoost");hr(this,"_hdrCapacityMin");hr(this,"_hdrCapacityMax");this._maxDisplayBoost=a,this._hdrCapacityMin=l,this._hdrCapacityMax=u,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(t){this.uniforms.sdr.value=t}get gainMap(){return this.uniforms.gainMap.value}set gainMap(t){this.uniforms.gainMap.value=t}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(t){this.uniforms.offsetHdr.value.fromArray(t)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(t){this.uniforms.offsetSdr.value.fromArray(t)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(t){this.uniforms.gainMapMin.value.fromArray(t)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(t){this.uniforms.gainMapMax.value.fromArray(t)}get gamma(){const t=this.uniforms.gamma.value;return[1/t.x,1/t.y,1/t.z]}set gamma(t){const r=this.uniforms.gamma.value;r.x=1/t[0],r.y=1/t[1],r.z=1/t[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(t){this._hdrCapacityMin=t,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(t){this._hdrCapacityMax=t,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(t){this._maxDisplayBoost=Math.max(1,Math.min(65504,t)),this.calculateWeight()}calculateWeight(){const t=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,t))}}class dF extends fZ{constructor(e,t){super({renderer:e,createMaterial:r=>new gZ(r),createQuadRenderer:r=>new wA(r)},t)}async render(e,t,r,i){const{sdrImage:s,gainMapImage:o,needsFlip:a}=await this.processImages(r,i,"flipY"),{gainMap:l,sdr:u}=this.createTextures(s,o,a);this.updateQuadRenderer(e,s,l,u,t),e.render()}}class vZ extends dF{load([e,t,r],i,s,o){const a=this.prepareQuadRenderer();let l,u,d;const f=async()=>{if(l&&u&&d){try{await this.render(a,d,l,u)}catch(M){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(r),typeof o=="function"&&o(M),a.disposeOnDemandRenderer();return}typeof i=="function"&&i(a),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(r),a.disposeOnDemandRenderer()}};let p=!0,g=0,y=0,S=!0,x=0,v=0,w=!0,T=0,R=0;const U=()=>{if(typeof s=="function"){const M=g+x+T,A=y+v+R,L=p&&S&&w;s(new ProgressEvent("progress",{lengthComputable:L,loaded:A,total:M}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(r);const N=new Ps(this._internalLoadingManager);N.setResponseType("arraybuffer"),N.setRequestHeader(this.requestHeader),N.setPath(this.path),N.setWithCredentials(this.withCredentials),N.load(e,async M=>{if(typeof M=="string")throw new Error("Invalid sdr buffer");l=M,await f()},M=>{p=M.lengthComputable,y=M.loaded,g=M.total,U()},M=>{this.manager.itemError(e),typeof o=="function"&&o(M)});const P=new Ps(this._internalLoadingManager);P.setResponseType("arraybuffer"),P.setRequestHeader(this.requestHeader),P.setPath(this.path),P.setWithCredentials(this.withCredentials),P.load(t,async M=>{if(typeof M=="string")throw new Error("Invalid gainmap buffer");u=M,await f()},M=>{S=M.lengthComputable,v=M.loaded,x=M.total,U()},M=>{this.manager.itemError(t),typeof o=="function"&&o(M)});const b=new Ps(this._internalLoadingManager);return b.setRequestHeader(this.requestHeader),b.setPath(this.path),b.setWithCredentials(this.withCredentials),b.load(r,async M=>{if(typeof M!="string")throw new Error("Invalid metadata string");d=JSON.parse(M),await f()},M=>{w=M.lengthComputable,R=M.loaded,T=M.total,U()},M=>{this.manager.itemError(r),typeof o=="function"&&o(M)}),a}}class _Z extends dF{load(e,t,r,i){const s=this.prepareQuadRenderer(),o=new Ps(this._internalLoadingManager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(this.withCredentials),this.manager.itemStart(e),o.load(e,async a=>{if(typeof a=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const l=new Uint8Array(a);let u,d,f;try{const p=await dZ(l);u=p.sdr,d=p.gainMap,f=p.metadata}catch(p){if(p instanceof hF||p instanceof cF)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),f={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},u=l;else throw p}try{await this.render(s,f,u.buffer,d==null?void 0:d.buffer)}catch(p){this.manager.itemError(e),typeof i=="function"&&i(p),s.disposeOnDemandRenderer();return}typeof t=="function"&&t(s),this.manager.itemEnd(e),s.disposeOnDemandRenderer()},r,a=>{this.manager.itemError(e),typeof i=="function"&&i(a)}),s}}const hm={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},fF="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",od=n=>Array.isArray(n),SA=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function W0({files:n=SA,path:e="",preset:t=void 0,encoding:r=void 0,extensions:i}={}){let s=null,o=!1;t&&(TA(t),n=hm[t],e=fF),o=od(n);const{extension:a,isCubemap:l}=MA(n);if(s=AA(a),!s)throw new Error("useEnvironment: Unrecognized file extension: "+n);const u=Mi(g=>g.gl);fe.useLayoutEffect(()=>{if(a!=="webp"&&a!=="jpg"&&a!=="jpeg")return;function g(){La.clear(s,o?[n]:n)}u.domElement.addEventListener("webglcontextlost",g,{once:!0})},[n,u.domElement]);const d=La(s,o?[n]:n,g=>{(a==="webp"||a==="jpg"||a==="jpeg")&&g.setRenderer(u),g.setPath==null||g.setPath(e),i&&i(g)});let f=o?d[0]:d;if(a==="jpg"||a==="jpeg"||a==="webp"){var p;f=(p=f.renderTarget)==null?void 0:p.texture}return f.mapping=l?Yo:xd,"colorSpace"in f?f.colorSpace=r??l?"srgb":"srgb-linear":f.encoding=r??l?aZ:oZ,f}const yZ={files:SA,path:"",preset:void 0,extensions:void 0};W0.preload=n=>{const e={...yZ,...n};let{files:t,path:r=""}=e;const{preset:i,extensions:s}=e;i&&(TA(i),t=hm[i],r=fF);const{extension:o}=MA(t);if(o==="webp"||o==="jpg"||o==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const a=AA(o);if(!a)throw new Error("useEnvironment: Unrecognized file extension: "+t);La.preload(a,od(t)?[t]:t,l=>{l.setPath==null||l.setPath(r),s&&s(l)})};const xZ={files:SA,preset:void 0};W0.clear=n=>{const e={...xZ,...n};let{files:t}=e;const{preset:r}=e;r&&(TA(r),t=hm[r]);const{extension:i}=MA(t),s=AA(i);if(!s)throw new Error("useEnvironment: Unrecognized file extension: "+t);La.clear(s,od(t)?[t]:t)};function TA(n){if(!(n in hm))throw new Error("Preset must be one of: "+Object.keys(hm).join(", "))}function MA(n){var e;const t=od(n)&&n.length===6,r=od(n)&&n.length===3&&n.some(o=>o.endsWith("json")),i=od(n)?n[0]:n;return{extension:t?"cube":r?"webp":i.startsWith("data:application/exr")?"exr":i.startsWith("data:application/hdr")?"hdr":i.startsWith("data:image/jpeg")?"jpg":(e=i.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:t,isGainmap:r}}function AA(n){return n==="cube"?vU:n==="hdr"?rZ:n==="exr"?iZ:n==="jpg"||n==="jpeg"?_Z:n==="webp"?vZ:null}const EZ=n=>n.current&&n.current.isScene,wZ=n=>EZ(n)?n.current:n;function CA(n,e,t,r,i={}){var s,o,a,l;i={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...i};const u=wZ(e||t),d=u.background,f=u.environment,p={backgroundBlurriness:u.backgroundBlurriness,backgroundIntensity:u.backgroundIntensity,backgroundRotation:(s=(o=u.backgroundRotation)==null||o.clone==null?void 0:o.clone())!==null&&s!==void 0?s:[0,0,0],environmentIntensity:u.environmentIntensity,environmentRotation:(a=(l=u.environmentRotation)==null||l.clone==null?void 0:l.clone())!==null&&a!==void 0?a:[0,0,0]};return n!=="only"&&(u.environment=r),n&&(u.background=r),ul(u,i),()=>{n!=="only"&&(u.environment=f),n&&(u.background=d),ul(u,p)}}function IA({scene:n,background:e=!1,map:t,...r}){const i=Mi(s=>s.scene);return fe.useLayoutEffect(()=>{if(t)return CA(e,n,i,t,r)}),null}function pF({background:n=!1,scene:e,blur:t,backgroundBlurriness:r,backgroundIntensity:i,backgroundRotation:s,environmentIntensity:o,environmentRotation:a,...l}){const u=W0(l),d=Mi(f=>f.scene);return fe.useLayoutEffect(()=>CA(n,e,d,u,{backgroundBlurriness:t??r,backgroundIntensity:i,backgroundRotation:s,environmentIntensity:o,environmentRotation:a})),fe.useEffect(()=>()=>{u.dispose()},[u]),null}function SZ({children:n,near:e=.1,far:t=1e3,resolution:r=256,frames:i=1,map:s,background:o=!1,blur:a,backgroundBlurriness:l,backgroundIntensity:u,backgroundRotation:d,environmentIntensity:f,environmentRotation:p,scene:g,files:y,path:S,preset:x=void 0,extensions:v}){const w=Mi(b=>b.gl),T=Mi(b=>b.scene),R=fe.useRef(null),[U]=fe.useState(()=>new Td),N=fe.useMemo(()=>{const b=new qM(r);return b.texture.type=ei,b},[r]);fe.useEffect(()=>()=>{N.dispose()},[N]),fe.useLayoutEffect(()=>{if(i===1){const b=w.autoClear;w.autoClear=!0,R.current.update(w,U),w.autoClear=b}return CA(o,g,T,N.texture,{backgroundBlurriness:a??l,backgroundIntensity:u,backgroundRotation:d,environmentIntensity:f,environmentRotation:p})},[n,U,N.texture,g,T,o,i,w]);let P=1;return jm(()=>{if(i===1/0||P<i){const b=w.autoClear;w.autoClear=!0,R.current.update(w,U),w.autoClear=b,P++}}),fe.createElement(fe.Fragment,null,dQ(fe.createElement(fe.Fragment,null,n,fe.createElement("cubeCamera",{ref:R,args:[e,t,N]}),y||x?fe.createElement(pF,{background:!0,files:y,preset:x,path:S,extensions:v}):s?fe.createElement(IA,{background:!0,map:s,extensions:v}):null),U))}function TZ(n){var e,t,r,i;const s=W0(n),o=n.map||s;fe.useMemo(()=>VU({GroundProjectedEnvImpl:qQ}),[]),fe.useEffect(()=>()=>{s.dispose()},[s]);const a=fe.useMemo(()=>[o],[o]),l=(e=n.ground)==null?void 0:e.height,u=(t=n.ground)==null?void 0:t.radius,d=(r=(i=n.ground)==null?void 0:i.scale)!==null&&r!==void 0?r:1e3;return fe.createElement(fe.Fragment,null,fe.createElement(IA,cm({},n,{map:o})),fe.createElement("groundProjectedEnvImpl",{args:a,scale:d,height:l,radius:u}))}function MZ(n){return n.ground?fe.createElement(TZ,n):n.map?fe.createElement(IA,n):n.children?fe.createElement(SZ,n):fe.createElement(pF,n)}const AZ=fe.forwardRef(({scale:n=10,frames:e=1/0,opacity:t=1,width:r=1,height:i=1,blur:s=1,near:o=0,far:a=10,resolution:l=512,smooth:u=!0,color:d="#000000",depthWrite:f=!1,renderOrder:p,...g},y)=>{const S=fe.useRef(null),x=Mi($=>$.scene),v=Mi($=>$.gl),w=fe.useRef(null);r=r*(Array.isArray(n)?n[0]:n||1),i=i*(Array.isArray(n)?n[1]:n||1);const[T,R,U,N,P,b,M]=fe.useMemo(()=>{const $=new Wi(l,l),he=new Wi(l,l);he.texture.generateMipmaps=$.texture.generateMipmaps=!1;const te=new ru(r,i).rotateX(Math.PI/2),ye=new sr(te),G=new E0;G.depthTest=G.depthWrite=!1,G.onBeforeCompile=ce=>{ce.uniforms={...ce.uniforms,ucolor:{value:new Tt(d)}},ce.fragmentShader=ce.fragmentShader.replace("void main() {",`uniform vec3 ucolor;
           void main() {
          `),ce.fragmentShader=ce.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );")};const Z=new ji(tZ),K=new ji(nZ);return K.depthTest=Z.depthTest=!1,[$,te,G,ye,Z,K,he]},[l,r,i,n,d]),A=$=>{N.visible=!0,N.material=P,P.uniforms.tDiffuse.value=T.texture,P.uniforms.h.value=$*1/256,v.setRenderTarget(M),v.render(N,w.current),N.material=b,b.uniforms.tDiffuse.value=M.texture,b.uniforms.v.value=$*1/256,v.setRenderTarget(T),v.render(N,w.current),N.visible=!1};let L=0,z,B;return jm(()=>{w.current&&(e===1/0||L<e)&&(L++,z=x.background,B=x.overrideMaterial,S.current.visible=!1,x.background=null,x.overrideMaterial=U,v.setRenderTarget(T),v.render(x,w.current),A(s),u&&A(s*.4),v.setRenderTarget(null),S.current.visible=!0,x.overrideMaterial=B,x.background=z)}),fe.useImperativeHandle(y,()=>S.current,[]),fe.createElement("group",cm({"rotation-x":Math.PI/2},g,{ref:S}),fe.createElement("mesh",{renderOrder:p,geometry:R,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},fe.createElement("meshBasicMaterial",{transparent:!0,map:T.texture,opacity:t,depthWrite:f})),fe.createElement("orthographicCamera",{ref:w,args:[-r/2,r/2,i/2,-i/2,o,a]}))});function CZ({spinning:n}){const e=fe.useRef(null),t=EA("/football-texture.svg");return jm((r,i)=>{if(!e.current)return;const s=r.clock.getElapsedTime(),o=n?1:0,a=n?7.2:1.6,l=n?3.1:.7;e.current.rotation.y+=i*a,e.current.rotation.x+=i*l,e.current.position.y=.07*Math.sin(s*(1.3+o*2.8))+.025*Math.sin(s*(2.7+o*4.4)),e.current.rotation.z=(n?.16:.05)*Math.sin(s*(2.4+o*1.6))}),F.jsxs("mesh",{ref:e,castShadow:!0,receiveShadow:!0,children:[F.jsx("sphereGeometry",{args:[1.1,96,96]}),F.jsx("meshStandardMaterial",{map:t,roughness:.48,metalness:.12,envMapIntensity:.8})]})}function IZ({spinning:n}){return F.jsx("div",{className:"football-scene","aria-hidden":"true",children:F.jsxs(PQ,{camera:{position:[0,.25,3.8],fov:46},shadows:!0,dpr:[1,2],children:[F.jsx("ambientLight",{intensity:.45}),F.jsx("hemisphereLight",{args:["#dbeafe","#0b1220",.45]}),F.jsx("spotLight",{position:[2.2,4.4,2.8],angle:.35,penumbra:.7,intensity:1.45,castShadow:!0,"shadow-mapSize-width":1024,"shadow-mapSize-height":1024}),F.jsx(lZ,{speed:n?3.3:1.25,rotationIntensity:n?1.15:.38,floatIntensity:n?.7:.35,children:F.jsx(CZ,{spinning:n})}),F.jsx(AZ,{position:[0,-1.28,0],opacity:.5,scale:4.4,blur:2.3,far:2.2}),F.jsx(MZ,{preset:"studio"}),F.jsx(sZ,{enableZoom:!1,enablePan:!1,autoRotate:!0,autoRotateSpeed:n?1.45:.42,maxPolarAngle:Math.PI/1.85,minPolarAngle:Math.PI/2.25})]})})}function bZ({courts:n,schedules:e,holidays:t,newCourtName:r,newHoliday:i,courtPrice:s,newCourtPrice:o,onChangeNewCourt:a,onChangeNewHoliday:l,onChangeCourtPrice:u,onAddCourt:d,onSaveCourtPrice:f,onRemoveCourt:p,onSaveScheduleHour:g,onAddHoliday:y,onRemoveHoliday:S,adminBookings:x,onCancelBooking:v,roleSearch:w,onChangeRoleSearch:T,selectedRoleUser:R,onSelectRoleUser:U,onClearRoleSelection:N,roleSuggestions:P,adminUsers:b,onMakeAdmin:M,onRemoveAdmin:A,onBlockUser:L,onUnblockUser:z,manualBookingData:B,onChangeManualBookingField:$,onCreateManualBooking:he,manualBookableDates:te,manualBookableCourts:ye,manualBookableHours:G,onPrefillManualBooking:Z,onMoveBooking:K,fixedBookings:ce,onUpdateFixedStatus:de,onCancelFixedBooking:ue,raffleDraft:Ee,raffleAnimating:Fe,raffleWinners:ke,onChangeRaffleItemName:Ye,onSpinRaffle:Ct,onPublishRaffleWinner:Dt}){const gt=typeof window<"u"?window.location.origin:"",vt=Hp(new Date),[ie,Be]=fe.useState("canchas"),[Ae,We]=fe.useState("today"),[be,At]=fe.useState(vt),[st,W]=fe.useState(vt),[H,_e]=fe.useState(vt),[Ve,ze]=fe.useState("all"),[De,yt]=fe.useState(!1),[Xe,Qe]=fe.useState(""),[lt,Nt]=fe.useState({date:"",courtId:"",hour:""}),[He,tn]=fe.useState("all"),Ht=fe.useMemo(()=>He==="all"?ce:ce.filter(q=>Number(q.weekday)===Number(He)),[ce,He]),xt=fe.useMemo(()=>{if(Ae==="today")return[vt];if(Ae==="exact"&&be)return[be];if(Ae==="range"){const q=st||H,J=H||st;if(!q||!J)return[];const Ne=q<=J?q:J,Ke=q<=J?J:q,Ze=[],ot=new Date(`${Ne}T00:00:00`),$t=new Date(`${Ke}T00:00:00`);for(;ot<=$t&&Ze.length<45;)Ze.push(Hp(ot)),ot.setDate(ot.getDate()+1);return Ze}return[]},[Ae,be,st,H,vt]),ct=fe.useMemo(()=>{const q=new Map;return x.forEach(J=>{q.set(`${J.date}-${J.courtId}-${J.hour}`,J)}),q},[x]),ft=fe.useMemo(()=>{const q=[];return xt.forEach(J=>{const Ne=new Date(`${J}T00:00:00`).getDay();(Ve==="all"?n:n.filter(Ze=>Ze.id===Ve)).forEach(Ze=>{const ot=(e[Ze.id]||Lo)[Ne],rn=(ot&&ot.open<ot.close?Array.from({length:ot.close-ot.open},(sn,gn)=>ot.open+gn):[]).reduce((sn,gn)=>{const Vt=ct.get(`${J}-${Ze.id}-${gn}`);return Vt?(sn.push({type:"reserved",booking:Vt,hour:gn}),sn):(De&&!Mh(J,gn)&&sn.push({type:"free",date:J,courtId:Ze.id,courtName:Ze.name,hour:gn,canManualReserve:te.includes(J)}),sn)},[]);rn.length>0&&q.push({key:`${J}-${Ze.id}`,date:J,dayName:Hh[Ne],court:Ze,rows:rn})})}),q},[xt,Ve,n,e,ct,De,te]),ae=fe.useMemo(()=>{const q=[...new Set([...xt,...te])].sort();return q.length>0?q:[vt]},[xt,te,vt]),Se=fe.useMemo(()=>{if(!lt.date||!lt.courtId)return[];const q=new Date(`${lt.date}T00:00:00`).getDay(),J=(e[lt.courtId]||Lo)[q];return!J||J.open>=J.close?[]:Array.from({length:J.close-J.open},(Ne,Ke)=>J.open+Ke).filter(Ne=>{const Ke=ct.get(`${lt.date}-${lt.courtId}-${Ne}`);return!Ke||Ke.id===Xe})},[lt.date,lt.courtId,e,ct,Xe]),Je=q=>{if(!gt||!(q!=null&&q.id))return"";const J=q.confirmationToken||q.id;return`${gt}/launicafutbol550-stack/?confirmBooking=${q.id}&token=${J}`},ut=(q,J)=>{if(!(q!=null&&q.userPhone))return"";const Ne=Je(q);if(!Ne)return"";const Ke=`Hola ${q.userName||""}, por favor confirm tu turno en ${J||"la cancha"} el ${q.date} a las ${q.hour}:00 ingresando aqu: ${Ne}`;return`https://wa.me/${q.userPhone.replace(/\D/g,"")}?text=${encodeURIComponent(Ke.trim())}`};return F.jsxs("section",{className:"card admin-card",children:[F.jsx("h2",{children:"Administracin"}),F.jsxs("div",{className:"admin-panel-nav",role:"tablist","aria-label":"Paneles de administracin",children:[F.jsx("button",{type:"button",className:ie==="canchas"?"nav-pill nav-pill-active":"nav-pill",onClick:()=>Be("canchas"),children:"Gestin de canchas"}),F.jsx("button",{type:"button",className:ie==="turnos"?"nav-pill nav-pill-active":"nav-pill",onClick:()=>Be("turnos"),children:"Turnos"}),F.jsx("button",{type:"button",className:ie==="turnos-manual"?"nav-pill nav-pill-active":"nav-pill",onClick:()=>Be("turnos-manual"),children:"Cargar turno manual"}),F.jsx("button",{type:"button",className:ie==="turnos-fijos"?"nav-pill nav-pill-active":"nav-pill",onClick:()=>Be("turnos-fijos"),children:"Turnos fijos"}),F.jsx("button",{type:"button",className:ie==="roles"?"nav-pill nav-pill-active":"nav-pill",onClick:()=>Be("roles"),children:"Gestin de roles"})]}),F.jsxs("div",{className:"admin-panels",children:[ie==="canchas"&&F.jsxs("article",{className:"admin-panel",children:[F.jsx("h3",{children:"Canchas"}),F.jsx("p",{className:"admin-panel-subtitle",children:"CRUD de canchas, horarios por da y feriados."}),F.jsxs("form",{onSubmit:d,className:"inline-form",children:[F.jsx("input",{type:"text",placeholder:"Nombre de la nueva cancha",value:r,onChange:q=>a(q.target.value)}),F.jsx("button",{type:"submit",children:"Agregar cancha"})]}),n.map(q=>F.jsxs("article",{className:"admin-court",children:[F.jsxs("div",{className:"admin-court-header",children:[F.jsx("h4",{children:q.name}),F.jsx("button",{type:"button",onClick:()=>p(q.id),children:"Quitar cancha"})]}),F.jsx("div",{className:"schedule-grid",children:Object.entries(e[q.id]||Lo).map(([J,Ne])=>F.jsxs("div",{children:[F.jsx("strong",{children:Hh[Number(J)]}),F.jsxs("label",{children:["Desde",F.jsx("input",{type:"number",min:"0",max:"23",value:Ne.open,onChange:Ke=>g(q.id,J,"open",Ke.target.value)})]}),F.jsxs("label",{children:["Hasta",F.jsx("input",{type:"number",min:"1",max:"24",value:Ne.close,onChange:Ke=>g(q.id,J,"close",Ke.target.value)})]})]},`${q.id}-${J}`))})]},`${q.id}-admin`)),F.jsx("h4",{children:"Precio de la cancha"}),F.jsxs("form",{onSubmit:f,className:"inline-form",children:[F.jsx("input",{type:"number",step:"any",value:o,onChange:q=>u(q.target.value),placeholder:"Valor total de la cancha"}),F.jsx("button",{type:"submit",children:"Actualizar precio"})]}),F.jsxs("p",{className:"admin-panel-subtitle",children:["Valor actual: $",s.toLocaleString("es-AR"),"."]}),F.jsx("h4",{children:"Feriados"}),F.jsxs("form",{onSubmit:y,className:"inline-form",children:[F.jsx("input",{type:"date",value:i,onChange:q=>l(q.target.value)}),F.jsx("button",{type:"submit",children:"Agregar feriado"})]}),F.jsx("ul",{children:t.map(q=>F.jsxs("li",{children:[q,F.jsx("button",{type:"button",onClick:()=>S(q),children:"Quitar"})]},q))})]}),ie==="turnos"&&F.jsxs("article",{className:"admin-panel",children:[F.jsx("h3",{children:"Turnos reservados"}),F.jsx("p",{className:"admin-panel-subtitle",children:"Visualizacin agrupada por da/cancha, filtros avanzados y acciones rpidas."}),F.jsxs("section",{className:"manual-booking-card",children:[F.jsx("h4",{children:"Filtros de turnos"}),F.jsxs("div",{className:"day-filter-buttons",role:"group","aria-label":"Filtro por perodo",children:[F.jsx("button",{type:"button",className:Ae==="today"?"nav-pill nav-pill-active":"nav-pill",onClick:()=>We("today"),children:"Hoy"}),F.jsx("button",{type:"button",className:Ae==="exact"?"nav-pill nav-pill-active":"nav-pill",onClick:()=>We("exact"),children:"Fecha exacta"}),F.jsx("button",{type:"button",className:Ae==="range"?"nav-pill nav-pill-active":"nav-pill",onClick:()=>We("range"),children:"Rango de fechas"})]}),Ae==="exact"?F.jsxs("label",{children:["Fecha",F.jsx("input",{type:"date",value:be,onChange:q=>At(q.target.value)})]}):null,Ae==="range"?F.jsxs("div",{className:"admin-filters-grid",children:[F.jsxs("label",{children:["Desde",F.jsx("input",{type:"date",value:st,onChange:q=>W(q.target.value)})]}),F.jsxs("label",{children:["Hasta",F.jsx("input",{type:"date",value:H,onChange:q=>_e(q.target.value)})]})]}):null,F.jsxs("div",{className:"admin-filters-grid",children:[F.jsxs("label",{children:["Cancha",F.jsxs("select",{value:Ve,onChange:q=>ze(q.target.value),children:[F.jsx("option",{value:"all",children:"Todas"}),n.map(q=>F.jsx("option",{value:q.id,children:q.name},`filter-${q.id}`))]})]}),F.jsxs("label",{className:"checkbox-label",children:[F.jsx("input",{type:"checkbox",checked:De,onChange:q=>yt(q.target.checked)}),"Mostrar registros libres"]})]})]}),Xe?F.jsxs("section",{className:"manual-booking-card",children:[F.jsx("h4",{children:"Mover turno reservado"}),F.jsxs("div",{className:"admin-filters-grid",children:[F.jsxs("label",{children:["Fecha nueva",F.jsx("select",{value:lt.date,onChange:q=>Nt(J=>({...J,date:q.target.value,hour:""})),children:ae.map(q=>F.jsx("option",{value:q,children:q},`move-date-${q}`))})]}),F.jsxs("label",{children:["Cancha nueva",F.jsx("select",{value:lt.courtId,onChange:q=>Nt(J=>({...J,courtId:q.target.value,hour:""})),children:n.map(q=>F.jsx("option",{value:q.id,children:q.name},`move-court-${q.id}`))})]}),F.jsxs("label",{children:["Hora nueva",F.jsxs("select",{value:lt.hour,onChange:q=>Nt(J=>({...J,hour:q.target.value})),children:[Se.length===0?F.jsx("option",{value:"",children:"Sin horarios libres"}):null,Se.map(q=>F.jsxs("option",{value:q,children:[q,":00"]},`move-hour-${q}`))]})]})]}),F.jsxs("div",{className:"role-actions",children:[F.jsx("button",{type:"button",disabled:!lt.date||!lt.courtId||lt.hour==="",onClick:()=>{K(Xe,{date:lt.date,courtId:lt.courtId,hour:Number(lt.hour)}),Qe("")},children:"Guardar cambios"}),F.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>Qe(""),children:"Cancelar edicin"})]})]}):null,F.jsx("div",{className:"admin-table-wrapper",children:F.jsxs("table",{className:"admin-table",children:[F.jsx("thead",{children:F.jsxs("tr",{children:[F.jsx("th",{children:"Hora"}),F.jsx("th",{children:"Cliente"}),F.jsx("th",{children:"Estado"}),F.jsx("th",{children:"WhatsApp"}),F.jsx("th",{children:"Confirmacin"}),F.jsx("th",{children:"Acciones"})]})}),F.jsx("tbody",{children:ft.length===0?F.jsx("tr",{children:F.jsx("td",{colSpan:6,children:"No hay registros para los filtros seleccionados."})}):ft.flatMap(q=>[F.jsx("tr",{className:"group-day-header-row",children:F.jsxs("td",{colSpan:6,children:[" ",q.dayName,"  ",q.date]})},`${q.key}-day`),F.jsx("tr",{className:"group-court-subheader-row",children:F.jsxs("td",{colSpan:6,children:[" ",q.court.name]})},`${q.key}-court`),...q.rows.map(J=>{if(J.type==="free")return F.jsxs("tr",{className:"free-slot-row",children:[F.jsxs("td",{"data-label":"Hora",children:[J.hour,":00"]}),F.jsx("td",{"data-label":"Cliente",children:"-"}),F.jsx("td",{"data-label":"Estado",children:"Libre"}),F.jsx("td",{"data-label":"WhatsApp",children:"-"}),F.jsx("td",{"data-label":"Confirmacin",children:"-"}),F.jsx("td",{"data-label":"Acciones",children:F.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{J.canManualReserve&&(Z({date:J.date,courtId:J.courtId,hour:J.hour}),Be("turnos-manual"))},disabled:!J.canManualReserve,children:"Reservar"})})]},`${q.key}-free-${J.hour}`);const Ne=J.booking,Ke=ut(Ne,q.court.name);return F.jsxs("tr",{children:[F.jsxs("td",{"data-label":"Hora",children:[Ne.hour,":00"]}),F.jsx("td",{"data-label":"Cliente",children:Ne.userName||"-"}),F.jsx("td",{"data-label":"Estado",children:Ne.status||"reservado"}),F.jsx("td",{"data-label":"WhatsApp",children:Ne.userPhone?F.jsx("a",{className:"btn-whatsapp",href:`https://wa.me/${Ne.userPhone.replace(/\D/g,"")}`,target:"_blank",rel:"noreferrer",children:"WhatsApp"}):"-"}),F.jsx("td",{"data-label":"Confirmacin",children:Ne.status==="confirmado"?F.jsx("span",{className:"confirm-check",children:" Confirmado"}):Ke?F.jsx("a",{className:"btn-secondary btn-confirm",href:Ke,target:"_blank",rel:"noreferrer",children:"Solicitar confirmacin"}):"-"}),F.jsx("td",{"data-label":"Acciones",children:F.jsxs("div",{className:"admin-actions-cell",children:[F.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{var Ze;Qe(Ne.id),Nt({date:Ne.date||ae[0]||vt,courtId:Ne.courtId||((Ze=n[0])==null?void 0:Ze.id)||"",hour:String(Ne.hour??"")})},children:"Modificar / mover"}),F.jsx("button",{type:"button",className:"btn-cancel",onClick:()=>v(Ne.id),children:"Cancelar"})]})})]},Ne.id)})])})]})})]}),ie==="turnos-manual"&&F.jsxs("article",{className:"admin-panel",children:[F.jsx("h3",{children:"Cargar turno manual"}),F.jsx("p",{className:"admin-panel-subtitle",children:"Us esta herramienta para reservar un turno a nombre de una persona sin cuenta."}),F.jsx("section",{className:"manual-booking-card",children:F.jsxs("form",{className:"manual-booking-form",onSubmit:he,children:[F.jsxs("label",{children:["Fecha",F.jsxs("select",{value:B.date,onChange:q=>$("date",q.target.value),disabled:te.length===0,children:[te.length===0&&F.jsx("option",{value:"",children:"Sin fechas disponibles"}),te.map(q=>F.jsx("option",{value:q,children:q},q))]})]}),F.jsxs("label",{children:["Cancha",F.jsxs("select",{value:B.courtId,onChange:q=>$("courtId",q.target.value),disabled:ye.length===0,children:[ye.length===0&&F.jsx("option",{value:"",children:"Sin canchas disponibles"}),ye.map(q=>F.jsx("option",{value:q.id,children:q.name},q.id))]})]}),F.jsxs("label",{children:["Horario",F.jsxs("select",{value:B.hour,onChange:q=>$("hour",q.target.value),disabled:G.length===0,children:[G.length===0&&F.jsx("option",{value:"",children:"Sin horarios disponibles"}),G.map(q=>F.jsxs("option",{value:q,children:[q,":00"]},`${B.courtId}-${q}`))]})]}),F.jsxs("label",{children:["Nombre",F.jsx("input",{type:"text",value:B.firstName,onChange:q=>$("firstName",q.target.value),placeholder:"Nombre"})]}),F.jsxs("label",{children:["Apellido",F.jsx("input",{type:"text",value:B.lastName,onChange:q=>$("lastName",q.target.value),placeholder:"Apellido"})]}),F.jsxs("label",{children:["Telfono",F.jsx("input",{type:"tel",value:B.phone,onChange:q=>$("phone",q.target.value),placeholder:"+54 11 1234-5678"})]}),F.jsx("button",{type:"submit",disabled:te.length===0||ye.length===0||G.length===0,children:"Cargar turno manual"})]})})]}),ie==="turnos-fijos"&&F.jsxs("article",{className:"admin-panel",children:[F.jsx("h3",{children:"Administracin de turnos fijos"}),F.jsx("p",{className:"admin-panel-subtitle",children:"Seccin dedicada para pausar, reactivar o cancelar turnos semanales."}),F.jsxs("div",{className:"day-filter-buttons",role:"group","aria-label":"Filtrar turnos fijos por da de la semana",children:[F.jsx("button",{type:"button",className:He==="all"?"nav-pill nav-pill-active":"nav-pill",onClick:()=>tn("all"),children:"Todos"}),Hh.map((q,J)=>F.jsx("button",{type:"button",className:He===String(J)?"nav-pill nav-pill-active":"nav-pill",onClick:()=>tn(String(J)),children:q},`fixed-${q}`))]}),F.jsx("div",{className:"admin-table-wrapper",children:F.jsxs("table",{className:"admin-table",children:[F.jsx("thead",{children:F.jsxs("tr",{children:[F.jsx("th",{children:"Cliente"}),F.jsx("th",{children:"Cancha"}),F.jsx("th",{children:"Da"}),F.jsx("th",{children:"Hora"}),F.jsx("th",{children:"Estado"}),F.jsx("th",{children:"Acciones"})]})}),F.jsx("tbody",{children:Ht.length===0?F.jsx("tr",{children:F.jsx("td",{colSpan:6,children:"No hay turnos fijos."})}):Ht.map(q=>{var Ne;const J=((Ne=n.find(Ke=>Ke.id===q.courtId))==null?void 0:Ne.name)||q.courtId;return F.jsxs("tr",{children:[F.jsx("td",{"data-label":"Cliente",children:q.userName||"-"}),F.jsx("td",{"data-label":"Cancha",children:J}),F.jsx("td",{"data-label":"Da",children:Hh[q.weekday]||"-"}),F.jsxs("td",{"data-label":"Hora",children:[q.hour,":00"]}),F.jsx("td",{"data-label":"Estado",children:q.status}),F.jsxs("td",{"data-label":"Acciones",children:[q.status==="active"?F.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>de(q.id,"paused"),children:"Pausar"}):q.status==="paused"?F.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>de(q.id,"active"),children:"Reactivar"}):null,q.status!=="cancelled"&&F.jsx("button",{type:"button",className:"btn-cancel",onClick:()=>ue(q.id),children:"Cancelar"})]})]},q.id)})})]})})]}),ie==="roles"&&F.jsxs("article",{className:"admin-panel",children:[F.jsx("h3",{children:"Gestin de roles"}),F.jsx("p",{className:"admin-panel-subtitle",children:"Asign o quit permisos de administrador."}),F.jsxs("div",{className:"role-manager",children:[F.jsxs("label",{className:"role-search",children:["Buscar usuario por email",F.jsx("input",{type:"text",placeholder:"ejemplo@correo.com",value:w,onChange:q=>T(q.target.value)})]}),P.length>0&&F.jsx("ul",{className:"role-suggestions",children:P.map(q=>F.jsxs("li",{children:[F.jsx("span",{children:q.email}),F.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>U(q),children:"Seleccionar"})]},q.id))}),R?F.jsxs("div",{className:"role-selected-user",children:[F.jsxs("p",{children:["Usuario seleccionado: ",F.jsx("strong",{children:R.email})]}),F.jsxs("p",{children:["Estado: ",F.jsx("strong",{children:R.isBlocked?"Bloqueado":"Activo"})]}),F.jsxs("div",{className:"role-actions",children:[F.jsx("button",{type:"button",onClick:()=>M(R.id),children:"Hacer administrador"}),R.isBlocked?F.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>z(R.id),children:"Desbloquear usuario"}):F.jsx("button",{type:"button",className:"btn-cancel",onClick:()=>L(R.id),children:"Bloquear usuario"}),F.jsx("button",{type:"button",className:"btn-secondary",onClick:N,children:"Limpiar seleccin"})]})]}):null]}),F.jsxs("div",{className:"admin-users-list",children:[F.jsx("h4",{children:"Administradores actuales"}),b.length===0?F.jsx("p",{children:"No hay administradores asignados."}):F.jsx("ul",{children:b.map(q=>F.jsxs("li",{children:[F.jsx("span",{children:q.email}),F.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>A(q.id),children:"Quitar admin"})]},q.id))})]})]}),ie==="sorteos"&&F.jsxs("article",{className:"admin-panel raffle-panel",children:[F.jsx("h3",{children:"Ruleta de sorteos"}),F.jsx("p",{className:"admin-panel-subtitle",children:"Eleg el artculo, gir la ruleta y public el resultado oficial."}),F.jsxs("label",{children:["Artculo a sortear",F.jsx("input",{type:"text",placeholder:"Ej: Camiseta oficial",value:Ee.itemName,onChange:q=>Ye(q.target.value)})]}),F.jsxs("div",{className:Fe?"raffle-wheel raffle-wheel-spinning":"raffle-wheel",children:[F.jsx(IZ,{spinning:Fe}),F.jsxs("p",{className:"raffle-wheel-title",children:["El ganador de ",Ee.itemName||"..."," es:"]}),F.jsx("p",{className:"raffle-wheel-name",children:Ee.winnerName||" Gir la ruleta "})]}),F.jsxs("div",{className:"raffle-actions",children:[F.jsx("button",{type:"button",onClick:Ct,disabled:Fe,children:Fe?"Girando...":"Girar ruleta"}),F.jsx("button",{type:"button",className:"btn-secondary",onClick:Dt,disabled:Fe||!Ee.winnerId,children:"Hacer oficial el sorteo"}),Ee.winnerPhone?F.jsx("a",{className:"btn-whatsapp",href:`https://wa.me/${Ee.winnerPhone.replace(/\D/g,"")}`,target:"_blank",rel:"noreferrer",children:"Contactar ganador por WhatsApp"}):null]}),F.jsxs("section",{children:[F.jsx("h4",{children:"Ganadores de los ltimos sorteos"}),ke.length===0?F.jsx("p",{children:"Todava no hay resultados publicados."}):F.jsx("ul",{className:"raffle-history-list",children:ke.map(q=>F.jsxs("li",{className:"raffle-history-item",children:[F.jsxs("span",{children:[q.drawDate,"  ",q.itemName,"  ",F.jsx("strong",{children:q.winnerName})]}),q.winnerPhone?F.jsx("a",{className:"btn-whatsapp",href:`https://wa.me/${q.winnerPhone.replace(/\D/g,"")}`,target:"_blank",rel:"noreferrer",children:"WhatsApp"}):null]},q.id))})]})]})]})]})}const mF=["Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"],RZ=n=>{const e=new Date(`${n}T00:00:00`),t=mF[e.getDay()]||"",r=e.getDate();return`${t} ${r}`};function PZ({user:n,bookings:e,fixedBookings:t,courts:r,onCancelBooking:i,onCreateFixedBooking:s,onUpdateFixedStatus:o,onCancelFixedBooking:a,onGoLogin:l}){if(!n)return F.jsxs("section",{className:"card auth-card",children:[F.jsx("h2",{children:"Mis reservas"}),F.jsx("p",{children:"Inici sesin para ver y administrar tus reservas."}),F.jsx("button",{type:"button",onClick:l,children:"Iniciar sesin"})]});const u=r.reduce((d,f)=>(d[f.id]=f.name,d),{});return F.jsxs("section",{className:"card my-bookings-card",children:[F.jsx("h2",{children:"Mis reservas"}),e.length===0?F.jsx("p",{children:"No tens reservas activas."}):F.jsx("ul",{className:"bookings-list",children:e.map(d=>F.jsxs("li",{className:"booking-item",children:[F.jsxs("div",{children:[F.jsx("strong",{children:u[d.courtId]||"Cancha"}),F.jsxs("p",{children:[RZ(d.date)," - ",d.hour,":00 hs",d.source==="fixed"?"  Fijo":""]})]}),F.jsxs("div",{className:"booking-item-actions",children:[!d.fixedId&&F.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>s(d),children:"Hacer fijo"}),F.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>i(d),children:"Cancelar"})]})]},d.id))}),F.jsxs("div",{className:"fixed-bookings-section",children:[F.jsx("h3",{children:"Mis turnos fijos"}),t.length===0?F.jsx("p",{children:"No tens turnos fijos."}):F.jsx("ul",{className:"bookings-list",children:t.map(d=>{var f;return F.jsxs("li",{className:"booking-item",children:[F.jsxs("div",{children:[F.jsx("strong",{children:u[d.courtId]||"Cancha"}),F.jsxs("p",{children:["Todos los ",(f=mF[d.weekday])==null?void 0:f.toLowerCase()," - ",d.hour,":00 hs  Estado:"," ",d.status]})]}),F.jsxs("div",{className:"booking-item-actions",children:[d.status==="active"?F.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>o(d.id,"paused"),children:"Pausar"}):d.status==="paused"?F.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>o(d.id,"active"),children:"Reactivar"}):null,d.status!=="cancelled"&&F.jsx("button",{type:"button",className:"btn-cancel",onClick:()=>a(d.id),children:"Cancelar fijo"})]})]},d.id)})})]})]})}function NZ({raffleWinners:n}){return F.jsxs("section",{className:"card raffle-history-card",children:[F.jsx("h2",{children:"Ganadores de los ltimos sorteos"}),F.jsx("p",{className:"admin-panel-subtitle",children:"Resultados oficiales publicados por administracin."}),n.length===0?F.jsx("p",{children:"Todava no hay sorteos oficiales publicados."}):F.jsx("ul",{className:"raffle-history-list",children:n.map(e=>F.jsxs("li",{className:"raffle-history-item",children:[F.jsxs("p",{children:[F.jsx("strong",{children:"Fecha:"})," ",e.drawDate]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Artculo:"})," ",e.itemName]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Ganador/a:"})," ",e.winnerName]})]},e.id))})]})}const LZ=new pa,D2=n=>{if(!n)return[];const{open:e,close:t}=n;return e>=t?[]:Array.from({length:t-e},(r,i)=>e+i)},k2=({countryCode:n,areaCode:e,phoneNumber:t})=>`+${n.trim()} ${e.trim()} ${t.trim()}`.replace(/\s+/g," ").trim(),DZ=async n=>{const e=Ou(fr(Bt,"users"),Uu("phone","==",n));return!(await ol(e)).empty},O2=(n="")=>{const e=n.trim().replace(/\s+/g," "),t=e.split(" ").filter(Boolean);if(t.length>=3){const[r,i,...s]=t;return{countryCode:r.replace(/\D/g,""),areaCode:i.replace(/\D/g,""),phoneNumber:s.join("").replace(/\D/g,"")}}return{countryCode:"54",areaCode:"",phoneNumber:e.replace(/\D/g,"")}},mw=n=>!!(n!=null&&n.firstName&&(n!=null&&n.phone)),kZ=n=>!!(n!=null&&n.isBlocked),gw=()=>`${Date.now()}-${Math.random().toString(36).slice(2,10)}`,U2=(n="")=>{const e=n.trim().replace(/\s+/g," ");if(!e)return{firstName:"",lastName:""};const[t,...r]=e.split(" ");return{firstName:t,lastName:r.join(" ")}},Zv=(n,e)=>{const t=(n==null?void 0:n.code)||"",r=(n==null?void 0:n.message)||"";return t==="auth/configuration-not-found"||r.includes("CONFIGURATION_NOT_FOUND")?"No se pudo conectar con Firebase Auth (CONFIGURATION_NOT_FOUND). Verific que el API key pertenezca al proyecto activo y que Authentication est habilitado en Firebase Console.":t==="auth/invalid-api-key"?"El API key de Firebase es invlido. Revis VITE_FIREBASE_API_KEY en tu .env.":t==="auth/network-request-failed"?"No se pudo conectar con Firebase. Revis tu conexin e intent nuevamente.":e},OZ={date:"",courtId:"",hour:"",firstName:"",lastName:"",phone:""},jf=58800,UZ=4,FZ=["active","paused","cancelled"],F2={itemName:"",winnerId:"",winnerName:"",winnerPhone:""},VZ=(n=new Date)=>new Intl.DateTimeFormat("es-AR",{dateStyle:"full",timeStyle:"short"}).format(n),BZ={reservas:{title:"Reservas",description:"Eleg fecha y horario para reservar tu cancha en pocos pasos."},ganadores:{title:"ltimos ganadores",description:"Consult los resultados de los sorteos ms recientes."},"mis-reservas":{title:"Mis reservas",description:"Revis, confirm o cancel tus turnos activos."},registro:{title:"Mi cuenta",description:"Inici sesin, registrate o edit tus datos de perfil."},admin:{title:"Administracin",description:"Configur canchas, horarios, feriados y usuarios."}},vw=n=>{const e=Number(n);return!Number.isFinite(e)||e<0?jf:Math.round(e)};function zZ(){const n=fe.useMemo(()=>VW(7),[]),[e,t]=fe.useState("reservas"),[r,i]=fe.useState("login"),[s,o]=fe.useState(!0),[a,l]=fe.useState(!1),[u,d]=fe.useState(null),[f,p]=fe.useState(null),[g,y]=fe.useState([]),[S,x]=fe.useState({}),[v,w]=fe.useState([]),[T,R]=fe.useState({}),[U,N]=fe.useState([]),[P,b]=fe.useState([]),[M,A]=fe.useState([]),[L,z]=fe.useState(()=>{const oe=Hp(new Date);return n.includes(oe)?oe:n[0]}),[B,$]=fe.useState(""),[he,te]=fe.useState(""),[ye,G]=fe.useState(kR),[Z,K]=fe.useState(ev),[ce,de]=fe.useState(""),[ue,Ee]=fe.useState(""),[Fe,ke]=fe.useState(null),[Ye,Ct]=fe.useState(!1),[Dt,gt]=fe.useState([]),[vt,ie]=fe.useState([]),[Be,Ae]=fe.useState(""),[We,be]=fe.useState(null),[At,st]=fe.useState(!1),[W,H]=fe.useState(OZ),[_e,Ve]=fe.useState(!1),[ze,De]=fe.useState(jf),[yt,Xe]=fe.useState(String(jf)),[Qe,lt]=fe.useState(F2),[Nt,He]=fe.useState([]),[tn,Ht]=fe.useState(!1),xt=!!(f!=null&&f.isAdmin),ct=fe.useMemo(()=>P.filter(oe=>!Mh(oe.date,oe.hour)),[P]),ft=fe.useMemo(()=>M.filter(oe=>oe.userId===(u==null?void 0:u.uid)&&oe.status!=="cancelled"),[M,u==null?void 0:u.uid]),ae=fe.useMemo(()=>M.filter(oe=>oe.status!=="cancelled"),[M]),Se=oe=>typeof window>"u"?!0:window.confirm(oe),Je=oe=>typeof oe=="string"&&oe.trim().length>0,ut=oe=>oe.docs.map(ge=>({id:ge.id,...ge.data()})).sort((ge,Le)=>`${ge.date||""}-${ge.hour||0}`.localeCompare(`${Le.date||""}-${Le.hour||0}`)),q=oe=>oe.docs.map(ge=>({id:ge.id,...ge.data()})).sort((ge,Le)=>`${ge.weekday||0}-${ge.hour||0}`.localeCompare(`${Le.weekday||0}-${Le.hour||0}`)),J=async oe=>{if(!oe){b([]);return}const Le=(await ol(Ou(fr(Bt,"bookings"),Uu("userId","==",oe)))).docs.map(qe=>({id:qe.id,...qe.data()})).sort((qe,ht)=>`${qe.date}-${qe.hour}`.localeCompare(`${ht.date}-${ht.hour}`));b(Le)},Ne=async(oe,ge=!1)=>{if(!oe&&!ge){A([]);return}const Le=ge?fr(Bt,"fixedBookings"):Ou(fr(Bt,"fixedBookings"),Uu("userId","==",oe)),ht=(await ol(Le)).docs.map(rt=>({id:rt.id,...rt.data()})).sort((rt,et)=>`${rt.weekday||0}-${rt.hour||0}`.localeCompare(`${et.weekday||0}-${et.hour||0}`));A(ht)},Ke=async oe=>{if(!oe||oe.status!=="active")return;const ge=new Date(`${oe.startDate}T00:00:00`);if(Number.isNaN(ge.getTime()))return;const Le=new Date;Le.setHours(0,0,0,0);for(let qe=0;qe<UZ;qe+=1){const ht=new Date(Le);ht.setDate(Le.getDate()+qe*7);const rt=(oe.weekday-ht.getDay()+7)%7;if(ht.setDate(ht.getDate()+rt),ht<ge)continue;const et=Hp(ht);if(oe.endDate&&et>oe.endDate||Mh(et,oe.hour))continue;const It=`${et}_${oe.courtId}_${oe.hour}`,Yt=Nn(Bt,"bookings",It);(await wu(Yt)).exists()||await xi(Yt,{courtId:oe.courtId,hour:oe.hour,date:et,userId:oe.userId,userName:oe.userName,userPhone:oe.userPhone,status:"reservado",source:"fixed",fixedId:oe.id,confirmationToken:gw(),createdAt:io()})}};fe.useEffect(()=>{const oe=u6(Zc,async ge=>{var Le,qe,ht;if(d(ge),l(!1),!ge){p(null),b([]),A([]),Ve(!1),o(!1);return}try{const rt=await wu(Nn(Bt,"users",ge.uid));rt.exists()?p(rt.data()):p({firstName:((Le=ge.displayName)==null?void 0:Le.split(" ")[0])||"",lastName:((qe=ge.displayName)==null?void 0:qe.split(" ").slice(1).join(" "))||"",email:ge.email||"",phone:""}),await J(ge.uid),await Ne(ge.uid,!!((ht=rt.data())!=null&&ht.isAdmin))}catch{$("Sesin iniciada, pero no se pudo leer tu perfil.")}finally{o(!1)}});return()=>oe()},[]),fe.useEffect(()=>{const oe=Ro(fr(Bt,"courts"),et=>{const It=et.docs.map(Yt=>({id:Yt.id,...Yt.data()}));y(It)}),ge=Ro(fr(Bt,"schedules"),et=>{const It={};et.docs.forEach(Yt=>{It[Yt.id]=Yt.data()}),x(Yt=>{const Dn={...Yt,...It};return g.forEach(ln=>{Dn[ln.id]||(Dn[ln.id]=Lo)}),Dn})}),Le=Ro(Nn(Bt,"settings","holidays"),et=>{const It=et.exists()?et.data().dates||[]:[];w(It)}),qe=Ro(Nn(Bt,"settings","pricing"),et=>{const It=et.exists()?vw(et.data().courtPrice):jf;De(It),Xe(String(It))}),ht=Ro(fr(Bt,"users"),et=>{const It=et.docs.map(Yt=>({id:Yt.id,...Yt.data()})).filter(Yt=>Yt.email).sort((Yt,Dn)=>Yt.email.localeCompare(Dn.email));gt(It),ie(It.filter(Yt=>Yt.isAdmin))}),rt=Ro(fr(Bt,"raffleHistory"),et=>{const It=et.docs.map(Yt=>({id:Yt.id,...Yt.data()})).sort((Yt,Dn)=>{var Ki,Xr;const ln=((Ki=Yt.createdAt)==null?void 0:Ki.seconds)||0;return(((Xr=Dn.createdAt)==null?void 0:Xr.seconds)||0)-ln}).slice(0,12);He(It)});return()=>{oe(),ge(),Le(),qe(),ht(),rt()}},[]),fe.useEffect(()=>{x(oe=>{const ge={...oe};let Le=!1;return g.forEach(qe=>{ge[qe.id]||(ge[qe.id]=Lo,Le=!0)}),Le?ge:oe})},[g]),fe.useEffect(()=>{const oe=Ro(Ou(fr(Bt,"bookings"),Uu("date","==",L)),ge=>{const Le={};ge.forEach(qe=>{const ht=qe.data();Le[`${ht.courtId}-${ht.hour}`]={id:qe.id,...ht}}),R(Le)});return()=>oe()},[L]),fe.useEffect(()=>{const oe=Ro(fr(Bt,"bookings"),ge=>{N(ut(ge))});return()=>oe()},[]),fe.useEffect(()=>{if(!(u!=null&&u.uid)){b([]);return}const oe=Ro(Ou(fr(Bt,"bookings"),Uu("userId","==",u.uid)),ge=>{b(ut(ge))});return()=>oe()},[u==null?void 0:u.uid]),fe.useEffect(()=>{if(!(u!=null&&u.uid)&&!xt){A([]);return}const oe=xt?fr(Bt,"fixedBookings"):Ou(fr(Bt,"fixedBookings"),Uu("userId","==",u.uid)),ge=Ro(oe,Le=>{A(q(Le))});return()=>ge()},[xt,u==null?void 0:u.uid]);const Ze=async oe=>{var Nc;const Le=(await ol(fr(Bt,"courts"))).docs.map(yn=>({id:yn.id,...yn.data()}));y(Le);const qe={};await Promise.all(Le.map(async yn=>{const Vr=await wu(Nn(Bt,"schedules",yn.id));qe[yn.id]=Vr.exists()?Vr.data():Lo})),x(qe);const ht=await wu(Nn(Bt,"settings","holidays")),rt=ht.exists()?ht.data().dates||[]:[];w(rt);const et=await wu(Nn(Bt,"settings","pricing")),It=et.exists()?vw(et.data().courtPrice):jf;De(It),Xe(String(It));const Yt=await ol(Ou(fr(Bt,"bookings"),Uu("date","==",oe))),Dn={};Yt.forEach(yn=>{const Vr=yn.data();Dn[`${Vr.courtId}-${Vr.hour}`]={id:yn.id,...Vr}}),R(Dn);const Us=(await ol(fr(Bt,"bookings"))).docs.map(yn=>({id:yn.id,...yn.data()})).sort((yn,Vr)=>`${yn.date||""}-${yn.hour||0}`.localeCompare(`${Vr.date||""}-${Vr.hour||0}`));N(Us);const Xr=(await ol(fr(Bt,"users"))).docs.map(yn=>({id:yn.id,...yn.data()})).filter(yn=>yn.email).sort((yn,Vr)=>yn.email.localeCompare(Vr.email));gt(Xr),ie(Xr.filter(yn=>yn.isAdmin));const Pc=(await ol(fr(Bt,"raffleHistory"))).docs.map(yn=>({id:yn.id,...yn.data()})).sort((yn,Vr)=>{var Ni,vn;const Qo=((Ni=yn.createdAt)==null?void 0:Ni.seconds)||0;return(((vn=Vr.createdAt)==null?void 0:vn.seconds)||0)-Qo}).slice(0,12);He(Pc),u!=null&&u.uid&&await Ne(u.uid,!!((Nc=Xr.find(yn=>yn.id===u.uid))!=null&&Nc.isAdmin))};fe.useEffect(()=>{Ze(L)},[L]),fe.useEffect(()=>{const oe=new URLSearchParams(window.location.search),ge=oe.get("confirmBooking"),Le=oe.get("token");if(!ge||!Le){ke(null);return}ke({bookingId:ge,token:Le})},[]),fe.useEffect(()=>{u&&!mw(f)&&(t("registro"),i("register"))},[u,f]),fe.useEffect(()=>{!xt&&e==="admin"&&t("reservas")},[e,xt]);const ot=oe=>{i(oe),Ve(!1),t("registro")},$t=async()=>{if(!a){$(""),l(!0);try{await k6(Zc,LZ)}catch(oe){$(Zv(oe,"No se pudo iniciar sesin con Google.")),l(!1)}}},rn=async oe=>{oe.preventDefault(),$(""),l(!0);try{await o6(Zc,ye.email,ye.password),G(kR),te("Sesin iniciada."),t("reservas")}catch(ge){$(Zv(ge,"No se pudo iniciar sesin. Verific tus credenciales."))}finally{l(!1)}},sn=async oe=>{if(oe.preventDefault(),$(""),!Z.countryCode||!Z.areaCode||!Z.phoneNumber){$("Complet cdigo de pas, cdigo de rea y nmero de telfono.");return}l(!0);try{const ge=k2(Z),{firstName:Le,lastName:qe}=U2(Z.fullName);if(!Le){$("Complet tu nombre y apellido.");return}if(await DZ(ge)){$("Ese telfono ya est registrado. Us otro nmero o inici sesin.");return}const ht=await s6(Zc,Z.email,Z.password),rt={firstName:Le.trim(),lastName:qe.trim(),phone:ge,email:Z.email.trim()};await xi(Nn(Bt,"users",ht.user.uid),rt,{merge:!0}),p(rt),K(ev),te("Cuenta creada correctamente."),Ve(!1),t("reservas")}catch(ge){$(Zv(ge,"No se pudo registrar la cuenta."))}finally{l(!1)}},gn=async()=>{const oe=ye.email.trim();if($(""),te(""),!oe){$("Ingres tu correo para enviarte el link de recuperacin.");return}l(!0);try{await i6(Zc,oe),te("Te enviamos un enlace para recuperar tu contrasea. Revis tu correo.")}catch(ge){$(Zv(ge,"No se pudo enviar el correo de recuperacin. Verific el email e intent de nuevo."))}finally{l(!1)}},Vt=async oe=>{if(oe.preventDefault(),!!u){if($(""),!Z.countryCode||!Z.areaCode||!Z.phoneNumber){$("Complet cdigo de pas, cdigo de rea y nmero de telfono.");return}l(!0);try{const{firstName:ge,lastName:Le}=U2(Z.fullName);if(!ge){$("Complet tu nombre y apellido.");return}const qe={firstName:ge.trim(),lastName:Le.trim(),phone:k2(Z),email:u.email||(f==null?void 0:f.email)||""};await xi(Nn(Bt,"users",u.uid),qe,{merge:!0}),p(qe),K(ev),Ve(!1),te("Perfil guardado correctamente.")}catch{$("No se pudo guardar tu perfil.")}finally{l(!1)}}},$n=async()=>{Se("Ests seguro de que quers cerrar sesin?")&&(await c6(Zc),te("Sesin cerrada."))},ur=()=>{const oe=O2((f==null?void 0:f.phone)||"");K(ge=>({...ge,fullName:`${(f==null?void 0:f.firstName)||""} ${(f==null?void 0:f.lastName)||""}`.trim(),countryCode:oe.countryCode,areaCode:oe.areaCode,phoneNumber:oe.phoneNumber})),$(""),Ve(!0)},qr=()=>{K(ev),$(""),Ve(!1)},eo=async(oe,ge)=>{if(At)return;if(!u||!mw(f)){te("Necesits iniciar sesin y completar tus datos para reservar."),ot(u?"register":"login");return}if(kZ(f)){te("Tu usuario est bloqueado para reservar turnos. Contact a administracin.");return}const Le=`${oe}-${ge}`;if(T[Le])return;if(Mh(L,ge)){te("Ese horario ya pas segn la hora de Argentina (GMT-3).");return}if(Object.values(T).some(ht=>ht.userId===u.uid)){te("Solo pods reservar un turno por da. Cancel tu reserva actual para tomar otro horario."),t("mis-reservas");return}if(Se(`Ests seguro de que quers reservar el turno de las ${ge}:00?`)){st(!0);try{await _E(Bt,async ht=>{const rt=`${L}_${oe}_${ge}`,et=Nn(Bt,"bookings",rt);if((await ht.get(et)).exists())throw new Error("SLOT_ALREADY_BOOKED");ht.set(et,{courtId:oe,hour:ge,date:L,userId:u.uid,userName:`${(f==null?void 0:f.firstName)||""} ${(f==null?void 0:f.lastName)||""}`.trim(),userPhone:(f==null?void 0:f.phone)||"",status:"reservado",confirmationToken:gw(),createdAt:io()})}),te(`Turno reservado para las ${ge}:00.`),await Promise.all([Ze(L),J(u.uid)])}catch(ht){ht instanceof Error&&ht.message==="SLOT_ALREADY_BOOKED"?te("Ese turno ya fue reservado por otra persona. Eleg otro horario."):te("No se pudo reservar el turno. Intent nuevamente."),await Ze(L)}finally{st(!1)}}},ci=async oe=>{if(oe!=null&&oe.id){if(HW(oe.date,oe.hour)){te("Es muy tarde para cancelar el turno.");return}Se("Ests seguro de que quers cancelar esta reserva?")&&(await _f(Nn(Bt,"bookings",oe.id)),te("Reserva cancelada correctamente."),await Promise.all([Ze(L),J(u==null?void 0:u.uid)]))}},tr=async oe=>{if(!u||!(oe!=null&&oe.id))return;if(oe.source==="fixed"&&oe.fixedId){te("Este turno ya pertenece a un turno fijo.");return}const ge=new Date(`${oe.date}T00:00:00`).getDay();if(M.find(rt=>rt.userId===u.uid&&rt.courtId===oe.courtId&&rt.hour===oe.hour&&rt.weekday===ge&&rt.status!=="cancelled")){te("Ya tens un turno fijo activo o pausado para ese da y horario.");return}if(!Se("Quers convertir este turno en fijo semanal?"))return;const qe=await Jg(fr(Bt,"fixedBookings"),{userId:u.uid,userName:oe.userName,userPhone:oe.userPhone,courtId:oe.courtId,weekday:ge,hour:oe.hour,status:"active",startDate:oe.date,createdAt:io(),updatedAt:io()}),ht={id:qe.id,userId:u.uid,userName:oe.userName,userPhone:oe.userPhone,courtId:oe.courtId,weekday:ge,hour:oe.hour,status:"active",startDate:oe.date};await xi(Nn(Bt,"bookings",oe.id),{source:"fixed",fixedId:qe.id},{merge:!0}),await Ke(ht),await Ze(L),await J(u.uid),te("Turno fijo creado. Vamos a ir generando tus prximos turnos semanales.")},Zt=async(oe,ge)=>{if(!Je(oe)){te("No se pudo identificar el turno fijo a actualizar.");return}if(!FZ.includes(ge)){te("Estado de turno fijo invlido.");return}if(await xi(Nn(Bt,"fixedBookings",oe),{status:ge,updatedAt:io()},{merge:!0}),ge==="active"){const Le=await wu(Nn(Bt,"fixedBookings",oe));Le.exists()&&await Ke({id:oe,...Le.data()})}await Ne(u==null?void 0:u.uid,xt),await Ze(L),u!=null&&u.uid&&await J(u.uid)},Os=async oe=>{if(!Je(oe)){te("No se pudo identificar el turno fijo a cancelar.");return}Se("Quers cancelar definitivamente este turno fijo?")&&(await xi(Nn(Bt,"fixedBookings",oe),{status:"cancelled",cancelledBy:xt?"admin":"user",updatedAt:io()},{merge:!0}),te("Turno fijo cancelado."),await Ne(u==null?void 0:u.uid,xt))},us=async oe=>{Se("Ests seguro de que quers cancelar este turno?")&&(await _f(Nn(Bt,"bookings",oe)),te("Turno cancelado desde administracin."),await Promise.all([Ze(L),J(u==null?void 0:u.uid)]))},V=({date:oe,courtId:ge,hour:Le})=>{t("admin"),H(qe=>({...qe,date:oe||qe.date,courtId:ge||qe.courtId,hour:Le!=null?String(Le):qe.hour})),te("Se precarg el turno libre en la planilla manual.")},X=async(oe,ge)=>{if(!oe||!(ge!=null&&ge.date)||!(ge!=null&&ge.courtId)||(ge==null?void 0:ge.hour)===void 0||(ge==null?void 0:ge.hour)===null){te("Complet fecha, cancha y horario para mover el turno.");return}if(Se("Quers mover este turno a la nueva fecha/horario?"))try{await _E(Bt,async Le=>{const qe=Nn(Bt,"bookings",oe),ht=await Le.get(qe);if(!ht.exists())throw new Error("BOOKING_NOT_FOUND");const rt=ht.data(),et=`${ge.date}_${ge.courtId}_${Number(ge.hour)}`,It=Nn(Bt,"bookings",et);if((await Le.get(It)).exists()&&et!==oe)throw new Error("SLOT_ALREADY_BOOKED");Le.set(It,{...rt,date:ge.date,courtId:ge.courtId,hour:Number(ge.hour),updatedAt:io()}),et!==oe&&Le.delete(qe)}),te("Turno movido correctamente."),await Promise.all([Ze(L),J(u==null?void 0:u.uid)])}catch(Le){Le instanceof Error&&Le.message==="SLOT_ALREADY_BOOKED"?te("El nuevo horario ya est ocupado por otro turno."):Le instanceof Error&&Le.message==="BOOKING_NOT_FOUND"?te("El turno original ya no existe."):te("No se pudo mover el turno. Intent nuevamente."),await Ze(L)}},le=async oe=>{Se("Ests seguro de que quers otorgar permisos de administrador?")&&(await xi(Nn(Bt,"users",oe),{isAdmin:!0},{merge:!0}),te("Usuario actualizado como administrador."),be(null),Ae(""),await Ze(L))},O=async oe=>{Se("Ests seguro de que quers bloquear a este usuario?")&&(await xi(Nn(Bt,"users",oe),{isBlocked:!0},{merge:!0}),te("Usuario bloqueado para reservar turnos."),(We==null?void 0:We.id)===oe&&be(ge=>ge&&{...ge,isBlocked:!0}),await Ze(L))},Y=async oe=>{Se("Ests seguro de que quers desbloquear a este usuario?")&&(await xi(Nn(Bt,"users",oe),{isBlocked:!1},{merge:!0}),te("Usuario desbloqueado."),(We==null?void 0:We.id)===oe&&be(ge=>ge&&{...ge,isBlocked:!1}),await Ze(L))},ee=async oe=>{Se("Ests seguro de que quers quitar los permisos de administrador?")&&(await xi(Nn(Bt,"users",oe),{isAdmin:!1},{merge:!0}),te("Permiso de administrador removido."),await Ze(L))},se=async oe=>{if(!(!Fe||Ye)){Ct(!0);try{const ge=Nn(Bt,"bookings",Fe.bookingId),Le=await wu(ge);if(!Le.exists()){te("El turno no existe o ya fue eliminado.");return}const qe=Le.data();if((qe.confirmationToken||Fe.bookingId)!==Fe.token){te("El enlace de confirmacin no es vlido.");return}if(oe){if(!Se("Ests seguro de que quers confirmar tu asistencia?"))return;qe.status!=="confirmado"?(await xi(ge,{status:"confirmado",confirmedAt:io()},{merge:!0}),te("Gracias! Confirmaste tu asistencia al turno.")):te("Este turno ya estaba confirmado.")}else{if(!Se("Ests seguro de que quers liberar este turno?"))return;await _f(ge),te("Liberaste el turno correctamente para otra persona.")}await Ze(L),u!=null&&u.uid&&await J(u.uid),ke(null),window.history.replaceState({},"",window.location.pathname)}catch{te("No se pudo procesar la confirmacin del turno.")}finally{Ct(!1)}}},re=async oe=>{if(oe.preventDefault(),!ce.trim()||!Se("Ests seguro de que quers agregar esta cancha?"))return;const ge=await Jg(fr(Bt,"courts"),{name:ce.trim()});await xi(Nn(Bt,"schedules",ge.id),Lo),de(""),te("Cancha agregada correctamente."),await Ze(L)},xe=async oe=>{Se("Ests seguro de que quers eliminar esta cancha?")&&(await _f(Nn(Bt,"courts",oe)),await _f(Nn(Bt,"schedules",oe)),te("Cancha eliminada."),await Ze(L))},Me=async(oe,ge,Le,qe)=>{const ht=S[oe]||Lo,rt={...ht,[ge]:{...ht[ge],[Le]:Number(qe)}};await xi(Nn(Bt,"schedules",oe),rt),x(et=>({...et,[oe]:rt}))},Re=async oe=>{if(oe.preventDefault(),!ue||v.includes(ue)||!Se("Ests seguro de que quers agregar este feriado?"))return;const ge=[...v,ue].sort();await xi(Nn(Bt,"settings","holidays"),{dates:ge}),w(ge),Ee("")},Ce=async oe=>{if(!Se("Ests seguro de que quers quitar este feriado?"))return;const ge=v.filter(Le=>Le!==oe);await xi(Nn(Bt,"settings","holidays"),{dates:ge}),w(ge)},Et=async oe=>{oe.preventDefault();const ge=vw(yt);Se("Ests seguro de que quers actualizar el valor de la cancha?")&&(await xi(Nn(Bt,"settings","pricing"),{courtPrice:ge},{merge:!0}),De(ge),Xe(String(ge)),te("Valor de la cancha actualizado correctamente."))},je=async()=>{if(!xt||tn)return;const oe=Dt.filter(It=>It.firstName&&It.phone);if(!Qe.itemName.trim()){te("Ingres el nombre del artculo antes de girar la ruleta.");return}if(oe.length===0){te("No hay usuarios registrados con nombre y telfono para sortear.");return}Ht(!0);const Le=4200,qe=95;let ht=0;const rt=Math.floor(Le/qe),et=setInterval(()=>{const It=oe[Math.floor(Math.random()*oe.length)];lt(Yt=>({...Yt,winnerId:It.id,winnerName:`${It.firstName||""} ${It.lastName||""}`.trim()||It.email||"Participante",winnerPhone:It.phone||""})),ht+=1,ht>=rt&&(clearInterval(et),Ht(!1))},qe)},$e=async()=>{if(!xt)return;const oe=Qe.itemName.trim();if(!oe){te("Ingres el artculo del sorteo antes de hacerlo oficial.");return}if(!Qe.winnerId){te("Primero gir la ruleta para elegir un ganador.");return}if(!Se("Quers publicar este resultado como oficial?"))return;const ge=VZ(new Date);await Jg(fr(Bt,"raffleHistory"),{itemName:oe,winnerId:Qe.winnerId,winnerName:Qe.winnerName,drawDate:ge,createdAt:io(),publishedBy:(u==null?void 0:u.uid)||null}),await Jg(fr(Bt,"raffleContacts"),{itemName:oe,winnerId:Qe.winnerId,winnerName:Qe.winnerName,winnerPhone:Qe.winnerPhone,drawDate:ge,createdAt:io(),publishedBy:(u==null?void 0:u.uid)||null}),lt(F2),te("Sorteo oficial publicado correctamente."),await Ze(L)},mt=new Date(`${L}T00:00:00`).getDay(),Pt=fe.useMemo(()=>g.map(oe=>({...oe,hours:D2((S[oe.id]||Lo)[mt]).filter(ge=>!Mh(L,ge))})),[g,S,mt,L]),Ut=fe.useMemo(()=>{const oe=Be.trim().toLowerCase();return oe?Dt.filter(ge=>ge.email.toLowerCase().includes(oe)).slice(0,8):[]},[Dt,Be]),Gt=fe.useMemo(()=>n.filter(oe=>!v.includes(oe)),[n,v]),pt=fe.useMemo(()=>{if(!W.date)return{courts:[],hoursByCourt:{}};const oe=new Set(U.filter(qe=>qe.date===W.date).map(qe=>`${qe.courtId}-${qe.hour}`)),ge=new Date(`${W.date}T00:00:00`).getDay(),Le={};return g.forEach(qe=>{const ht=(S[qe.id]||Lo)[ge],rt=D2(ht).filter(et=>!Mh(W.date,et)).filter(et=>!oe.has(`${qe.id}-${et}`));Le[qe.id]=rt}),{courts:g.filter(qe=>(Le[qe.id]||[]).length>0),hoursByCourt:Le}},[U,g,W.date,S]);fe.useEffect(()=>{H(oe=>{const ge=Gt[0]||"",Le=oe.date&&Gt.includes(oe.date)?oe.date:ge;return Le!==oe.date?{...oe,date:Le,courtId:"",hour:""}:oe})},[Gt]),fe.useEffect(()=>{H(oe=>{const ge=pt.courts.map(et=>et.id),Le=ge.includes(oe.courtId)?oe.courtId:ge[0]||"",qe=pt.hoursByCourt[Le]||[],ht=Number(oe.hour),rt=qe.includes(ht)?String(ht):String(qe[0]??"");return oe.courtId!==Le||oe.hour!==rt?{...oe,courtId:Le,hour:rt}:oe})},[pt]);const at=async oe=>{oe.preventDefault();const ge=W.firstName.trim(),Le=W.lastName.trim(),qe=W.phone.trim();if(!ge||!Le||!qe){te("Complet nombre, apellido y telfono para cargar el turno manual.");return}if(!W.date||!W.courtId||W.hour===""){te("Seleccion fecha, cancha y horario para registrar el turno manual.");return}const ht=Number(W.hour);if(!(pt.hoursByCourt[W.courtId]||[]).includes(ht)){te("El turno seleccionado ya no est disponible. Eleg otro horario."),await Ze(L);return}if(Se("Ests seguro de que quers cargar este turno manual?"))try{await _E(Bt,async et=>{const It=`${W.date}_${W.courtId}_${ht}`,Yt=Nn(Bt,"bookings",It);if((await et.get(Yt)).exists())throw new Error("SLOT_ALREADY_BOOKED");et.set(Yt,{courtId:W.courtId,hour:ht,date:W.date,userId:null,userName:`${ge} ${Le}`,userPhone:qe,status:"reservado",bookedByAdmin:!0,confirmationToken:gw(),createdAt:io()})}),te("Turno cargado manualmente con xito."),H(et=>({...et,firstName:"",lastName:"",phone:""})),await Ze(L)}catch(et){et instanceof Error&&et.message==="SLOT_ALREADY_BOOKED"?te("Ese turno ya fue reservado por otra persona. Eleg otro horario."):te("No se pudo cargar el turno manual. Intent nuevamente."),await Ze(L)}},Jt=O2((f==null?void 0:f.phone)||""),kt=BZ[e],Wt=oe=>{t(oe),typeof window<"u"&&window.scrollTo({top:0,behavior:"smooth"})},Mn={fullName:Z.fullName||`${(f==null?void 0:f.firstName)||""} ${(f==null?void 0:f.lastName)||""}`.trim(),countryCode:Z.countryCode||Jt.countryCode||"54",areaCode:Z.areaCode||Jt.areaCode,phoneNumber:Z.phoneNumber||Jt.phoneNumber};return F.jsxs("div",{className:"app",children:[F.jsx(qW,{activeSection:e,onChangeSection:Wt,canAccessAdmin:xt}),F.jsxs("section",{className:"auth-topbar","aria-label":"Accesos de cuenta",children:[F.jsx("div",{className:"auth-topbar-status",children:u?F.jsxs("p",{children:["Sesin iniciada como"," ",F.jsx("strong",{children:`${(f==null?void 0:f.firstName)||""} ${(f==null?void 0:f.lastName)||""}`.trim()||u.email})]}):F.jsx("p",{children:"No iniciaste sesin."})}),F.jsx("div",{className:"auth-topbar-actions",children:u?F.jsx("button",{type:"button",className:"btn-secondary",onClick:$n,children:"Cerrar sesin"}):F.jsxs(F.Fragment,{children:[F.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>ot("login"),children:"Login"}),F.jsx("button",{type:"button",onClick:()=>ot("register"),children:"Registrarme"})]})})]}),F.jsx(WW,{}),kt?F.jsxs("section",{className:"section-guide","aria-live":"polite",children:[F.jsx("p",{className:"section-guide-title",children:kt.title}),F.jsx("p",{children:kt.description})]}):null,F.jsxs("main",{children:[s?F.jsx("section",{className:"card",children:F.jsx("p",{children:"Cargando datos..."})}):null,!s&&Fe&&F.jsxs("section",{className:"card confirmation-card",children:[F.jsx("h3",{children:"Confirms la asistencia a tu turno?"}),F.jsx("p",{children:"Eleg una opcin para continuar con tu reserva."}),F.jsxs("div",{className:"confirmation-actions",children:[F.jsx("button",{type:"button",disabled:Ye,onClick:()=>se(!0),children:"S, voy a ir"}),F.jsx("button",{type:"button",className:"btn-secondary",disabled:Ye,onClick:()=>se(!1),children:"No, libero el turno para alguien ms"})]})]}),!s&&e==="reservas"&&F.jsx($W,{user:u,courtPrice:ze,myBookings:P,selectedDate:L,upcomingDates:n,holidays:v,slotsByCourt:Pt,bookingsByCourtHour:T,onChangeDate:z,onBookSlot:eo,onGoLogin:()=>ot("login"),onGoRegister:()=>ot("register"),bookingInProgress:At}),!s&&e==="ganadores"&&F.jsx(NZ,{raffleWinners:Nt}),!s&&e==="mis-reservas"&&F.jsx(PZ,{user:u,bookings:ct,fixedBookings:ft,courts:g,onCancelBooking:ci,onCreateFixedBooking:tr,onUpdateFixedStatus:Zt,onCancelFixedBooking:Os,onGoLogin:()=>ot("login")}),!s&&e==="registro"&&F.jsx(YW,{user:u,profile:f,profileDraft:Mn,authView:r,authError:B,authLoading:a,loginData:ye,registerData:Z,onChangeAuthView:oe=>{i(oe),$("")},onChangeLogin:(oe,ge)=>G(Le=>({...Le,[oe]:ge})),onChangeRegister:(oe,ge)=>K(Le=>({...Le,[oe]:ge})),onChangeProfileDraft:(oe,ge)=>K(Le=>({...Le,[oe]:ge})),onLogin:rn,onRecoverPassword:gn,onRegister:sn,onGoogleLogin:$t,onSaveProfile:Vt,onLogout:$n,onStartEditProfile:ur,onCancelEditProfile:qr,editingProfile:_e,profileComplete:mw(f)}),!s&&xt&&e==="admin"&&F.jsx(bZ,{courts:g,schedules:S,holidays:v,newCourtName:ce,newHoliday:ue,courtPrice:ze,newCourtPrice:yt,onChangeNewCourt:de,onChangeNewHoliday:Ee,onChangeCourtPrice:Xe,onAddCourt:re,onSaveCourtPrice:Et,onRemoveCourt:xe,onSaveScheduleHour:Me,onAddHoliday:Re,onRemoveHoliday:Ce,adminBookings:U,onCancelBooking:us,roleSearch:Be,onChangeRoleSearch:Ae,selectedRoleUser:We,onSelectRoleUser:be,onClearRoleSelection:()=>{be(null),Ae("")},roleSuggestions:Ut,adminUsers:vt,onMakeAdmin:le,onRemoveAdmin:ee,onBlockUser:O,onUnblockUser:Y,manualBookingData:W,onChangeManualBookingField:(oe,ge)=>H(Le=>({...Le,[oe]:ge})),onCreateManualBooking:at,manualBookableDates:Gt,manualBookableCourts:pt.courts,manualBookableHours:pt.hoursByCourt[W.courtId]||[],onPrefillManualBooking:V,onMoveBooking:X,fixedBookings:ae,onUpdateFixedStatus:Zt,onCancelFixedBooking:Os,raffleDraft:Qe,raffleAnimating:tn,raffleWinners:Nt,onChangeRaffleItemName:oe=>lt(ge=>({...ge,itemName:oe})),onSpinRaffle:je,onPublishRaffleWinner:$e})]}),he&&F.jsx("p",{className:"status",children:he})]})}QL(document.getElementById("root")).render(F.jsx(u4.StrictMode,{children:F.jsx(zZ,{})}));
